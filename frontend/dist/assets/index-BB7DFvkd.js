var gj=r=>{throw TypeError(r)};var dm=(r,e,t)=>e.has(r)||gj("Cannot "+t);var Rt=(r,e,t)=>(dm(r,e,"read from private field"),t?t.call(r):e.get(r)),en=(r,e,t)=>e.has(r)?gj("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Qs=(r,e,t,n)=>(dm(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),tn=(r,e,t)=>(dm(r,e,"access private method"),t);var xj=(r,e,t,n)=>({set _(i){Qs(r,e,i,t)},get _(){return Rt(r,e,n)}});function _R(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(r,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var um={exports:{}},ml={},hm={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yj;function AR(){if(yj)return Ze;yj=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),f=Symbol.iterator;function m(O){return O===null||typeof O!="object"?null:(O=f&&O[f]||O["@@iterator"],typeof O=="function"?O:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function x(O,U,K){this.props=O,this.context=U,this.refs=y,this.updater=K||g}x.prototype.isReactComponent={},x.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},x.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function b(){}b.prototype=x.prototype;function w(O,U,K){this.props=O,this.context=U,this.refs=y,this.updater=K||g}var k=w.prototype=new b;k.constructor=w,v(k,x.prototype),k.isPureReactComponent=!0;var N=Array.isArray,E=Object.prototype.hasOwnProperty,S={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function C(O,U,K){var se,te={},X=null,Q=null;if(U!=null)for(se in U.ref!==void 0&&(Q=U.ref),U.key!==void 0&&(X=""+U.key),U)E.call(U,se)&&!A.hasOwnProperty(se)&&(te[se]=U[se]);var ae=arguments.length-2;if(ae===1)te.children=K;else if(1<ae){for(var J=Array(ae),ue=0;ue<ae;ue++)J[ue]=arguments[ue+2];te.children=J}if(O&&O.defaultProps)for(se in ae=O.defaultProps,ae)te[se]===void 0&&(te[se]=ae[se]);return{$$typeof:r,type:O,key:X,ref:Q,props:te,_owner:S.current}}function I(O,U){return{$$typeof:r,type:O.type,key:U,ref:O.ref,props:O.props,_owner:O._owner}}function L(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function M(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(K){return U[K]})}var D=/\/+/g;function F(O,U){return typeof O=="object"&&O!==null&&O.key!=null?M(""+O.key):U.toString(36)}function q(O,U,K,se,te){var X=typeof O;(X==="undefined"||X==="boolean")&&(O=null);var Q=!1;if(O===null)Q=!0;else switch(X){case"string":case"number":Q=!0;break;case"object":switch(O.$$typeof){case r:case e:Q=!0}}if(Q)return Q=O,te=te(Q),O=se===""?"."+F(Q,0):se,N(te)?(K="",O!=null&&(K=O.replace(D,"$&/")+"/"),q(te,U,K,"",function(ue){return ue})):te!=null&&(L(te)&&(te=I(te,K+(!te.key||Q&&Q.key===te.key?"":(""+te.key).replace(D,"$&/")+"/")+O)),U.push(te)),1;if(Q=0,se=se===""?".":se+":",N(O))for(var ae=0;ae<O.length;ae++){X=O[ae];var J=se+F(X,ae);Q+=q(X,U,K,J,te)}else if(J=m(O),typeof J=="function")for(O=J.call(O),ae=0;!(X=O.next()).done;)X=X.value,J=se+F(X,ae++),Q+=q(X,U,K,J,te);else if(X==="object")throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return Q}function B(O,U,K){if(O==null)return O;var se=[],te=0;return q(O,se,"","",function(X){return U.call(K,X,te++)}),se}function z(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(K){(O._status===0||O._status===-1)&&(O._status=1,O._result=K)},function(K){(O._status===0||O._status===-1)&&(O._status=2,O._result=K)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var G={current:null},Y={transition:null},H={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:Y,ReactCurrentOwner:S};function V(){throw Error("act(...) is not supported in production builds of React.")}return Ze.Children={map:B,forEach:function(O,U,K){B(O,function(){U.apply(this,arguments)},K)},count:function(O){var U=0;return B(O,function(){U++}),U},toArray:function(O){return B(O,function(U){return U})||[]},only:function(O){if(!L(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Ze.Component=x,Ze.Fragment=t,Ze.Profiler=i,Ze.PureComponent=w,Ze.StrictMode=n,Ze.Suspense=u,Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,Ze.act=V,Ze.cloneElement=function(O,U,K){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var se=v({},O.props),te=O.key,X=O.ref,Q=O._owner;if(U!=null){if(U.ref!==void 0&&(X=U.ref,Q=S.current),U.key!==void 0&&(te=""+U.key),O.type&&O.type.defaultProps)var ae=O.type.defaultProps;for(J in U)E.call(U,J)&&!A.hasOwnProperty(J)&&(se[J]=U[J]===void 0&&ae!==void 0?ae[J]:U[J])}var J=arguments.length-2;if(J===1)se.children=K;else if(1<J){ae=Array(J);for(var ue=0;ue<J;ue++)ae[ue]=arguments[ue+2];se.children=ae}return{$$typeof:r,type:O.type,key:te,ref:X,props:se,_owner:Q}},Ze.createContext=function(O){return O={$$typeof:o,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:a,_context:O},O.Consumer=O},Ze.createElement=C,Ze.createFactory=function(O){var U=C.bind(null,O);return U.type=O,U},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(O){return{$$typeof:l,render:O}},Ze.isValidElement=L,Ze.lazy=function(O){return{$$typeof:c,_payload:{_status:-1,_result:O},_init:z}},Ze.memo=function(O,U){return{$$typeof:h,type:O,compare:U===void 0?null:U}},Ze.startTransition=function(O){var U=Y.transition;Y.transition={};try{O()}finally{Y.transition=U}},Ze.unstable_act=V,Ze.useCallback=function(O,U){return G.current.useCallback(O,U)},Ze.useContext=function(O){return G.current.useContext(O)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(O){return G.current.useDeferredValue(O)},Ze.useEffect=function(O,U){return G.current.useEffect(O,U)},Ze.useId=function(){return G.current.useId()},Ze.useImperativeHandle=function(O,U,K){return G.current.useImperativeHandle(O,U,K)},Ze.useInsertionEffect=function(O,U){return G.current.useInsertionEffect(O,U)},Ze.useLayoutEffect=function(O,U){return G.current.useLayoutEffect(O,U)},Ze.useMemo=function(O,U){return G.current.useMemo(O,U)},Ze.useReducer=function(O,U,K){return G.current.useReducer(O,U,K)},Ze.useRef=function(O){return G.current.useRef(O)},Ze.useState=function(O){return G.current.useState(O)},Ze.useSyncExternalStore=function(O,U,K){return G.current.useSyncExternalStore(O,U,K)},Ze.useTransition=function(){return G.current.useTransition()},Ze.version="18.3.1",Ze}var vj;function Gu(){return vj||(vj=1,hm.exports=AR()),hm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bj;function CR(){if(bj)return ml;bj=1;var r=Gu(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,h){var c,f={},m=null,g=null;h!==void 0&&(m=""+h),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(g=u.ref);for(c in u)n.call(u,c)&&!a.hasOwnProperty(c)&&(f[c]=u[c]);if(l&&l.defaultProps)for(c in u=l.defaultProps,u)f[c]===void 0&&(f[c]=u[c]);return{$$typeof:e,type:l,key:m,ref:g,props:f,_owner:i.current}}return ml.Fragment=t,ml.jsx=o,ml.jsxs=o,ml}var jj;function TR(){return jj||(jj=1,um.exports=CR()),um.exports}var s=TR(),R=Gu();const _r=Wu(R),RR=_R({__proto__:null,default:_r},[R]);var Dd={},fm={exports:{}},Js={},mm={exports:{}},pm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wj;function DR(){return wj||(wj=1,(function(r){function e(Y,H){var V=Y.length;Y.push(H);e:for(;0<V;){var O=V-1>>>1,U=Y[O];if(0<i(U,H))Y[O]=H,Y[V]=U,V=O;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var H=Y[0],V=Y.pop();if(V!==H){Y[0]=V;e:for(var O=0,U=Y.length,K=U>>>1;O<K;){var se=2*(O+1)-1,te=Y[se],X=se+1,Q=Y[X];if(0>i(te,V))X<U&&0>i(Q,te)?(Y[O]=Q,Y[X]=V,O=X):(Y[O]=te,Y[se]=V,O=se);else if(X<U&&0>i(Q,V))Y[O]=Q,Y[X]=V,O=X;else break e}}return H}function i(Y,H){var V=Y.sortIndex-H.sortIndex;return V!==0?V:Y.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var u=[],h=[],c=1,f=null,m=3,g=!1,v=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(Y){for(var H=t(h);H!==null;){if(H.callback===null)n(h);else if(H.startTime<=Y)n(h),H.sortIndex=H.expirationTime,e(u,H);else break;H=t(h)}}function N(Y){if(y=!1,k(Y),!v)if(t(u)!==null)v=!0,z(E);else{var H=t(h);H!==null&&G(N,H.startTime-Y)}}function E(Y,H){v=!1,y&&(y=!1,b(C),C=-1),g=!0;var V=m;try{for(k(H),f=t(u);f!==null&&(!(f.expirationTime>H)||Y&&!M());){var O=f.callback;if(typeof O=="function"){f.callback=null,m=f.priorityLevel;var U=O(f.expirationTime<=H);H=r.unstable_now(),typeof U=="function"?f.callback=U:f===t(u)&&n(u),k(H)}else n(u);f=t(u)}if(f!==null)var K=!0;else{var se=t(h);se!==null&&G(N,se.startTime-H),K=!1}return K}finally{f=null,m=V,g=!1}}var S=!1,A=null,C=-1,I=5,L=-1;function M(){return!(r.unstable_now()-L<I)}function D(){if(A!==null){var Y=r.unstable_now();L=Y;var H=!0;try{H=A(!0,Y)}finally{H?F():(S=!1,A=null)}}else S=!1}var F;if(typeof w=="function")F=function(){w(D)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,B=q.port2;q.port1.onmessage=D,F=function(){B.postMessage(null)}}else F=function(){x(D,0)};function z(Y){A=Y,S||(S=!0,F())}function G(Y,H){C=x(function(){Y(r.unstable_now())},H)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Y){Y.callback=null},r.unstable_continueExecution=function(){v||g||(v=!0,z(E))},r.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(Y){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var V=m;m=H;try{return Y()}finally{m=V}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Y,H){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var V=m;m=Y;try{return H()}finally{m=V}},r.unstable_scheduleCallback=function(Y,H,V){var O=r.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?O+V:O):V=O,Y){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=V+U,Y={id:c++,callback:H,priorityLevel:Y,startTime:V,expirationTime:U,sortIndex:-1},V>O?(Y.sortIndex=V,e(h,Y),t(u)===null&&Y===t(h)&&(y?(b(C),C=-1):y=!0,G(N,V-O))):(Y.sortIndex=U,e(u,Y),v||g||(v=!0,z(E))),Y},r.unstable_shouldYield=M,r.unstable_wrapCallback=function(Y){var H=m;return function(){var V=m;m=H;try{return Y.apply(this,arguments)}finally{m=V}}}})(pm)),pm}var Nj;function PR(){return Nj||(Nj=1,mm.exports=DR()),mm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kj;function MR(){if(kj)return Js;kj=1;var r=Gu(),e=PR();function t(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,j=1;j<arguments.length;j++)p+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(d,p){o(d,p),o(d+"Capture",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)n.add(p[d])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},f={};function m(d){return u.call(f,d)?!0:u.call(c,d)?!1:h.test(d)?f[d]=!0:(c[d]=!0,!1)}function g(d,p,j,_){if(j!==null&&j.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return _?!1:j!==null?!j.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function v(d,p,j,_){if(p===null||typeof p>"u"||g(d,p,j,_))return!0;if(_)return!1;if(j!==null)switch(j.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function y(d,p,j,_,T,P,$){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=_,this.attributeNamespace=T,this.mustUseProperty=j,this.propertyName=d,this.type=p,this.sanitizeURL=P,this.removeEmptyString=$}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){x[d]=new y(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];x[p]=new y(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){x[d]=new y(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){x[d]=new y(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){x[d]=new y(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){x[d]=new y(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){x[d]=new y(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){x[d]=new y(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){x[d]=new y(d,5,!1,d.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function w(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(b,w);x[p]=new y(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(b,w);x[p]=new y(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(b,w);x[p]=new y(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){x[d]=new y(d,1,!1,d.toLowerCase(),null,!1,!1)}),x.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){x[d]=new y(d,1,!1,d.toLowerCase(),null,!0,!0)});function k(d,p,j,_){var T=x.hasOwnProperty(p)?x[p]:null;(T!==null?T.type!==0:_||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(v(p,j,T,_)&&(j=null),_||T===null?m(p)&&(j===null?d.removeAttribute(p):d.setAttribute(p,""+j)):T.mustUseProperty?d[T.propertyName]=j===null?T.type===3?!1:"":j:(p=T.attributeName,_=T.attributeNamespace,j===null?d.removeAttribute(p):(T=T.type,j=T===3||T===4&&j===!0?"":""+j,_?d.setAttributeNS(_,p,j):d.setAttribute(p,j))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),S=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),M=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),Y=Symbol.iterator;function H(d){return d===null||typeof d!="object"?null:(d=Y&&d[Y]||d["@@iterator"],typeof d=="function"?d:null)}var V=Object.assign,O;function U(d){if(O===void 0)try{throw Error()}catch(j){var p=j.stack.trim().match(/\n( *(at )?)/);O=p&&p[1]||""}return`
`+O+d}var K=!1;function se(d,p){if(!d||K)return"";K=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(fe){var _=fe}Reflect.construct(d,[],p)}else{try{p.call()}catch(fe){_=fe}d.call(p.prototype)}else{try{throw Error()}catch(fe){_=fe}d()}}catch(fe){if(fe&&_&&typeof fe.stack=="string"){for(var T=fe.stack.split(`
`),P=_.stack.split(`
`),$=T.length-1,Z=P.length-1;1<=$&&0<=Z&&T[$]!==P[Z];)Z--;for(;1<=$&&0<=Z;$--,Z--)if(T[$]!==P[Z]){if($!==1||Z!==1)do if($--,Z--,0>Z||T[$]!==P[Z]){var ne=`
`+T[$].replace(" at new "," at ");return d.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",d.displayName)),ne}while(1<=$&&0<=Z);break}}}finally{K=!1,Error.prepareStackTrace=j}return(d=d?d.displayName||d.name:"")?U(d):""}function te(d){switch(d.tag){case 5:return U(d.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return d=se(d.type,!1),d;case 11:return d=se(d.type.render,!1),d;case 1:return d=se(d.type,!0),d;default:return""}}function X(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case A:return"Fragment";case S:return"Portal";case I:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case q:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case M:return(d.displayName||"Context")+".Consumer";case L:return(d._context.displayName||"Context")+".Provider";case D:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case B:return p=d.displayName||null,p!==null?p:X(d.type)||"Memo";case z:p=d._payload,d=d._init;try{return X(d(p))}catch{}}return null}function Q(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(p);case 8:return p===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function ae(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function J(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function ue(d){var p=J(d)?"checked":"value",j=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),_=""+d[p];if(!d.hasOwnProperty(p)&&typeof j<"u"&&typeof j.get=="function"&&typeof j.set=="function"){var T=j.get,P=j.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return T.call(this)},set:function($){_=""+$,P.call(this,$)}}),Object.defineProperty(d,p,{enumerable:j.enumerable}),{getValue:function(){return _},setValue:function($){_=""+$},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function we(d){d._valueTracker||(d._valueTracker=ue(d))}function _e(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var j=p.getValue(),_="";return d&&(_=J(d)?d.checked?"true":"false":d.value),d=_,d!==j?(p.setValue(d),!0):!1}function Ce(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Le(d,p){var j=p.checked;return V({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:j??d._wrapperState.initialChecked})}function Qe(d,p){var j=p.defaultValue==null?"":p.defaultValue,_=p.checked!=null?p.checked:p.defaultChecked;j=ae(p.value!=null?p.value:j),d._wrapperState={initialChecked:_,initialValue:j,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function St(d,p){p=p.checked,p!=null&&k(d,"checked",p,!1)}function at(d,p){St(d,p);var j=ae(p.value),_=p.type;if(j!=null)_==="number"?(j===0&&d.value===""||d.value!=j)&&(d.value=""+j):d.value!==""+j&&(d.value=""+j);else if(_==="submit"||_==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?ce(d,p.type,j):p.hasOwnProperty("defaultValue")&&ce(d,p.type,ae(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function ee(d,p,j){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var _=p.type;if(!(_!=="submit"&&_!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,j||p===d.value||(d.value=p),d.defaultValue=p}j=d.name,j!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,j!==""&&(d.name=j)}function ce(d,p,j){(p!=="number"||Ce(d.ownerDocument)!==d)&&(j==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+j&&(d.defaultValue=""+j))}var ge=Array.isArray;function ve(d,p,j,_){if(d=d.options,p){p={};for(var T=0;T<j.length;T++)p["$"+j[T]]=!0;for(j=0;j<d.length;j++)T=p.hasOwnProperty("$"+d[j].value),d[j].selected!==T&&(d[j].selected=T),T&&_&&(d[j].defaultSelected=!0)}else{for(j=""+ae(j),p=null,T=0;T<d.length;T++){if(d[T].value===j){d[T].selected=!0,_&&(d[T].defaultSelected=!0);return}p!==null||d[T].disabled||(p=d[T])}p!==null&&(p.selected=!0)}}function pe(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return V({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Ue(d,p){var j=p.value;if(j==null){if(j=p.children,p=p.defaultValue,j!=null){if(p!=null)throw Error(t(92));if(ge(j)){if(1<j.length)throw Error(t(93));j=j[0]}p=j}p==null&&(p=""),j=p}d._wrapperState={initialValue:ae(j)}}function We(d,p){var j=ae(p.value),_=ae(p.defaultValue);j!=null&&(j=""+j,j!==d.value&&(d.value=j),p.defaultValue==null&&d.defaultValue!==j&&(d.defaultValue=j)),_!=null&&(d.defaultValue=""+_)}function Ge(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function Jt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function os(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?Jt(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var ut,Ri=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,j,_,T){MSApp.execUnsafeLocalFunction(function(){return d(p,j,_,T)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(ut=ut||document.createElement("div"),ut.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=ut.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function gt(d,p){if(p){var j=d.firstChild;if(j&&j===d.lastChild&&j.nodeType===3){j.nodeValue=p;return}}d.textContent=p}var _s={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ah=["Webkit","ms","Moz","O"];Object.keys(_s).forEach(function(d){Ah.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),_s[p]=_s[d]})});function xc(d,p,j){return p==null||typeof p=="boolean"||p===""?"":j||typeof p!="number"||p===0||_s.hasOwnProperty(d)&&_s[d]?(""+p).trim():p+"px"}function yc(d,p){d=d.style;for(var j in p)if(p.hasOwnProperty(j)){var _=j.indexOf("--")===0,T=xc(j,p[j],_);j==="float"&&(j="cssFloat"),_?d.setProperty(j,T):d[j]=T}}var vc=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ro(d,p){if(p){if(vc[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Do(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hn=null;function Po(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Mo=null,Vn=null,yn=null;function bc(d){if(d=Zo(d)){if(typeof Mo!="function")throw Error(t(280));var p=d.stateNode;p&&(p=Wc(p),Mo(d.stateNode,d.type,p))}}function jc(d){Vn?yn?yn.push(d):yn=[d]:Vn=d}function wc(){if(Vn){var d=Vn,p=yn;if(yn=Vn=null,bc(d),p)for(d=0;d<p.length;d++)bc(p[d])}}function Nc(d,p){return d(p)}function kc(){}var va=!1;function Ec(d,p,j){if(va)return d(p,j);va=!0;try{return Nc(d,p,j)}finally{va=!1,(Vn!==null||yn!==null)&&(kc(),wc())}}function Di(d,p){var j=d.stateNode;if(j===null)return null;var _=Wc(j);if(_===null)return null;j=_[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(d=d.type,_=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!_;break e;default:d=!1}if(d)return null;if(j&&typeof j!="function")throw Error(t(231,p,typeof j));return j}var he=!1;if(l)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){he=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch{he=!1}function tt(d,p,j,_,T,P,$,Z,ne){var fe=Array.prototype.slice.call(arguments,3);try{p.apply(j,fe)}catch(ye){this.onError(ye)}}var xt=!1,jt=null,$s=!1,Tr=null,MC={onError:function(d){xt=!0,jt=d}};function OC(d,p,j,_,T,P,$,Z,ne){xt=!1,jt=null,tt.apply(MC,arguments)}function LC(d,p,j,_,T,P,$,Z,ne){if(OC.apply(this,arguments),xt){if(xt){var fe=jt;xt=!1,jt=null}else throw Error(t(198));$s||($s=!0,Tr=fe)}}function Pi(d){var p=d,j=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(j=p.return),d=p.return;while(d)}return p.tag===3?j:null}function Fy(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function zy(d){if(Pi(d)!==d)throw Error(t(188))}function IC(d){var p=d.alternate;if(!p){if(p=Pi(d),p===null)throw Error(t(188));return p!==d?null:d}for(var j=d,_=p;;){var T=j.return;if(T===null)break;var P=T.alternate;if(P===null){if(_=T.return,_!==null){j=_;continue}break}if(T.child===P.child){for(P=T.child;P;){if(P===j)return zy(T),d;if(P===_)return zy(T),p;P=P.sibling}throw Error(t(188))}if(j.return!==_.return)j=T,_=P;else{for(var $=!1,Z=T.child;Z;){if(Z===j){$=!0,j=T,_=P;break}if(Z===_){$=!0,_=T,j=P;break}Z=Z.sibling}if(!$){for(Z=P.child;Z;){if(Z===j){$=!0,j=P,_=T;break}if(Z===_){$=!0,_=P,j=T;break}Z=Z.sibling}if(!$)throw Error(t(189))}}if(j.alternate!==_)throw Error(t(190))}if(j.tag!==3)throw Error(t(188));return j.stateNode.current===j?d:p}function Uy(d){return d=IC(d),d!==null?Hy(d):null}function Hy(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=Hy(d);if(p!==null)return p;d=d.sibling}return null}var Vy=e.unstable_scheduleCallback,qy=e.unstable_cancelCallback,BC=e.unstable_shouldYield,FC=e.unstable_requestPaint,Wt=e.unstable_now,zC=e.unstable_getCurrentPriorityLevel,Ch=e.unstable_ImmediatePriority,$y=e.unstable_UserBlockingPriority,Sc=e.unstable_NormalPriority,UC=e.unstable_LowPriority,Wy=e.unstable_IdlePriority,_c=null,Kr=null;function HC(d){if(Kr&&typeof Kr.onCommitFiberRoot=="function")try{Kr.onCommitFiberRoot(_c,d,void 0,(d.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:$C,VC=Math.log,qC=Math.LN2;function $C(d){return d>>>=0,d===0?32:31-(VC(d)/qC|0)|0}var Ac=64,Cc=4194304;function Oo(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function Tc(d,p){var j=d.pendingLanes;if(j===0)return 0;var _=0,T=d.suspendedLanes,P=d.pingedLanes,$=j&268435455;if($!==0){var Z=$&~T;Z!==0?_=Oo(Z):(P&=$,P!==0&&(_=Oo(P)))}else $=j&~T,$!==0?_=Oo($):P!==0&&(_=Oo(P));if(_===0)return 0;if(p!==0&&p!==_&&(p&T)===0&&(T=_&-_,P=p&-p,T>=P||T===16&&(P&4194240)!==0))return p;if((_&4)!==0&&(_|=j&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=_;0<p;)j=31-Rr(p),T=1<<j,_|=d[j],p&=~T;return _}function WC(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GC(d,p){for(var j=d.suspendedLanes,_=d.pingedLanes,T=d.expirationTimes,P=d.pendingLanes;0<P;){var $=31-Rr(P),Z=1<<$,ne=T[$];ne===-1?((Z&j)===0||(Z&_)!==0)&&(T[$]=WC(Z,p)):ne<=p&&(d.expiredLanes|=Z),P&=~Z}}function Th(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Gy(){var d=Ac;return Ac<<=1,(Ac&4194240)===0&&(Ac=64),d}function Rh(d){for(var p=[],j=0;31>j;j++)p.push(d);return p}function Lo(d,p,j){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Rr(p),d[p]=j}function YC(d,p){var j=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var _=d.eventTimes;for(d=d.expirationTimes;0<j;){var T=31-Rr(j),P=1<<T;p[T]=0,_[T]=-1,d[T]=-1,j&=~P}}function Dh(d,p){var j=d.entangledLanes|=p;for(d=d.entanglements;j;){var _=31-Rr(j),T=1<<_;T&p|d[_]&p&&(d[_]|=p),j&=~T}}var pt=0;function Yy(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Ky,Ph,Xy,Qy,Jy,Mh=!1,Rc=[],qn=null,$n=null,Wn=null,Io=new Map,Bo=new Map,Gn=[],KC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zy(d,p){switch(d){case"focusin":case"focusout":qn=null;break;case"dragenter":case"dragleave":$n=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":Io.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bo.delete(p.pointerId)}}function Fo(d,p,j,_,T,P){return d===null||d.nativeEvent!==P?(d={blockedOn:p,domEventName:j,eventSystemFlags:_,nativeEvent:P,targetContainers:[T]},p!==null&&(p=Zo(p),p!==null&&Ph(p)),d):(d.eventSystemFlags|=_,p=d.targetContainers,T!==null&&p.indexOf(T)===-1&&p.push(T),d)}function XC(d,p,j,_,T){switch(p){case"focusin":return qn=Fo(qn,d,p,j,_,T),!0;case"dragenter":return $n=Fo($n,d,p,j,_,T),!0;case"mouseover":return Wn=Fo(Wn,d,p,j,_,T),!0;case"pointerover":var P=T.pointerId;return Io.set(P,Fo(Io.get(P)||null,d,p,j,_,T)),!0;case"gotpointercapture":return P=T.pointerId,Bo.set(P,Fo(Bo.get(P)||null,d,p,j,_,T)),!0}return!1}function ev(d){var p=Mi(d.target);if(p!==null){var j=Pi(p);if(j!==null){if(p=j.tag,p===13){if(p=Fy(j),p!==null){d.blockedOn=p,Jy(d.priority,function(){Xy(j)});return}}else if(p===3&&j.stateNode.current.memoizedState.isDehydrated){d.blockedOn=j.tag===3?j.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Dc(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var j=Lh(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(j===null){j=d.nativeEvent;var _=new j.constructor(j.type,j);Hn=_,j.target.dispatchEvent(_),Hn=null}else return p=Zo(j),p!==null&&Ph(p),d.blockedOn=j,!1;p.shift()}return!0}function tv(d,p,j){Dc(d)&&j.delete(p)}function QC(){Mh=!1,qn!==null&&Dc(qn)&&(qn=null),$n!==null&&Dc($n)&&($n=null),Wn!==null&&Dc(Wn)&&(Wn=null),Io.forEach(tv),Bo.forEach(tv)}function zo(d,p){d.blockedOn===p&&(d.blockedOn=null,Mh||(Mh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,QC)))}function Uo(d){function p(T){return zo(T,d)}if(0<Rc.length){zo(Rc[0],d);for(var j=1;j<Rc.length;j++){var _=Rc[j];_.blockedOn===d&&(_.blockedOn=null)}}for(qn!==null&&zo(qn,d),$n!==null&&zo($n,d),Wn!==null&&zo(Wn,d),Io.forEach(p),Bo.forEach(p),j=0;j<Gn.length;j++)_=Gn[j],_.blockedOn===d&&(_.blockedOn=null);for(;0<Gn.length&&(j=Gn[0],j.blockedOn===null);)ev(j),j.blockedOn===null&&Gn.shift()}var ba=N.ReactCurrentBatchConfig,Pc=!0;function JC(d,p,j,_){var T=pt,P=ba.transition;ba.transition=null;try{pt=1,Oh(d,p,j,_)}finally{pt=T,ba.transition=P}}function ZC(d,p,j,_){var T=pt,P=ba.transition;ba.transition=null;try{pt=4,Oh(d,p,j,_)}finally{pt=T,ba.transition=P}}function Oh(d,p,j,_){if(Pc){var T=Lh(d,p,j,_);if(T===null)Zh(d,p,_,Mc,j),Zy(d,_);else if(XC(T,d,p,j,_))_.stopPropagation();else if(Zy(d,_),p&4&&-1<KC.indexOf(d)){for(;T!==null;){var P=Zo(T);if(P!==null&&Ky(P),P=Lh(d,p,j,_),P===null&&Zh(d,p,_,Mc,j),P===T)break;T=P}T!==null&&_.stopPropagation()}else Zh(d,p,_,null,j)}}var Mc=null;function Lh(d,p,j,_){if(Mc=null,d=Po(_),d=Mi(d),d!==null)if(p=Pi(d),p===null)d=null;else if(j=p.tag,j===13){if(d=Fy(p),d!==null)return d;d=null}else if(j===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Mc=d,null}function sv(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zC()){case Ch:return 1;case $y:return 4;case Sc:case UC:return 16;case Wy:return 536870912;default:return 16}default:return 16}}var Yn=null,Ih=null,Oc=null;function rv(){if(Oc)return Oc;var d,p=Ih,j=p.length,_,T="value"in Yn?Yn.value:Yn.textContent,P=T.length;for(d=0;d<j&&p[d]===T[d];d++);var $=j-d;for(_=1;_<=$&&p[j-_]===T[P-_];_++);return Oc=T.slice(d,1<_?1-_:void 0)}function Lc(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Ic(){return!0}function nv(){return!1}function ir(d){function p(j,_,T,P,$){this._reactName=j,this._targetInst=T,this.type=_,this.nativeEvent=P,this.target=$,this.currentTarget=null;for(var Z in d)d.hasOwnProperty(Z)&&(j=d[Z],this[Z]=j?j(P):P[Z]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Ic:nv,this.isPropagationStopped=nv,this}return V(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var j=this.nativeEvent;j&&(j.preventDefault?j.preventDefault():typeof j.returnValue!="unknown"&&(j.returnValue=!1),this.isDefaultPrevented=Ic)},stopPropagation:function(){var j=this.nativeEvent;j&&(j.stopPropagation?j.stopPropagation():typeof j.cancelBubble!="unknown"&&(j.cancelBubble=!0),this.isPropagationStopped=Ic)},persist:function(){},isPersistent:Ic}),p}var ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bh=ir(ja),Ho=V({},ja,{view:0,detail:0}),eT=ir(Ho),Fh,zh,Vo,Bc=V({},Ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hh,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Vo&&(Vo&&d.type==="mousemove"?(Fh=d.screenX-Vo.screenX,zh=d.screenY-Vo.screenY):zh=Fh=0,Vo=d),Fh)},movementY:function(d){return"movementY"in d?d.movementY:zh}}),iv=ir(Bc),tT=V({},Bc,{dataTransfer:0}),sT=ir(tT),rT=V({},Ho,{relatedTarget:0}),Uh=ir(rT),nT=V({},ja,{animationName:0,elapsedTime:0,pseudoElement:0}),iT=ir(nT),aT=V({},ja,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),oT=ir(aT),lT=V({},ja,{data:0}),av=ir(lT),cT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hT(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=uT[d])?!!p[d]:!1}function Hh(){return hT}var fT=V({},Ho,{key:function(d){if(d.key){var p=cT[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=Lc(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?dT[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hh,charCode:function(d){return d.type==="keypress"?Lc(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Lc(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),mT=ir(fT),pT=V({},Bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ov=ir(pT),gT=V({},Ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hh}),xT=ir(gT),yT=V({},ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),vT=ir(yT),bT=V({},Bc,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),jT=ir(bT),wT=[9,13,27,32],Vh=l&&"CompositionEvent"in window,qo=null;l&&"documentMode"in document&&(qo=document.documentMode);var NT=l&&"TextEvent"in window&&!qo,lv=l&&(!Vh||qo&&8<qo&&11>=qo),cv=" ",dv=!1;function uv(d,p){switch(d){case"keyup":return wT.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hv(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var wa=!1;function kT(d,p){switch(d){case"compositionend":return hv(p);case"keypress":return p.which!==32?null:(dv=!0,cv);case"textInput":return d=p.data,d===cv&&dv?null:d;default:return null}}function ET(d,p){if(wa)return d==="compositionend"||!Vh&&uv(d,p)?(d=rv(),Oc=Ih=Yn=null,wa=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return lv&&p.locale!=="ko"?null:p.data;default:return null}}var ST={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fv(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!ST[d.type]:p==="textarea"}function mv(d,p,j,_){jc(_),p=Vc(p,"onChange"),0<p.length&&(j=new Bh("onChange","change",null,j,_),d.push({event:j,listeners:p}))}var $o=null,Wo=null;function _T(d){Dv(d,0)}function Fc(d){var p=_a(d);if(_e(p))return d}function AT(d,p){if(d==="change")return p}var pv=!1;if(l){var qh;if(l){var $h="oninput"in document;if(!$h){var gv=document.createElement("div");gv.setAttribute("oninput","return;"),$h=typeof gv.oninput=="function"}qh=$h}else qh=!1;pv=qh&&(!document.documentMode||9<document.documentMode)}function xv(){$o&&($o.detachEvent("onpropertychange",yv),Wo=$o=null)}function yv(d){if(d.propertyName==="value"&&Fc(Wo)){var p=[];mv(p,Wo,d,Po(d)),Ec(_T,p)}}function CT(d,p,j){d==="focusin"?(xv(),$o=p,Wo=j,$o.attachEvent("onpropertychange",yv)):d==="focusout"&&xv()}function TT(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Fc(Wo)}function RT(d,p){if(d==="click")return Fc(p)}function DT(d,p){if(d==="input"||d==="change")return Fc(p)}function PT(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Dr=typeof Object.is=="function"?Object.is:PT;function Go(d,p){if(Dr(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var j=Object.keys(d),_=Object.keys(p);if(j.length!==_.length)return!1;for(_=0;_<j.length;_++){var T=j[_];if(!u.call(p,T)||!Dr(d[T],p[T]))return!1}return!0}function vv(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function bv(d,p){var j=vv(d);d=0;for(var _;j;){if(j.nodeType===3){if(_=d+j.textContent.length,d<=p&&_>=p)return{node:j,offset:p-d};d=_}e:{for(;j;){if(j.nextSibling){j=j.nextSibling;break e}j=j.parentNode}j=void 0}j=vv(j)}}function jv(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?jv(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function wv(){for(var d=window,p=Ce();p instanceof d.HTMLIFrameElement;){try{var j=typeof p.contentWindow.location.href=="string"}catch{j=!1}if(j)d=p.contentWindow;else break;p=Ce(d.document)}return p}function Wh(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function MT(d){var p=wv(),j=d.focusedElem,_=d.selectionRange;if(p!==j&&j&&j.ownerDocument&&jv(j.ownerDocument.documentElement,j)){if(_!==null&&Wh(j)){if(p=_.start,d=_.end,d===void 0&&(d=p),"selectionStart"in j)j.selectionStart=p,j.selectionEnd=Math.min(d,j.value.length);else if(d=(p=j.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var T=j.textContent.length,P=Math.min(_.start,T);_=_.end===void 0?P:Math.min(_.end,T),!d.extend&&P>_&&(T=_,_=P,P=T),T=bv(j,P);var $=bv(j,_);T&&$&&(d.rangeCount!==1||d.anchorNode!==T.node||d.anchorOffset!==T.offset||d.focusNode!==$.node||d.focusOffset!==$.offset)&&(p=p.createRange(),p.setStart(T.node,T.offset),d.removeAllRanges(),P>_?(d.addRange(p),d.extend($.node,$.offset)):(p.setEnd($.node,$.offset),d.addRange(p)))}}for(p=[],d=j;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<p.length;j++)d=p[j],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var OT=l&&"documentMode"in document&&11>=document.documentMode,Na=null,Gh=null,Yo=null,Yh=!1;function Nv(d,p,j){var _=j.window===j?j.document:j.nodeType===9?j:j.ownerDocument;Yh||Na==null||Na!==Ce(_)||(_=Na,"selectionStart"in _&&Wh(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Yo&&Go(Yo,_)||(Yo=_,_=Vc(Gh,"onSelect"),0<_.length&&(p=new Bh("onSelect","select",null,p,j),d.push({event:p,listeners:_}),p.target=Na)))}function zc(d,p){var j={};return j[d.toLowerCase()]=p.toLowerCase(),j["Webkit"+d]="webkit"+p,j["Moz"+d]="moz"+p,j}var ka={animationend:zc("Animation","AnimationEnd"),animationiteration:zc("Animation","AnimationIteration"),animationstart:zc("Animation","AnimationStart"),transitionend:zc("Transition","TransitionEnd")},Kh={},kv={};l&&(kv=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function Uc(d){if(Kh[d])return Kh[d];if(!ka[d])return d;var p=ka[d],j;for(j in p)if(p.hasOwnProperty(j)&&j in kv)return Kh[d]=p[j];return d}var Ev=Uc("animationend"),Sv=Uc("animationiteration"),_v=Uc("animationstart"),Av=Uc("transitionend"),Cv=new Map,Tv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kn(d,p){Cv.set(d,p),a(p,[d])}for(var Xh=0;Xh<Tv.length;Xh++){var Qh=Tv[Xh],LT=Qh.toLowerCase(),IT=Qh[0].toUpperCase()+Qh.slice(1);Kn(LT,"on"+IT)}Kn(Ev,"onAnimationEnd"),Kn(Sv,"onAnimationIteration"),Kn(_v,"onAnimationStart"),Kn("dblclick","onDoubleClick"),Kn("focusin","onFocus"),Kn("focusout","onBlur"),Kn(Av,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ko));function Rv(d,p,j){var _=d.type||"unknown-event";d.currentTarget=j,LC(_,p,void 0,d),d.currentTarget=null}function Dv(d,p){p=(p&4)!==0;for(var j=0;j<d.length;j++){var _=d[j],T=_.event;_=_.listeners;e:{var P=void 0;if(p)for(var $=_.length-1;0<=$;$--){var Z=_[$],ne=Z.instance,fe=Z.currentTarget;if(Z=Z.listener,ne!==P&&T.isPropagationStopped())break e;Rv(T,Z,fe),P=ne}else for($=0;$<_.length;$++){if(Z=_[$],ne=Z.instance,fe=Z.currentTarget,Z=Z.listener,ne!==P&&T.isPropagationStopped())break e;Rv(T,Z,fe),P=ne}}}if($s)throw d=Tr,$s=!1,Tr=null,d}function _t(d,p){var j=p[af];j===void 0&&(j=p[af]=new Set);var _=d+"__bubble";j.has(_)||(Pv(p,d,2,!1),j.add(_))}function Jh(d,p,j){var _=0;p&&(_|=4),Pv(j,d,_,p)}var Hc="_reactListening"+Math.random().toString(36).slice(2);function Xo(d){if(!d[Hc]){d[Hc]=!0,n.forEach(function(j){j!=="selectionchange"&&(BT.has(j)||Jh(j,!1,d),Jh(j,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[Hc]||(p[Hc]=!0,Jh("selectionchange",!1,p))}}function Pv(d,p,j,_){switch(sv(p)){case 1:var T=JC;break;case 4:T=ZC;break;default:T=Oh}j=T.bind(null,p,j,d),T=void 0,!he||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(T=!0),_?T!==void 0?d.addEventListener(p,j,{capture:!0,passive:T}):d.addEventListener(p,j,!0):T!==void 0?d.addEventListener(p,j,{passive:T}):d.addEventListener(p,j,!1)}function Zh(d,p,j,_,T){var P=_;if((p&1)===0&&(p&2)===0&&_!==null)e:for(;;){if(_===null)return;var $=_.tag;if($===3||$===4){var Z=_.stateNode.containerInfo;if(Z===T||Z.nodeType===8&&Z.parentNode===T)break;if($===4)for($=_.return;$!==null;){var ne=$.tag;if((ne===3||ne===4)&&(ne=$.stateNode.containerInfo,ne===T||ne.nodeType===8&&ne.parentNode===T))return;$=$.return}for(;Z!==null;){if($=Mi(Z),$===null)return;if(ne=$.tag,ne===5||ne===6){_=P=$;continue e}Z=Z.parentNode}}_=_.return}Ec(function(){var fe=P,ye=Po(j),be=[];e:{var xe=Cv.get(d);if(xe!==void 0){var ke=Bh,Te=d;switch(d){case"keypress":if(Lc(j)===0)break e;case"keydown":case"keyup":ke=mT;break;case"focusin":Te="focus",ke=Uh;break;case"focusout":Te="blur",ke=Uh;break;case"beforeblur":case"afterblur":ke=Uh;break;case"click":if(j.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=iv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=sT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=xT;break;case Ev:case Sv:case _v:ke=iT;break;case Av:ke=vT;break;case"scroll":ke=eT;break;case"wheel":ke=jT;break;case"copy":case"cut":case"paste":ke=oT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=ov}var Re=(p&4)!==0,Gt=!Re&&d==="scroll",le=Re?xe!==null?xe+"Capture":null:xe;Re=[];for(var ie=fe,de;ie!==null;){de=ie;var Ne=de.stateNode;if(de.tag===5&&Ne!==null&&(de=Ne,le!==null&&(Ne=Di(ie,le),Ne!=null&&Re.push(Qo(ie,Ne,de)))),Gt)break;ie=ie.return}0<Re.length&&(xe=new ke(xe,Te,null,j,ye),be.push({event:xe,listeners:Re}))}}if((p&7)===0){e:{if(xe=d==="mouseover"||d==="pointerover",ke=d==="mouseout"||d==="pointerout",xe&&j!==Hn&&(Te=j.relatedTarget||j.fromElement)&&(Mi(Te)||Te[vn]))break e;if((ke||xe)&&(xe=ye.window===ye?ye:(xe=ye.ownerDocument)?xe.defaultView||xe.parentWindow:window,ke?(Te=j.relatedTarget||j.toElement,ke=fe,Te=Te?Mi(Te):null,Te!==null&&(Gt=Pi(Te),Te!==Gt||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(ke=null,Te=fe),ke!==Te)){if(Re=iv,Ne="onMouseLeave",le="onMouseEnter",ie="mouse",(d==="pointerout"||d==="pointerover")&&(Re=ov,Ne="onPointerLeave",le="onPointerEnter",ie="pointer"),Gt=ke==null?xe:_a(ke),de=Te==null?xe:_a(Te),xe=new Re(Ne,ie+"leave",ke,j,ye),xe.target=Gt,xe.relatedTarget=de,Ne=null,Mi(ye)===fe&&(Re=new Re(le,ie+"enter",Te,j,ye),Re.target=de,Re.relatedTarget=Gt,Ne=Re),Gt=Ne,ke&&Te)t:{for(Re=ke,le=Te,ie=0,de=Re;de;de=Ea(de))ie++;for(de=0,Ne=le;Ne;Ne=Ea(Ne))de++;for(;0<ie-de;)Re=Ea(Re),ie--;for(;0<de-ie;)le=Ea(le),de--;for(;ie--;){if(Re===le||le!==null&&Re===le.alternate)break t;Re=Ea(Re),le=Ea(le)}Re=null}else Re=null;ke!==null&&Mv(be,xe,ke,Re,!1),Te!==null&&Gt!==null&&Mv(be,Gt,Te,Re,!0)}}e:{if(xe=fe?_a(fe):window,ke=xe.nodeName&&xe.nodeName.toLowerCase(),ke==="select"||ke==="input"&&xe.type==="file")var De=AT;else if(fv(xe))if(pv)De=DT;else{De=TT;var Ie=CT}else(ke=xe.nodeName)&&ke.toLowerCase()==="input"&&(xe.type==="checkbox"||xe.type==="radio")&&(De=RT);if(De&&(De=De(d,fe))){mv(be,De,j,ye);break e}Ie&&Ie(d,xe,fe),d==="focusout"&&(Ie=xe._wrapperState)&&Ie.controlled&&xe.type==="number"&&ce(xe,"number",xe.value)}switch(Ie=fe?_a(fe):window,d){case"focusin":(fv(Ie)||Ie.contentEditable==="true")&&(Na=Ie,Gh=fe,Yo=null);break;case"focusout":Yo=Gh=Na=null;break;case"mousedown":Yh=!0;break;case"contextmenu":case"mouseup":case"dragend":Yh=!1,Nv(be,j,ye);break;case"selectionchange":if(OT)break;case"keydown":case"keyup":Nv(be,j,ye)}var Be;if(Vh)e:{switch(d){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else wa?uv(d,j)&&(qe="onCompositionEnd"):d==="keydown"&&j.keyCode===229&&(qe="onCompositionStart");qe&&(lv&&j.locale!=="ko"&&(wa||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&wa&&(Be=rv()):(Yn=ye,Ih="value"in Yn?Yn.value:Yn.textContent,wa=!0)),Ie=Vc(fe,qe),0<Ie.length&&(qe=new av(qe,d,null,j,ye),be.push({event:qe,listeners:Ie}),Be?qe.data=Be:(Be=hv(j),Be!==null&&(qe.data=Be)))),(Be=NT?kT(d,j):ET(d,j))&&(fe=Vc(fe,"onBeforeInput"),0<fe.length&&(ye=new av("onBeforeInput","beforeinput",null,j,ye),be.push({event:ye,listeners:fe}),ye.data=Be))}Dv(be,p)})}function Qo(d,p,j){return{instance:d,listener:p,currentTarget:j}}function Vc(d,p){for(var j=p+"Capture",_=[];d!==null;){var T=d,P=T.stateNode;T.tag===5&&P!==null&&(T=P,P=Di(d,j),P!=null&&_.unshift(Qo(d,P,T)),P=Di(d,p),P!=null&&_.push(Qo(d,P,T))),d=d.return}return _}function Ea(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function Mv(d,p,j,_,T){for(var P=p._reactName,$=[];j!==null&&j!==_;){var Z=j,ne=Z.alternate,fe=Z.stateNode;if(ne!==null&&ne===_)break;Z.tag===5&&fe!==null&&(Z=fe,T?(ne=Di(j,P),ne!=null&&$.unshift(Qo(j,ne,Z))):T||(ne=Di(j,P),ne!=null&&$.push(Qo(j,ne,Z)))),j=j.return}$.length!==0&&d.push({event:p,listeners:$})}var FT=/\r\n?/g,zT=/\u0000|\uFFFD/g;function Ov(d){return(typeof d=="string"?d:""+d).replace(FT,`
`).replace(zT,"")}function qc(d,p,j){if(p=Ov(p),Ov(d)!==p&&j)throw Error(t(425))}function $c(){}var ef=null,tf=null;function sf(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var rf=typeof setTimeout=="function"?setTimeout:void 0,UT=typeof clearTimeout=="function"?clearTimeout:void 0,Lv=typeof Promise=="function"?Promise:void 0,HT=typeof queueMicrotask=="function"?queueMicrotask:typeof Lv<"u"?function(d){return Lv.resolve(null).then(d).catch(VT)}:rf;function VT(d){setTimeout(function(){throw d})}function nf(d,p){var j=p,_=0;do{var T=j.nextSibling;if(d.removeChild(j),T&&T.nodeType===8)if(j=T.data,j==="/$"){if(_===0){d.removeChild(T),Uo(p);return}_--}else j!=="$"&&j!=="$?"&&j!=="$!"||_++;j=T}while(j);Uo(p)}function Xn(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function Iv(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var j=d.data;if(j==="$"||j==="$!"||j==="$?"){if(p===0)return d;p--}else j==="/$"&&p++}d=d.previousSibling}return null}var Sa=Math.random().toString(36).slice(2),Xr="__reactFiber$"+Sa,Jo="__reactProps$"+Sa,vn="__reactContainer$"+Sa,af="__reactEvents$"+Sa,qT="__reactListeners$"+Sa,$T="__reactHandles$"+Sa;function Mi(d){var p=d[Xr];if(p)return p;for(var j=d.parentNode;j;){if(p=j[vn]||j[Xr]){if(j=p.alternate,p.child!==null||j!==null&&j.child!==null)for(d=Iv(d);d!==null;){if(j=d[Xr])return j;d=Iv(d)}return p}d=j,j=d.parentNode}return null}function Zo(d){return d=d[Xr]||d[vn],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function _a(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function Wc(d){return d[Jo]||null}var of=[],Aa=-1;function Qn(d){return{current:d}}function At(d){0>Aa||(d.current=of[Aa],of[Aa]=null,Aa--)}function wt(d,p){Aa++,of[Aa]=d.current,d.current=p}var Jn={},As=Qn(Jn),Ws=Qn(!1),Oi=Jn;function Ca(d,p){var j=d.type.contextTypes;if(!j)return Jn;var _=d.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===p)return _.__reactInternalMemoizedMaskedChildContext;var T={},P;for(P in j)T[P]=p[P];return _&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=T),T}function Gs(d){return d=d.childContextTypes,d!=null}function Gc(){At(Ws),At(As)}function Bv(d,p,j){if(As.current!==Jn)throw Error(t(168));wt(As,p),wt(Ws,j)}function Fv(d,p,j){var _=d.stateNode;if(p=p.childContextTypes,typeof _.getChildContext!="function")return j;_=_.getChildContext();for(var T in _)if(!(T in p))throw Error(t(108,Q(d)||"Unknown",T));return V({},j,_)}function Yc(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Jn,Oi=As.current,wt(As,d),wt(Ws,Ws.current),!0}function zv(d,p,j){var _=d.stateNode;if(!_)throw Error(t(169));j?(d=Fv(d,p,Oi),_.__reactInternalMemoizedMergedChildContext=d,At(Ws),At(As),wt(As,d)):At(Ws),wt(Ws,j)}var bn=null,Kc=!1,lf=!1;function Uv(d){bn===null?bn=[d]:bn.push(d)}function WT(d){Kc=!0,Uv(d)}function Zn(){if(!lf&&bn!==null){lf=!0;var d=0,p=pt;try{var j=bn;for(pt=1;d<j.length;d++){var _=j[d];do _=_(!0);while(_!==null)}bn=null,Kc=!1}catch(T){throw bn!==null&&(bn=bn.slice(d+1)),Vy(Ch,Zn),T}finally{pt=p,lf=!1}}return null}var Ta=[],Ra=0,Xc=null,Qc=0,mr=[],pr=0,Li=null,jn=1,wn="";function Ii(d,p){Ta[Ra++]=Qc,Ta[Ra++]=Xc,Xc=d,Qc=p}function Hv(d,p,j){mr[pr++]=jn,mr[pr++]=wn,mr[pr++]=Li,Li=d;var _=jn;d=wn;var T=32-Rr(_)-1;_&=~(1<<T),j+=1;var P=32-Rr(p)+T;if(30<P){var $=T-T%5;P=(_&(1<<$)-1).toString(32),_>>=$,T-=$,jn=1<<32-Rr(p)+T|j<<T|_,wn=P+d}else jn=1<<P|j<<T|_,wn=d}function cf(d){d.return!==null&&(Ii(d,1),Hv(d,1,0))}function df(d){for(;d===Xc;)Xc=Ta[--Ra],Ta[Ra]=null,Qc=Ta[--Ra],Ta[Ra]=null;for(;d===Li;)Li=mr[--pr],mr[pr]=null,wn=mr[--pr],mr[pr]=null,jn=mr[--pr],mr[pr]=null}var ar=null,or=null,Tt=!1,Pr=null;function Vv(d,p){var j=vr(5,null,null,0);j.elementType="DELETED",j.stateNode=p,j.return=d,p=d.deletions,p===null?(d.deletions=[j],d.flags|=16):p.push(j)}function qv(d,p){switch(d.tag){case 5:var j=d.type;return p=p.nodeType!==1||j.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,ar=d,or=Xn(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,ar=d,or=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(j=Li!==null?{id:jn,overflow:wn}:null,d.memoizedState={dehydrated:p,treeContext:j,retryLane:1073741824},j=vr(18,null,null,0),j.stateNode=p,j.return=d,d.child=j,ar=d,or=null,!0):!1;default:return!1}}function uf(d){return(d.mode&1)!==0&&(d.flags&128)===0}function hf(d){if(Tt){var p=or;if(p){var j=p;if(!qv(d,p)){if(uf(d))throw Error(t(418));p=Xn(j.nextSibling);var _=ar;p&&qv(d,p)?Vv(_,j):(d.flags=d.flags&-4097|2,Tt=!1,ar=d)}}else{if(uf(d))throw Error(t(418));d.flags=d.flags&-4097|2,Tt=!1,ar=d}}}function $v(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;ar=d}function Jc(d){if(d!==ar)return!1;if(!Tt)return $v(d),Tt=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!sf(d.type,d.memoizedProps)),p&&(p=or)){if(uf(d))throw Wv(),Error(t(418));for(;p;)Vv(d,p),p=Xn(p.nextSibling)}if($v(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var j=d.data;if(j==="/$"){if(p===0){or=Xn(d.nextSibling);break e}p--}else j!=="$"&&j!=="$!"&&j!=="$?"||p++}d=d.nextSibling}or=null}}else or=ar?Xn(d.stateNode.nextSibling):null;return!0}function Wv(){for(var d=or;d;)d=Xn(d.nextSibling)}function Da(){or=ar=null,Tt=!1}function ff(d){Pr===null?Pr=[d]:Pr.push(d)}var GT=N.ReactCurrentBatchConfig;function el(d,p,j){if(d=j.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(j._owner){if(j=j._owner,j){if(j.tag!==1)throw Error(t(309));var _=j.stateNode}if(!_)throw Error(t(147,d));var T=_,P=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===P?p.ref:(p=function($){var Z=T.refs;$===null?delete Z[P]:Z[P]=$},p._stringRef=P,p)}if(typeof d!="string")throw Error(t(284));if(!j._owner)throw Error(t(290,d))}return d}function Zc(d,p){throw d=Object.prototype.toString.call(p),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Gv(d){var p=d._init;return p(d._payload)}function Yv(d){function p(le,ie){if(d){var de=le.deletions;de===null?(le.deletions=[ie],le.flags|=16):de.push(ie)}}function j(le,ie){if(!d)return null;for(;ie!==null;)p(le,ie),ie=ie.sibling;return null}function _(le,ie){for(le=new Map;ie!==null;)ie.key!==null?le.set(ie.key,ie):le.set(ie.index,ie),ie=ie.sibling;return le}function T(le,ie){return le=oi(le,ie),le.index=0,le.sibling=null,le}function P(le,ie,de){return le.index=de,d?(de=le.alternate,de!==null?(de=de.index,de<ie?(le.flags|=2,ie):de):(le.flags|=2,ie)):(le.flags|=1048576,ie)}function $(le){return d&&le.alternate===null&&(le.flags|=2),le}function Z(le,ie,de,Ne){return ie===null||ie.tag!==6?(ie=nm(de,le.mode,Ne),ie.return=le,ie):(ie=T(ie,de),ie.return=le,ie)}function ne(le,ie,de,Ne){var De=de.type;return De===A?ye(le,ie,de.props.children,Ne,de.key):ie!==null&&(ie.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===z&&Gv(De)===ie.type)?(Ne=T(ie,de.props),Ne.ref=el(le,ie,de),Ne.return=le,Ne):(Ne=Nd(de.type,de.key,de.props,null,le.mode,Ne),Ne.ref=el(le,ie,de),Ne.return=le,Ne)}function fe(le,ie,de,Ne){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==de.containerInfo||ie.stateNode.implementation!==de.implementation?(ie=im(de,le.mode,Ne),ie.return=le,ie):(ie=T(ie,de.children||[]),ie.return=le,ie)}function ye(le,ie,de,Ne,De){return ie===null||ie.tag!==7?(ie=$i(de,le.mode,Ne,De),ie.return=le,ie):(ie=T(ie,de),ie.return=le,ie)}function be(le,ie,de){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=nm(""+ie,le.mode,de),ie.return=le,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case E:return de=Nd(ie.type,ie.key,ie.props,null,le.mode,de),de.ref=el(le,null,ie),de.return=le,de;case S:return ie=im(ie,le.mode,de),ie.return=le,ie;case z:var Ne=ie._init;return be(le,Ne(ie._payload),de)}if(ge(ie)||H(ie))return ie=$i(ie,le.mode,de,null),ie.return=le,ie;Zc(le,ie)}return null}function xe(le,ie,de,Ne){var De=ie!==null?ie.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return De!==null?null:Z(le,ie,""+de,Ne);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case E:return de.key===De?ne(le,ie,de,Ne):null;case S:return de.key===De?fe(le,ie,de,Ne):null;case z:return De=de._init,xe(le,ie,De(de._payload),Ne)}if(ge(de)||H(de))return De!==null?null:ye(le,ie,de,Ne,null);Zc(le,de)}return null}function ke(le,ie,de,Ne,De){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return le=le.get(de)||null,Z(ie,le,""+Ne,De);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case E:return le=le.get(Ne.key===null?de:Ne.key)||null,ne(ie,le,Ne,De);case S:return le=le.get(Ne.key===null?de:Ne.key)||null,fe(ie,le,Ne,De);case z:var Ie=Ne._init;return ke(le,ie,de,Ie(Ne._payload),De)}if(ge(Ne)||H(Ne))return le=le.get(de)||null,ye(ie,le,Ne,De,null);Zc(ie,Ne)}return null}function Te(le,ie,de,Ne){for(var De=null,Ie=null,Be=ie,qe=ie=0,ds=null;Be!==null&&qe<de.length;qe++){Be.index>qe?(ds=Be,Be=null):ds=Be.sibling;var dt=xe(le,Be,de[qe],Ne);if(dt===null){Be===null&&(Be=ds);break}d&&Be&&dt.alternate===null&&p(le,Be),ie=P(dt,ie,qe),Ie===null?De=dt:Ie.sibling=dt,Ie=dt,Be=ds}if(qe===de.length)return j(le,Be),Tt&&Ii(le,qe),De;if(Be===null){for(;qe<de.length;qe++)Be=be(le,de[qe],Ne),Be!==null&&(ie=P(Be,ie,qe),Ie===null?De=Be:Ie.sibling=Be,Ie=Be);return Tt&&Ii(le,qe),De}for(Be=_(le,Be);qe<de.length;qe++)ds=ke(Be,le,qe,de[qe],Ne),ds!==null&&(d&&ds.alternate!==null&&Be.delete(ds.key===null?qe:ds.key),ie=P(ds,ie,qe),Ie===null?De=ds:Ie.sibling=ds,Ie=ds);return d&&Be.forEach(function(li){return p(le,li)}),Tt&&Ii(le,qe),De}function Re(le,ie,de,Ne){var De=H(de);if(typeof De!="function")throw Error(t(150));if(de=De.call(de),de==null)throw Error(t(151));for(var Ie=De=null,Be=ie,qe=ie=0,ds=null,dt=de.next();Be!==null&&!dt.done;qe++,dt=de.next()){Be.index>qe?(ds=Be,Be=null):ds=Be.sibling;var li=xe(le,Be,dt.value,Ne);if(li===null){Be===null&&(Be=ds);break}d&&Be&&li.alternate===null&&p(le,Be),ie=P(li,ie,qe),Ie===null?De=li:Ie.sibling=li,Ie=li,Be=ds}if(dt.done)return j(le,Be),Tt&&Ii(le,qe),De;if(Be===null){for(;!dt.done;qe++,dt=de.next())dt=be(le,dt.value,Ne),dt!==null&&(ie=P(dt,ie,qe),Ie===null?De=dt:Ie.sibling=dt,Ie=dt);return Tt&&Ii(le,qe),De}for(Be=_(le,Be);!dt.done;qe++,dt=de.next())dt=ke(Be,le,qe,dt.value,Ne),dt!==null&&(d&&dt.alternate!==null&&Be.delete(dt.key===null?qe:dt.key),ie=P(dt,ie,qe),Ie===null?De=dt:Ie.sibling=dt,Ie=dt);return d&&Be.forEach(function(SR){return p(le,SR)}),Tt&&Ii(le,qe),De}function Gt(le,ie,de,Ne){if(typeof de=="object"&&de!==null&&de.type===A&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case E:e:{for(var De=de.key,Ie=ie;Ie!==null;){if(Ie.key===De){if(De=de.type,De===A){if(Ie.tag===7){j(le,Ie.sibling),ie=T(Ie,de.props.children),ie.return=le,le=ie;break e}}else if(Ie.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===z&&Gv(De)===Ie.type){j(le,Ie.sibling),ie=T(Ie,de.props),ie.ref=el(le,Ie,de),ie.return=le,le=ie;break e}j(le,Ie);break}else p(le,Ie);Ie=Ie.sibling}de.type===A?(ie=$i(de.props.children,le.mode,Ne,de.key),ie.return=le,le=ie):(Ne=Nd(de.type,de.key,de.props,null,le.mode,Ne),Ne.ref=el(le,ie,de),Ne.return=le,le=Ne)}return $(le);case S:e:{for(Ie=de.key;ie!==null;){if(ie.key===Ie)if(ie.tag===4&&ie.stateNode.containerInfo===de.containerInfo&&ie.stateNode.implementation===de.implementation){j(le,ie.sibling),ie=T(ie,de.children||[]),ie.return=le,le=ie;break e}else{j(le,ie);break}else p(le,ie);ie=ie.sibling}ie=im(de,le.mode,Ne),ie.return=le,le=ie}return $(le);case z:return Ie=de._init,Gt(le,ie,Ie(de._payload),Ne)}if(ge(de))return Te(le,ie,de,Ne);if(H(de))return Re(le,ie,de,Ne);Zc(le,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,ie!==null&&ie.tag===6?(j(le,ie.sibling),ie=T(ie,de),ie.return=le,le=ie):(j(le,ie),ie=nm(de,le.mode,Ne),ie.return=le,le=ie),$(le)):j(le,ie)}return Gt}var Pa=Yv(!0),Kv=Yv(!1),ed=Qn(null),td=null,Ma=null,mf=null;function pf(){mf=Ma=td=null}function gf(d){var p=ed.current;At(ed),d._currentValue=p}function xf(d,p,j){for(;d!==null;){var _=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,_!==null&&(_.childLanes|=p)):_!==null&&(_.childLanes&p)!==p&&(_.childLanes|=p),d===j)break;d=d.return}}function Oa(d,p){td=d,mf=Ma=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Ys=!0),d.firstContext=null)}function gr(d){var p=d._currentValue;if(mf!==d)if(d={context:d,memoizedValue:p,next:null},Ma===null){if(td===null)throw Error(t(308));Ma=d,td.dependencies={lanes:0,firstContext:d}}else Ma=Ma.next=d;return p}var Bi=null;function yf(d){Bi===null?Bi=[d]:Bi.push(d)}function Xv(d,p,j,_){var T=p.interleaved;return T===null?(j.next=j,yf(p)):(j.next=T.next,T.next=j),p.interleaved=j,Nn(d,_)}function Nn(d,p){d.lanes|=p;var j=d.alternate;for(j!==null&&(j.lanes|=p),j=d,d=d.return;d!==null;)d.childLanes|=p,j=d.alternate,j!==null&&(j.childLanes|=p),j=d,d=d.return;return j.tag===3?j.stateNode:null}var ei=!1;function vf(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qv(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function kn(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function ti(d,p,j){var _=d.updateQueue;if(_===null)return null;if(_=_.shared,(lt&2)!==0){var T=_.pending;return T===null?p.next=p:(p.next=T.next,T.next=p),_.pending=p,Nn(d,j)}return T=_.interleaved,T===null?(p.next=p,yf(_)):(p.next=T.next,T.next=p),_.interleaved=p,Nn(d,j)}function sd(d,p,j){if(p=p.updateQueue,p!==null&&(p=p.shared,(j&4194240)!==0)){var _=p.lanes;_&=d.pendingLanes,j|=_,p.lanes=j,Dh(d,j)}}function Jv(d,p){var j=d.updateQueue,_=d.alternate;if(_!==null&&(_=_.updateQueue,j===_)){var T=null,P=null;if(j=j.firstBaseUpdate,j!==null){do{var $={eventTime:j.eventTime,lane:j.lane,tag:j.tag,payload:j.payload,callback:j.callback,next:null};P===null?T=P=$:P=P.next=$,j=j.next}while(j!==null);P===null?T=P=p:P=P.next=p}else T=P=p;j={baseState:_.baseState,firstBaseUpdate:T,lastBaseUpdate:P,shared:_.shared,effects:_.effects},d.updateQueue=j;return}d=j.lastBaseUpdate,d===null?j.firstBaseUpdate=p:d.next=p,j.lastBaseUpdate=p}function rd(d,p,j,_){var T=d.updateQueue;ei=!1;var P=T.firstBaseUpdate,$=T.lastBaseUpdate,Z=T.shared.pending;if(Z!==null){T.shared.pending=null;var ne=Z,fe=ne.next;ne.next=null,$===null?P=fe:$.next=fe,$=ne;var ye=d.alternate;ye!==null&&(ye=ye.updateQueue,Z=ye.lastBaseUpdate,Z!==$&&(Z===null?ye.firstBaseUpdate=fe:Z.next=fe,ye.lastBaseUpdate=ne))}if(P!==null){var be=T.baseState;$=0,ye=fe=ne=null,Z=P;do{var xe=Z.lane,ke=Z.eventTime;if((_&xe)===xe){ye!==null&&(ye=ye.next={eventTime:ke,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var Te=d,Re=Z;switch(xe=p,ke=j,Re.tag){case 1:if(Te=Re.payload,typeof Te=="function"){be=Te.call(ke,be,xe);break e}be=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Re.payload,xe=typeof Te=="function"?Te.call(ke,be,xe):Te,xe==null)break e;be=V({},be,xe);break e;case 2:ei=!0}}Z.callback!==null&&Z.lane!==0&&(d.flags|=64,xe=T.effects,xe===null?T.effects=[Z]:xe.push(Z))}else ke={eventTime:ke,lane:xe,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},ye===null?(fe=ye=ke,ne=be):ye=ye.next=ke,$|=xe;if(Z=Z.next,Z===null){if(Z=T.shared.pending,Z===null)break;xe=Z,Z=xe.next,xe.next=null,T.lastBaseUpdate=xe,T.shared.pending=null}}while(!0);if(ye===null&&(ne=be),T.baseState=ne,T.firstBaseUpdate=fe,T.lastBaseUpdate=ye,p=T.shared.interleaved,p!==null){T=p;do $|=T.lane,T=T.next;while(T!==p)}else P===null&&(T.shared.lanes=0);Ui|=$,d.lanes=$,d.memoizedState=be}}function Zv(d,p,j){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var _=d[p],T=_.callback;if(T!==null){if(_.callback=null,_=j,typeof T!="function")throw Error(t(191,T));T.call(_)}}}var tl={},Qr=Qn(tl),sl=Qn(tl),rl=Qn(tl);function Fi(d){if(d===tl)throw Error(t(174));return d}function bf(d,p){switch(wt(rl,p),wt(sl,d),wt(Qr,tl),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:os(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=os(p,d)}At(Qr),wt(Qr,p)}function La(){At(Qr),At(sl),At(rl)}function eb(d){Fi(rl.current);var p=Fi(Qr.current),j=os(p,d.type);p!==j&&(wt(sl,d),wt(Qr,j))}function jf(d){sl.current===d&&(At(Qr),At(sl))}var Ot=Qn(0);function nd(d){for(var p=d;p!==null;){if(p.tag===13){var j=p.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||j.data==="$?"||j.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var wf=[];function Nf(){for(var d=0;d<wf.length;d++)wf[d]._workInProgressVersionPrimary=null;wf.length=0}var id=N.ReactCurrentDispatcher,kf=N.ReactCurrentBatchConfig,zi=0,Lt=null,ns=null,ls=null,ad=!1,nl=!1,il=0,YT=0;function Cs(){throw Error(t(321))}function Ef(d,p){if(p===null)return!1;for(var j=0;j<p.length&&j<d.length;j++)if(!Dr(d[j],p[j]))return!1;return!0}function Sf(d,p,j,_,T,P){if(zi=P,Lt=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,id.current=d===null||d.memoizedState===null?JT:ZT,d=j(_,T),nl){P=0;do{if(nl=!1,il=0,25<=P)throw Error(t(301));P+=1,ls=ns=null,p.updateQueue=null,id.current=eR,d=j(_,T)}while(nl)}if(id.current=cd,p=ns!==null&&ns.next!==null,zi=0,ls=ns=Lt=null,ad=!1,p)throw Error(t(300));return d}function _f(){var d=il!==0;return il=0,d}function Jr(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ls===null?Lt.memoizedState=ls=d:ls=ls.next=d,ls}function xr(){if(ns===null){var d=Lt.alternate;d=d!==null?d.memoizedState:null}else d=ns.next;var p=ls===null?Lt.memoizedState:ls.next;if(p!==null)ls=p,ns=d;else{if(d===null)throw Error(t(310));ns=d,d={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},ls===null?Lt.memoizedState=ls=d:ls=ls.next=d}return ls}function al(d,p){return typeof p=="function"?p(d):p}function Af(d){var p=xr(),j=p.queue;if(j===null)throw Error(t(311));j.lastRenderedReducer=d;var _=ns,T=_.baseQueue,P=j.pending;if(P!==null){if(T!==null){var $=T.next;T.next=P.next,P.next=$}_.baseQueue=T=P,j.pending=null}if(T!==null){P=T.next,_=_.baseState;var Z=$=null,ne=null,fe=P;do{var ye=fe.lane;if((zi&ye)===ye)ne!==null&&(ne=ne.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),_=fe.hasEagerState?fe.eagerState:d(_,fe.action);else{var be={lane:ye,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};ne===null?(Z=ne=be,$=_):ne=ne.next=be,Lt.lanes|=ye,Ui|=ye}fe=fe.next}while(fe!==null&&fe!==P);ne===null?$=_:ne.next=Z,Dr(_,p.memoizedState)||(Ys=!0),p.memoizedState=_,p.baseState=$,p.baseQueue=ne,j.lastRenderedState=_}if(d=j.interleaved,d!==null){T=d;do P=T.lane,Lt.lanes|=P,Ui|=P,T=T.next;while(T!==d)}else T===null&&(j.lanes=0);return[p.memoizedState,j.dispatch]}function Cf(d){var p=xr(),j=p.queue;if(j===null)throw Error(t(311));j.lastRenderedReducer=d;var _=j.dispatch,T=j.pending,P=p.memoizedState;if(T!==null){j.pending=null;var $=T=T.next;do P=d(P,$.action),$=$.next;while($!==T);Dr(P,p.memoizedState)||(Ys=!0),p.memoizedState=P,p.baseQueue===null&&(p.baseState=P),j.lastRenderedState=P}return[P,_]}function tb(){}function sb(d,p){var j=Lt,_=xr(),T=p(),P=!Dr(_.memoizedState,T);if(P&&(_.memoizedState=T,Ys=!0),_=_.queue,Tf(ib.bind(null,j,_,d),[d]),_.getSnapshot!==p||P||ls!==null&&ls.memoizedState.tag&1){if(j.flags|=2048,ol(9,nb.bind(null,j,_,T,p),void 0,null),cs===null)throw Error(t(349));(zi&30)!==0||rb(j,p,T)}return T}function rb(d,p,j){d.flags|=16384,d={getSnapshot:p,value:j},p=Lt.updateQueue,p===null?(p={lastEffect:null,stores:null},Lt.updateQueue=p,p.stores=[d]):(j=p.stores,j===null?p.stores=[d]:j.push(d))}function nb(d,p,j,_){p.value=j,p.getSnapshot=_,ab(p)&&ob(d)}function ib(d,p,j){return j(function(){ab(p)&&ob(d)})}function ab(d){var p=d.getSnapshot;d=d.value;try{var j=p();return!Dr(d,j)}catch{return!0}}function ob(d){var p=Nn(d,1);p!==null&&Ir(p,d,1,-1)}function lb(d){var p=Jr();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:d},p.queue=d,d=d.dispatch=QT.bind(null,Lt,d),[p.memoizedState,d]}function ol(d,p,j,_){return d={tag:d,create:p,destroy:j,deps:_,next:null},p=Lt.updateQueue,p===null?(p={lastEffect:null,stores:null},Lt.updateQueue=p,p.lastEffect=d.next=d):(j=p.lastEffect,j===null?p.lastEffect=d.next=d:(_=j.next,j.next=d,d.next=_,p.lastEffect=d)),d}function cb(){return xr().memoizedState}function od(d,p,j,_){var T=Jr();Lt.flags|=d,T.memoizedState=ol(1|p,j,void 0,_===void 0?null:_)}function ld(d,p,j,_){var T=xr();_=_===void 0?null:_;var P=void 0;if(ns!==null){var $=ns.memoizedState;if(P=$.destroy,_!==null&&Ef(_,$.deps)){T.memoizedState=ol(p,j,P,_);return}}Lt.flags|=d,T.memoizedState=ol(1|p,j,P,_)}function db(d,p){return od(8390656,8,d,p)}function Tf(d,p){return ld(2048,8,d,p)}function ub(d,p){return ld(4,2,d,p)}function hb(d,p){return ld(4,4,d,p)}function fb(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function mb(d,p,j){return j=j!=null?j.concat([d]):null,ld(4,4,fb.bind(null,p,d),j)}function Rf(){}function pb(d,p){var j=xr();p=p===void 0?null:p;var _=j.memoizedState;return _!==null&&p!==null&&Ef(p,_[1])?_[0]:(j.memoizedState=[d,p],d)}function gb(d,p){var j=xr();p=p===void 0?null:p;var _=j.memoizedState;return _!==null&&p!==null&&Ef(p,_[1])?_[0]:(d=d(),j.memoizedState=[d,p],d)}function xb(d,p,j){return(zi&21)===0?(d.baseState&&(d.baseState=!1,Ys=!0),d.memoizedState=j):(Dr(j,p)||(j=Gy(),Lt.lanes|=j,Ui|=j,d.baseState=!0),p)}function KT(d,p){var j=pt;pt=j!==0&&4>j?j:4,d(!0);var _=kf.transition;kf.transition={};try{d(!1),p()}finally{pt=j,kf.transition=_}}function yb(){return xr().memoizedState}function XT(d,p,j){var _=ii(d);if(j={lane:_,action:j,hasEagerState:!1,eagerState:null,next:null},vb(d))bb(p,j);else if(j=Xv(d,p,j,_),j!==null){var T=Os();Ir(j,d,_,T),jb(j,p,_)}}function QT(d,p,j){var _=ii(d),T={lane:_,action:j,hasEagerState:!1,eagerState:null,next:null};if(vb(d))bb(p,T);else{var P=d.alternate;if(d.lanes===0&&(P===null||P.lanes===0)&&(P=p.lastRenderedReducer,P!==null))try{var $=p.lastRenderedState,Z=P($,j);if(T.hasEagerState=!0,T.eagerState=Z,Dr(Z,$)){var ne=p.interleaved;ne===null?(T.next=T,yf(p)):(T.next=ne.next,ne.next=T),p.interleaved=T;return}}catch{}finally{}j=Xv(d,p,T,_),j!==null&&(T=Os(),Ir(j,d,_,T),jb(j,p,_))}}function vb(d){var p=d.alternate;return d===Lt||p!==null&&p===Lt}function bb(d,p){nl=ad=!0;var j=d.pending;j===null?p.next=p:(p.next=j.next,j.next=p),d.pending=p}function jb(d,p,j){if((j&4194240)!==0){var _=p.lanes;_&=d.pendingLanes,j|=_,p.lanes=j,Dh(d,j)}}var cd={readContext:gr,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},JT={readContext:gr,useCallback:function(d,p){return Jr().memoizedState=[d,p===void 0?null:p],d},useContext:gr,useEffect:db,useImperativeHandle:function(d,p,j){return j=j!=null?j.concat([d]):null,od(4194308,4,fb.bind(null,p,d),j)},useLayoutEffect:function(d,p){return od(4194308,4,d,p)},useInsertionEffect:function(d,p){return od(4,2,d,p)},useMemo:function(d,p){var j=Jr();return p=p===void 0?null:p,d=d(),j.memoizedState=[d,p],d},useReducer:function(d,p,j){var _=Jr();return p=j!==void 0?j(p):p,_.memoizedState=_.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},_.queue=d,d=d.dispatch=XT.bind(null,Lt,d),[_.memoizedState,d]},useRef:function(d){var p=Jr();return d={current:d},p.memoizedState=d},useState:lb,useDebugValue:Rf,useDeferredValue:function(d){return Jr().memoizedState=d},useTransition:function(){var d=lb(!1),p=d[0];return d=KT.bind(null,d[1]),Jr().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,j){var _=Lt,T=Jr();if(Tt){if(j===void 0)throw Error(t(407));j=j()}else{if(j=p(),cs===null)throw Error(t(349));(zi&30)!==0||rb(_,p,j)}T.memoizedState=j;var P={value:j,getSnapshot:p};return T.queue=P,db(ib.bind(null,_,P,d),[d]),_.flags|=2048,ol(9,nb.bind(null,_,P,j,p),void 0,null),j},useId:function(){var d=Jr(),p=cs.identifierPrefix;if(Tt){var j=wn,_=jn;j=(_&~(1<<32-Rr(_)-1)).toString(32)+j,p=":"+p+"R"+j,j=il++,0<j&&(p+="H"+j.toString(32)),p+=":"}else j=YT++,p=":"+p+"r"+j.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},ZT={readContext:gr,useCallback:pb,useContext:gr,useEffect:Tf,useImperativeHandle:mb,useInsertionEffect:ub,useLayoutEffect:hb,useMemo:gb,useReducer:Af,useRef:cb,useState:function(){return Af(al)},useDebugValue:Rf,useDeferredValue:function(d){var p=xr();return xb(p,ns.memoizedState,d)},useTransition:function(){var d=Af(al)[0],p=xr().memoizedState;return[d,p]},useMutableSource:tb,useSyncExternalStore:sb,useId:yb,unstable_isNewReconciler:!1},eR={readContext:gr,useCallback:pb,useContext:gr,useEffect:Tf,useImperativeHandle:mb,useInsertionEffect:ub,useLayoutEffect:hb,useMemo:gb,useReducer:Cf,useRef:cb,useState:function(){return Cf(al)},useDebugValue:Rf,useDeferredValue:function(d){var p=xr();return ns===null?p.memoizedState=d:xb(p,ns.memoizedState,d)},useTransition:function(){var d=Cf(al)[0],p=xr().memoizedState;return[d,p]},useMutableSource:tb,useSyncExternalStore:sb,useId:yb,unstable_isNewReconciler:!1};function Mr(d,p){if(d&&d.defaultProps){p=V({},p),d=d.defaultProps;for(var j in d)p[j]===void 0&&(p[j]=d[j]);return p}return p}function Df(d,p,j,_){p=d.memoizedState,j=j(_,p),j=j==null?p:V({},p,j),d.memoizedState=j,d.lanes===0&&(d.updateQueue.baseState=j)}var dd={isMounted:function(d){return(d=d._reactInternals)?Pi(d)===d:!1},enqueueSetState:function(d,p,j){d=d._reactInternals;var _=Os(),T=ii(d),P=kn(_,T);P.payload=p,j!=null&&(P.callback=j),p=ti(d,P,T),p!==null&&(Ir(p,d,T,_),sd(p,d,T))},enqueueReplaceState:function(d,p,j){d=d._reactInternals;var _=Os(),T=ii(d),P=kn(_,T);P.tag=1,P.payload=p,j!=null&&(P.callback=j),p=ti(d,P,T),p!==null&&(Ir(p,d,T,_),sd(p,d,T))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var j=Os(),_=ii(d),T=kn(j,_);T.tag=2,p!=null&&(T.callback=p),p=ti(d,T,_),p!==null&&(Ir(p,d,_,j),sd(p,d,_))}};function wb(d,p,j,_,T,P,$){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(_,P,$):p.prototype&&p.prototype.isPureReactComponent?!Go(j,_)||!Go(T,P):!0}function Nb(d,p,j){var _=!1,T=Jn,P=p.contextType;return typeof P=="object"&&P!==null?P=gr(P):(T=Gs(p)?Oi:As.current,_=p.contextTypes,P=(_=_!=null)?Ca(d,T):Jn),p=new p(j,P),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=dd,d.stateNode=p,p._reactInternals=d,_&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=T,d.__reactInternalMemoizedMaskedChildContext=P),p}function kb(d,p,j,_){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(j,_),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(j,_),p.state!==d&&dd.enqueueReplaceState(p,p.state,null)}function Pf(d,p,j,_){var T=d.stateNode;T.props=j,T.state=d.memoizedState,T.refs={},vf(d);var P=p.contextType;typeof P=="object"&&P!==null?T.context=gr(P):(P=Gs(p)?Oi:As.current,T.context=Ca(d,P)),T.state=d.memoizedState,P=p.getDerivedStateFromProps,typeof P=="function"&&(Df(d,p,P,j),T.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(p=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),p!==T.state&&dd.enqueueReplaceState(T,T.state,null),rd(d,j,T,_),T.state=d.memoizedState),typeof T.componentDidMount=="function"&&(d.flags|=4194308)}function Ia(d,p){try{var j="",_=p;do j+=te(_),_=_.return;while(_);var T=j}catch(P){T=`
Error generating stack: `+P.message+`
`+P.stack}return{value:d,source:p,stack:T,digest:null}}function Mf(d,p,j){return{value:d,source:null,stack:j??null,digest:p??null}}function Of(d,p){try{console.error(p.value)}catch(j){setTimeout(function(){throw j})}}var tR=typeof WeakMap=="function"?WeakMap:Map;function Eb(d,p,j){j=kn(-1,j),j.tag=3,j.payload={element:null};var _=p.value;return j.callback=function(){xd||(xd=!0,Xf=_),Of(d,p)},j}function Sb(d,p,j){j=kn(-1,j),j.tag=3;var _=d.type.getDerivedStateFromError;if(typeof _=="function"){var T=p.value;j.payload=function(){return _(T)},j.callback=function(){Of(d,p)}}var P=d.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(j.callback=function(){Of(d,p),typeof _!="function"&&(ri===null?ri=new Set([this]):ri.add(this));var $=p.stack;this.componentDidCatch(p.value,{componentStack:$!==null?$:""})}),j}function _b(d,p,j){var _=d.pingCache;if(_===null){_=d.pingCache=new tR;var T=new Set;_.set(p,T)}else T=_.get(p),T===void 0&&(T=new Set,_.set(p,T));T.has(j)||(T.add(j),d=pR.bind(null,d,p,j),p.then(d,d))}function Ab(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function Cb(d,p,j,_,T){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,j.flags|=131072,j.flags&=-52805,j.tag===1&&(j.alternate===null?j.tag=17:(p=kn(-1,1),p.tag=2,ti(j,p,1))),j.lanes|=1),d):(d.flags|=65536,d.lanes=T,d)}var sR=N.ReactCurrentOwner,Ys=!1;function Ms(d,p,j,_){p.child=d===null?Kv(p,null,j,_):Pa(p,d.child,j,_)}function Tb(d,p,j,_,T){j=j.render;var P=p.ref;return Oa(p,T),_=Sf(d,p,j,_,P,T),j=_f(),d!==null&&!Ys?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~T,En(d,p,T)):(Tt&&j&&cf(p),p.flags|=1,Ms(d,p,_,T),p.child)}function Rb(d,p,j,_,T){if(d===null){var P=j.type;return typeof P=="function"&&!rm(P)&&P.defaultProps===void 0&&j.compare===null&&j.defaultProps===void 0?(p.tag=15,p.type=P,Db(d,p,P,_,T)):(d=Nd(j.type,null,_,p,p.mode,T),d.ref=p.ref,d.return=p,p.child=d)}if(P=d.child,(d.lanes&T)===0){var $=P.memoizedProps;if(j=j.compare,j=j!==null?j:Go,j($,_)&&d.ref===p.ref)return En(d,p,T)}return p.flags|=1,d=oi(P,_),d.ref=p.ref,d.return=p,p.child=d}function Db(d,p,j,_,T){if(d!==null){var P=d.memoizedProps;if(Go(P,_)&&d.ref===p.ref)if(Ys=!1,p.pendingProps=_=P,(d.lanes&T)!==0)(d.flags&131072)!==0&&(Ys=!0);else return p.lanes=d.lanes,En(d,p,T)}return Lf(d,p,j,_,T)}function Pb(d,p,j){var _=p.pendingProps,T=_.children,P=d!==null?d.memoizedState:null;if(_.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Fa,lr),lr|=j;else{if((j&1073741824)===0)return d=P!==null?P.baseLanes|j:j,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,wt(Fa,lr),lr|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=P!==null?P.baseLanes:j,wt(Fa,lr),lr|=_}else P!==null?(_=P.baseLanes|j,p.memoizedState=null):_=j,wt(Fa,lr),lr|=_;return Ms(d,p,T,j),p.child}function Mb(d,p){var j=p.ref;(d===null&&j!==null||d!==null&&d.ref!==j)&&(p.flags|=512,p.flags|=2097152)}function Lf(d,p,j,_,T){var P=Gs(j)?Oi:As.current;return P=Ca(p,P),Oa(p,T),j=Sf(d,p,j,_,P,T),_=_f(),d!==null&&!Ys?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~T,En(d,p,T)):(Tt&&_&&cf(p),p.flags|=1,Ms(d,p,j,T),p.child)}function Ob(d,p,j,_,T){if(Gs(j)){var P=!0;Yc(p)}else P=!1;if(Oa(p,T),p.stateNode===null)hd(d,p),Nb(p,j,_),Pf(p,j,_,T),_=!0;else if(d===null){var $=p.stateNode,Z=p.memoizedProps;$.props=Z;var ne=$.context,fe=j.contextType;typeof fe=="object"&&fe!==null?fe=gr(fe):(fe=Gs(j)?Oi:As.current,fe=Ca(p,fe));var ye=j.getDerivedStateFromProps,be=typeof ye=="function"||typeof $.getSnapshotBeforeUpdate=="function";be||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(Z!==_||ne!==fe)&&kb(p,$,_,fe),ei=!1;var xe=p.memoizedState;$.state=xe,rd(p,_,$,T),ne=p.memoizedState,Z!==_||xe!==ne||Ws.current||ei?(typeof ye=="function"&&(Df(p,j,ye,_),ne=p.memoizedState),(Z=ei||wb(p,j,Z,_,xe,ne,fe))?(be||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(p.flags|=4194308)):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=_,p.memoizedState=ne),$.props=_,$.state=ne,$.context=fe,_=Z):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),_=!1)}else{$=p.stateNode,Qv(d,p),Z=p.memoizedProps,fe=p.type===p.elementType?Z:Mr(p.type,Z),$.props=fe,be=p.pendingProps,xe=$.context,ne=j.contextType,typeof ne=="object"&&ne!==null?ne=gr(ne):(ne=Gs(j)?Oi:As.current,ne=Ca(p,ne));var ke=j.getDerivedStateFromProps;(ye=typeof ke=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(Z!==be||xe!==ne)&&kb(p,$,_,ne),ei=!1,xe=p.memoizedState,$.state=xe,rd(p,_,$,T);var Te=p.memoizedState;Z!==be||xe!==Te||Ws.current||ei?(typeof ke=="function"&&(Df(p,j,ke,_),Te=p.memoizedState),(fe=ei||wb(p,j,fe,_,xe,Te,ne)||!1)?(ye||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(_,Te,ne),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(_,Te,ne)),typeof $.componentDidUpdate=="function"&&(p.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof $.componentDidUpdate!="function"||Z===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||Z===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),p.memoizedProps=_,p.memoizedState=Te),$.props=_,$.state=Te,$.context=ne,_=fe):(typeof $.componentDidUpdate!="function"||Z===d.memoizedProps&&xe===d.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||Z===d.memoizedProps&&xe===d.memoizedState||(p.flags|=1024),_=!1)}return If(d,p,j,_,P,T)}function If(d,p,j,_,T,P){Mb(d,p);var $=(p.flags&128)!==0;if(!_&&!$)return T&&zv(p,j,!1),En(d,p,P);_=p.stateNode,sR.current=p;var Z=$&&typeof j.getDerivedStateFromError!="function"?null:_.render();return p.flags|=1,d!==null&&$?(p.child=Pa(p,d.child,null,P),p.child=Pa(p,null,Z,P)):Ms(d,p,Z,P),p.memoizedState=_.state,T&&zv(p,j,!0),p.child}function Lb(d){var p=d.stateNode;p.pendingContext?Bv(d,p.pendingContext,p.pendingContext!==p.context):p.context&&Bv(d,p.context,!1),bf(d,p.containerInfo)}function Ib(d,p,j,_,T){return Da(),ff(T),p.flags|=256,Ms(d,p,j,_),p.child}var Bf={dehydrated:null,treeContext:null,retryLane:0};function Ff(d){return{baseLanes:d,cachePool:null,transitions:null}}function Bb(d,p,j){var _=p.pendingProps,T=Ot.current,P=!1,$=(p.flags&128)!==0,Z;if((Z=$)||(Z=d!==null&&d.memoizedState===null?!1:(T&2)!==0),Z?(P=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(T|=1),wt(Ot,T&1),d===null)return hf(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):($=_.children,d=_.fallback,P?(_=p.mode,P=p.child,$={mode:"hidden",children:$},(_&1)===0&&P!==null?(P.childLanes=0,P.pendingProps=$):P=kd($,_,0,null),d=$i(d,_,j,null),P.return=p,d.return=p,P.sibling=d,p.child=P,p.child.memoizedState=Ff(j),p.memoizedState=Bf,d):zf(p,$));if(T=d.memoizedState,T!==null&&(Z=T.dehydrated,Z!==null))return rR(d,p,$,_,Z,T,j);if(P){P=_.fallback,$=p.mode,T=d.child,Z=T.sibling;var ne={mode:"hidden",children:_.children};return($&1)===0&&p.child!==T?(_=p.child,_.childLanes=0,_.pendingProps=ne,p.deletions=null):(_=oi(T,ne),_.subtreeFlags=T.subtreeFlags&14680064),Z!==null?P=oi(Z,P):(P=$i(P,$,j,null),P.flags|=2),P.return=p,_.return=p,_.sibling=P,p.child=_,_=P,P=p.child,$=d.child.memoizedState,$=$===null?Ff(j):{baseLanes:$.baseLanes|j,cachePool:null,transitions:$.transitions},P.memoizedState=$,P.childLanes=d.childLanes&~j,p.memoizedState=Bf,_}return P=d.child,d=P.sibling,_=oi(P,{mode:"visible",children:_.children}),(p.mode&1)===0&&(_.lanes=j),_.return=p,_.sibling=null,d!==null&&(j=p.deletions,j===null?(p.deletions=[d],p.flags|=16):j.push(d)),p.child=_,p.memoizedState=null,_}function zf(d,p){return p=kd({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function ud(d,p,j,_){return _!==null&&ff(_),Pa(p,d.child,null,j),d=zf(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function rR(d,p,j,_,T,P,$){if(j)return p.flags&256?(p.flags&=-257,_=Mf(Error(t(422))),ud(d,p,$,_)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(P=_.fallback,T=p.mode,_=kd({mode:"visible",children:_.children},T,0,null),P=$i(P,T,$,null),P.flags|=2,_.return=p,P.return=p,_.sibling=P,p.child=_,(p.mode&1)!==0&&Pa(p,d.child,null,$),p.child.memoizedState=Ff($),p.memoizedState=Bf,P);if((p.mode&1)===0)return ud(d,p,$,null);if(T.data==="$!"){if(_=T.nextSibling&&T.nextSibling.dataset,_)var Z=_.dgst;return _=Z,P=Error(t(419)),_=Mf(P,_,void 0),ud(d,p,$,_)}if(Z=($&d.childLanes)!==0,Ys||Z){if(_=cs,_!==null){switch($&-$){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(_.suspendedLanes|$))!==0?0:T,T!==0&&T!==P.retryLane&&(P.retryLane=T,Nn(d,T),Ir(_,d,T,-1))}return sm(),_=Mf(Error(t(421))),ud(d,p,$,_)}return T.data==="$?"?(p.flags|=128,p.child=d.child,p=gR.bind(null,d),T._reactRetry=p,null):(d=P.treeContext,or=Xn(T.nextSibling),ar=p,Tt=!0,Pr=null,d!==null&&(mr[pr++]=jn,mr[pr++]=wn,mr[pr++]=Li,jn=d.id,wn=d.overflow,Li=p),p=zf(p,_.children),p.flags|=4096,p)}function Fb(d,p,j){d.lanes|=p;var _=d.alternate;_!==null&&(_.lanes|=p),xf(d.return,p,j)}function Uf(d,p,j,_,T){var P=d.memoizedState;P===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:_,tail:j,tailMode:T}:(P.isBackwards=p,P.rendering=null,P.renderingStartTime=0,P.last=_,P.tail=j,P.tailMode=T)}function zb(d,p,j){var _=p.pendingProps,T=_.revealOrder,P=_.tail;if(Ms(d,p,_.children,j),_=Ot.current,(_&2)!==0)_=_&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Fb(d,j,p);else if(d.tag===19)Fb(d,j,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}_&=1}if(wt(Ot,_),(p.mode&1)===0)p.memoizedState=null;else switch(T){case"forwards":for(j=p.child,T=null;j!==null;)d=j.alternate,d!==null&&nd(d)===null&&(T=j),j=j.sibling;j=T,j===null?(T=p.child,p.child=null):(T=j.sibling,j.sibling=null),Uf(p,!1,T,j,P);break;case"backwards":for(j=null,T=p.child,p.child=null;T!==null;){if(d=T.alternate,d!==null&&nd(d)===null){p.child=T;break}d=T.sibling,T.sibling=j,j=T,T=d}Uf(p,!0,j,null,P);break;case"together":Uf(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function hd(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function En(d,p,j){if(d!==null&&(p.dependencies=d.dependencies),Ui|=p.lanes,(j&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(t(153));if(p.child!==null){for(d=p.child,j=oi(d,d.pendingProps),p.child=j,j.return=p;d.sibling!==null;)d=d.sibling,j=j.sibling=oi(d,d.pendingProps),j.return=p;j.sibling=null}return p.child}function nR(d,p,j){switch(p.tag){case 3:Lb(p),Da();break;case 5:eb(p);break;case 1:Gs(p.type)&&Yc(p);break;case 4:bf(p,p.stateNode.containerInfo);break;case 10:var _=p.type._context,T=p.memoizedProps.value;wt(ed,_._currentValue),_._currentValue=T;break;case 13:if(_=p.memoizedState,_!==null)return _.dehydrated!==null?(wt(Ot,Ot.current&1),p.flags|=128,null):(j&p.child.childLanes)!==0?Bb(d,p,j):(wt(Ot,Ot.current&1),d=En(d,p,j),d!==null?d.sibling:null);wt(Ot,Ot.current&1);break;case 19:if(_=(j&p.childLanes)!==0,(d.flags&128)!==0){if(_)return zb(d,p,j);p.flags|=128}if(T=p.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),wt(Ot,Ot.current),_)break;return null;case 22:case 23:return p.lanes=0,Pb(d,p,j)}return En(d,p,j)}var Ub,Hf,Hb,Vb;Ub=function(d,p){for(var j=p.child;j!==null;){if(j.tag===5||j.tag===6)d.appendChild(j.stateNode);else if(j.tag!==4&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===p)break;for(;j.sibling===null;){if(j.return===null||j.return===p)return;j=j.return}j.sibling.return=j.return,j=j.sibling}},Hf=function(){},Hb=function(d,p,j,_){var T=d.memoizedProps;if(T!==_){d=p.stateNode,Fi(Qr.current);var P=null;switch(j){case"input":T=Le(d,T),_=Le(d,_),P=[];break;case"select":T=V({},T,{value:void 0}),_=V({},_,{value:void 0}),P=[];break;case"textarea":T=pe(d,T),_=pe(d,_),P=[];break;default:typeof T.onClick!="function"&&typeof _.onClick=="function"&&(d.onclick=$c)}Ro(j,_);var $;j=null;for(fe in T)if(!_.hasOwnProperty(fe)&&T.hasOwnProperty(fe)&&T[fe]!=null)if(fe==="style"){var Z=T[fe];for($ in Z)Z.hasOwnProperty($)&&(j||(j={}),j[$]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(i.hasOwnProperty(fe)?P||(P=[]):(P=P||[]).push(fe,null));for(fe in _){var ne=_[fe];if(Z=T?.[fe],_.hasOwnProperty(fe)&&ne!==Z&&(ne!=null||Z!=null))if(fe==="style")if(Z){for($ in Z)!Z.hasOwnProperty($)||ne&&ne.hasOwnProperty($)||(j||(j={}),j[$]="");for($ in ne)ne.hasOwnProperty($)&&Z[$]!==ne[$]&&(j||(j={}),j[$]=ne[$])}else j||(P||(P=[]),P.push(fe,j)),j=ne;else fe==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Z=Z?Z.__html:void 0,ne!=null&&Z!==ne&&(P=P||[]).push(fe,ne)):fe==="children"?typeof ne!="string"&&typeof ne!="number"||(P=P||[]).push(fe,""+ne):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(fe)?(ne!=null&&fe==="onScroll"&&_t("scroll",d),P||Z===ne||(P=[])):(P=P||[]).push(fe,ne))}j&&(P=P||[]).push("style",j);var fe=P;(p.updateQueue=fe)&&(p.flags|=4)}},Vb=function(d,p,j,_){j!==_&&(p.flags|=4)};function ll(d,p){if(!Tt)switch(d.tailMode){case"hidden":p=d.tail;for(var j=null;p!==null;)p.alternate!==null&&(j=p),p=p.sibling;j===null?d.tail=null:j.sibling=null;break;case"collapsed":j=d.tail;for(var _=null;j!==null;)j.alternate!==null&&(_=j),j=j.sibling;_===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:_.sibling=null}}function Ts(d){var p=d.alternate!==null&&d.alternate.child===d.child,j=0,_=0;if(p)for(var T=d.child;T!==null;)j|=T.lanes|T.childLanes,_|=T.subtreeFlags&14680064,_|=T.flags&14680064,T.return=d,T=T.sibling;else for(T=d.child;T!==null;)j|=T.lanes|T.childLanes,_|=T.subtreeFlags,_|=T.flags,T.return=d,T=T.sibling;return d.subtreeFlags|=_,d.childLanes=j,p}function iR(d,p,j){var _=p.pendingProps;switch(df(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(p),null;case 1:return Gs(p.type)&&Gc(),Ts(p),null;case 3:return _=p.stateNode,La(),At(Ws),At(As),Nf(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(d===null||d.child===null)&&(Jc(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Pr!==null&&(Zf(Pr),Pr=null))),Hf(d,p),Ts(p),null;case 5:jf(p);var T=Fi(rl.current);if(j=p.type,d!==null&&p.stateNode!=null)Hb(d,p,j,_,T),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!_){if(p.stateNode===null)throw Error(t(166));return Ts(p),null}if(d=Fi(Qr.current),Jc(p)){_=p.stateNode,j=p.type;var P=p.memoizedProps;switch(_[Xr]=p,_[Jo]=P,d=(p.mode&1)!==0,j){case"dialog":_t("cancel",_),_t("close",_);break;case"iframe":case"object":case"embed":_t("load",_);break;case"video":case"audio":for(T=0;T<Ko.length;T++)_t(Ko[T],_);break;case"source":_t("error",_);break;case"img":case"image":case"link":_t("error",_),_t("load",_);break;case"details":_t("toggle",_);break;case"input":Qe(_,P),_t("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!P.multiple},_t("invalid",_);break;case"textarea":Ue(_,P),_t("invalid",_)}Ro(j,P),T=null;for(var $ in P)if(P.hasOwnProperty($)){var Z=P[$];$==="children"?typeof Z=="string"?_.textContent!==Z&&(P.suppressHydrationWarning!==!0&&qc(_.textContent,Z,d),T=["children",Z]):typeof Z=="number"&&_.textContent!==""+Z&&(P.suppressHydrationWarning!==!0&&qc(_.textContent,Z,d),T=["children",""+Z]):i.hasOwnProperty($)&&Z!=null&&$==="onScroll"&&_t("scroll",_)}switch(j){case"input":we(_),ee(_,P,!0);break;case"textarea":we(_),Ge(_);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(_.onclick=$c)}_=T,p.updateQueue=_,_!==null&&(p.flags|=4)}else{$=T.nodeType===9?T:T.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Jt(j)),d==="http://www.w3.org/1999/xhtml"?j==="script"?(d=$.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof _.is=="string"?d=$.createElement(j,{is:_.is}):(d=$.createElement(j),j==="select"&&($=d,_.multiple?$.multiple=!0:_.size&&($.size=_.size))):d=$.createElementNS(d,j),d[Xr]=p,d[Jo]=_,Ub(d,p,!1,!1),p.stateNode=d;e:{switch($=Do(j,_),j){case"dialog":_t("cancel",d),_t("close",d),T=_;break;case"iframe":case"object":case"embed":_t("load",d),T=_;break;case"video":case"audio":for(T=0;T<Ko.length;T++)_t(Ko[T],d);T=_;break;case"source":_t("error",d),T=_;break;case"img":case"image":case"link":_t("error",d),_t("load",d),T=_;break;case"details":_t("toggle",d),T=_;break;case"input":Qe(d,_),T=Le(d,_),_t("invalid",d);break;case"option":T=_;break;case"select":d._wrapperState={wasMultiple:!!_.multiple},T=V({},_,{value:void 0}),_t("invalid",d);break;case"textarea":Ue(d,_),T=pe(d,_),_t("invalid",d);break;default:T=_}Ro(j,T),Z=T;for(P in Z)if(Z.hasOwnProperty(P)){var ne=Z[P];P==="style"?yc(d,ne):P==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&Ri(d,ne)):P==="children"?typeof ne=="string"?(j!=="textarea"||ne!=="")&&gt(d,ne):typeof ne=="number"&&gt(d,""+ne):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(i.hasOwnProperty(P)?ne!=null&&P==="onScroll"&&_t("scroll",d):ne!=null&&k(d,P,ne,$))}switch(j){case"input":we(d),ee(d,_,!1);break;case"textarea":we(d),Ge(d);break;case"option":_.value!=null&&d.setAttribute("value",""+ae(_.value));break;case"select":d.multiple=!!_.multiple,P=_.value,P!=null?ve(d,!!_.multiple,P,!1):_.defaultValue!=null&&ve(d,!!_.multiple,_.defaultValue,!0);break;default:typeof T.onClick=="function"&&(d.onclick=$c)}switch(j){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Ts(p),null;case 6:if(d&&p.stateNode!=null)Vb(d,p,d.memoizedProps,_);else{if(typeof _!="string"&&p.stateNode===null)throw Error(t(166));if(j=Fi(rl.current),Fi(Qr.current),Jc(p)){if(_=p.stateNode,j=p.memoizedProps,_[Xr]=p,(P=_.nodeValue!==j)&&(d=ar,d!==null))switch(d.tag){case 3:qc(_.nodeValue,j,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&qc(_.nodeValue,j,(d.mode&1)!==0)}P&&(p.flags|=4)}else _=(j.nodeType===9?j:j.ownerDocument).createTextNode(_),_[Xr]=p,p.stateNode=_}return Ts(p),null;case 13:if(At(Ot),_=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(Tt&&or!==null&&(p.mode&1)!==0&&(p.flags&128)===0)Wv(),Da(),p.flags|=98560,P=!1;else if(P=Jc(p),_!==null&&_.dehydrated!==null){if(d===null){if(!P)throw Error(t(318));if(P=p.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(t(317));P[Xr]=p}else Da(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Ts(p),P=!1}else Pr!==null&&(Zf(Pr),Pr=null),P=!0;if(!P)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=j,p):(_=_!==null,_!==(d!==null&&d.memoizedState!==null)&&_&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Ot.current&1)!==0?is===0&&(is=3):sm())),p.updateQueue!==null&&(p.flags|=4),Ts(p),null);case 4:return La(),Hf(d,p),d===null&&Xo(p.stateNode.containerInfo),Ts(p),null;case 10:return gf(p.type._context),Ts(p),null;case 17:return Gs(p.type)&&Gc(),Ts(p),null;case 19:if(At(Ot),P=p.memoizedState,P===null)return Ts(p),null;if(_=(p.flags&128)!==0,$=P.rendering,$===null)if(_)ll(P,!1);else{if(is!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if($=nd(d),$!==null){for(p.flags|=128,ll(P,!1),_=$.updateQueue,_!==null&&(p.updateQueue=_,p.flags|=4),p.subtreeFlags=0,_=j,j=p.child;j!==null;)P=j,d=_,P.flags&=14680066,$=P.alternate,$===null?(P.childLanes=0,P.lanes=d,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=$.childLanes,P.lanes=$.lanes,P.child=$.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=$.memoizedProps,P.memoizedState=$.memoizedState,P.updateQueue=$.updateQueue,P.type=$.type,d=$.dependencies,P.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),j=j.sibling;return wt(Ot,Ot.current&1|2),p.child}d=d.sibling}P.tail!==null&&Wt()>za&&(p.flags|=128,_=!0,ll(P,!1),p.lanes=4194304)}else{if(!_)if(d=nd($),d!==null){if(p.flags|=128,_=!0,j=d.updateQueue,j!==null&&(p.updateQueue=j,p.flags|=4),ll(P,!0),P.tail===null&&P.tailMode==="hidden"&&!$.alternate&&!Tt)return Ts(p),null}else 2*Wt()-P.renderingStartTime>za&&j!==1073741824&&(p.flags|=128,_=!0,ll(P,!1),p.lanes=4194304);P.isBackwards?($.sibling=p.child,p.child=$):(j=P.last,j!==null?j.sibling=$:p.child=$,P.last=$)}return P.tail!==null?(p=P.tail,P.rendering=p,P.tail=p.sibling,P.renderingStartTime=Wt(),p.sibling=null,j=Ot.current,wt(Ot,_?j&1|2:j&1),p):(Ts(p),null);case 22:case 23:return tm(),_=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==_&&(p.flags|=8192),_&&(p.mode&1)!==0?(lr&1073741824)!==0&&(Ts(p),p.subtreeFlags&6&&(p.flags|=8192)):Ts(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function aR(d,p){switch(df(p),p.tag){case 1:return Gs(p.type)&&Gc(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return La(),At(Ws),At(As),Nf(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return jf(p),null;case 13:if(At(Ot),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(t(340));Da()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return At(Ot),null;case 4:return La(),null;case 10:return gf(p.type._context),null;case 22:case 23:return tm(),null;case 24:return null;default:return null}}var fd=!1,Rs=!1,oR=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Ba(d,p){var j=d.ref;if(j!==null)if(typeof j=="function")try{j(null)}catch(_){Ht(d,p,_)}else j.current=null}function Vf(d,p,j){try{j()}catch(_){Ht(d,p,_)}}var qb=!1;function lR(d,p){if(ef=Pc,d=wv(),Wh(d)){if("selectionStart"in d)var j={start:d.selectionStart,end:d.selectionEnd};else e:{j=(j=d.ownerDocument)&&j.defaultView||window;var _=j.getSelection&&j.getSelection();if(_&&_.rangeCount!==0){j=_.anchorNode;var T=_.anchorOffset,P=_.focusNode;_=_.focusOffset;try{j.nodeType,P.nodeType}catch{j=null;break e}var $=0,Z=-1,ne=-1,fe=0,ye=0,be=d,xe=null;t:for(;;){for(var ke;be!==j||T!==0&&be.nodeType!==3||(Z=$+T),be!==P||_!==0&&be.nodeType!==3||(ne=$+_),be.nodeType===3&&($+=be.nodeValue.length),(ke=be.firstChild)!==null;)xe=be,be=ke;for(;;){if(be===d)break t;if(xe===j&&++fe===T&&(Z=$),xe===P&&++ye===_&&(ne=$),(ke=be.nextSibling)!==null)break;be=xe,xe=be.parentNode}be=ke}j=Z===-1||ne===-1?null:{start:Z,end:ne}}else j=null}j=j||{start:0,end:0}}else j=null;for(tf={focusedElem:d,selectionRange:j},Pc=!1,Ee=p;Ee!==null;)if(p=Ee,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,Ee=d;else for(;Ee!==null;){p=Ee;try{var Te=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var Re=Te.memoizedProps,Gt=Te.memoizedState,le=p.stateNode,ie=le.getSnapshotBeforeUpdate(p.elementType===p.type?Re:Mr(p.type,Re),Gt);le.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var de=p.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ne){Ht(p,p.return,Ne)}if(d=p.sibling,d!==null){d.return=p.return,Ee=d;break}Ee=p.return}return Te=qb,qb=!1,Te}function cl(d,p,j){var _=p.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var T=_=_.next;do{if((T.tag&d)===d){var P=T.destroy;T.destroy=void 0,P!==void 0&&Vf(p,j,P)}T=T.next}while(T!==_)}}function md(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var j=p=p.next;do{if((j.tag&d)===d){var _=j.create;j.destroy=_()}j=j.next}while(j!==p)}}function qf(d){var p=d.ref;if(p!==null){var j=d.stateNode;switch(d.tag){case 5:d=j;break;default:d=j}typeof p=="function"?p(d):p.current=d}}function $b(d){var p=d.alternate;p!==null&&(d.alternate=null,$b(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Xr],delete p[Jo],delete p[af],delete p[qT],delete p[$T])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Wb(d){return d.tag===5||d.tag===3||d.tag===4}function Gb(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Wb(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function $f(d,p,j){var _=d.tag;if(_===5||_===6)d=d.stateNode,p?j.nodeType===8?j.parentNode.insertBefore(d,p):j.insertBefore(d,p):(j.nodeType===8?(p=j.parentNode,p.insertBefore(d,j)):(p=j,p.appendChild(d)),j=j._reactRootContainer,j!=null||p.onclick!==null||(p.onclick=$c));else if(_!==4&&(d=d.child,d!==null))for($f(d,p,j),d=d.sibling;d!==null;)$f(d,p,j),d=d.sibling}function Wf(d,p,j){var _=d.tag;if(_===5||_===6)d=d.stateNode,p?j.insertBefore(d,p):j.appendChild(d);else if(_!==4&&(d=d.child,d!==null))for(Wf(d,p,j),d=d.sibling;d!==null;)Wf(d,p,j),d=d.sibling}var vs=null,Or=!1;function si(d,p,j){for(j=j.child;j!==null;)Yb(d,p,j),j=j.sibling}function Yb(d,p,j){if(Kr&&typeof Kr.onCommitFiberUnmount=="function")try{Kr.onCommitFiberUnmount(_c,j)}catch{}switch(j.tag){case 5:Rs||Ba(j,p);case 6:var _=vs,T=Or;vs=null,si(d,p,j),vs=_,Or=T,vs!==null&&(Or?(d=vs,j=j.stateNode,d.nodeType===8?d.parentNode.removeChild(j):d.removeChild(j)):vs.removeChild(j.stateNode));break;case 18:vs!==null&&(Or?(d=vs,j=j.stateNode,d.nodeType===8?nf(d.parentNode,j):d.nodeType===1&&nf(d,j),Uo(d)):nf(vs,j.stateNode));break;case 4:_=vs,T=Or,vs=j.stateNode.containerInfo,Or=!0,si(d,p,j),vs=_,Or=T;break;case 0:case 11:case 14:case 15:if(!Rs&&(_=j.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){T=_=_.next;do{var P=T,$=P.destroy;P=P.tag,$!==void 0&&((P&2)!==0||(P&4)!==0)&&Vf(j,p,$),T=T.next}while(T!==_)}si(d,p,j);break;case 1:if(!Rs&&(Ba(j,p),_=j.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=j.memoizedProps,_.state=j.memoizedState,_.componentWillUnmount()}catch(Z){Ht(j,p,Z)}si(d,p,j);break;case 21:si(d,p,j);break;case 22:j.mode&1?(Rs=(_=Rs)||j.memoizedState!==null,si(d,p,j),Rs=_):si(d,p,j);break;default:si(d,p,j)}}function Kb(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var j=d.stateNode;j===null&&(j=d.stateNode=new oR),p.forEach(function(_){var T=xR.bind(null,d,_);j.has(_)||(j.add(_),_.then(T,T))})}}function Lr(d,p){var j=p.deletions;if(j!==null)for(var _=0;_<j.length;_++){var T=j[_];try{var P=d,$=p,Z=$;e:for(;Z!==null;){switch(Z.tag){case 5:vs=Z.stateNode,Or=!1;break e;case 3:vs=Z.stateNode.containerInfo,Or=!0;break e;case 4:vs=Z.stateNode.containerInfo,Or=!0;break e}Z=Z.return}if(vs===null)throw Error(t(160));Yb(P,$,T),vs=null,Or=!1;var ne=T.alternate;ne!==null&&(ne.return=null),T.return=null}catch(fe){Ht(T,p,fe)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)Xb(p,d),p=p.sibling}function Xb(d,p){var j=d.alternate,_=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Lr(p,d),Zr(d),_&4){try{cl(3,d,d.return),md(3,d)}catch(Re){Ht(d,d.return,Re)}try{cl(5,d,d.return)}catch(Re){Ht(d,d.return,Re)}}break;case 1:Lr(p,d),Zr(d),_&512&&j!==null&&Ba(j,j.return);break;case 5:if(Lr(p,d),Zr(d),_&512&&j!==null&&Ba(j,j.return),d.flags&32){var T=d.stateNode;try{gt(T,"")}catch(Re){Ht(d,d.return,Re)}}if(_&4&&(T=d.stateNode,T!=null)){var P=d.memoizedProps,$=j!==null?j.memoizedProps:P,Z=d.type,ne=d.updateQueue;if(d.updateQueue=null,ne!==null)try{Z==="input"&&P.type==="radio"&&P.name!=null&&St(T,P),Do(Z,$);var fe=Do(Z,P);for($=0;$<ne.length;$+=2){var ye=ne[$],be=ne[$+1];ye==="style"?yc(T,be):ye==="dangerouslySetInnerHTML"?Ri(T,be):ye==="children"?gt(T,be):k(T,ye,be,fe)}switch(Z){case"input":at(T,P);break;case"textarea":We(T,P);break;case"select":var xe=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!P.multiple;var ke=P.value;ke!=null?ve(T,!!P.multiple,ke,!1):xe!==!!P.multiple&&(P.defaultValue!=null?ve(T,!!P.multiple,P.defaultValue,!0):ve(T,!!P.multiple,P.multiple?[]:"",!1))}T[Jo]=P}catch(Re){Ht(d,d.return,Re)}}break;case 6:if(Lr(p,d),Zr(d),_&4){if(d.stateNode===null)throw Error(t(162));T=d.stateNode,P=d.memoizedProps;try{T.nodeValue=P}catch(Re){Ht(d,d.return,Re)}}break;case 3:if(Lr(p,d),Zr(d),_&4&&j!==null&&j.memoizedState.isDehydrated)try{Uo(p.containerInfo)}catch(Re){Ht(d,d.return,Re)}break;case 4:Lr(p,d),Zr(d);break;case 13:Lr(p,d),Zr(d),T=d.child,T.flags&8192&&(P=T.memoizedState!==null,T.stateNode.isHidden=P,!P||T.alternate!==null&&T.alternate.memoizedState!==null||(Kf=Wt())),_&4&&Kb(d);break;case 22:if(ye=j!==null&&j.memoizedState!==null,d.mode&1?(Rs=(fe=Rs)||ye,Lr(p,d),Rs=fe):Lr(p,d),Zr(d),_&8192){if(fe=d.memoizedState!==null,(d.stateNode.isHidden=fe)&&!ye&&(d.mode&1)!==0)for(Ee=d,ye=d.child;ye!==null;){for(be=Ee=ye;Ee!==null;){switch(xe=Ee,ke=xe.child,xe.tag){case 0:case 11:case 14:case 15:cl(4,xe,xe.return);break;case 1:Ba(xe,xe.return);var Te=xe.stateNode;if(typeof Te.componentWillUnmount=="function"){_=xe,j=xe.return;try{p=_,Te.props=p.memoizedProps,Te.state=p.memoizedState,Te.componentWillUnmount()}catch(Re){Ht(_,j,Re)}}break;case 5:Ba(xe,xe.return);break;case 22:if(xe.memoizedState!==null){Zb(be);continue}}ke!==null?(ke.return=xe,Ee=ke):Zb(be)}ye=ye.sibling}e:for(ye=null,be=d;;){if(be.tag===5){if(ye===null){ye=be;try{T=be.stateNode,fe?(P=T.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(Z=be.stateNode,ne=be.memoizedProps.style,$=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Z.style.display=xc("display",$))}catch(Re){Ht(d,d.return,Re)}}}else if(be.tag===6){if(ye===null)try{be.stateNode.nodeValue=fe?"":be.memoizedProps}catch(Re){Ht(d,d.return,Re)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===d)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===d)break e;for(;be.sibling===null;){if(be.return===null||be.return===d)break e;ye===be&&(ye=null),be=be.return}ye===be&&(ye=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:Lr(p,d),Zr(d),_&4&&Kb(d);break;case 21:break;default:Lr(p,d),Zr(d)}}function Zr(d){var p=d.flags;if(p&2){try{e:{for(var j=d.return;j!==null;){if(Wb(j)){var _=j;break e}j=j.return}throw Error(t(160))}switch(_.tag){case 5:var T=_.stateNode;_.flags&32&&(gt(T,""),_.flags&=-33);var P=Gb(d);Wf(d,P,T);break;case 3:case 4:var $=_.stateNode.containerInfo,Z=Gb(d);$f(d,Z,$);break;default:throw Error(t(161))}}catch(ne){Ht(d,d.return,ne)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function cR(d,p,j){Ee=d,Qb(d)}function Qb(d,p,j){for(var _=(d.mode&1)!==0;Ee!==null;){var T=Ee,P=T.child;if(T.tag===22&&_){var $=T.memoizedState!==null||fd;if(!$){var Z=T.alternate,ne=Z!==null&&Z.memoizedState!==null||Rs;Z=fd;var fe=Rs;if(fd=$,(Rs=ne)&&!fe)for(Ee=T;Ee!==null;)$=Ee,ne=$.child,$.tag===22&&$.memoizedState!==null?ej(T):ne!==null?(ne.return=$,Ee=ne):ej(T);for(;P!==null;)Ee=P,Qb(P),P=P.sibling;Ee=T,fd=Z,Rs=fe}Jb(d)}else(T.subtreeFlags&8772)!==0&&P!==null?(P.return=T,Ee=P):Jb(d)}}function Jb(d){for(;Ee!==null;){var p=Ee;if((p.flags&8772)!==0){var j=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Rs||md(5,p);break;case 1:var _=p.stateNode;if(p.flags&4&&!Rs)if(j===null)_.componentDidMount();else{var T=p.elementType===p.type?j.memoizedProps:Mr(p.type,j.memoizedProps);_.componentDidUpdate(T,j.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var P=p.updateQueue;P!==null&&Zv(p,P,_);break;case 3:var $=p.updateQueue;if($!==null){if(j=null,p.child!==null)switch(p.child.tag){case 5:j=p.child.stateNode;break;case 1:j=p.child.stateNode}Zv(p,$,j)}break;case 5:var Z=p.stateNode;if(j===null&&p.flags&4){j=Z;var ne=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&j.focus();break;case"img":ne.src&&(j.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var fe=p.alternate;if(fe!==null){var ye=fe.memoizedState;if(ye!==null){var be=ye.dehydrated;be!==null&&Uo(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Rs||p.flags&512&&qf(p)}catch(xe){Ht(p,p.return,xe)}}if(p===d){Ee=null;break}if(j=p.sibling,j!==null){j.return=p.return,Ee=j;break}Ee=p.return}}function Zb(d){for(;Ee!==null;){var p=Ee;if(p===d){Ee=null;break}var j=p.sibling;if(j!==null){j.return=p.return,Ee=j;break}Ee=p.return}}function ej(d){for(;Ee!==null;){var p=Ee;try{switch(p.tag){case 0:case 11:case 15:var j=p.return;try{md(4,p)}catch(ne){Ht(p,j,ne)}break;case 1:var _=p.stateNode;if(typeof _.componentDidMount=="function"){var T=p.return;try{_.componentDidMount()}catch(ne){Ht(p,T,ne)}}var P=p.return;try{qf(p)}catch(ne){Ht(p,P,ne)}break;case 5:var $=p.return;try{qf(p)}catch(ne){Ht(p,$,ne)}}}catch(ne){Ht(p,p.return,ne)}if(p===d){Ee=null;break}var Z=p.sibling;if(Z!==null){Z.return=p.return,Ee=Z;break}Ee=p.return}}var dR=Math.ceil,pd=N.ReactCurrentDispatcher,Gf=N.ReactCurrentOwner,yr=N.ReactCurrentBatchConfig,lt=0,cs=null,Zt=null,bs=0,lr=0,Fa=Qn(0),is=0,dl=null,Ui=0,gd=0,Yf=0,ul=null,Ks=null,Kf=0,za=1/0,Sn=null,xd=!1,Xf=null,ri=null,yd=!1,ni=null,vd=0,hl=0,Qf=null,bd=-1,jd=0;function Os(){return(lt&6)!==0?Wt():bd!==-1?bd:bd=Wt()}function ii(d){return(d.mode&1)===0?1:(lt&2)!==0&&bs!==0?bs&-bs:GT.transition!==null?(jd===0&&(jd=Gy()),jd):(d=pt,d!==0||(d=window.event,d=d===void 0?16:sv(d.type)),d)}function Ir(d,p,j,_){if(50<hl)throw hl=0,Qf=null,Error(t(185));Lo(d,j,_),((lt&2)===0||d!==cs)&&(d===cs&&((lt&2)===0&&(gd|=j),is===4&&ai(d,bs)),Xs(d,_),j===1&&lt===0&&(p.mode&1)===0&&(za=Wt()+500,Kc&&Zn()))}function Xs(d,p){var j=d.callbackNode;GC(d,p);var _=Tc(d,d===cs?bs:0);if(_===0)j!==null&&qy(j),d.callbackNode=null,d.callbackPriority=0;else if(p=_&-_,d.callbackPriority!==p){if(j!=null&&qy(j),p===1)d.tag===0?WT(sj.bind(null,d)):Uv(sj.bind(null,d)),HT(function(){(lt&6)===0&&Zn()}),j=null;else{switch(Yy(_)){case 1:j=Ch;break;case 4:j=$y;break;case 16:j=Sc;break;case 536870912:j=Wy;break;default:j=Sc}j=dj(j,tj.bind(null,d))}d.callbackPriority=p,d.callbackNode=j}}function tj(d,p){if(bd=-1,jd=0,(lt&6)!==0)throw Error(t(327));var j=d.callbackNode;if(Ua()&&d.callbackNode!==j)return null;var _=Tc(d,d===cs?bs:0);if(_===0)return null;if((_&30)!==0||(_&d.expiredLanes)!==0||p)p=wd(d,_);else{p=_;var T=lt;lt|=2;var P=nj();(cs!==d||bs!==p)&&(Sn=null,za=Wt()+500,Vi(d,p));do try{fR();break}catch(Z){rj(d,Z)}while(!0);pf(),pd.current=P,lt=T,Zt!==null?p=0:(cs=null,bs=0,p=is)}if(p!==0){if(p===2&&(T=Th(d),T!==0&&(_=T,p=Jf(d,T))),p===1)throw j=dl,Vi(d,0),ai(d,_),Xs(d,Wt()),j;if(p===6)ai(d,_);else{if(T=d.current.alternate,(_&30)===0&&!uR(T)&&(p=wd(d,_),p===2&&(P=Th(d),P!==0&&(_=P,p=Jf(d,P))),p===1))throw j=dl,Vi(d,0),ai(d,_),Xs(d,Wt()),j;switch(d.finishedWork=T,d.finishedLanes=_,p){case 0:case 1:throw Error(t(345));case 2:qi(d,Ks,Sn);break;case 3:if(ai(d,_),(_&130023424)===_&&(p=Kf+500-Wt(),10<p)){if(Tc(d,0)!==0)break;if(T=d.suspendedLanes,(T&_)!==_){Os(),d.pingedLanes|=d.suspendedLanes&T;break}d.timeoutHandle=rf(qi.bind(null,d,Ks,Sn),p);break}qi(d,Ks,Sn);break;case 4:if(ai(d,_),(_&4194240)===_)break;for(p=d.eventTimes,T=-1;0<_;){var $=31-Rr(_);P=1<<$,$=p[$],$>T&&(T=$),_&=~P}if(_=T,_=Wt()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*dR(_/1960))-_,10<_){d.timeoutHandle=rf(qi.bind(null,d,Ks,Sn),_);break}qi(d,Ks,Sn);break;case 5:qi(d,Ks,Sn);break;default:throw Error(t(329))}}}return Xs(d,Wt()),d.callbackNode===j?tj.bind(null,d):null}function Jf(d,p){var j=ul;return d.current.memoizedState.isDehydrated&&(Vi(d,p).flags|=256),d=wd(d,p),d!==2&&(p=Ks,Ks=j,p!==null&&Zf(p)),d}function Zf(d){Ks===null?Ks=d:Ks.push.apply(Ks,d)}function uR(d){for(var p=d;;){if(p.flags&16384){var j=p.updateQueue;if(j!==null&&(j=j.stores,j!==null))for(var _=0;_<j.length;_++){var T=j[_],P=T.getSnapshot;T=T.value;try{if(!Dr(P(),T))return!1}catch{return!1}}}if(j=p.child,p.subtreeFlags&16384&&j!==null)j.return=p,p=j;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function ai(d,p){for(p&=~Yf,p&=~gd,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var j=31-Rr(p),_=1<<j;d[j]=-1,p&=~_}}function sj(d){if((lt&6)!==0)throw Error(t(327));Ua();var p=Tc(d,0);if((p&1)===0)return Xs(d,Wt()),null;var j=wd(d,p);if(d.tag!==0&&j===2){var _=Th(d);_!==0&&(p=_,j=Jf(d,_))}if(j===1)throw j=dl,Vi(d,0),ai(d,p),Xs(d,Wt()),j;if(j===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,qi(d,Ks,Sn),Xs(d,Wt()),null}function em(d,p){var j=lt;lt|=1;try{return d(p)}finally{lt=j,lt===0&&(za=Wt()+500,Kc&&Zn())}}function Hi(d){ni!==null&&ni.tag===0&&(lt&6)===0&&Ua();var p=lt;lt|=1;var j=yr.transition,_=pt;try{if(yr.transition=null,pt=1,d)return d()}finally{pt=_,yr.transition=j,lt=p,(lt&6)===0&&Zn()}}function tm(){lr=Fa.current,At(Fa)}function Vi(d,p){d.finishedWork=null,d.finishedLanes=0;var j=d.timeoutHandle;if(j!==-1&&(d.timeoutHandle=-1,UT(j)),Zt!==null)for(j=Zt.return;j!==null;){var _=j;switch(df(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Gc();break;case 3:La(),At(Ws),At(As),Nf();break;case 5:jf(_);break;case 4:La();break;case 13:At(Ot);break;case 19:At(Ot);break;case 10:gf(_.type._context);break;case 22:case 23:tm()}j=j.return}if(cs=d,Zt=d=oi(d.current,null),bs=lr=p,is=0,dl=null,Yf=gd=Ui=0,Ks=ul=null,Bi!==null){for(p=0;p<Bi.length;p++)if(j=Bi[p],_=j.interleaved,_!==null){j.interleaved=null;var T=_.next,P=j.pending;if(P!==null){var $=P.next;P.next=T,_.next=$}j.pending=_}Bi=null}return d}function rj(d,p){do{var j=Zt;try{if(pf(),id.current=cd,ad){for(var _=Lt.memoizedState;_!==null;){var T=_.queue;T!==null&&(T.pending=null),_=_.next}ad=!1}if(zi=0,ls=ns=Lt=null,nl=!1,il=0,Gf.current=null,j===null||j.return===null){is=1,dl=p,Zt=null;break}e:{var P=d,$=j.return,Z=j,ne=p;if(p=bs,Z.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var fe=ne,ye=Z,be=ye.tag;if((ye.mode&1)===0&&(be===0||be===11||be===15)){var xe=ye.alternate;xe?(ye.updateQueue=xe.updateQueue,ye.memoizedState=xe.memoizedState,ye.lanes=xe.lanes):(ye.updateQueue=null,ye.memoizedState=null)}var ke=Ab($);if(ke!==null){ke.flags&=-257,Cb(ke,$,Z,P,p),ke.mode&1&&_b(P,fe,p),p=ke,ne=fe;var Te=p.updateQueue;if(Te===null){var Re=new Set;Re.add(ne),p.updateQueue=Re}else Te.add(ne);break e}else{if((p&1)===0){_b(P,fe,p),sm();break e}ne=Error(t(426))}}else if(Tt&&Z.mode&1){var Gt=Ab($);if(Gt!==null){(Gt.flags&65536)===0&&(Gt.flags|=256),Cb(Gt,$,Z,P,p),ff(Ia(ne,Z));break e}}P=ne=Ia(ne,Z),is!==4&&(is=2),ul===null?ul=[P]:ul.push(P),P=$;do{switch(P.tag){case 3:P.flags|=65536,p&=-p,P.lanes|=p;var le=Eb(P,ne,p);Jv(P,le);break e;case 1:Z=ne;var ie=P.type,de=P.stateNode;if((P.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(ri===null||!ri.has(de)))){P.flags|=65536,p&=-p,P.lanes|=p;var Ne=Sb(P,Z,p);Jv(P,Ne);break e}}P=P.return}while(P!==null)}aj(j)}catch(De){p=De,Zt===j&&j!==null&&(Zt=j=j.return);continue}break}while(!0)}function nj(){var d=pd.current;return pd.current=cd,d===null?cd:d}function sm(){(is===0||is===3||is===2)&&(is=4),cs===null||(Ui&268435455)===0&&(gd&268435455)===0||ai(cs,bs)}function wd(d,p){var j=lt;lt|=2;var _=nj();(cs!==d||bs!==p)&&(Sn=null,Vi(d,p));do try{hR();break}catch(T){rj(d,T)}while(!0);if(pf(),lt=j,pd.current=_,Zt!==null)throw Error(t(261));return cs=null,bs=0,is}function hR(){for(;Zt!==null;)ij(Zt)}function fR(){for(;Zt!==null&&!BC();)ij(Zt)}function ij(d){var p=cj(d.alternate,d,lr);d.memoizedProps=d.pendingProps,p===null?aj(d):Zt=p,Gf.current=null}function aj(d){var p=d;do{var j=p.alternate;if(d=p.return,(p.flags&32768)===0){if(j=iR(j,p,lr),j!==null){Zt=j;return}}else{if(j=aR(j,p),j!==null){j.flags&=32767,Zt=j;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{is=6,Zt=null;return}}if(p=p.sibling,p!==null){Zt=p;return}Zt=p=d}while(p!==null);is===0&&(is=5)}function qi(d,p,j){var _=pt,T=yr.transition;try{yr.transition=null,pt=1,mR(d,p,j,_)}finally{yr.transition=T,pt=_}return null}function mR(d,p,j,_){do Ua();while(ni!==null);if((lt&6)!==0)throw Error(t(327));j=d.finishedWork;var T=d.finishedLanes;if(j===null)return null;if(d.finishedWork=null,d.finishedLanes=0,j===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var P=j.lanes|j.childLanes;if(YC(d,P),d===cs&&(Zt=cs=null,bs=0),(j.subtreeFlags&2064)===0&&(j.flags&2064)===0||yd||(yd=!0,dj(Sc,function(){return Ua(),null})),P=(j.flags&15990)!==0,(j.subtreeFlags&15990)!==0||P){P=yr.transition,yr.transition=null;var $=pt;pt=1;var Z=lt;lt|=4,Gf.current=null,lR(d,j),Xb(j,d),MT(tf),Pc=!!ef,tf=ef=null,d.current=j,cR(j),FC(),lt=Z,pt=$,yr.transition=P}else d.current=j;if(yd&&(yd=!1,ni=d,vd=T),P=d.pendingLanes,P===0&&(ri=null),HC(j.stateNode),Xs(d,Wt()),p!==null)for(_=d.onRecoverableError,j=0;j<p.length;j++)T=p[j],_(T.value,{componentStack:T.stack,digest:T.digest});if(xd)throw xd=!1,d=Xf,Xf=null,d;return(vd&1)!==0&&d.tag!==0&&Ua(),P=d.pendingLanes,(P&1)!==0?d===Qf?hl++:(hl=0,Qf=d):hl=0,Zn(),null}function Ua(){if(ni!==null){var d=Yy(vd),p=yr.transition,j=pt;try{if(yr.transition=null,pt=16>d?16:d,ni===null)var _=!1;else{if(d=ni,ni=null,vd=0,(lt&6)!==0)throw Error(t(331));var T=lt;for(lt|=4,Ee=d.current;Ee!==null;){var P=Ee,$=P.child;if((Ee.flags&16)!==0){var Z=P.deletions;if(Z!==null){for(var ne=0;ne<Z.length;ne++){var fe=Z[ne];for(Ee=fe;Ee!==null;){var ye=Ee;switch(ye.tag){case 0:case 11:case 15:cl(8,ye,P)}var be=ye.child;if(be!==null)be.return=ye,Ee=be;else for(;Ee!==null;){ye=Ee;var xe=ye.sibling,ke=ye.return;if($b(ye),ye===fe){Ee=null;break}if(xe!==null){xe.return=ke,Ee=xe;break}Ee=ke}}}var Te=P.alternate;if(Te!==null){var Re=Te.child;if(Re!==null){Te.child=null;do{var Gt=Re.sibling;Re.sibling=null,Re=Gt}while(Re!==null)}}Ee=P}}if((P.subtreeFlags&2064)!==0&&$!==null)$.return=P,Ee=$;else e:for(;Ee!==null;){if(P=Ee,(P.flags&2048)!==0)switch(P.tag){case 0:case 11:case 15:cl(9,P,P.return)}var le=P.sibling;if(le!==null){le.return=P.return,Ee=le;break e}Ee=P.return}}var ie=d.current;for(Ee=ie;Ee!==null;){$=Ee;var de=$.child;if(($.subtreeFlags&2064)!==0&&de!==null)de.return=$,Ee=de;else e:for($=ie;Ee!==null;){if(Z=Ee,(Z.flags&2048)!==0)try{switch(Z.tag){case 0:case 11:case 15:md(9,Z)}}catch(De){Ht(Z,Z.return,De)}if(Z===$){Ee=null;break e}var Ne=Z.sibling;if(Ne!==null){Ne.return=Z.return,Ee=Ne;break e}Ee=Z.return}}if(lt=T,Zn(),Kr&&typeof Kr.onPostCommitFiberRoot=="function")try{Kr.onPostCommitFiberRoot(_c,d)}catch{}_=!0}return _}finally{pt=j,yr.transition=p}}return!1}function oj(d,p,j){p=Ia(j,p),p=Eb(d,p,1),d=ti(d,p,1),p=Os(),d!==null&&(Lo(d,1,p),Xs(d,p))}function Ht(d,p,j){if(d.tag===3)oj(d,d,j);else for(;p!==null;){if(p.tag===3){oj(p,d,j);break}else if(p.tag===1){var _=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(ri===null||!ri.has(_))){d=Ia(j,d),d=Sb(p,d,1),p=ti(p,d,1),d=Os(),p!==null&&(Lo(p,1,d),Xs(p,d));break}}p=p.return}}function pR(d,p,j){var _=d.pingCache;_!==null&&_.delete(p),p=Os(),d.pingedLanes|=d.suspendedLanes&j,cs===d&&(bs&j)===j&&(is===4||is===3&&(bs&130023424)===bs&&500>Wt()-Kf?Vi(d,0):Yf|=j),Xs(d,p)}function lj(d,p){p===0&&((d.mode&1)===0?p=1:(p=Cc,Cc<<=1,(Cc&130023424)===0&&(Cc=4194304)));var j=Os();d=Nn(d,p),d!==null&&(Lo(d,p,j),Xs(d,j))}function gR(d){var p=d.memoizedState,j=0;p!==null&&(j=p.retryLane),lj(d,j)}function xR(d,p){var j=0;switch(d.tag){case 13:var _=d.stateNode,T=d.memoizedState;T!==null&&(j=T.retryLane);break;case 19:_=d.stateNode;break;default:throw Error(t(314))}_!==null&&_.delete(p),lj(d,j)}var cj;cj=function(d,p,j){if(d!==null)if(d.memoizedProps!==p.pendingProps||Ws.current)Ys=!0;else{if((d.lanes&j)===0&&(p.flags&128)===0)return Ys=!1,nR(d,p,j);Ys=(d.flags&131072)!==0}else Ys=!1,Tt&&(p.flags&1048576)!==0&&Hv(p,Qc,p.index);switch(p.lanes=0,p.tag){case 2:var _=p.type;hd(d,p),d=p.pendingProps;var T=Ca(p,As.current);Oa(p,j),T=Sf(null,p,_,d,T,j);var P=_f();return p.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Gs(_)?(P=!0,Yc(p)):P=!1,p.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,vf(p),T.updater=dd,p.stateNode=T,T._reactInternals=p,Pf(p,_,d,j),p=If(null,p,_,!0,P,j)):(p.tag=0,Tt&&P&&cf(p),Ms(null,p,T,j),p=p.child),p;case 16:_=p.elementType;e:{switch(hd(d,p),d=p.pendingProps,T=_._init,_=T(_._payload),p.type=_,T=p.tag=vR(_),d=Mr(_,d),T){case 0:p=Lf(null,p,_,d,j);break e;case 1:p=Ob(null,p,_,d,j);break e;case 11:p=Tb(null,p,_,d,j);break e;case 14:p=Rb(null,p,_,Mr(_.type,d),j);break e}throw Error(t(306,_,""))}return p;case 0:return _=p.type,T=p.pendingProps,T=p.elementType===_?T:Mr(_,T),Lf(d,p,_,T,j);case 1:return _=p.type,T=p.pendingProps,T=p.elementType===_?T:Mr(_,T),Ob(d,p,_,T,j);case 3:e:{if(Lb(p),d===null)throw Error(t(387));_=p.pendingProps,P=p.memoizedState,T=P.element,Qv(d,p),rd(p,_,null,j);var $=p.memoizedState;if(_=$.element,P.isDehydrated)if(P={element:_,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},p.updateQueue.baseState=P,p.memoizedState=P,p.flags&256){T=Ia(Error(t(423)),p),p=Ib(d,p,_,j,T);break e}else if(_!==T){T=Ia(Error(t(424)),p),p=Ib(d,p,_,j,T);break e}else for(or=Xn(p.stateNode.containerInfo.firstChild),ar=p,Tt=!0,Pr=null,j=Kv(p,null,_,j),p.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(Da(),_===T){p=En(d,p,j);break e}Ms(d,p,_,j)}p=p.child}return p;case 5:return eb(p),d===null&&hf(p),_=p.type,T=p.pendingProps,P=d!==null?d.memoizedProps:null,$=T.children,sf(_,T)?$=null:P!==null&&sf(_,P)&&(p.flags|=32),Mb(d,p),Ms(d,p,$,j),p.child;case 6:return d===null&&hf(p),null;case 13:return Bb(d,p,j);case 4:return bf(p,p.stateNode.containerInfo),_=p.pendingProps,d===null?p.child=Pa(p,null,_,j):Ms(d,p,_,j),p.child;case 11:return _=p.type,T=p.pendingProps,T=p.elementType===_?T:Mr(_,T),Tb(d,p,_,T,j);case 7:return Ms(d,p,p.pendingProps,j),p.child;case 8:return Ms(d,p,p.pendingProps.children,j),p.child;case 12:return Ms(d,p,p.pendingProps.children,j),p.child;case 10:e:{if(_=p.type._context,T=p.pendingProps,P=p.memoizedProps,$=T.value,wt(ed,_._currentValue),_._currentValue=$,P!==null)if(Dr(P.value,$)){if(P.children===T.children&&!Ws.current){p=En(d,p,j);break e}}else for(P=p.child,P!==null&&(P.return=p);P!==null;){var Z=P.dependencies;if(Z!==null){$=P.child;for(var ne=Z.firstContext;ne!==null;){if(ne.context===_){if(P.tag===1){ne=kn(-1,j&-j),ne.tag=2;var fe=P.updateQueue;if(fe!==null){fe=fe.shared;var ye=fe.pending;ye===null?ne.next=ne:(ne.next=ye.next,ye.next=ne),fe.pending=ne}}P.lanes|=j,ne=P.alternate,ne!==null&&(ne.lanes|=j),xf(P.return,j,p),Z.lanes|=j;break}ne=ne.next}}else if(P.tag===10)$=P.type===p.type?null:P.child;else if(P.tag===18){if($=P.return,$===null)throw Error(t(341));$.lanes|=j,Z=$.alternate,Z!==null&&(Z.lanes|=j),xf($,j,p),$=P.sibling}else $=P.child;if($!==null)$.return=P;else for($=P;$!==null;){if($===p){$=null;break}if(P=$.sibling,P!==null){P.return=$.return,$=P;break}$=$.return}P=$}Ms(d,p,T.children,j),p=p.child}return p;case 9:return T=p.type,_=p.pendingProps.children,Oa(p,j),T=gr(T),_=_(T),p.flags|=1,Ms(d,p,_,j),p.child;case 14:return _=p.type,T=Mr(_,p.pendingProps),T=Mr(_.type,T),Rb(d,p,_,T,j);case 15:return Db(d,p,p.type,p.pendingProps,j);case 17:return _=p.type,T=p.pendingProps,T=p.elementType===_?T:Mr(_,T),hd(d,p),p.tag=1,Gs(_)?(d=!0,Yc(p)):d=!1,Oa(p,j),Nb(p,_,T),Pf(p,_,T,j),If(null,p,_,!0,d,j);case 19:return zb(d,p,j);case 22:return Pb(d,p,j)}throw Error(t(156,p.tag))};function dj(d,p){return Vy(d,p)}function yR(d,p,j,_){this.tag=d,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vr(d,p,j,_){return new yR(d,p,j,_)}function rm(d){return d=d.prototype,!(!d||!d.isReactComponent)}function vR(d){if(typeof d=="function")return rm(d)?1:0;if(d!=null){if(d=d.$$typeof,d===D)return 11;if(d===B)return 14}return 2}function oi(d,p){var j=d.alternate;return j===null?(j=vr(d.tag,p,d.key,d.mode),j.elementType=d.elementType,j.type=d.type,j.stateNode=d.stateNode,j.alternate=d,d.alternate=j):(j.pendingProps=p,j.type=d.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=d.flags&14680064,j.childLanes=d.childLanes,j.lanes=d.lanes,j.child=d.child,j.memoizedProps=d.memoizedProps,j.memoizedState=d.memoizedState,j.updateQueue=d.updateQueue,p=d.dependencies,j.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},j.sibling=d.sibling,j.index=d.index,j.ref=d.ref,j}function Nd(d,p,j,_,T,P){var $=2;if(_=d,typeof d=="function")rm(d)&&($=1);else if(typeof d=="string")$=5;else e:switch(d){case A:return $i(j.children,T,P,p);case C:$=8,T|=8;break;case I:return d=vr(12,j,p,T|2),d.elementType=I,d.lanes=P,d;case F:return d=vr(13,j,p,T),d.elementType=F,d.lanes=P,d;case q:return d=vr(19,j,p,T),d.elementType=q,d.lanes=P,d;case G:return kd(j,T,P,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case L:$=10;break e;case M:$=9;break e;case D:$=11;break e;case B:$=14;break e;case z:$=16,_=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return p=vr($,j,p,T),p.elementType=d,p.type=_,p.lanes=P,p}function $i(d,p,j,_){return d=vr(7,d,_,p),d.lanes=j,d}function kd(d,p,j,_){return d=vr(22,d,_,p),d.elementType=G,d.lanes=j,d.stateNode={isHidden:!1},d}function nm(d,p,j){return d=vr(6,d,null,p),d.lanes=j,d}function im(d,p,j){return p=vr(4,d.children!==null?d.children:[],d.key,p),p.lanes=j,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function bR(d,p,j,_,T){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rh(0),this.expirationTimes=Rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rh(0),this.identifierPrefix=_,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function am(d,p,j,_,T,P,$,Z,ne){return d=new bR(d,p,j,Z,ne),p===1?(p=1,P===!0&&(p|=8)):p=0,P=vr(3,null,null,p),d.current=P,P.stateNode=d,P.memoizedState={element:_,isDehydrated:j,cache:null,transitions:null,pendingSuspenseBoundaries:null},vf(P),d}function jR(d,p,j){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:S,key:_==null?null:""+_,children:d,containerInfo:p,implementation:j}}function uj(d){if(!d)return Jn;d=d._reactInternals;e:{if(Pi(d)!==d||d.tag!==1)throw Error(t(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Gs(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(d.tag===1){var j=d.type;if(Gs(j))return Fv(d,j,p)}return p}function hj(d,p,j,_,T,P,$,Z,ne){return d=am(j,_,!0,d,T,P,$,Z,ne),d.context=uj(null),j=d.current,_=Os(),T=ii(j),P=kn(_,T),P.callback=p??null,ti(j,P,T),d.current.lanes=T,Lo(d,T,_),Xs(d,_),d}function Ed(d,p,j,_){var T=p.current,P=Os(),$=ii(T);return j=uj(j),p.context===null?p.context=j:p.pendingContext=j,p=kn(P,$),p.payload={element:d},_=_===void 0?null:_,_!==null&&(p.callback=_),d=ti(T,p,$),d!==null&&(Ir(d,T,$,P),sd(d,T,$)),$}function Sd(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function fj(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var j=d.retryLane;d.retryLane=j!==0&&j<p?j:p}}function om(d,p){fj(d,p),(d=d.alternate)&&fj(d,p)}function wR(){return null}var mj=typeof reportError=="function"?reportError:function(d){console.error(d)};function lm(d){this._internalRoot=d}_d.prototype.render=lm.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(t(409));Ed(d,p,null,null)},_d.prototype.unmount=lm.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Hi(function(){Ed(null,d,null,null)}),p[vn]=null}};function _d(d){this._internalRoot=d}_d.prototype.unstable_scheduleHydration=function(d){if(d){var p=Qy();d={blockedOn:null,target:d,priority:p};for(var j=0;j<Gn.length&&p!==0&&p<Gn[j].priority;j++);Gn.splice(j,0,d),j===0&&ev(d)}};function cm(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Ad(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function pj(){}function NR(d,p,j,_,T){if(T){if(typeof _=="function"){var P=_;_=function(){var fe=Sd($);P.call(fe)}}var $=hj(p,_,d,0,null,!1,!1,"",pj);return d._reactRootContainer=$,d[vn]=$.current,Xo(d.nodeType===8?d.parentNode:d),Hi(),$}for(;T=d.lastChild;)d.removeChild(T);if(typeof _=="function"){var Z=_;_=function(){var fe=Sd(ne);Z.call(fe)}}var ne=am(d,0,!1,null,null,!1,!1,"",pj);return d._reactRootContainer=ne,d[vn]=ne.current,Xo(d.nodeType===8?d.parentNode:d),Hi(function(){Ed(p,ne,j,_)}),ne}function Cd(d,p,j,_,T){var P=j._reactRootContainer;if(P){var $=P;if(typeof T=="function"){var Z=T;T=function(){var ne=Sd($);Z.call(ne)}}Ed(p,$,d,T)}else $=NR(j,p,d,T,_);return Sd($)}Ky=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var j=Oo(p.pendingLanes);j!==0&&(Dh(p,j|1),Xs(p,Wt()),(lt&6)===0&&(za=Wt()+500,Zn()))}break;case 13:Hi(function(){var _=Nn(d,1);if(_!==null){var T=Os();Ir(_,d,1,T)}}),om(d,1)}},Ph=function(d){if(d.tag===13){var p=Nn(d,134217728);if(p!==null){var j=Os();Ir(p,d,134217728,j)}om(d,134217728)}},Xy=function(d){if(d.tag===13){var p=ii(d),j=Nn(d,p);if(j!==null){var _=Os();Ir(j,d,p,_)}om(d,p)}},Qy=function(){return pt},Jy=function(d,p){var j=pt;try{return pt=d,p()}finally{pt=j}},Mo=function(d,p,j){switch(p){case"input":if(at(d,j),p=j.name,j.type==="radio"&&p!=null){for(j=d;j.parentNode;)j=j.parentNode;for(j=j.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<j.length;p++){var _=j[p];if(_!==d&&_.form===d.form){var T=Wc(_);if(!T)throw Error(t(90));_e(_),at(_,T)}}}break;case"textarea":We(d,j);break;case"select":p=j.value,p!=null&&ve(d,!!j.multiple,p,!1)}},Nc=em,kc=Hi;var kR={usingClientEntryPoint:!1,Events:[Zo,_a,Wc,jc,wc,em]},fl={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ER={bundleType:fl.bundleType,version:fl.version,rendererPackageName:fl.rendererPackageName,rendererConfig:fl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Uy(d),d===null?null:d.stateNode},findFiberByHostInstance:fl.findFiberByHostInstance||wR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{_c=Td.inject(ER),Kr=Td}catch{}}return Js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kR,Js.createPortal=function(d,p){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cm(p))throw Error(t(200));return jR(d,p,null,j)},Js.createRoot=function(d,p){if(!cm(d))throw Error(t(299));var j=!1,_="",T=mj;return p!=null&&(p.unstable_strictMode===!0&&(j=!0),p.identifierPrefix!==void 0&&(_=p.identifierPrefix),p.onRecoverableError!==void 0&&(T=p.onRecoverableError)),p=am(d,1,!1,null,null,j,!1,_,T),d[vn]=p.current,Xo(d.nodeType===8?d.parentNode:d),new lm(p)},Js.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=Uy(p),d=d===null?null:d.stateNode,d},Js.flushSync=function(d){return Hi(d)},Js.hydrate=function(d,p,j){if(!Ad(p))throw Error(t(200));return Cd(null,d,p,!0,j)},Js.hydrateRoot=function(d,p,j){if(!cm(d))throw Error(t(405));var _=j!=null&&j.hydratedSources||null,T=!1,P="",$=mj;if(j!=null&&(j.unstable_strictMode===!0&&(T=!0),j.identifierPrefix!==void 0&&(P=j.identifierPrefix),j.onRecoverableError!==void 0&&($=j.onRecoverableError)),p=hj(p,null,d,1,j??null,T,!1,P,$),d[vn]=p.current,Xo(d),_)for(d=0;d<_.length;d++)j=_[d],T=j._getVersion,T=T(j._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[j,T]:p.mutableSourceEagerHydrationData.push(j,T);return new _d(p)},Js.render=function(d,p,j){if(!Ad(p))throw Error(t(200));return Cd(null,d,p,!1,j)},Js.unmountComponentAtNode=function(d){if(!Ad(d))throw Error(t(40));return d._reactRootContainer?(Hi(function(){Cd(null,null,d,!1,function(){d._reactRootContainer=null,d[vn]=null})}),!0):!1},Js.unstable_batchedUpdates=em,Js.unstable_renderSubtreeIntoContainer=function(d,p,j,_){if(!Ad(j))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return Cd(d,p,j,!1,_)},Js.version="18.3.1-next-f1338f8080-20240426",Js}var Ej;function Xx(){if(Ej)return fm.exports;Ej=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),fm.exports=MR(),fm.exports}var Sj;function OR(){if(Sj)return Dd;Sj=1;var r=Xx();return Dd.createRoot=r.createRoot,Dd.hydrateRoot=r.hydrateRoot,Dd}var LR=OR();const IR=Wu(LR);var pu=Xx();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Il(){return Il=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Il.apply(this,arguments)}var fi;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(fi||(fi={}));const _j="popstate";function BR(r){r===void 0&&(r={});function e(n,i){let{pathname:a,search:o,hash:l}=n.location;return Hg("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:gu(i)}return zR(e,t,null,r)}function Xt(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Lk(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FR(){return Math.random().toString(36).substr(2,8)}function Aj(r,e){return{usr:r.state,key:r.key,idx:e}}function Hg(r,e,t,n){return t===void 0&&(t=null),Il({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?wo(e):e,{state:t,key:e&&e.key||n||FR()})}function gu(r){let{pathname:e="/",search:t="",hash:n=""}=r;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function wo(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}function zR(r,e,t,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,l=fi.Pop,u=null,h=c();h==null&&(h=0,o.replaceState(Il({},o.state,{idx:h}),""));function c(){return(o.state||{idx:null}).idx}function f(){l=fi.Pop;let x=c(),b=x==null?null:x-h;h=x,u&&u({action:l,location:y.location,delta:b})}function m(x,b){l=fi.Push;let w=Hg(y.location,x,b);h=c()+1;let k=Aj(w,h),N=y.createHref(w);try{o.pushState(k,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(N)}a&&u&&u({action:l,location:y.location,delta:1})}function g(x,b){l=fi.Replace;let w=Hg(y.location,x,b);h=c();let k=Aj(w,h),N=y.createHref(w);o.replaceState(k,"",N),a&&u&&u({action:l,location:y.location,delta:0})}function v(x){let b=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof x=="string"?x:gu(x);return w=w.replace(/ $/,"%20"),Xt(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let y={get action(){return l},get location(){return r(i,o)},listen(x){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(_j,f),u=x,()=>{i.removeEventListener(_j,f),u=null}},createHref(x){return e(i,x)},createURL:v,encodeLocation(x){let b=v(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:g,go(x){return o.go(x)}};return y}var Cj;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Cj||(Cj={}));function UR(r,e,t){return t===void 0&&(t="/"),HR(r,e,t)}function HR(r,e,t,n){let i=typeof e=="string"?wo(e):e,a=Qx(i.pathname||"/",t);if(a==null)return null;let o=Ik(r);VR(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=tD(a);l=JR(o[u],h)}return l}function Ik(r,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let i=(a,o,l)=>{let u={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(Xt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let h=vi([n,u.relativePath]),c=t.concat(u);a.children&&a.children.length>0&&(Xt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Ik(a.children,e,c,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:XR(h,a.index),routesMeta:c})};return r.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let u of Bk(a.path))i(a,o,u)}),e}function Bk(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=Bk(n.join("/")),l=[];return l.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&l.push(...o),l.map(u=>r.startsWith("/")&&u===""?"/":u)}function VR(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:QR(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const qR=/^:[\w-]+$/,$R=3,WR=2,GR=1,YR=10,KR=-2,Tj=r=>r==="*";function XR(r,e){let t=r.split("/"),n=t.length;return t.some(Tj)&&(n+=KR),e&&(n+=WR),t.filter(i=>!Tj(i)).reduce((i,a)=>i+(qR.test(a)?$R:a===""?GR:YR),n)}function QR(r,e){return r.length===e.length&&r.slice(0,-1).every((n,i)=>n===e[i])?r[r.length-1]-e[e.length-1]:0}function JR(r,e,t){let{routesMeta:n}=r,i={},a="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],h=l===n.length-1,c=a==="/"?e:e.slice(a.length)||"/",f=ZR({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},c),m=u.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:vi([a,f.pathname]),pathnameBase:iD(vi([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=vi([a,f.pathnameBase]))}return o}function ZR(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=eD(r.path,r.caseSensitive,r.end),i=e.match(t);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((h,c,f)=>{let{paramName:m,isOptional:g}=c;if(m==="*"){let y=l[f]||"";o=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const v=l[f];return g&&!v?h[m]=void 0:h[m]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:o,pattern:r}}function eD(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Lk(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let n=[],i="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),i+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":r!==""&&r!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function tD(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Lk(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function Qx(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function sD(r,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:i=""}=typeof r=="string"?wo(r):r;return{pathname:t?t.startsWith("/")?t:rD(t,e):e,search:aD(n),hash:oD(i)}}function rD(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function gm(r,e,t,n){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nD(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jx(r,e){let t=nD(r);return e?t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function Zx(r,e,t,n){n===void 0&&(n=!1);let i;typeof r=="string"?i=wo(r):(i=Il({},r),Xt(!i.pathname||!i.pathname.includes("?"),gm("?","pathname","search",i)),Xt(!i.pathname||!i.pathname.includes("#"),gm("#","pathname","hash",i)),Xt(!i.search||!i.search.includes("#"),gm("#","search","hash",i)));let a=r===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=t;else{let f=e.length-1;if(!n&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}l=f>=0?e[f]:"/"}let u=sD(i,l),h=o&&o!=="/"&&o.endsWith("/"),c=(a||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(h||c)&&(u.pathname+="/"),u}const vi=r=>r.join("/").replace(/\/\/+/g,"/"),iD=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),aD=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,oD=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function lD(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const Fk=["post","put","patch","delete"];new Set(Fk);const cD=["get",...Fk];new Set(cD);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bl(){return Bl=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Bl.apply(this,arguments)}const e0=R.createContext(null),dD=R.createContext(null),Ai=R.createContext(null),Yu=R.createContext(null),Bn=R.createContext({outlet:null,matches:[],isDataRoute:!1}),zk=R.createContext(null);function uD(r,e){let{relative:t}=e===void 0?{}:e;No()||Xt(!1);let{basename:n,navigator:i}=R.useContext(Ai),{hash:a,pathname:o,search:l}=Hk(r,{relative:t}),u=o;return n!=="/"&&(u=o==="/"?n:vi([n,o])),i.createHref({pathname:u,search:l,hash:a})}function No(){return R.useContext(Yu)!=null}function Yr(){return No()||Xt(!1),R.useContext(Yu).location}function Uk(r){R.useContext(Ai).static||R.useLayoutEffect(r)}function qs(){let{isDataRoute:r}=R.useContext(Bn);return r?kD():hD()}function hD(){No()||Xt(!1);let r=R.useContext(e0),{basename:e,future:t,navigator:n}=R.useContext(Ai),{matches:i}=R.useContext(Bn),{pathname:a}=Yr(),o=JSON.stringify(Jx(i,t.v7_relativeSplatPath)),l=R.useRef(!1);return Uk(()=>{l.current=!0}),R.useCallback(function(h,c){if(c===void 0&&(c={}),!l.current)return;if(typeof h=="number"){n.go(h);return}let f=Zx(h,JSON.parse(o),a,c.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:vi([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,o,a,r])}function Ku(){let{matches:r}=R.useContext(Bn),e=r[r.length-1];return e?e.params:{}}function Hk(r,e){let{relative:t}=e===void 0?{}:e,{future:n}=R.useContext(Ai),{matches:i}=R.useContext(Bn),{pathname:a}=Yr(),o=JSON.stringify(Jx(i,n.v7_relativeSplatPath));return R.useMemo(()=>Zx(r,JSON.parse(o),a,t==="path"),[r,o,a,t])}function fD(r,e){return mD(r,e)}function mD(r,e,t,n){No()||Xt(!1);let{navigator:i}=R.useContext(Ai),{matches:a}=R.useContext(Bn),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=Yr(),c;if(e){var f;let x=typeof e=="string"?wo(e):e;u==="/"||(f=x.pathname)!=null&&f.startsWith(u)||Xt(!1),c=x}else c=h;let m=c.pathname||"/",g=m;if(u!=="/"){let x=u.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=UR(r,{pathname:g}),y=vD(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:vi([u,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:vi([u,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,t,n);return e&&y?R.createElement(Yu.Provider,{value:{location:Bl({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:fi.Pop}},y):y}function pD(){let r=ND(),e=lD(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),t?R.createElement("pre",{style:i},t):null,null)}const gD=R.createElement(pD,null);class xD extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?R.createElement(Bn.Provider,{value:this.props.routeContext},R.createElement(zk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function yD(r){let{routeContext:e,match:t,children:n}=r,i=R.useContext(e0);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),R.createElement(Bn.Provider,{value:e},n)}function vD(r,e,t,n){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),r==null){var a;if(!t)return null;if(t.errors)r=t.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let o=r,l=(i=t)==null?void 0:i.errors;if(l!=null){let c=o.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);c>=0||Xt(!1),o=o.slice(0,Math.min(o.length,c+1))}let u=!1,h=-1;if(t&&n&&n.v7_partialHydration)for(let c=0;c<o.length;c++){let f=o[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(h=c),f.route.id){let{loaderData:m,errors:g}=t,v=f.route.loader&&m[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||v){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((c,f,m)=>{let g,v=!1,y=null,x=null;t&&(g=l&&f.route.id?l[f.route.id]:void 0,y=f.route.errorElement||gD,u&&(h<0&&m===0?(ED("route-fallback"),v=!0,x=null):h===m&&(v=!0,x=f.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,m+1)),w=()=>{let k;return g?k=y:v?k=x:f.route.Component?k=R.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=c,R.createElement(yD,{match:f,routeContext:{outlet:c,matches:b,isDataRoute:t!=null},children:k})};return t&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?R.createElement(xD,{location:t.location,revalidation:t.revalidation,component:y,error:g,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var Vk=(function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r})(Vk||{}),qk=(function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r})(qk||{});function bD(r){let e=R.useContext(e0);return e||Xt(!1),e}function jD(r){let e=R.useContext(dD);return e||Xt(!1),e}function wD(r){let e=R.useContext(Bn);return e||Xt(!1),e}function $k(r){let e=wD(),t=e.matches[e.matches.length-1];return t.route.id||Xt(!1),t.route.id}function ND(){var r;let e=R.useContext(zk),t=jD(),n=$k();return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function kD(){let{router:r}=bD(Vk.UseNavigateStable),e=$k(qk.UseNavigateStable),t=R.useRef(!1);return Uk(()=>{t.current=!0}),R.useCallback(function(i,a){a===void 0&&(a={}),t.current&&(typeof i=="number"?r.navigate(i):r.navigate(i,Bl({fromRouteId:e},a)))},[r,e])}const Rj={};function ED(r,e,t){Rj[r]||(Rj[r]=!0)}function SD(r,e){r?.v7_startTransition,r?.v7_relativeSplatPath}function Dj(r){let{to:e,replace:t,state:n,relative:i}=r;No()||Xt(!1);let{future:a,static:o}=R.useContext(Ai),{matches:l}=R.useContext(Bn),{pathname:u}=Yr(),h=qs(),c=Zx(e,Jx(l,a.v7_relativeSplatPath),u,i==="path"),f=JSON.stringify(c);return R.useEffect(()=>h(JSON.parse(f),{replace:t,state:n,relative:i}),[h,f,i,t,n]),null}function Ye(r){Xt(!1)}function _D(r){let{basename:e="/",children:t=null,location:n,navigationType:i=fi.Pop,navigator:a,static:o=!1,future:l}=r;No()&&Xt(!1);let u=e.replace(/^\/*/,"/"),h=R.useMemo(()=>({basename:u,navigator:a,static:o,future:Bl({v7_relativeSplatPath:!1},l)}),[u,l,a,o]);typeof n=="string"&&(n=wo(n));let{pathname:c="/",search:f="",hash:m="",state:g=null,key:v="default"}=n,y=R.useMemo(()=>{let x=Qx(c,u);return x==null?null:{location:{pathname:x,search:f,hash:m,state:g,key:v},navigationType:i}},[u,c,f,m,g,v,i]);return y==null?null:R.createElement(Ai.Provider,{value:h},R.createElement(Yu.Provider,{children:t,value:y}))}function Wk(r){let{children:e,location:t}=r;return fD(Vg(e),t)}new Promise(()=>{});function Vg(r,e){e===void 0&&(e=[]);let t=[];return R.Children.forEach(r,(n,i)=>{if(!R.isValidElement(n))return;let a=[...e,i];if(n.type===R.Fragment){t.push.apply(t,Vg(n.props.children,a));return}n.type!==Ye&&Xt(!1),!n.props.index||!n.props.children||Xt(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Vg(n.props.children,a)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qg(){return qg=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},qg.apply(this,arguments)}function AD(r,e){if(r==null)return{};var t={},n=Object.keys(r),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(t[i]=r[i]);return t}function CD(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function TD(r,e){return r.button===0&&(!e||e==="_self")&&!CD(r)}function $g(r){return r===void 0&&(r=""),new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((e,t)=>{let n=r[t];return e.concat(Array.isArray(n)?n.map(i=>[t,i]):[[t,n]])},[]))}function RD(r,e){let t=$g(r);return e&&e.forEach((n,i)=>{t.has(i)||e.getAll(i).forEach(a=>{t.append(i,a)})}),t}const DD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],PD="6";try{window.__reactRouterVersion=PD}catch{}const MD="startTransition",Pj=RR[MD];function OD(r){let{basename:e,children:t,future:n,window:i}=r,a=R.useRef();a.current==null&&(a.current=BR({window:i,v5Compat:!0}));let o=a.current,[l,u]=R.useState({action:o.action,location:o.location}),{v7_startTransition:h}=n||{},c=R.useCallback(f=>{h&&Pj?Pj(()=>u(f)):u(f)},[u,h]);return R.useLayoutEffect(()=>o.listen(c),[o,c]),R.useEffect(()=>SD(n),[n]),R.createElement(_D,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:n})}const LD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ID=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tr=R.forwardRef(function(e,t){let{onClick:n,relative:i,reloadDocument:a,replace:o,state:l,target:u,to:h,preventScrollReset:c,viewTransition:f}=e,m=AD(e,DD),{basename:g}=R.useContext(Ai),v,y=!1;if(typeof h=="string"&&ID.test(h)&&(v=h,LD))try{let k=new URL(window.location.href),N=h.startsWith("//")?new URL(k.protocol+h):new URL(h),E=Qx(N.pathname,g);N.origin===k.origin&&E!=null?h=E+N.search+N.hash:y=!0}catch{}let x=uD(h,{relative:i}),b=BD(h,{replace:o,state:l,target:u,preventScrollReset:c,relative:i,viewTransition:f});function w(k){n&&n(k),k.defaultPrevented||b(k)}return R.createElement("a",qg({},m,{href:v||x,onClick:y||a?n:w,ref:t,target:u}))});var Mj;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(Mj||(Mj={}));var Oj;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(Oj||(Oj={}));function BD(r,e){let{target:t,replace:n,state:i,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,u=qs(),h=Yr(),c=Hk(r,{relative:o});return R.useCallback(f=>{if(TD(f,t)){f.preventDefault();let m=n!==void 0?n:gu(h)===gu(c);u(r,{replace:m,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[h,u,c,n,i,t,r,a,o,l])}function FD(r){let e=R.useRef($g(r)),t=R.useRef(!1),n=Yr(),i=R.useMemo(()=>RD(n.search,t.current?null:e.current),[n.search]),a=qs(),o=R.useCallback((l,u)=>{const h=$g(typeof l=="function"?l(i):l);t.current=!0,a("?"+h,u)},[a,i]);return[i,o]}var Gk={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Lj=_r.createContext&&_r.createContext(Gk),zD=["attr","size","title"];function UD(r,e){if(r==null)return{};var t=HD(r,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function HD(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function xu(){return xu=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},xu.apply(this,arguments)}function Ij(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function yu(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ij(Object(t),!0).forEach(function(n){VD(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ij(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function VD(r,e,t){return e=qD(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function qD(r){var e=$D(r,"string");return typeof e=="symbol"?e:e+""}function $D(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Yk(r){return r&&r.map((e,t)=>_r.createElement(e.tag,yu({key:t},e.attr),Yk(e.child)))}function je(r){return e=>_r.createElement(WD,xu({attr:yu({},r.attr)},e),Yk(r.child))}function WD(r){var e=t=>{var{attr:n,size:i,title:a}=r,o=UD(r,zD),l=i||t.size||"1em",u;return t.className&&(u=t.className),r.className&&(u=(u?u+" ":"")+r.className),_r.createElement("svg",xu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,o,{className:u,style:yu(yu({color:r.color||t.color},t.style),r.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&_r.createElement("title",null,a),r.children)};return Lj!==void 0?_r.createElement(Lj.Consumer,null,t=>e(t)):e(Gk)}function cn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(r)}function Fs(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(r)}function ps(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},child:[]},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(r)}function Bj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"21 8 21 21 3 21 3 8"},child:[]},{tag:"rect",attr:{x:"1",y:"3",width:"22",height:"5"},child:[]},{tag:"line",attr:{x1:"10",y1:"12",x2:"14",y2:"12"},child:[]}]})(r)}function Kk(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"polyline",attr:{points:"19 12 12 19 5 12"},child:[]}]})(r)}function Xu(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(r)}function GD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(r)}function Xk(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"5"},child:[]},{tag:"polyline",attr:{points:"5 12 12 5 19 12"},child:[]}]})(r)}function fs(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(r)}function gs(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(r)}function t0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(r)}function et(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},child:[]},{tag:"path",attr:{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},child:[]}]})(r)}function Je(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(r)}function YD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"},child:[]}]})(r)}function Ct(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(r)}function ms(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(r)}function KD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(r)}function s0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(r)}function r0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(r)}function XD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(r)}function fn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(r)}function Fj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"},child:[]}]})(r)}function QD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 18 22 12 16 6"},child:[]},{tag:"polyline",attr:{points:"8 6 2 12 8 18"},child:[]}]})(r)}function JD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},child:[]}]})(r)}function ZD(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 10 4 15 9 20"},child:[]},{tag:"path",attr:{d:"M20 4v7a4 4 0 0 1-4 4H4"},child:[]}]})(r)}function Pn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(r)}function Wg(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"ellipse",attr:{cx:"12",cy:"5",rx:"9",ry:"3"},child:[]},{tag:"path",attr:{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"},child:[]},{tag:"path",attr:{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"},child:[]}]})(r)}function ln(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(r)}function Qu(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(r)}function as(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"},child:[]},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"},child:[]}]})(r)}function zj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},child:[]},{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"},child:[]}]})(r)}function Ya(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(r)}function Ss(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(r)}function mi(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(r)}function dn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"},child:[]},{tag:"polyline",attr:{points:"13 2 13 9 20 9"},child:[]}]})(r)}function ko(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(r)}function pi(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"},child:[]},{tag:"line",attr:{x1:"4",y1:"22",x2:"4",y2:"15"},child:[]}]})(r)}function eP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(r)}function tP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 12 20 22 4 22 4 12"},child:[]},{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"22",x2:"12",y2:"7"},child:[]},{tag:"path",attr:{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"},child:[]},{tag:"path",attr:{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"},child:[]}]})(r)}function sP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"},child:[]}]})(r)}function $t(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(r)}function n0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(r)}function Fl(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(r)}function Uj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"},child:[]}]})(r)}function Pd(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(r)}function Qk(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(r)}function zl(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(r)}function Jk(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(r)}function $r(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(r)}function Mn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(r)}function rP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(r)}function Ul(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"},child:[]}]})(r)}function mn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(r)}function Hj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]},{tag:"path",attr:{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"},child:[]},{tag:"path",attr:{d:"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"},child:[]},{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"8",y1:"23",x2:"16",y2:"23"},child:[]}]})(r)}function nP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"},child:[]},{tag:"path",attr:{d:"M19 10v2a7 7 0 0 1-14 0v-2"},child:[]},{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"8",y1:"23",x2:"16",y2:"23"},child:[]}]})(r)}function Zk(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(r)}function iP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"8",y1:"21",x2:"16",y2:"21"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12",y2:"21"},child:[]}]})(r)}function aP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"5",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"19",r:"1"},child:[]}]})(r)}function xs(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(r)}function oP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"6",y:"4",width:"4",height:"16"},child:[]},{tag:"rect",attr:{x:"14",y:"4",width:"4",height:"16"},child:[]}]})(r)}function Vj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 19l7-7 3 3-7 7-3-3z"},child:[]},{tag:"path",attr:{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"},child:[]},{tag:"path",attr:{d:"M2 2l7.586 7.586"},child:[]},{tag:"circle",attr:{cx:"11",cy:"11",r:"2"},child:[]}]})(r)}function Ju(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(r)}function Gg(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"},child:[]}]})(r)}function bt(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(r)}function Wr(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(r)}function Er(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(r)}function nr(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(r)}function i0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(r)}function ji(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(r)}function Yg(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"},child:[]},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"},child:[]},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"},child:[]}]})(r)}function Tn(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(r)}function lP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"path",attr:{d:"M16 10a4 4 0 0 1-8 0"},child:[]}]})(r)}function qr(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"9",cy:"21",r:"1"},child:[]},{tag:"circle",attr:{cx:"20",cy:"21",r:"1"},child:[]},{tag:"path",attr:{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"},child:[]}]})(r)}function eu(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12.01",y2:"18"},child:[]}]})(r)}function cP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]}]})(r)}function Nt(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(r)}function Qi(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"},child:[]},{tag:"line",attr:{x1:"7",y1:"7",x2:"7.01",y2:"7"},child:[]}]})(r)}function rs(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(r)}function zt(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(r)}function po(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(r)}function ct(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(r)}function dP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"3",width:"15",height:"13"},child:[]},{tag:"polygon",attr:{points:"16 8 20 8 23 11 23 16 16 16 16 8"},child:[]},{tag:"circle",attr:{cx:"5.5",cy:"18.5",r:"2.5"},child:[]},{tag:"circle",attr:{cx:"18.5",cy:"18.5",r:"2.5"},child:[]}]})(r)}function uP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"4 7 4 4 20 4 20 7"},child:[]},{tag:"line",attr:{x1:"9",y1:"20",x2:"15",y2:"20"},child:[]},{tag:"line",attr:{x1:"12",y1:"4",x2:"12",y2:"20"},child:[]}]})(r)}function qj(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(r)}function a0(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(r)}function Ka(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"18",y1:"8",x2:"23",y2:"13"},child:[]},{tag:"line",attr:{x1:"23",y1:"8",x2:"18",y2:"13"},child:[]}]})(r)}function Qt(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(r)}function Me(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(r)}function $j(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(r)}function Ur(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"23 7 16 12 23 17 23 7"},child:[]},{tag:"rect",attr:{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"},child:[]}]})(r)}function hP(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12.55a11 11 0 0 1 14.08 0"},child:[]},{tag:"path",attr:{d:"M1.42 9a16 16 0 0 1 21.16 0"},child:[]},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"},child:[]}]})(r)}function Hr(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(r)}function ot(r){return je({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(r)}const o0=R.createContext({});function l0(r){const e=R.useRef(null);return e.current===null&&(e.current=r()),e.current}const c0=typeof window<"u",eE=c0?R.useLayoutEffect:R.useEffect,Zu=R.createContext(null);function d0(r,e){r.indexOf(e)===-1&&r.push(e)}function u0(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const On=(r,e,t)=>t>e?e:t<r?r:t;let h0=()=>{};const Ln={},tE=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r);function sE(r){return typeof r=="object"&&r!==null}const rE=r=>/^0[^.\s]+$/u.test(r);function f0(r){let e;return()=>(e===void 0&&(e=r()),e)}const Ar=r=>r,fP=(r,e)=>t=>e(r(t)),sc=(...r)=>r.reduce(fP),Hl=(r,e,t)=>{const n=e-r;return n===0?1:(t-r)/n};class m0{constructor(){this.subscriptions=[]}add(e){return d0(this.subscriptions,e),()=>u0(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,n);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const un=r=>r*1e3,Sr=r=>r/1e3;function nE(r,e){return e?r*(1e3/e):0}const iE=(r,e,t)=>(((1-3*t+3*e)*r+(3*t-6*e))*r+3*e)*r,mP=1e-7,pP=12;function gP(r,e,t,n,i){let a,o,l=0;do o=e+(t-e)/2,a=iE(o,n,i)-r,a>0?t=o:e=o;while(Math.abs(a)>mP&&++l<pP);return o}function rc(r,e,t,n){if(r===e&&t===n)return Ar;const i=a=>gP(a,0,1,r,t);return a=>a===0||a===1?a:iE(i(a),e,n)}const aE=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,oE=r=>e=>1-r(1-e),lE=rc(.33,1.53,.69,.99),p0=oE(lE),cE=aE(p0),dE=r=>(r*=2)<1?.5*p0(r):.5*(2-Math.pow(2,-10*(r-1))),g0=r=>1-Math.sin(Math.acos(r)),uE=oE(g0),hE=aE(g0),xP=rc(.42,0,1,1),yP=rc(0,0,.58,1),fE=rc(.42,0,.58,1),vP=r=>Array.isArray(r)&&typeof r[0]!="number",mE=r=>Array.isArray(r)&&typeof r[0]=="number",bP={linear:Ar,easeIn:xP,easeInOut:fE,easeOut:yP,circIn:g0,circInOut:hE,circOut:uE,backIn:p0,backInOut:cE,backOut:lE,anticipate:dE},jP=r=>typeof r=="string",Wj=r=>{if(mE(r)){h0(r.length===4);const[e,t,n,i]=r;return rc(e,t,n,i)}else if(jP(r))return bP[r];return r},Md=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function wP(r,e){let t=new Set,n=new Set,i=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(c){o.has(c)&&(h.schedule(c),r()),c(l)}const h={schedule:(c,f=!1,m=!1)=>{const v=m&&i?t:n;return f&&o.add(c),v.has(c)||v.add(c),c},cancel:c=>{n.delete(c),o.delete(c)},process:c=>{if(l=c,i){a=!0;return}i=!0,[t,n]=[n,t],t.forEach(u),t.clear(),i=!1,a&&(a=!1,h.process(c))}};return h}const NP=40;function pE(r,e){let t=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,o=Md.reduce((k,N)=>(k[N]=wP(a),k),{}),{setup:l,read:u,resolveKeyframes:h,preUpdate:c,update:f,preRender:m,render:g,postRender:v}=o,y=()=>{const k=Ln.useManualTiming?i.timestamp:performance.now();t=!1,Ln.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(k-i.timestamp,NP),1)),i.timestamp=k,i.isProcessing=!0,l.process(i),u.process(i),h.process(i),c.process(i),f.process(i),m.process(i),g.process(i),v.process(i),i.isProcessing=!1,t&&e&&(n=!1,r(y))},x=()=>{t=!0,n=!0,i.isProcessing||r(y)};return{schedule:Md.reduce((k,N)=>{const E=o[N];return k[N]=(S,A=!1,C=!1)=>(t||x(),E.schedule(S,A,C)),k},{}),cancel:k=>{for(let N=0;N<Md.length;N++)o[Md[N]].cancel(k)},state:i,steps:o}}const{schedule:Pt,cancel:wi,state:Ns,steps:xm}=pE(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ar,!0);let tu;function kP(){tu=void 0}const sr={now:()=>(tu===void 0&&sr.set(Ns.isProcessing||Ln.useManualTiming?Ns.timestamp:performance.now()),tu),set:r=>{tu=r,queueMicrotask(kP)}},gE=r=>e=>typeof e=="string"&&e.startsWith(r),x0=gE("--"),EP=gE("var(--"),y0=r=>EP(r)?SP.test(r.split("/*")[0].trim()):!1,SP=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Eo={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},Vl={...Eo,transform:r=>On(0,1,r)},Od={...Eo,default:1},Al=r=>Math.round(r*1e5)/1e5,v0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function _P(r){return r==null}const AP=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,b0=(r,e)=>t=>!!(typeof t=="string"&&AP.test(t)&&t.startsWith(r)||e&&!_P(t)&&Object.prototype.hasOwnProperty.call(t,e)),xE=(r,e,t)=>n=>{if(typeof n!="string")return n;const[i,a,o,l]=n.match(v0);return{[r]:parseFloat(i),[e]:parseFloat(a),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},CP=r=>On(0,255,r),ym={...Eo,transform:r=>Math.round(CP(r))},Ji={test:b0("rgb","red"),parse:xE("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+ym.transform(r)+", "+ym.transform(e)+", "+ym.transform(t)+", "+Al(Vl.transform(n))+")"};function TP(r){let e="",t="",n="",i="";return r.length>5?(e=r.substring(1,3),t=r.substring(3,5),n=r.substring(5,7),i=r.substring(7,9)):(e=r.substring(1,2),t=r.substring(2,3),n=r.substring(3,4),i=r.substring(4,5),e+=e,t+=t,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const Kg={test:b0("#"),parse:TP,transform:Ji.transform},nc=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),di=nc("deg"),hn=nc("%"),He=nc("px"),RP=nc("vh"),DP=nc("vw"),Gj={...hn,parse:r=>hn.parse(r)/100,transform:r=>hn.transform(r*100)},Xa={test:b0("hsl","hue"),parse:xE("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+hn.transform(Al(e))+", "+hn.transform(Al(t))+", "+Al(Vl.transform(n))+")"},ss={test:r=>Ji.test(r)||Kg.test(r)||Xa.test(r),parse:r=>Ji.test(r)?Ji.parse(r):Xa.test(r)?Xa.parse(r):Kg.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?Ji.transform(r):Xa.transform(r),getAnimatableNone:r=>{const e=ss.parse(r);return e.alpha=0,ss.transform(e)}},PP=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function MP(r){return isNaN(r)&&typeof r=="string"&&(r.match(v0)?.length||0)+(r.match(PP)?.length||0)>0}const yE="number",vE="color",OP="var",LP="var(",Yj="${}",IP=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ql(r){const e=r.toString(),t=[],n={color:[],number:[],var:[]},i=[];let a=0;const l=e.replace(IP,u=>(ss.test(u)?(n.color.push(a),i.push(vE),t.push(ss.parse(u))):u.startsWith(LP)?(n.var.push(a),i.push(OP),t.push(u)):(n.number.push(a),i.push(yE),t.push(parseFloat(u))),++a,Yj)).split(Yj);return{values:t,split:l,indexes:n,types:i}}function bE(r){return ql(r).values}function jE(r){const{split:e,types:t}=ql(r),n=e.length;return i=>{let a="";for(let o=0;o<n;o++)if(a+=e[o],i[o]!==void 0){const l=t[o];l===yE?a+=Al(i[o]):l===vE?a+=ss.transform(i[o]):a+=i[o]}return a}}const BP=r=>typeof r=="number"?0:ss.test(r)?ss.getAnimatableNone(r):r;function FP(r){const e=bE(r);return jE(r)(e.map(BP))}const Ni={test:MP,parse:bE,createTransformer:jE,getAnimatableNone:FP};function vm(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function zP({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let i=0,a=0,o=0;if(!e)i=a=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;i=vm(u,l,r+1/3),a=vm(u,l,r),o=vm(u,l,r-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}function vu(r,e){return t=>t>0?e:r}const Bt=(r,e,t)=>r+(e-r)*t,bm=(r,e,t)=>{const n=r*r,i=t*(e*e-n)+n;return i<0?0:Math.sqrt(i)},UP=[Kg,Ji,Xa],HP=r=>UP.find(e=>e.test(r));function Kj(r){const e=HP(r);if(!e)return!1;let t=e.parse(r);return e===Xa&&(t=zP(t)),t}const Xj=(r,e)=>{const t=Kj(r),n=Kj(e);if(!t||!n)return vu(r,e);const i={...t};return a=>(i.red=bm(t.red,n.red,a),i.green=bm(t.green,n.green,a),i.blue=bm(t.blue,n.blue,a),i.alpha=Bt(t.alpha,n.alpha,a),Ji.transform(i))},Xg=new Set(["none","hidden"]);function VP(r,e){return Xg.has(r)?t=>t<=0?r:e:t=>t>=1?e:r}function qP(r,e){return t=>Bt(r,e,t)}function j0(r){return typeof r=="number"?qP:typeof r=="string"?y0(r)?vu:ss.test(r)?Xj:GP:Array.isArray(r)?wE:typeof r=="object"?ss.test(r)?Xj:$P:vu}function wE(r,e){const t=[...r],n=t.length,i=r.map((a,o)=>j0(a)(a,e[o]));return a=>{for(let o=0;o<n;o++)t[o]=i[o](a);return t}}function $P(r,e){const t={...r,...e},n={};for(const i in t)r[i]!==void 0&&e[i]!==void 0&&(n[i]=j0(r[i])(r[i],e[i]));return i=>{for(const a in n)t[a]=n[a](i);return t}}function WP(r,e){const t=[],n={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=r.indexes[a][n[a]],l=r.values[o]??0;t[i]=l,n[a]++}return t}const GP=(r,e)=>{const t=Ni.createTransformer(e),n=ql(r),i=ql(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Xg.has(r)&&!i.values.length||Xg.has(e)&&!n.values.length?VP(r,e):sc(wE(WP(n,i),i.values),t):vu(r,e)};function NE(r,e,t){return typeof r=="number"&&typeof e=="number"&&typeof t=="number"?Bt(r,e,t):j0(r)(r,e)}const YP=r=>{const e=({timestamp:t})=>r(t);return{start:(t=!0)=>Pt.update(e,t),stop:()=>wi(e),now:()=>Ns.isProcessing?Ns.timestamp:sr.now()}},kE=(r,e,t=10)=>{let n="";const i=Math.max(Math.round(e/t),2);for(let a=0;a<i;a++)n+=Math.round(r(a/(i-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},bu=2e4;function w0(r){let e=0;const t=50;let n=r.next(e);for(;!n.done&&e<bu;)e+=t,n=r.next(e);return e>=bu?1/0:e}function KP(r,e=100,t){const n=t({...r,keyframes:[0,e]}),i=Math.min(w0(n),bu);return{type:"keyframes",ease:a=>n.next(i*a).value/e,duration:Sr(i)}}const XP=5;function EE(r,e,t){const n=Math.max(e-XP,0);return nE(t-r(n),e-n)}const Vt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},jm=.001;function QP({duration:r=Vt.duration,bounce:e=Vt.bounce,velocity:t=Vt.velocity,mass:n=Vt.mass}){let i,a,o=1-e;o=On(Vt.minDamping,Vt.maxDamping,o),r=On(Vt.minDuration,Vt.maxDuration,Sr(r)),o<1?(i=h=>{const c=h*o,f=c*r,m=c-t,g=Qg(h,o),v=Math.exp(-f);return jm-m/g*v},a=h=>{const f=h*o*r,m=f*t+t,g=Math.pow(o,2)*Math.pow(h,2)*r,v=Math.exp(-f),y=Qg(Math.pow(h,2),o);return(-i(h)+jm>0?-1:1)*((m-g)*v)/y}):(i=h=>{const c=Math.exp(-h*r),f=(h-t)*r+1;return-jm+c*f},a=h=>{const c=Math.exp(-h*r),f=(t-h)*(r*r);return c*f});const l=5/r,u=ZP(i,a,l);if(r=un(r),isNaN(u))return{stiffness:Vt.stiffness,damping:Vt.damping,duration:r};{const h=Math.pow(u,2)*n;return{stiffness:h,damping:o*2*Math.sqrt(n*h),duration:r}}}const JP=12;function ZP(r,e,t){let n=t;for(let i=1;i<JP;i++)n=n-r(n)/e(n);return n}function Qg(r,e){return r*Math.sqrt(1-e*e)}const e4=["duration","bounce"],t4=["stiffness","damping","mass"];function Qj(r,e){return e.some(t=>r[t]!==void 0)}function s4(r){let e={velocity:Vt.velocity,stiffness:Vt.stiffness,damping:Vt.damping,mass:Vt.mass,isResolvedFromDuration:!1,...r};if(!Qj(r,t4)&&Qj(r,e4))if(r.visualDuration){const t=r.visualDuration,n=2*Math.PI/(t*1.2),i=n*n,a=2*On(.05,1,1-(r.bounce||0))*Math.sqrt(i);e={...e,mass:Vt.mass,stiffness:i,damping:a}}else{const t=QP(r);e={...e,...t,mass:Vt.mass},e.isResolvedFromDuration=!0}return e}function ju(r=Vt.visualDuration,e=Vt.bounce){const t=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:n,restDelta:i}=t;const a=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:a},{stiffness:u,damping:h,mass:c,duration:f,velocity:m,isResolvedFromDuration:g}=s4({...t,velocity:-Sr(t.velocity||0)}),v=m||0,y=h/(2*Math.sqrt(u*c)),x=o-a,b=Sr(Math.sqrt(u/c)),w=Math.abs(x)<5;n||(n=w?Vt.restSpeed.granular:Vt.restSpeed.default),i||(i=w?Vt.restDelta.granular:Vt.restDelta.default);let k;if(y<1){const E=Qg(b,y);k=S=>{const A=Math.exp(-y*b*S);return o-A*((v+y*b*x)/E*Math.sin(E*S)+x*Math.cos(E*S))}}else if(y===1)k=E=>o-Math.exp(-b*E)*(x+(v+b*x)*E);else{const E=b*Math.sqrt(y*y-1);k=S=>{const A=Math.exp(-y*b*S),C=Math.min(E*S,300);return o-A*((v+y*b*x)*Math.sinh(C)+E*x*Math.cosh(C))/E}}const N={calculatedDuration:g&&f||null,next:E=>{const S=k(E);if(g)l.done=E>=f;else{let A=E===0?v:0;y<1&&(A=E===0?un(v):EE(k,E,S));const C=Math.abs(A)<=n,I=Math.abs(o-S)<=i;l.done=C&&I}return l.value=l.done?o:S,l},toString:()=>{const E=Math.min(w0(N),bu),S=kE(A=>N.next(E*A).value,E,30);return E+"ms "+S},toTransition:()=>{}};return N}ju.applyToOptions=r=>{const e=KP(r,100,ju);return r.ease=e.ease,r.duration=un(e.duration),r.type="keyframes",r};function Jg({keyframes:r,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:c}){const f=r[0],m={done:!1,value:f},g=C=>l!==void 0&&C<l||u!==void 0&&C>u,v=C=>l===void 0?u:u===void 0||Math.abs(l-C)<Math.abs(u-C)?l:u;let y=t*e;const x=f+y,b=o===void 0?x:o(x);b!==x&&(y=b-f);const w=C=>-y*Math.exp(-C/n),k=C=>b+w(C),N=C=>{const I=w(C),L=k(C);m.done=Math.abs(I)<=h,m.value=m.done?b:L};let E,S;const A=C=>{g(m.value)&&(E=C,S=ju({keyframes:[m.value,v(m.value)],velocity:EE(k,C,m.value),damping:i,stiffness:a,restDelta:h,restSpeed:c}))};return A(0),{calculatedDuration:null,next:C=>{let I=!1;return!S&&E===void 0&&(I=!0,N(C),A(C)),E!==void 0&&C>=E?S.next(C-E):(!I&&N(C),m)}}}function r4(r,e,t){const n=[],i=t||Ln.mix||NE,a=r.length-1;for(let o=0;o<a;o++){let l=i(r[o],r[o+1]);if(e){const u=Array.isArray(e)?e[o]||Ar:e;l=sc(u,l)}n.push(l)}return n}function n4(r,e,{clamp:t=!0,ease:n,mixer:i}={}){const a=r.length;if(h0(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=r[0]===r[1];r[0]>r[a-1]&&(r=[...r].reverse(),e=[...e].reverse());const l=r4(e,n,i),u=l.length,h=c=>{if(o&&c<r[0])return e[0];let f=0;if(u>1)for(;f<r.length-2&&!(c<r[f+1]);f++);const m=Hl(r[f],r[f+1],c);return l[f](m)};return t?c=>h(On(r[0],r[a-1],c)):h}function i4(r,e){const t=r[r.length-1];for(let n=1;n<=e;n++){const i=Hl(0,e,n);r.push(Bt(t,1,i))}}function a4(r){const e=[0];return i4(e,r.length-1),e}function o4(r,e){return r.map(t=>t*e)}function l4(r,e){return r.map(()=>e||fE).splice(0,r.length-1)}function Cl({duration:r=300,keyframes:e,times:t,ease:n="easeInOut"}){const i=vP(n)?n.map(Wj):Wj(n),a={done:!1,value:e[0]},o=o4(t&&t.length===e.length?t:a4(e),r),l=n4(o,e,{ease:Array.isArray(i)?i:l4(e,i)});return{calculatedDuration:r,next:u=>(a.value=l(u),a.done=u>=r,a)}}const c4=r=>r!==null;function N0(r,{repeat:e,repeatType:t="loop"},n,i=1){const a=r.filter(c4),l=i<0||e&&t!=="loop"&&e%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const d4={decay:Jg,inertia:Jg,tween:Cl,keyframes:Cl,spring:ju};function SE(r){typeof r.type=="string"&&(r.type=d4[r.type])}class k0{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const u4=r=>r/100;class E0 extends k0{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==sr.now()&&this.tick(sr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;SE(e);const{type:t=Cl,repeat:n=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:l}=e;const u=t||Cl;u!==Cl&&typeof l[0]!="number"&&(this.mixKeyframes=sc(u4,NE(l[0],l[1])),l=[0,100]);const h=u({...e,keyframes:l});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...l].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=w0(h));const{calculatedDuration:c}=h;this.calculatedDuration=c,this.resolvedDuration=c+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=h}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return n.next(0);const{delay:h=0,keyframes:c,repeat:f,repeatType:m,repeatDelay:g,type:v,onUpdate:y,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const b=this.currentTime-h*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?b<0:b>i;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let k=this.currentTime,N=n;if(f){const C=Math.min(this.currentTime,i)/l;let I=Math.floor(C),L=C%1;!L&&C>=1&&(L=1),L===1&&I--,I=Math.min(I,f+1),!!(I%2)&&(m==="reverse"?(L=1-L,g&&(L-=g/l)):m==="mirror"&&(N=o)),k=On(0,1,L)*l}const E=w?{done:!1,value:c[0]}:N.next(k);a&&(E.value=a(E.value));let{done:S}=E;!w&&u!==null&&(S=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return A&&v!==Jg&&(E.value=N0(c,this.options,x,this.speed)),y&&y(E.value),A&&this.finish(),E}then(e,t){return this.finished.then(e,t)}get duration(){return Sr(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Sr(e)}get time(){return Sr(this.currentTime)}set time(e){e=un(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(sr.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Sr(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=YP,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=t??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(sr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function h4(r){for(let e=1;e<r.length;e++)r[e]??(r[e]=r[e-1])}const Zi=r=>r*180/Math.PI,Zg=r=>{const e=Zi(Math.atan2(r[1],r[0]));return ex(e)},f4={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:r=>(Math.abs(r[0])+Math.abs(r[3]))/2,rotate:Zg,rotateZ:Zg,skewX:r=>Zi(Math.atan(r[1])),skewY:r=>Zi(Math.atan(r[2])),skew:r=>(Math.abs(r[1])+Math.abs(r[2]))/2},ex=r=>(r=r%360,r<0&&(r+=360),r),Jj=Zg,Zj=r=>Math.sqrt(r[0]*r[0]+r[1]*r[1]),ew=r=>Math.sqrt(r[4]*r[4]+r[5]*r[5]),m4={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Zj,scaleY:ew,scale:r=>(Zj(r)+ew(r))/2,rotateX:r=>ex(Zi(Math.atan2(r[6],r[5]))),rotateY:r=>ex(Zi(Math.atan2(-r[2],r[0]))),rotateZ:Jj,rotate:Jj,skewX:r=>Zi(Math.atan(r[4])),skewY:r=>Zi(Math.atan(r[1])),skew:r=>(Math.abs(r[1])+Math.abs(r[4]))/2};function tx(r){return r.includes("scale")?1:0}function sx(r,e){if(!r||r==="none")return tx(e);const t=r.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(t)n=m4,i=t;else{const l=r.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=f4,i=l}if(!i)return tx(e);const a=n[e],o=i[1].split(",").map(g4);return typeof a=="function"?a(o):o[a]}const p4=(r,e)=>{const{transform:t="none"}=getComputedStyle(r);return sx(t,e)};function g4(r){return parseFloat(r.trim())}const So=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_o=new Set(So),tw=r=>r===Eo||r===He,x4=new Set(["x","y","z"]),y4=So.filter(r=>!x4.has(r));function v4(r){const e=[];return y4.forEach(t=>{const n=r.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const na={width:({x:r},{paddingLeft:e="0",paddingRight:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),height:({y:r},{paddingTop:e="0",paddingBottom:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:(r,{transform:e})=>sx(e,"x"),y:(r,{transform:e})=>sx(e,"y")};na.translateX=na.x;na.translateY=na.y;const ia=new Set;let rx=!1,nx=!1,ix=!1;function _E(){if(nx){const r=Array.from(ia).filter(n=>n.needsMeasurement),e=new Set(r.map(n=>n.element)),t=new Map;e.forEach(n=>{const i=v4(n);i.length&&(t.set(n,i),n.render())}),r.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=t.get(n);i&&i.forEach(([a,o])=>{n.getValue(a)?.set(o)})}),r.forEach(n=>n.measureEndState()),r.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}nx=!1,rx=!1,ia.forEach(r=>r.complete(ix)),ia.clear()}function AE(){ia.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(nx=!0)})}function b4(){ix=!0,AE(),_E(),ix=!1}class S0{constructor(e,t,n,i,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ia.add(this),rx||(rx=!0,Pt.read(AE),Pt.resolveKeyframes(_E))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;if(e[0]===null){const a=i?.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&t){const l=n.readValue(t,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}h4(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ia.delete(this)}cancel(){this.state==="scheduled"&&(ia.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const j4=r=>r.startsWith("--");function w4(r,e,t){j4(e)?r.style.setProperty(e,t):r.style[e]=t}const N4=f0(()=>window.ScrollTimeline!==void 0),k4={};function E4(r,e){const t=f0(r);return()=>k4[e]??t()}const CE=E4(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),wl=([r,e,t,n])=>`cubic-bezier(${r}, ${e}, ${t}, ${n})`,sw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:wl([0,.65,.55,1]),circOut:wl([.55,0,1,.45]),backIn:wl([.31,.01,.66,-.59]),backOut:wl([.33,1.53,.69,.99])};function TE(r,e){if(r)return typeof r=="function"?CE()?kE(r,e):"ease-out":mE(r)?wl(r):Array.isArray(r)?r.map(t=>TE(t,e)||sw.easeOut):sw[r]}function S4(r,e,t,{delay:n=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:u}={},h=void 0){const c={[e]:t};u&&(c.offset=u);const f=TE(l,i);Array.isArray(f)&&(c.easing=f);const m={delay:n,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return h&&(m.pseudoElement=h),r.animate(c,m)}function RE(r){return typeof r=="function"&&"applyToOptions"in r}function _4({type:r,...e}){return RE(r)&&CE()?r.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class A4 extends k0{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,h0(typeof e.type!="string");const h=_4(e);this.animation=S4(t,n,i,h,a),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const c=N0(i,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(c):w4(t,n,c),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Sr(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Sr(e)}get time(){return Sr(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=un(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&N4()?(this.animation.timeline=e,Ar):t(this)}}const DE={anticipate:dE,backInOut:cE,circInOut:hE};function C4(r){return r in DE}function T4(r){typeof r.ease=="string"&&C4(r.ease)&&(r.ease=DE[r.ease])}const rw=10;class R4 extends A4{constructor(e){T4(e),SE(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:n,onComplete:i,element:a,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const l=new E0({...o,autoplay:!1}),u=un(this.finishedTime??this.time);t.setWithVelocity(l.sample(u-rw).value,l.sample(u).value,rw),l.stop()}}const nw=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(Ni.test(r)||r==="0")&&!r.startsWith("url("));function D4(r){const e=r[0];if(r.length===1)return!0;for(let t=0;t<r.length;t++)if(r[t]!==e)return!0}function P4(r,e,t,n){const i=r[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=r[r.length-1],o=nw(i,e),l=nw(a,e);return!o||!l?!1:D4(r)||(t==="spring"||RE(t))&&n}function ax(r){r.duration=0,r.type="keyframes"}const M4=new Set(["opacity","clipPath","filter","transform"]),O4=f0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function L4(r){const{motionValue:e,name:t,repeatDelay:n,repeatType:i,damping:a,type:o}=r;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=e.owner.getProps();return O4()&&t&&M4.has(t)&&(t!=="transform"||!h)&&!u&&!n&&i!=="mirror"&&a!==0&&o!=="inertia"}const I4=40;class B4 extends k0{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:u,motionValue:h,element:c,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=sr.now();const m={autoplay:e,delay:t,type:n,repeat:i,repeatDelay:a,repeatType:o,name:u,motionValue:h,element:c,...f},g=c?.KeyframeResolver||S0;this.keyframeResolver=new g(l,(v,y,x)=>this.onKeyframesResolved(v,y,m,!x),u,h,c),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,n,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:u,isHandoff:h,onUpdate:c}=n;this.resolvedAt=sr.now(),P4(e,a,o,l)||((Ln.instantAnimations||!u)&&c?.(N0(e,n,t)),e[0]=e[e.length-1],ax(n),n.repeat=0);const m={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>I4?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},g=!h&&L4(m)?new R4({...m,element:m.motionValue.owner.current}):new E0(m);g.finished.then(()=>this.notifyFinished()).catch(Ar),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),b4()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const F4=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function z4(r){const e=F4.exec(r);if(!e)return[,];const[,t,n,i]=e;return[`--${t??n}`,i]}function PE(r,e,t=1){const[n,i]=z4(r);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const o=a.trim();return tE(o)?parseFloat(o):o}return y0(i)?PE(i,e,t+1):i}function _0(r,e){return r?.[e]??r?.default??r}const ME=new Set(["width","height","top","left","right","bottom",...So]),U4={test:r=>r==="auto",parse:r=>r},OE=r=>e=>e.test(r),LE=[Eo,He,hn,di,DP,RP,U4],iw=r=>LE.find(OE(r));function H4(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||rE(r):!0}const V4=new Set(["brightness","contrast","saturate","opacity"]);function q4(r){const[e,t]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[n]=t.match(v0)||[];if(!n)return r;const i=t.replace(n,"");let a=V4.has(e)?1:0;return n!==t&&(a*=100),e+"("+a+i+")"}const $4=/\b([a-z-]*)\(.*?\)/gu,ox={...Ni,getAnimatableNone:r=>{const e=r.match($4);return e?e.map(q4).join(" "):r}},aw={...Eo,transform:Math.round},W4={rotate:di,rotateX:di,rotateY:di,rotateZ:di,scale:Od,scaleX:Od,scaleY:Od,scaleZ:Od,skew:di,skewX:di,skewY:di,distance:He,translateX:He,translateY:He,translateZ:He,x:He,y:He,z:He,perspective:He,transformPerspective:He,opacity:Vl,originX:Gj,originY:Gj,originZ:He},A0={borderWidth:He,borderTopWidth:He,borderRightWidth:He,borderBottomWidth:He,borderLeftWidth:He,borderRadius:He,radius:He,borderTopLeftRadius:He,borderTopRightRadius:He,borderBottomRightRadius:He,borderBottomLeftRadius:He,width:He,maxWidth:He,height:He,maxHeight:He,top:He,right:He,bottom:He,left:He,padding:He,paddingTop:He,paddingRight:He,paddingBottom:He,paddingLeft:He,margin:He,marginTop:He,marginRight:He,marginBottom:He,marginLeft:He,backgroundPositionX:He,backgroundPositionY:He,...W4,zIndex:aw,fillOpacity:Vl,strokeOpacity:Vl,numOctaves:aw},G4={...A0,color:ss,backgroundColor:ss,outlineColor:ss,fill:ss,stroke:ss,borderColor:ss,borderTopColor:ss,borderRightColor:ss,borderBottomColor:ss,borderLeftColor:ss,filter:ox,WebkitFilter:ox},IE=r=>G4[r];function BE(r,e){let t=IE(r);return t!==ox&&(t=Ni),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Y4=new Set(["auto","none","0"]);function K4(r,e,t){let n=0,i;for(;n<r.length&&!i;){const a=r[n];typeof a=="string"&&!Y4.has(a)&&ql(a).values.length&&(i=r[n]),n++}if(i&&t)for(const a of e)r[a]=BE(t,i)}class X4 extends S0{constructor(e,t,n,i,a){super(e,t,n,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),y0(h))){const c=PE(h,t.current);c!==void 0&&(e[u]=c),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!ME.has(n)||e.length!==2)return;const[i,a]=e,o=iw(i),l=iw(a);if(o!==l)if(tw(o)&&tw(l))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else na[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let i=0;i<e.length;i++)(e[i]===null||H4(e[i]))&&n.push(i);n.length&&K4(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=na[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const a=n.length-1,o=n[a];n[a]=na[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function Q4(r,e,t){if(r instanceof EventTarget)return[r];if(typeof r=="string"){let n=document;const i=t?.[r]??n.querySelectorAll(r);return i?Array.from(i):[]}return Array.from(r)}const FE=(r,e)=>e&&typeof r=="number"?e.transform(r):r;function zE(r){return sE(r)&&"offsetHeight"in r}const ow=30,J4=r=>!isNaN(parseFloat(r));class Z4{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const i=sr.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=sr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=J4(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new m0);const n=this.events[e].add(t);return e==="change"?()=>{n(),Pt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=sr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>ow)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,ow);return nE(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function go(r,e){return new Z4(r,e)}const{schedule:C0}=pE(queueMicrotask,!1),Fr={x:!1,y:!1};function UE(){return Fr.x||Fr.y}function e6(r){return r==="x"||r==="y"?Fr[r]?null:(Fr[r]=!0,()=>{Fr[r]=!1}):Fr.x||Fr.y?null:(Fr.x=Fr.y=!0,()=>{Fr.x=Fr.y=!1})}function HE(r,e){const t=Q4(r),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[t,i,()=>n.abort()]}function lw(r){return!(r.pointerType==="touch"||UE())}function t6(r,e,t={}){const[n,i,a]=HE(r,t),o=l=>{if(!lw(l))return;const{target:u}=l,h=e(u,l);if(typeof h!="function"||!u)return;const c=f=>{lw(f)&&(h(f),u.removeEventListener("pointerleave",c))};u.addEventListener("pointerleave",c,i)};return n.forEach(l=>{l.addEventListener("pointerenter",o,i)}),a}const VE=(r,e)=>e?r===e?!0:VE(r,e.parentElement):!1,T0=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,s6=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function r6(r){return s6.has(r.tagName)||r.tabIndex!==-1}const su=new WeakSet;function cw(r){return e=>{e.key==="Enter"&&r(e)}}function wm(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const n6=(r,e)=>{const t=r.currentTarget;if(!t)return;const n=cw(()=>{if(su.has(t))return;wm(t,"down");const i=cw(()=>{wm(t,"up")}),a=()=>wm(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function dw(r){return T0(r)&&!UE()}function i6(r,e,t={}){const[n,i,a]=HE(r,t),o=l=>{const u=l.currentTarget;if(!dw(l))return;su.add(u);const h=e(u,l),c=(g,v)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),su.has(u)&&su.delete(u),dw(g)&&typeof h=="function"&&h(g,{success:v})},f=g=>{c(g,u===window||u===document||t.useGlobalTarget||VE(u,g.target))},m=g=>{c(g,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return n.forEach(l=>{(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,i),zE(l)&&(l.addEventListener("focus",h=>n6(h,i)),!r6(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function qE(r){return sE(r)&&"ownerSVGElement"in r}function a6(r){return qE(r)&&r.tagName==="svg"}const Ps=r=>!!(r&&r.getVelocity),o6=[...LE,ss,Ni],l6=r=>o6.find(OE(r)),R0=R.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function uw(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function c6(...r){return e=>{let t=!1;const n=r.map(i=>{const a=uw(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():uw(r[i],null)}}}}function d6(...r){return R.useCallback(c6(...r),r)}class u6 extends R.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=t.offsetParent,i=zE(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h6({children:r,isPresent:e,anchorX:t,root:n}){const i=R.useId(),a=R.useRef(null),o=R.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=R.useContext(R0),u=d6(a,r?.ref);return R.useInsertionEffect(()=>{const{width:h,height:c,top:f,left:m,right:g}=o.current;if(e||!a.current||!h||!c)return;const v=t==="left"?`left: ${m}`:`right: ${g}`;a.current.dataset.motionPopId=i;const y=document.createElement("style");l&&(y.nonce=l);const x=n??document.head;return x.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${c}px !important;
            ${v}px !important;
            top: ${f}px !important;
          }
        `),()=>{x.contains(y)&&x.removeChild(y)}},[e]),s.jsx(u6,{isPresent:e,childRef:a,sizeRef:o,children:R.cloneElement(r,{ref:u})})}const f6=({children:r,initial:e,isPresent:t,onExitComplete:n,custom:i,presenceAffectsLayout:a,mode:o,anchorX:l,root:u})=>{const h=l0(m6),c=R.useId();let f=!0,m=R.useMemo(()=>(f=!1,{id:c,initial:e,isPresent:t,custom:i,onExitComplete:g=>{h.set(g,!0);for(const v of h.values())if(!v)return;n&&n()},register:g=>(h.set(g,!1),()=>h.delete(g))}),[t,h,n]);return a&&f&&(m={...m}),R.useMemo(()=>{h.forEach((g,v)=>h.set(v,!1))},[t]),R.useEffect(()=>{!t&&!h.size&&n&&n()},[t]),o==="popLayout"&&(r=s.jsx(h6,{isPresent:t,anchorX:l,root:u,children:r})),s.jsx(Zu.Provider,{value:m,children:r})};function m6(){return new Map}function $E(r=!0){const e=R.useContext(Zu);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:i}=e,a=R.useId();R.useEffect(()=>{if(r)return i(a)},[r]);const o=R.useCallback(()=>r&&n&&n(a),[a,n,r]);return!t&&n?[!1,o]:[!0]}const Ld=r=>r.key||"";function hw(r){const e=[];return R.Children.forEach(r,t=>{R.isValidElement(t)&&e.push(t)}),e}const zs=({children:r,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:u})=>{const[h,c]=$E(o),f=R.useMemo(()=>hw(r),[r]),m=o&&!h?[]:f.map(Ld),g=R.useRef(!0),v=R.useRef(f),y=l0(()=>new Map),[x,b]=R.useState(f),[w,k]=R.useState(f);eE(()=>{g.current=!1,v.current=f;for(let S=0;S<w.length;S++){const A=Ld(w[S]);m.includes(A)?y.delete(A):y.get(A)!==!0&&y.set(A,!1)}},[w,m.length,m.join("-")]);const N=[];if(f!==x){let S=[...f];for(let A=0;A<w.length;A++){const C=w[A],I=Ld(C);m.includes(I)||(S.splice(A,0,C),N.push(C))}return a==="wait"&&N.length&&(S=N),k(hw(S)),b(f),null}const{forceRender:E}=R.useContext(o0);return s.jsx(s.Fragment,{children:w.map(S=>{const A=Ld(S),C=o&&!h?!1:f===w||m.includes(A),I=()=>{if(y.has(A))y.set(A,!0);else return;let L=!0;y.forEach(M=>{M||(L=!1)}),L&&(E?.(),k(v.current),o&&c?.(),n&&n())};return s.jsx(f6,{isPresent:C,initial:!g.current||t?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,root:u,onExitComplete:C?void 0:I,anchorX:l,children:S},A)})})},WE=R.createContext({strict:!1}),fw={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},xo={};for(const r in fw)xo[r]={isEnabled:e=>fw[r].some(t=>!!e[t])};function p6(r){for(const e in r)xo[e]={...xo[e],...r[e]}}const g6=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function wu(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||g6.has(r)}let GE=r=>!wu(r);function x6(r){typeof r=="function"&&(GE=e=>e.startsWith("on")?!wu(e):r(e))}try{x6(require("@emotion/is-prop-valid").default)}catch{}function y6(r,e,t){const n={};for(const i in r)i==="values"&&typeof r.values=="object"||(GE(i)||t===!0&&wu(i)||!e&&!wu(i)||r.draggable&&i.startsWith("onDrag"))&&(n[i]=r[i]);return n}const eh=R.createContext({});function th(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}function $l(r){return typeof r=="string"||Array.isArray(r)}const D0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],P0=["initial",...D0];function sh(r){return th(r.animate)||P0.some(e=>$l(r[e]))}function YE(r){return!!(sh(r)||r.variants)}function v6(r,e){if(sh(r)){const{initial:t,animate:n}=r;return{initial:t===!1||$l(t)?t:void 0,animate:$l(n)?n:void 0}}return r.inherit!==!1?e:{}}function b6(r){const{initial:e,animate:t}=v6(r,R.useContext(eh));return R.useMemo(()=>({initial:e,animate:t}),[mw(e),mw(t)])}function mw(r){return Array.isArray(r)?r.join(" "):r}const Wl={};function j6(r){for(const e in r)Wl[e]=r[e],x0(e)&&(Wl[e].isCSSVariable=!0)}function KE(r,{layout:e,layoutId:t}){return _o.has(r)||r.startsWith("origin")||(e||t!==void 0)&&(!!Wl[r]||r==="opacity")}const w6={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},N6=So.length;function k6(r,e,t){let n="",i=!0;for(let a=0;a<N6;a++){const o=So[a],l=r[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const h=FE(l,A0[o]);if(!u){i=!1;const c=w6[o]||o;n+=`${c}(${h}) `}t&&(e[o]=h)}}return n=n.trim(),t?n=t(e,i?"":n):i&&(n="none"),n}function M0(r,e,t){const{style:n,vars:i,transformOrigin:a}=r;let o=!1,l=!1;for(const u in e){const h=e[u];if(_o.has(u)){o=!0;continue}else if(x0(u)){i[u]=h;continue}else{const c=FE(h,A0[u]);u.startsWith("origin")?(l=!0,a[u]=c):n[u]=c}}if(e.transform||(o||t?n.transform=k6(e,r.transform,t):n.transform&&(n.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:c=0}=a;n.transformOrigin=`${u} ${h} ${c}`}}const O0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function XE(r,e,t){for(const n in e)!Ps(e[n])&&!KE(n,t)&&(r[n]=e[n])}function E6({transformTemplate:r},e){return R.useMemo(()=>{const t=O0();return M0(t,e,r),Object.assign({},t.vars,t.style)},[e])}function S6(r,e){const t=r.style||{},n={};return XE(n,t,r),Object.assign(n,E6(r,e)),n}function _6(r,e){const t={},n=S6(r,e);return r.drag&&r.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(t.tabIndex=0),t.style=n,t}const A6={offset:"stroke-dashoffset",array:"stroke-dasharray"},C6={offset:"strokeDashoffset",array:"strokeDasharray"};function T6(r,e,t=1,n=0,i=!0){r.pathLength=1;const a=i?A6:C6;r[a.offset]=He.transform(-n);const o=He.transform(e),l=He.transform(t);r[a.array]=`${o} ${l}`}function QE(r,{attrX:e,attrY:t,attrScale:n,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...l},u,h,c){if(M0(r,l,h),u){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:f,style:m}=r;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=c?.transformBox??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),t!==void 0&&(f.y=t),n!==void 0&&(f.scale=n),i!==void 0&&T6(f,i,a,o,!1)}const JE=()=>({...O0(),attrs:{}}),ZE=r=>typeof r=="string"&&r.toLowerCase()==="svg";function R6(r,e,t,n){const i=R.useMemo(()=>{const a=JE();return QE(a,e,ZE(n),r.transformTemplate,r.style),{...a.attrs,style:{...a.style}}},[e]);if(r.style){const a={};XE(a,r.style,r),i.style={...a,...i.style}}return i}const D6=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function L0(r){return typeof r!="string"||r.includes("-")?!1:!!(D6.indexOf(r)>-1||/[A-Z]/u.test(r))}function P6(r,e,t,{latestValues:n},i,a=!1){const l=(L0(r)?R6:_6)(e,n,i,r),u=y6(e,typeof r=="string",a),h=r!==R.Fragment?{...u,...l,ref:t}:{},{children:c}=e,f=R.useMemo(()=>Ps(c)?c.get():c,[c]);return R.createElement(r,{...h,children:f})}function pw(r){const e=[{},{}];return r?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function I0(r,e,t,n){if(typeof e=="function"){const[i,a]=pw(n);e=e(t!==void 0?t:r.custom,i,a)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[i,a]=pw(n);e=e(t!==void 0?t:r.custom,i,a)}return e}function ru(r){return Ps(r)?r.get():r}function M6({scrapeMotionValuesFromProps:r,createRenderState:e},t,n,i){return{latestValues:O6(t,n,i,r),renderState:e()}}function O6(r,e,t,n){const i={},a=n(r,{});for(const m in a)i[m]=ru(a[m]);let{initial:o,animate:l}=r;const u=sh(r),h=YE(r);e&&h&&!u&&r.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let c=t?t.initial===!1:!1;c=c||o===!1;const f=c?l:o;if(f&&typeof f!="boolean"&&!th(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const v=I0(r,m[g]);if(v){const{transitionEnd:y,transition:x,...b}=v;for(const w in b){let k=b[w];if(Array.isArray(k)){const N=c?k.length-1:0;k=k[N]}k!==null&&(i[w]=k)}for(const w in y)i[w]=y[w]}}}return i}const eS=r=>(e,t)=>{const n=R.useContext(eh),i=R.useContext(Zu),a=()=>M6(r,e,n,i);return t?a():l0(a)};function B0(r,e,t){const{style:n}=r,i={};for(const a in n)(Ps(n[a])||e.style&&Ps(e.style[a])||KE(a,r)||t?.getValue(a)?.liveStyle!==void 0)&&(i[a]=n[a]);return i}const L6=eS({scrapeMotionValuesFromProps:B0,createRenderState:O0});function tS(r,e,t){const n=B0(r,e,t);for(const i in r)if(Ps(r[i])||Ps(e[i])){const a=So.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[a]=r[i]}return n}const I6=eS({scrapeMotionValuesFromProps:tS,createRenderState:JE}),B6=Symbol.for("motionComponentSymbol");function Qa(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function F6(r,e,t){return R.useCallback(n=>{n&&r.onMount&&r.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):Qa(t)&&(t.current=n))},[e])}const F0=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),z6="framerAppearId",sS="data-"+F0(z6),rS=R.createContext({});function U6(r,e,t,n,i){const{visualElement:a}=R.useContext(eh),o=R.useContext(WE),l=R.useContext(Zu),u=R.useContext(R0).reducedMotion,h=R.useRef(null);n=n||o.renderer,!h.current&&n&&(h.current=n(r,{visualState:e,parent:a,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:u}));const c=h.current,f=R.useContext(rS);c&&!c.projection&&i&&(c.type==="html"||c.type==="svg")&&H6(h.current,t,i,f);const m=R.useRef(!1);R.useInsertionEffect(()=>{c&&m.current&&c.update(t,l)});const g=t[sS],v=R.useRef(!!g&&!window.MotionHandoffIsComplete?.(g)&&window.MotionHasOptimisedAnimation?.(g));return eE(()=>{c&&(m.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),v.current&&c.animationState&&c.animationState.animateChanges())}),R.useEffect(()=>{c&&(!v.current&&c.animationState&&c.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(g)}),v.current=!1),c.enteringChildren=void 0)}),c}function H6(r,e,t,n){const{layoutId:i,layout:a,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h,layoutCrossfade:c}=e;r.projection=new t(r.latestValues,e["data-framer-portal-id"]?void 0:nS(r.parent)),r.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||l&&Qa(l),visualElement:r,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:c,layoutScroll:u,layoutRoot:h})}function nS(r){if(r)return r.options.allowProjection!==!1?r.projection:nS(r.parent)}function Nm(r,{forwardMotionProps:e=!1}={},t,n){t&&p6(t);const i=L0(r)?I6:L6;function a(l,u){let h;const c={...R.useContext(R0),...l,layoutId:V6(l)},{isStatic:f}=c,m=b6(l),g=i(l,f);if(!f&&c0){q6();const v=$6(c);h=v.MeasureLayout,m.visualElement=U6(r,g,c,n,v.ProjectionNode)}return s.jsxs(eh.Provider,{value:m,children:[h&&m.visualElement?s.jsx(h,{visualElement:m.visualElement,...c}):null,P6(r,l,F6(g,m.visualElement,u),g,f,e)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${r.displayName??r.name??""})`}`;const o=R.forwardRef(a);return o[B6]=r,o}function V6({layoutId:r}){const e=R.useContext(o0).id;return e&&r!==void 0?e+"-"+r:r}function q6(r,e){R.useContext(WE).strict}function $6(r){const{drag:e,layout:t}=xo;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(r)||t?.isEnabled(r)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function W6(r,e){if(typeof Proxy>"u")return Nm;const t=new Map,n=(a,o)=>Nm(a,o,r,e),i=(a,o)=>n(a,o);return new Proxy(i,{get:(a,o)=>o==="create"?n:(t.has(o)||t.set(o,Nm(o,void 0,r,e)),t.get(o))})}function iS({top:r,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:r,max:n}}}function G6({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function Y6(r,e){if(!e)return r;const t=e({x:r.left,y:r.top}),n=e({x:r.right,y:r.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function km(r){return r===void 0||r===1}function lx({scale:r,scaleX:e,scaleY:t}){return!km(r)||!km(e)||!km(t)}function Gi(r){return lx(r)||aS(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function aS(r){return gw(r.x)||gw(r.y)}function gw(r){return r&&r!=="0%"}function Nu(r,e,t){const n=r-t,i=e*n;return t+i}function xw(r,e,t,n,i){return i!==void 0&&(r=Nu(r,i,n)),Nu(r,t,n)+e}function cx(r,e=0,t=1,n,i){r.min=xw(r.min,e,t,n,i),r.max=xw(r.max,e,t,n,i)}function oS(r,{x:e,y:t}){cx(r.x,e.translate,e.scale,e.originPoint),cx(r.y,t.translate,t.scale,t.originPoint)}const yw=.999999999999,vw=1.0000000000001;function K6(r,e,t,n=!1){const i=t.length;if(!i)return;e.x=e.y=1;let a,o;for(let l=0;l<i;l++){a=t[l],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Za(r,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,oS(r,o)),n&&Gi(a.latestValues)&&Za(r,a.latestValues))}e.x<vw&&e.x>yw&&(e.x=1),e.y<vw&&e.y>yw&&(e.y=1)}function Ja(r,e){r.min=r.min+e,r.max=r.max+e}function bw(r,e,t,n,i=.5){const a=Bt(r.min,r.max,i);cx(r,e,t,a,n)}function Za(r,e){bw(r.x,e.x,e.scaleX,e.scale,e.originX),bw(r.y,e.y,e.scaleY,e.scale,e.originY)}function lS(r,e){return iS(Y6(r.getBoundingClientRect(),e))}function X6(r,e,t){const n=lS(r,t),{scroll:i}=e;return i&&(Ja(n.x,i.offset.x),Ja(n.y,i.offset.y)),n}const jw=()=>({translate:0,scale:1,origin:0,originPoint:0}),eo=()=>({x:jw(),y:jw()}),ww=()=>({min:0,max:0}),Kt=()=>({x:ww(),y:ww()}),dx={current:null},cS={current:!1};function Q6(){if(cS.current=!0,!!c0)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>dx.current=r.matches;r.addEventListener("change",e),e()}else dx.current=!1}const J6=new WeakMap;function Z6(r,e,t){for(const n in e){const i=e[n],a=t[n];if(Ps(i))r.addValue(n,i);else if(Ps(a))r.addValue(n,go(i,{owner:r}));else if(a!==i)if(r.hasValue(n)){const o=r.getValue(n);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=r.getStaticValue(n);r.addValue(n,go(o!==void 0?o:i,{owner:r}))}}for(const n in t)e[n]===void 0&&r.removeValue(n);return e}const Nw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class e3{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=S0,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=sr.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Pt.render(this.render,!1,!0))};const{latestValues:u,renderState:h}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=sh(t),this.isVariantNode=YE(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in f){const g=f[m];u[m]!==void 0&&Ps(g)&&g.set(u[m])}}mount(e){this.current=e,J6.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),cS.current||Q6(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:dx.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),wi(this.notifyUpdate),wi(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=_o.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Pt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in xo){const t=xo[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Kt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Nw.length;n++){const i=Nw[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Z6(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=go(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(tE(n)||rE(n))?n=parseFloat(n):!l6(n)&&Ni.test(t)&&(n=BE(e,t)),this.setBaseTarget(e,Ps(n)?n.get():n)),Ps(n)?n.get():n}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if(typeof t=="string"||typeof t=="object"){const a=I0(this.props,t,this.presenceContext?.custom);a&&(n=a[e])}if(t&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ps(i)?i:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new m0),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){C0.render(this.render)}}class dS extends e3{constructor(){super(...arguments),this.KeyframeResolver=X4}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ps(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function uS(r,{style:e,vars:t},n,i){const a=r.style;let o;for(o in e)a[o]=e[o];i?.applyProjectionStyles(a,n);for(o in t)a.setProperty(o,t[o])}function t3(r){return window.getComputedStyle(r)}class s3 extends dS{constructor(){super(...arguments),this.type="html",this.renderInstance=uS}readValueFromInstance(e,t){if(_o.has(t))return this.projection?.isProjecting?tx(t):p4(e,t);{const n=t3(e),i=(x0(t)?n.getPropertyValue(t):n[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return lS(e,t)}build(e,t,n){M0(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return B0(e,t,n)}}const hS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function r3(r,e,t,n){uS(r,e,void 0,n);for(const i in e.attrs)r.setAttribute(hS.has(i)?i:F0(i),e.attrs[i])}class n3 extends dS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Kt}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(_o.has(t)){const n=IE(t);return n&&n.default||0}return t=hS.has(t)?t:F0(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return tS(e,t,n)}build(e,t,n){QE(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,i){r3(e,t,n,i)}mount(e){this.isSVGTag=ZE(e.tagName),super.mount(e)}}const i3=(r,e)=>L0(r)?new n3(e):new s3(e,{allowProjection:r!==R.Fragment});function io(r,e,t){const n=r.getProps();return I0(n,e,t!==void 0?t:n.custom,r)}const ux=r=>Array.isArray(r);function a3(r,e,t){r.hasValue(e)?r.getValue(e).set(t):r.addValue(e,go(t))}function o3(r){return ux(r)?r[r.length-1]||0:r}function l3(r,e){const t=io(r,e);let{transitionEnd:n={},transition:i={},...a}=t||{};a={...a,...n};for(const o in a){const l=o3(a[o]);a3(r,o,l)}}function c3(r){return!!(Ps(r)&&r.add)}function hx(r,e){const t=r.getValue("willChange");if(c3(t))return t.add(e);if(!t&&Ln.WillChange){const n=new Ln.WillChange("auto");r.addValue("willChange",n),n.add(e)}}function fS(r){return r.props[sS]}const d3=r=>r!==null;function u3(r,{repeat:e,repeatType:t="loop"},n){const i=r.filter(d3),a=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[a]}const h3={type:"spring",stiffness:500,damping:25,restSpeed:10},f3=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),m3={type:"keyframes",duration:.8},p3={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},g3=(r,{keyframes:e})=>e.length>2?m3:_o.has(r)?r.startsWith("scale")?f3(e[1]):h3:p3;function x3({when:r,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:l,from:u,elapsed:h,...c}){return!!Object.keys(c).length}const z0=(r,e,t,n={},i,a)=>o=>{const l=_0(n,r)||{},u=l.delay||n.delay||0;let{elapsed:h=0}=n;h=h-un(u);const c={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-h,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:r,motionValue:e,element:a?void 0:i};x3(l)||Object.assign(c,g3(r,c)),c.duration&&(c.duration=un(c.duration)),c.repeatDelay&&(c.repeatDelay=un(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let f=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(ax(c),c.delay===0&&(f=!0)),(Ln.instantAnimations||Ln.skipAnimations)&&(f=!0,ax(c),c.delay=0),c.allowFlatten=!l.type&&!l.ease,f&&!a&&e.get()!==void 0){const m=u3(c.keyframes,l);if(m!==void 0){Pt.update(()=>{c.onUpdate(m),c.onComplete()});return}}return l.isSync?new E0(c):new B4(c)};function y3({protectedKeys:r,needsAnimating:e},t){const n=r.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function mS(r,e,{delay:t=0,transitionOverride:n,type:i}={}){let{transition:a=r.getDefaultTransition(),transitionEnd:o,...l}=e;n&&(a=n);const u=[],h=i&&r.animationState&&r.animationState.getState()[i];for(const c in l){const f=r.getValue(c,r.latestValues[c]??null),m=l[c];if(m===void 0||h&&y3(h,c))continue;const g={delay:t,..._0(a||{},c)},v=f.get();if(v!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===v&&!g.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const b=fS(r);if(b){const w=window.MotionHandoffAnimation(b,c,Pt);w!==null&&(g.startTime=w,y=!0)}}hx(r,c),f.start(z0(c,f,m,r.shouldReduceMotion&&ME.has(c)?{type:!1}:g,r,y));const x=f.animation;x&&u.push(x)}return o&&Promise.all(u).then(()=>{Pt.update(()=>{o&&l3(r,o)})}),u}function pS(r,e,t,n=0,i=1){const a=Array.from(r).sort((h,c)=>h.sortNodePosition(c)).indexOf(e),o=r.size,l=(o-1)*n;return typeof t=="function"?t(a,o):i===1?a*n:l-a*n}function fx(r,e,t={}){const n=io(r,e,t.type==="exit"?r.presenceContext?.custom:void 0);let{transition:i=r.getDefaultTransition()||{}}=n||{};t.transitionOverride&&(i=t.transitionOverride);const a=n?()=>Promise.all(mS(r,n,t)):()=>Promise.resolve(),o=r.variantChildren&&r.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:c,staggerDirection:f}=i;return v3(r,e,u,h,c,f,t)}:()=>Promise.resolve(),{when:l}=i;if(l){const[u,h]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>h())}else return Promise.all([a(),o(t.delay)])}function v3(r,e,t=0,n=0,i=0,a=1,o){const l=[];for(const u of r.variantChildren)u.notify("AnimationStart",e),l.push(fx(u,e,{...o,delay:t+(typeof n=="function"?0:n)+pS(r.variantChildren,u,n,i,a)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(l)}function b3(r,e,t={}){r.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(a=>fx(r,a,t));n=Promise.all(i)}else if(typeof e=="string")n=fx(r,e,t);else{const i=typeof e=="function"?io(r,e,t.custom):e;n=Promise.all(mS(r,i,t))}return n.then(()=>{r.notify("AnimationComplete",e)})}function gS(r,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==r.length)return!1;for(let n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}const j3=P0.length;function xS(r){if(!r)return;if(!r.isControllingVariants){const t=r.parent?xS(r.parent)||{}:{};return r.props.initial!==void 0&&(t.initial=r.props.initial),t}const e={};for(let t=0;t<j3;t++){const n=P0[t],i=r.props[n];($l(i)||i===!1)&&(e[n]=i)}return e}const w3=[...D0].reverse(),N3=D0.length;function k3(r){return e=>Promise.all(e.map(({animation:t,options:n})=>b3(r,t,n)))}function E3(r){let e=k3(r),t=kw(),n=!0;const i=u=>(h,c)=>{const f=io(r,c,u==="exit"?r.presenceContext?.custom:void 0);if(f){const{transition:m,transitionEnd:g,...v}=f;h={...h,...v,...g}}return h};function a(u){e=u(r)}function o(u){const{props:h}=r,c=xS(r.parent)||{},f=[],m=new Set;let g={},v=1/0;for(let x=0;x<N3;x++){const b=w3[x],w=t[b],k=h[b]!==void 0?h[b]:c[b],N=$l(k),E=b===u?w.isActive:null;E===!1&&(v=x);let S=k===c[b]&&k!==h[b]&&N;if(S&&n&&r.manuallyAnimateOnMount&&(S=!1),w.protectedKeys={...g},!w.isActive&&E===null||!k&&!w.prevProp||th(k)||typeof k=="boolean")continue;const A=S3(w.prevProp,k);let C=A||b===u&&w.isActive&&!S&&N||x>v&&N,I=!1;const L=Array.isArray(k)?k:[k];let M=L.reduce(i(b),{});E===!1&&(M={});const{prevResolvedValues:D={}}=w,F={...D,...M},q=G=>{C=!0,m.has(G)&&(I=!0,m.delete(G)),w.needsAnimating[G]=!0;const Y=r.getValue(G);Y&&(Y.liveStyle=!1)};for(const G in F){const Y=M[G],H=D[G];if(g.hasOwnProperty(G))continue;let V=!1;ux(Y)&&ux(H)?V=!gS(Y,H):V=Y!==H,V?Y!=null?q(G):m.add(G):Y!==void 0&&m.has(G)?q(G):w.protectedKeys[G]=!0}w.prevProp=k,w.prevResolvedValues=M,w.isActive&&(g={...g,...M}),n&&r.blockInitialAnimation&&(C=!1);const B=S&&A;C&&(!B||I)&&f.push(...L.map(G=>{const Y={type:b};if(typeof G=="string"&&n&&!B&&r.manuallyAnimateOnMount&&r.parent){const{parent:H}=r,V=io(H,G);if(H.enteringChildren&&V){const{delayChildren:O}=V.transition||{};Y.delay=pS(H.enteringChildren,r,O)}}return{animation:G,options:Y}}))}if(m.size){const x={};if(typeof h.initial!="boolean"){const b=io(r,Array.isArray(h.initial)?h.initial[0]:h.initial);b&&b.transition&&(x.transition=b.transition)}m.forEach(b=>{const w=r.getBaseTarget(b),k=r.getValue(b);k&&(k.liveStyle=!0),x[b]=w??null}),f.push({animation:x})}let y=!!f.length;return n&&(h.initial===!1||h.initial===h.animate)&&!r.manuallyAnimateOnMount&&(y=!1),n=!1,y?e(f):Promise.resolve()}function l(u,h){if(t[u].isActive===h)return Promise.resolve();r.variantChildren?.forEach(f=>f.animationState?.setActive(u,h)),t[u].isActive=h;const c=o(u);for(const f in t)t[f].protectedKeys={};return c}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>t,reset:()=>{t=kw()}}}function S3(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!gS(e,r):!1}function Wi(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function kw(){return{animate:Wi(!0),whileInView:Wi(),whileHover:Wi(),whileTap:Wi(),whileDrag:Wi(),whileFocus:Wi(),exit:Wi()}}class Ci{constructor(e){this.isMounted=!1,this.node=e}update(){}}class _3 extends Ci{constructor(e){super(e),e.animationState||(e.animationState=E3(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();th(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let A3=0;class C3 extends Ci{constructor(){super(...arguments),this.id=A3++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const T3={animation:{Feature:_3},exit:{Feature:C3}};function Gl(r,e,t,n={passive:!0}){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t)}function ic(r){return{point:{x:r.pageX,y:r.pageY}}}const R3=r=>e=>T0(e)&&r(e,ic(e));function Tl(r,e,t,n){return Gl(r,e,R3(t),n)}const yS=1e-4,D3=1-yS,P3=1+yS,vS=.01,M3=0-vS,O3=0+vS;function Us(r){return r.max-r.min}function L3(r,e,t){return Math.abs(r-e)<=t}function Ew(r,e,t,n=.5){r.origin=n,r.originPoint=Bt(e.min,e.max,r.origin),r.scale=Us(t)/Us(e),r.translate=Bt(t.min,t.max,r.origin)-r.originPoint,(r.scale>=D3&&r.scale<=P3||isNaN(r.scale))&&(r.scale=1),(r.translate>=M3&&r.translate<=O3||isNaN(r.translate))&&(r.translate=0)}function Rl(r,e,t,n){Ew(r.x,e.x,t.x,n?n.originX:void 0),Ew(r.y,e.y,t.y,n?n.originY:void 0)}function Sw(r,e,t){r.min=t.min+e.min,r.max=r.min+Us(e)}function I3(r,e,t){Sw(r.x,e.x,t.x),Sw(r.y,e.y,t.y)}function _w(r,e,t){r.min=e.min-t.min,r.max=r.min+Us(e)}function Dl(r,e,t){_w(r.x,e.x,t.x),_w(r.y,e.y,t.y)}function Nr(r){return[r("x"),r("y")]}const bS=({current:r})=>r?r.ownerDocument.defaultView:null,Aw=(r,e)=>Math.abs(r-e);function B3(r,e){const t=Aw(r.x,e.x),n=Aw(r.y,e.y);return Math.sqrt(t**2+n**2)}class jS{constructor(e,t,{transformPagePoint:n,contextWindow:i=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Sm(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,v=B3(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!g&&!v)return;const{point:y}=m,{timestamp:x}=Ns;this.history.push({...y,timestamp:x});const{onStart:b,onMove:w}=this.handlers;g||(b&&b(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,m)},this.handlePointerMove=(m,g)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Em(g,this.transformPagePoint),Pt.update(this.updatePoint,!0)},this.handlePointerUp=(m,g)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=Sm(m.type==="pointercancel"?this.lastMoveEventInfo:Em(g,this.transformPagePoint),this.history);this.startEvent&&v&&v(m,b),y&&y(m,b)},!T0(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=n,this.distanceThreshold=o,this.contextWindow=i||window;const l=ic(e),u=Em(l,this.transformPagePoint),{point:h}=u,{timestamp:c}=Ns;this.history=[{...h,timestamp:c}];const{onSessionStart:f}=t;f&&f(e,Sm(u,this.history)),this.removeListeners=sc(Tl(this.contextWindow,"pointermove",this.handlePointerMove),Tl(this.contextWindow,"pointerup",this.handlePointerUp),Tl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wi(this.updatePoint)}}function Em(r,e){return e?{point:e(r.point)}:r}function Cw(r,e){return{x:r.x-e.x,y:r.y-e.y}}function Sm({point:r},e){return{point:r,delta:Cw(r,wS(e)),offset:Cw(r,F3(e)),velocity:z3(e,.1)}}function F3(r){return r[0]}function wS(r){return r[r.length-1]}function z3(r,e){if(r.length<2)return{x:0,y:0};let t=r.length-1,n=null;const i=wS(r);for(;t>=0&&(n=r[t],!(i.timestamp-n.timestamp>un(e)));)t--;if(!n)return{x:0,y:0};const a=Sr(i.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const o={x:(i.x-n.x)/a,y:(i.y-n.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function U3(r,{min:e,max:t},n){return e!==void 0&&r<e?r=n?Bt(e,r,n.min):Math.max(r,e):t!==void 0&&r>t&&(r=n?Bt(t,r,n.max):Math.min(r,t)),r}function Tw(r,e,t){return{min:e!==void 0?r.min+e:void 0,max:t!==void 0?r.max+t-(r.max-r.min):void 0}}function H3(r,{top:e,left:t,bottom:n,right:i}){return{x:Tw(r.x,t,i),y:Tw(r.y,e,n)}}function Rw(r,e){let t=e.min-r.min,n=e.max-r.max;return e.max-e.min<r.max-r.min&&([t,n]=[n,t]),{min:t,max:n}}function V3(r,e){return{x:Rw(r.x,e.x),y:Rw(r.y,e.y)}}function q3(r,e){let t=.5;const n=Us(r),i=Us(e);return i>n?t=Hl(e.min,e.max-n,r.min):n>i&&(t=Hl(r.min,r.max-i,e.min)),On(0,1,t)}function $3(r,e){const t={};return e.min!==void 0&&(t.min=e.min-r.min),e.max!==void 0&&(t.max=e.max-r.min),t}const mx=.35;function W3(r=mx){return r===!1?r=0:r===!0&&(r=mx),{x:Dw(r,"left","right"),y:Dw(r,"top","bottom")}}function Dw(r,e,t){return{min:Pw(r,e),max:Pw(r,t)}}function Pw(r,e){return typeof r=="number"?r:r[e]||0}const G3=new WeakMap;class Y3{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Kt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:n}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ic(f).point)},o=(f,m)=>{const{drag:g,dragPropagation:v,onDragStart:y}=this.getProps();if(g&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=e6(g),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Nr(b=>{let w=this.getAxisMotionValue(b).get()||0;if(hn.test(w)){const{projection:k}=this.visualElement;if(k&&k.layout){const N=k.layout.layoutBox[b];N&&(w=Us(N)*(parseFloat(w)/100))}}this.originPoint[b]=w}),y&&Pt.postRender(()=>y(f,m)),hx(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},l=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m;const{dragPropagation:g,dragDirectionLock:v,onDirectionLock:y,onDrag:x}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:b}=m;if(v&&this.currentDirection===null){this.currentDirection=K3(b),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",m.point,b),this.updateAxis("y",m.point,b),this.visualElement.render(),x&&x(f,m)},u=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m,this.stop(f,m),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>Nr(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:c}=this.getProps();this.panSession=new jS(e,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:u,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:n,contextWindow:bS(this.visualElement)})}stop(e,t){const n=e||this.latestPointerEvent,i=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!i||!n)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&Pt.postRender(()=>l(n,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!Id(e,i,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=U3(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;e&&Qa(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=H3(n.layoutBox,e):this.constraints=!1,this.elastic=W3(t),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Nr(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=$3(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Qa(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const a=X6(n,i.root,this.visualElement.getTransformPagePoint());let o=V3(i.layout.layoutBox,a);if(t){const l=t(G6(o));this.hasMutatedConstraints=!!l,l&&(o=iS(l))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Nr(c=>{if(!Id(c,t,this.currentDirection))return;let f=u&&u[c]||{};o&&(f={min:0,max:0});const m=i?200:1e6,g=i?40:1e7,v={type:"inertia",velocity:n?e[c]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(c,v)});return Promise.all(h).then(l)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return hx(this.visualElement,e),n.start(z0(e,n,0,t,this.visualElement,!1))}stopAnimation(){Nr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Nr(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Nr(t=>{const{drag:n}=this.getProps();if(!Id(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,a=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:l}=i.layout.layoutBox[t];a.set(e[t]-Bt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Qa(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Nr(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();i[o]=q3({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Nr(o=>{if(!Id(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Bt(u,h,i[o]))})}addListeners(){if(!this.visualElement.current)return;G3.set(this.visualElement,this);const e=this.visualElement.current,t=Tl(e,"pointerdown",u=>{const{drag:h,dragListener:c=!0}=this.getProps();h&&c&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();Qa(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,a=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Pt.read(n);const o=Gl(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Nr(c=>{const f=this.getAxisMotionValue(c);f&&(this.originPoint[c]+=u[c].translate,f.set(f.get()+u[c].translate))}),this.visualElement.render())}));return()=>{o(),t(),a(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:a=!1,dragElastic:o=mx,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function Id(r,e,t){return(e===!0||e===r)&&(t===null||t===r)}function K3(r,e=10){let t=null;return Math.abs(r.y)>e?t="y":Math.abs(r.x)>e&&(t="x"),t}class X3 extends Ci{constructor(e){super(e),this.removeGroupControls=Ar,this.removeListeners=Ar,this.controls=new Y3(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ar}unmount(){this.removeGroupControls(),this.removeListeners()}}const Mw=r=>(e,t)=>{r&&Pt.postRender(()=>r(e,t))};class Q3 extends Ci{constructor(){super(...arguments),this.removePointerDownListener=Ar}onPointerDown(e){this.session=new jS(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:bS(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:Mw(e),onStart:Mw(t),onMove:n,onEnd:(a,o)=>{delete this.session,i&&Pt.postRender(()=>i(a,o))}}}mount(){this.removePointerDownListener=Tl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const nu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ow(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const pl={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(He.test(r))r=parseFloat(r);else return r;const t=Ow(r,e.target.x),n=Ow(r,e.target.y);return`${t}% ${n}%`}},J3={correct:(r,{treeScale:e,projectionDelta:t})=>{const n=r,i=Ni.parse(r);if(i.length>5)return n;const a=Ni.createTransformer(r),o=typeof i[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=l,i[1+o]/=u;const h=Bt(l,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=h),typeof i[3+o]=="number"&&(i[3+o]/=h),a(i)}};let _m=!1;class Z3 extends R.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:a}=e;j6(eM),a&&(t.group&&t.group.add(a),n&&n.register&&i&&n.register(a),_m&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),nu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:a}=this.props,{projection:o}=n;return o&&(o.isPresent=a,_m=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||Pt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),C0.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;_m=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function NS(r){const[e,t]=$E(),n=R.useContext(o0);return s.jsx(Z3,{...r,layoutGroup:n,switchLayoutGroup:R.useContext(rS),isPresent:e,safeToRemove:t})}const eM={borderRadius:{...pl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pl,borderTopRightRadius:pl,borderBottomLeftRadius:pl,borderBottomRightRadius:pl,boxShadow:J3};function tM(r,e,t){const n=Ps(r)?r:go(r);return n.start(z0("",n,e,t)),n.animation}const sM=(r,e)=>r.depth-e.depth;class rM{constructor(){this.children=[],this.isDirty=!1}add(e){d0(this.children,e),this.isDirty=!0}remove(e){u0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(sM),this.isDirty=!1,this.children.forEach(e)}}function nM(r,e){const t=sr.now(),n=({timestamp:i})=>{const a=i-t;a>=e&&(wi(n),r(a-e))};return Pt.setup(n,!0),()=>wi(n)}const kS=["TopLeft","TopRight","BottomLeft","BottomRight"],iM=kS.length,Lw=r=>typeof r=="string"?parseFloat(r):r,Iw=r=>typeof r=="number"||He.test(r);function aM(r,e,t,n,i,a){i?(r.opacity=Bt(0,t.opacity??1,oM(n)),r.opacityExit=Bt(e.opacity??1,0,lM(n))):a&&(r.opacity=Bt(e.opacity??1,t.opacity??1,n));for(let o=0;o<iM;o++){const l=`border${kS[o]}Radius`;let u=Bw(e,l),h=Bw(t,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||Iw(u)===Iw(h)?(r[l]=Math.max(Bt(Lw(u),Lw(h),n),0),(hn.test(h)||hn.test(u))&&(r[l]+="%")):r[l]=h}(e.rotate||t.rotate)&&(r.rotate=Bt(e.rotate||0,t.rotate||0,n))}function Bw(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const oM=ES(0,.5,uE),lM=ES(.5,.95,Ar);function ES(r,e,t){return n=>n<r?0:n>e?1:t(Hl(r,e,n))}function Fw(r,e){r.min=e.min,r.max=e.max}function br(r,e){Fw(r.x,e.x),Fw(r.y,e.y)}function zw(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function Uw(r,e,t,n,i){return r-=e,r=Nu(r,1/t,n),i!==void 0&&(r=Nu(r,1/i,n)),r}function cM(r,e=0,t=1,n=.5,i,a=r,o=r){if(hn.test(e)&&(e=parseFloat(e),e=Bt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=Bt(a.min,a.max,n);r===a&&(l-=e),r.min=Uw(r.min,e,t,l,i),r.max=Uw(r.max,e,t,l,i)}function Hw(r,e,[t,n,i],a,o){cM(r,e[t],e[n],e[i],e.scale,a,o)}const dM=["x","scaleX","originX"],uM=["y","scaleY","originY"];function Vw(r,e,t,n){Hw(r.x,e,dM,t?t.x:void 0,n?n.x:void 0),Hw(r.y,e,uM,t?t.y:void 0,n?n.y:void 0)}function qw(r){return r.translate===0&&r.scale===1}function SS(r){return qw(r.x)&&qw(r.y)}function $w(r,e){return r.min===e.min&&r.max===e.max}function hM(r,e){return $w(r.x,e.x)&&$w(r.y,e.y)}function Ww(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function _S(r,e){return Ww(r.x,e.x)&&Ww(r.y,e.y)}function Gw(r){return Us(r.x)/Us(r.y)}function Yw(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class fM{constructor(){this.members=[]}add(e){d0(this.members,e),e.scheduleRender()}remove(e){if(u0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let n;for(let i=t;i>=0;i--){const a=this.members[i];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mM(r,e,t){let n="";const i=r.x.translate/e.x,a=r.y.translate/e.y,o=t?.z||0;if((i||a||o)&&(n=`translate3d(${i}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:c,rotateX:f,rotateY:m,skewX:g,skewY:v}=t;h&&(n=`perspective(${h}px) ${n}`),c&&(n+=`rotate(${c}deg) `),f&&(n+=`rotateX(${f}deg) `),m&&(n+=`rotateY(${m}deg) `),g&&(n+=`skewX(${g}deg) `),v&&(n+=`skewY(${v}deg) `)}const l=r.x.scale*e.x,u=r.y.scale*e.y;return(l!==1||u!==1)&&(n+=`scale(${l}, ${u})`),n||"none"}const Am=["","X","Y","Z"],pM=1e3;let gM=0;function Cm(r,e,t,n){const{latestValues:i}=e;i[r]&&(t[r]=i[r],e.setStaticValue(r,0),n&&(n[r]=0))}function AS(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const t=fS(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:a}=r.options;window.MotionCancelOptimisedAnimation(t,"transform",Pt,!(i||a))}const{parent:n}=r;n&&!n.hasCheckedOptimisedAppear&&AS(n)}function CS({attachResizeListener:r,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(o={},l=e?.()){this.id=gM++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(vM),this.nodes.forEach(NM),this.nodes.forEach(kM),this.nodes.forEach(bM)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new rM)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new m0),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=qE(o)&&!a6(o),this.instance=o;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),r){let c,f=0;const m=()=>this.root.updateBlockedByResize=!1;Pt.read(()=>{f=window.innerWidth}),r(o,()=>{const g=window.innerWidth;g!==f&&(f=g,this.root.updateBlockedByResize=!0,c&&c(),c=nM(m,250),nu.hasAnimatedSinceResize&&(nu.hasAnimatedSinceResize=!1,this.nodes.forEach(Qw)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||h.getDefaultTransition()||CM,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=h.getProps(),b=!this.targetLayout||!_S(this.targetLayout,g),w=!f&&m;if(this.options.layoutRoot||this.resumeFrom||w||f&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={..._0(v,"layout"),onPlay:y,onComplete:x};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(c,w)}else f||Qw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),wi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(EM),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&AS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const f=this.path[c];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Kw);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Xw);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(wM),this.nodes.forEach(xM),this.nodes.forEach(yM)):this.nodes.forEach(Xw),this.clearAllSnapshots();const l=sr.now();Ns.delta=On(0,1e3/60,l-Ns.timestamp),Ns.timestamp=l,Ns.isProcessing=!0,xm.update.process(Ns),xm.preRender.process(Ns),xm.render.process(Ns),Ns.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,C0.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jM),this.sharedNodes.forEach(SM)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Pt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Pt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Us(this.snapshot.measuredBox.x)&&!Us(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Kt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!SS(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,c=h!==this.prevTransformTemplateValue;o&&this.instance&&(l||Gi(this.latestValues)||c)&&(i(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),TM(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Kt();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(RM))){const{scroll:h}=this.root;h&&(Ja(l.x,h.offset.x),Ja(l.y,h.offset.y))}return l}removeElementScroll(o){const l=Kt();if(br(l,o),this.scroll?.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:c,options:f}=h;h!==this.root&&c&&f.layoutScroll&&(c.wasRoot&&br(l,o),Ja(l.x,c.offset.x),Ja(l.y,c.offset.y))}return l}applyTransform(o,l=!1){const u=Kt();br(u,o);for(let h=0;h<this.path.length;h++){const c=this.path[h];!l&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Za(u,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Gi(c.latestValues)&&Za(u,c.latestValues)}return Gi(this.latestValues)&&Za(u,this.latestValues),u}removeTransform(o){const l=Kt();br(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Gi(h.latestValues))continue;lx(h.latestValues)&&h.updateSnapshot();const c=Kt(),f=h.measurePageBox();br(c,f),Vw(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,c)}return Gi(this.latestValues)&&Vw(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ns.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:f}=this.options;if(!(!this.layout||!(c||f))){if(this.resolvedRelativeTargetAt=Ns.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Kt(),this.relativeTargetOrigin=Kt(),Dl(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),br(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Kt(),this.targetWithTransforms=Kt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),I3(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):br(this.target,this.layout.layoutBox),oS(this.target,this.targetDelta)):br(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Kt(),this.relativeTargetOrigin=Kt(),Dl(this.relativeTargetOrigin,this.target,m.target),br(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||lx(this.parent.latestValues)||aS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ns.timestamp&&(u=!1),u)return;const{layout:h,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||c))return;br(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;K6(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Kt());const{target:g}=o;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(zw(this.prevProjectionDelta.x,this.projectionDelta.x),zw(this.prevProjectionDelta.y,this.projectionDelta.y)),Rl(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!Yw(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yw(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=eo(),this.projectionDelta=eo(),this.projectionDeltaWithTransform=eo()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},c={...this.latestValues},f=eo();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Kt(),g=u?u.source:void 0,v=this.layout?this.layout.source:void 0,y=g!==v,x=this.getStack(),b=!x||x.members.length<=1,w=!!(y&&!b&&this.options.crossfade===!0&&!this.path.some(AM));this.animationProgress=0;let k;this.mixTargetDelta=N=>{const E=N/1e3;Jw(f.x,o.x,E),Jw(f.y,o.y,E),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Dl(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),_M(this.relativeTarget,this.relativeTargetOrigin,m,E),k&&hM(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Kt()),br(k,this.relativeTarget)),y&&(this.animationValues=c,aM(c,h,this.latestValues,E,w,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(wi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Pt.update(()=>{nu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=go(0)),this.currentAnimation=tM(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(pM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:c}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&TS(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Kt();const f=Us(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+f;const m=Us(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}br(l,u),Za(l,c),Rl(this.projectionDeltaWithTransform,this.layoutCorrected,l,c)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new fM),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&Cm("z",o,h,this.animationValues);for(let c=0;c<Am.length;c++)Cm(`rotate${Am[c]}`,o,h,this.animationValues),Cm(`skew${Am[c]}`,o,h,this.animationValues);o.render();for(const c in h)o.setStaticValue(c,h[c]),this.animationValues&&(this.animationValues[c]=h[c]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=ru(l?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=ru(l?.pointerEvents)||""),this.hasProjected&&!Gi(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const c=h.animationValues||h.latestValues;this.applyTransformsToTarget();let f=mM(this.projectionDeltaWithTransform,this.treeScale,c);u&&(f=u(c,f)),o.transform=f;const{x:m,y:g}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?o.opacity=h===this?c.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:o.opacity=h===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const v in Wl){if(c[v]===void 0)continue;const{correct:y,applyTo:x,isCSSVariable:b}=Wl[v],w=f==="none"?c[v]:y(c[v],h);if(x){const k=x.length;for(let N=0;N<k;N++)o[x[N]]=w}else b?this.options.visualElement.renderState.vars[v]=w:o[v]=w}this.options.layoutId&&(o.pointerEvents=h===this?ru(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Kw),this.root.sharedNodes.clear()}}}function xM(r){r.updateLayout()}function yM(r){const e=r.resumeFrom?.snapshot||r.snapshot;if(r.isLead()&&r.layout&&e&&r.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:n}=r.layout,{animationType:i}=r.options,a=e.source!==r.layout.source;i==="size"?Nr(c=>{const f=a?e.measuredBox[c]:e.layoutBox[c],m=Us(f);f.min=t[c].min,f.max=f.min+m}):TS(i,e.layoutBox,t)&&Nr(c=>{const f=a?e.measuredBox[c]:e.layoutBox[c],m=Us(t[c]);f.max=f.min+m,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[c].max=r.relativeTarget[c].min+m)});const o=eo();Rl(o,t,e.layoutBox);const l=eo();a?Rl(l,r.applyTransform(n,!0),e.measuredBox):Rl(l,t,e.layoutBox);const u=!SS(o);let h=!1;if(!r.resumeFrom){const c=r.getClosestProjectingParent();if(c&&!c.resumeFrom){const{snapshot:f,layout:m}=c;if(f&&m){const g=Kt();Dl(g,e.layoutBox,f.layoutBox);const v=Kt();Dl(v,t,m.layoutBox),_S(g,v)||(h=!0),c.options.layoutRoot&&(r.relativeTarget=v,r.relativeTargetOrigin=g,r.relativeParent=c)}}}r.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(r.isLead()){const{onExitComplete:t}=r.options;t&&t()}r.options.transition=void 0}function vM(r){r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function bM(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function jM(r){r.clearSnapshot()}function Kw(r){r.clearMeasurements()}function Xw(r){r.isLayoutDirty=!1}function wM(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function Qw(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function NM(r){r.resolveTargetDelta()}function kM(r){r.calcProjection()}function EM(r){r.resetSkewAndRotation()}function SM(r){r.removeLeadSnapshot()}function Jw(r,e,t){r.translate=Bt(e.translate,0,t),r.scale=Bt(e.scale,1,t),r.origin=e.origin,r.originPoint=e.originPoint}function Zw(r,e,t,n){r.min=Bt(e.min,t.min,n),r.max=Bt(e.max,t.max,n)}function _M(r,e,t,n){Zw(r.x,e.x,t.x,n),Zw(r.y,e.y,t.y,n)}function AM(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const CM={duration:.45,ease:[.4,0,.1,1]},e1=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),t1=e1("applewebkit/")&&!e1("chrome/")?Math.round:Ar;function s1(r){r.min=t1(r.min),r.max=t1(r.max)}function TM(r){s1(r.x),s1(r.y)}function TS(r,e,t){return r==="position"||r==="preserve-aspect"&&!L3(Gw(e),Gw(t),.2)}function RM(r){return r!==r.root&&r.scroll?.wasRoot}const DM=CS({attachResizeListener:(r,e)=>Gl(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Tm={current:void 0},RS=CS({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!Tm.current){const r=new DM({});r.mount(window),r.setOptions({layoutScroll:!0}),Tm.current=r}return Tm.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),PM={pan:{Feature:Q3},drag:{Feature:X3,ProjectionNode:RS,MeasureLayout:NS}};function r1(r,e,t){const{props:n}=r;r.animationState&&n.whileHover&&r.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,a=n[i];a&&Pt.postRender(()=>a(e,ic(e)))}class MM extends Ci{mount(){const{current:e}=this.node;e&&(this.unmount=t6(e,(t,n)=>(r1(this.node,n,"Start"),i=>r1(this.node,i,"End"))))}unmount(){}}class OM extends Ci{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=sc(Gl(this.node.current,"focus",()=>this.onFocus()),Gl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function n1(r,e,t){const{props:n}=r;if(r.current instanceof HTMLButtonElement&&r.current.disabled)return;r.animationState&&n.whileTap&&r.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),a=n[i];a&&Pt.postRender(()=>a(e,ic(e)))}class LM extends Ci{mount(){const{current:e}=this.node;e&&(this.unmount=i6(e,(t,n)=>(n1(this.node,n,"Start"),(i,{success:a})=>n1(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const px=new WeakMap,Rm=new WeakMap,IM=r=>{const e=px.get(r.target);e&&e(r)},BM=r=>{r.forEach(IM)};function FM({root:r,...e}){const t=r||document;Rm.has(t)||Rm.set(t,{});const n=Rm.get(t),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(BM,{root:r,...e})),n[i]}function zM(r,e,t){const n=FM(e);return px.set(r,t),n.observe(r),()=>{px.delete(r),n.unobserve(r)}}const UM={some:0,all:1};class HM extends Ci{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:a}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:UM[i]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,a&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:c,onViewportLeave:f}=this.node.getProps(),m=h?c:f;m&&m(u)};return zM(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(VM(e,t))&&this.startObserver()}unmount(){}}function VM({viewport:r={}},{viewport:e={}}={}){return t=>r[t]!==e[t]}const qM={inView:{Feature:HM},tap:{Feature:LM},focus:{Feature:OM},hover:{Feature:MM}},$M={layout:{ProjectionNode:RS,MeasureLayout:NS}},WM={...T3,...qM,...PM,...$M},W=W6(WM,i3);function DS(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=DS(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function GM(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=DS(r))&&(n&&(n+=" "),n+=e);return n}const YM={primary:"bg-blue-500 text-white hover:bg-blue-600",outline:"border border-white text-white hover:bg-white hover:text-black"},KM={sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-3 text-lg"};function oe({children:r,variant:e="primary",size:t="md",onClick:n}){return s.jsx(W.button,{onClick:n,whileHover:{scale:1.05},whileTap:{scale:.95},className:GM("rounded-full font-semibold transition-all duration-200 shadow-lg flex gap-2",YM[e],KM[t]),children:r})}const PS=R.createContext();function XM({children:r}){const[e,t]=R.useState(()=>{try{const f=localStorage.getItem("user")||sessionStorage.getItem("user");if(f){const m=JSON.parse(f);return m.token?(console.log(" Auth initialis - ID:",m.user?.id,"Nom:",m.user?.nom),m):(console.error(" User sans token dans le storage"),null)}return null}catch(f){return console.error("Erreur parsing localStorage:",f),localStorage.removeItem("user"),sessionStorage.removeItem("user"),null}}),[n,i]=R.useState(!1),a=(f,m=!1)=>{if(!f?.token)throw console.error(" Login impossible: pas de token",f),new Error("Token manquant dans la rponse");if(!f.user?.id)throw console.error(" Login impossible: pas d'ID utilisateur",f),new Error("ID utilisateur manquant");return console.log(" Login - ID:",f.user.id,"Nom:",f.user.nom),(m?localStorage:sessionStorage).setItem("user",JSON.stringify(f)),t(f),f},o=()=>{console.log(" Logout - Nettoyage complet"),localStorage.removeItem("user"),sessionStorage.removeItem("user"),t(null),i(!1)},l=()=>{if(!e?.token)return console.log(" Pas de token dans user"),!1;try{const f=e.token.split(".");if(f.length!==3)return console.log(" Format token invalide"),!1;const m=JSON.parse(atob(f[1]));return!m.id||typeof m.id!="number"||m.id<1?(console.log(" ID invalide dans token:",m.id),!1):m.exp&&m.exp*1e3<Date.now()?(console.log(" Token expir"),!1):!0}catch{return console.log(" Token invalide"),!1}},u=()=>e?e.user?.role||null:(console.log(" getUserRole: pas d'user"),null),h=()=>e?e.user?.id&&typeof e.user.id=="number"?e.user.id:(console.log(" getUserId: ID non trouv"),null):(console.log(" getUserId: pas d'user"),null);R.useEffect(()=>{const m=u()==="admin";i(m)},[e]),R.useEffect(()=>{e&&!l()&&(console.log(" Token invalide, logout automatique"),o())},[]);const c={user:e,login:a,logout:o,isAuthenticated:!!e&&l(),isAdmin:n,getUserRole:u,getUserId:h,isTokenValid:l};return s.jsx(PS.Provider,{value:c,children:r})}function st(){const r=R.useContext(PS);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r}function QM(){const{user:r}=st(),[e,t]=R.useState([]),[n,i]=R.useState(!1),a=R.useRef(null),o=async()=>{try{const c=await(await fetch("https://vakio-boky-backend.onrender.com/api/notifications?limit=5",{headers:{Authorization:`Bearer ${r.token}`}})).json();c.success&&t(c.notifications)}catch(h){console.error("Erreur:",h)}};R.useEffect(()=>{o();const h=setInterval(o,3e4);return()=>clearInterval(h)},[]),R.useEffect(()=>{const h=c=>{a.current&&!a.current.contains(c.target)&&i(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const l=e.filter(h=>!h.lue).length,u=async h=>{try{await fetch(`https://vakio-boky-backend.onrender.com/api/notifications/${h}/read`,{method:"PUT",headers:{Authorization:`Bearer ${r.token}`}}),o()}catch(c){console.error("Erreur:",c)}};return s.jsxs("div",{className:"relative",ref:a,children:[s.jsxs("button",{onClick:()=>i(!n),className:"relative p-2 text-gray-600 hover:text-blue-600 transition-colors",children:[s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-4.66-6.24M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l>0&&s.jsx(W.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l>9?"9+":l})]}),s.jsx(zs,{children:n&&s.jsxs(W.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},className:"absolute right-0 top-12 w-80 bg-white rounded-2xl shadow-xl border border-gray-200 z-50",children:[s.jsx("div",{className:"p-4 border-b border-gray-100",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),s.jsxs("span",{className:"text-sm text-gray-500",children:[l," non lue(s)"]})]})}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.length===0?s.jsx("div",{className:"p-4 text-center text-gray-500",children:"Aucune notification"}):e.slice(0,5).map(h=>s.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 ${h.lue?"":"bg-blue-50"}`,children:s.jsxs("div",{className:"cursor-pointer",onClick:()=>{u(h.id),i(!1)},children:[s.jsx("p",{className:"font-medium text-sm text-gray-900",children:h.titre}),s.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:h.message}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(h.created_at).toLocaleTimeString("fr-FR")})]})},h.id))}),s.jsx("div",{className:"p-3 border-t border-gray-100",children:s.jsx(tr,{to:"/notifications",onClick:()=>i(!1),className:"block text-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Voir toutes les notifications"})})]})})]})}function MS(){const[r,e]=R.useState(!1),t=x=>{const b=document.getElementById(x);b&&b.scrollIntoView({behavior:"smooth"})},{user:n,logout:i,isAdmin:a}=st(),o=qs(),l=Yr(),u=["/login","/register","/forgot-password","/verify-code","/reset-password"].includes(l.pathname),h=!!n?.token&&!u,c=x=>{h?o(x):o("/login",{state:{from:x,message:"Connectez-vous pour accder  cette page"}})},f=()=>{i(),e(!1),o("/")},m=()=>{e(!1),o("/profile")},g=()=>{e(!1),o("/admin")};if(u)return null;const v=n?.nom||n?.user?.nom||"Utilisateur",y=v.split(" ")[0];return s.jsx("header",{className:"fixed top-0 left-0 w-full bg-white/90 backdrop-blur-xl border-b border-gray-200/80 shadow-lg z-50",children:s.jsxs("nav",{className:"flex items-center justify-between px-6 md:px-8 py-4",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx(tr,{to:"/",children:s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-gradient-to-br from-blue-600 to-purple-600 text-white rounded-xl px-4 py-3 cursor-pointer text-center shadow-lg hover:shadow-xl transition-all duration-300",children:[s.jsx("span",{className:"block font-bold text-sm tracking-wide",children:"#Vakio_Boky"}),s.jsxs("span",{className:"block text-xs font-light opacity-90",children:[h?"Connect":"Initiative",a&&" (Admin)"]})]})})}),s.jsx("div",{className:"hidden md:flex items-center gap-6 text-gray-700 font-medium",children:h?s.jsxs(s.Fragment,{children:[s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c("/explore"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(t0,{className:"text-lg"})," Explorer"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c("/marketplace"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(qr,{className:"text-lg"})," Marketplace"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o("/challenges"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(rs,{className:"text-lg"})," Dfis"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o("/calendar"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(Je,{className:"text-lg"})," Calendrier"]})]}):s.jsxs(s.Fragment,{children:[s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t("hero"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(n0,{className:"text-lg"})," Accueil"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t("features"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(Nt,{className:"text-lg"})," Avantages"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t("catalogue"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(et,{className:"text-lg"})," Catalogue"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t("auteur"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx(Me,{className:"text-lg"})," Nos auteurs"]}),s.jsxs(W.div,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t("contact"),className:"flex items-center gap-2 hover:text-blue-600 cursor-pointer transition-colors duration-200 px-3 py-2 rounded-lg hover:bg-blue-50",children:[s.jsx($r,{className:"text-lg"})," Contact"]})]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[h&&s.jsx("div",{className:"relative",children:s.jsx(QM,{})}),s.jsx("div",{className:"relative",children:h?s.jsxs(s.Fragment,{children:[s.jsxs(W.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e(!r),className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl",children:[s.jsx("div",{className:"w-8 h-8 bg-white text-blue-600 rounded-full flex items-center justify-center text-sm font-bold shadow-inner",children:v.charAt(0).toUpperCase()}),s.jsxs("div",{className:"text-left",children:[s.jsx("span",{className:"text-base font-semibold block leading-tight",children:y.length>10?y.slice(0,10)+"...":y}),s.jsx("span",{className:"text-xs opacity-90 block leading-tight",children:a?"Administrateur":"Membre"})]}),a&&s.jsx("div",{className:"text-yellow-300 text-lg",children:""})]}),r&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40 bg-black/10 backdrop-blur-sm",onClick:()=>e(!1)}),s.jsxs(W.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},className:"absolute right-0 mt-3 w-64 bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-200/80 py-3 z-50 overflow-hidden",children:[s.jsxs("button",{onClick:m,className:"flex items-center gap-3 w-full px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 text-left group",children:[s.jsx(Qt,{size:18,className:"text-gray-400 group-hover:text-blue-600 transition-colors"}),s.jsx("span",{className:"font-medium",children:"Mon Profil"})]}),a&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-gray-200/60 my-1"}),s.jsxs("button",{onClick:g,className:"flex items-center gap-3 w-full px-4 py-3 text-purple-600 hover:bg-purple-50 transition-all duration-200 text-left group",children:[s.jsx(ji,{size:18,className:"group-hover:rotate-90 transition-transform duration-300"}),s.jsx("span",{className:"font-medium",children:"Administration"})]})]}),s.jsx("div",{className:"border-t border-gray-200/60 my-1"}),s.jsxs("button",{onClick:f,className:"flex items-center gap-3 w-full px-4 py-3 text-red-600 hover:bg-red-50 transition-all duration-200 text-left group",children:[s.jsx(Jk,{size:18,className:"group-hover:scale-110 transition-transform"}),s.jsx("span",{className:"font-medium",children:"Dconnexion"})]})]})]})]}):s.jsx(tr,{to:"/login",children:s.jsxs(oe,{variant:"primary",size:"lg",className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-300 font-semibold px-6 py-3",children:[s.jsx(Qt,{size:18}),"Se connecter"]})})})]})]})})}function JM(r){return je({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"},child:[]}]})(r)}function ZM(r){return je({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(r)}function eO(r){return je({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(r)}function tO(){return s.jsx("footer",{className:"relative bg-blue-50 border-t-4 border-blue-500/40 backdrop-blur-sm rounded-t-2xl shadow-inner mt-12",children:s.jsxs("div",{className:"container mx-auto px-6 py-8 flex flex-col md:flex-row items-center justify-between text-center md:text-left gap-4 md:gap-0",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"text-gray-800 font-serif text-sm md:text-base italic",children:[" ",new Date().getFullYear()," Vakio Boky Initiative  Tous droits rservs"]}),s.jsx(W.div,{className:"flex items-center gap-6",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8,delay:.2},children:s.jsxs(W.div,{className:"flex items-center gap-6",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.8,delay:.2},children:[s.jsx(tr,{to:"#",className:"text-blue-700 hover:text-blue-500 transition-colors duration-300","aria-label":"Facebook",children:s.jsx(JM,{size:20})}),s.jsx(tr,{to:"#",className:"text-blue-700 hover:text-blue-500 transition-colors duration-300","aria-label":"Twitter",children:s.jsx(eO,{size:20})}),s.jsx(tr,{to:"#",className:"text-blue-700 hover:text-blue-500 transition-colors duration-300","aria-label":"Instagram",children:s.jsx(ZM,{size:20})})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.9,delay:.4},className:"text-gray-700 font-serif text-sm md:text-base italic mt-2 md:mt-0",children:" Plongez dans le monde des mots et des histoires. "})]})})}var Dm={exports:{}},Pm,i1;function sO(){if(i1)return Pm;i1=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Pm=r,Pm}var Mm,a1;function rO(){if(a1)return Mm;a1=1;var r=sO();function e(){}function t(){}return t.resetWarningCache=e,Mm=function(){function n(o,l,u,h,c,f){if(f!==r){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Mm}var o1;function nO(){return o1||(o1=1,Dm.exports=rO()()),Dm.exports}var iO=nO();const Ha=Wu(iO);function Ve({variant:r="primary",size:e="md",placeholder:t="Rechercher...",value:n,onChange:i,icon:a=s.jsx(nr,{})}){const o={primary:"bg-white border border-blue-400 text-blue-900 placeholder:text-blue-400",outline:"bg-transparent border border-blue-500 text-blue-900 placeholder:text-blue-500",secondary:"bg-gray-100 border border-gray-300 text-gray-900 placeholder:text-gray-500"},l={sm:"px-2 py-1 w-40 md:w-48",md:"px-3 py-2 w-48 md:w-64",lg:"px-4 py-2 w-64 md:w-80"};return s.jsxs(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:`flex items-center rounded-md ${o[r]} ${l[e]}`,children:[s.jsx("input",{type:"text",placeholder:t,value:n,onChange:i,className:"outline-none w-full bg-transparent text-sm"}),s.jsx("button",{type:"submit",className:"flex items-center",children:a&&s.jsx("span",{className:"ml-2 cursor-pointer",children:a})})]})}Ve.propTypes={variant:Ha.oneOf(["primary","outline","secondary"]),size:Ha.oneOf(["sm","md","lg"]),placeholder:Ha.string,value:Ha.string,onChange:Ha.func,icon:Ha.element};function aO(){const[r,e]=R.useState(""),[t,n]=R.useState(""),[i,a]=R.useState(!1),o=qs(),{login:l}=st(),u=Yr(),h=()=>o("/register"),c=()=>o("/forgot-password"),f=u.state?.from||"/explore",m=u.state?.message,g=async v=>{v.preventDefault(),a(!0);try{const y=await fetch("https://vakio-boky-backend.onrender.com/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:r,mot_de_passe:t})}),x=await y.json();if(y.ok){const b={token:x.token,user:{id:x.user.id,nom:x.user.nom,email:x.user.email,role:x.user.role,telephone:x.user.telephone||"",genre_prefere:x.user.genre_prefere||"",bio:x.user.bio||"",photo_profil:x.user.photo_profil||null}};l(b,!0),console.log(" Redirection vers:",f),o(f,{replace:!0})}else alert(x.error||"Email ou mot de passe incorrect.")}catch(y){console.error(" Erreur login:",y),alert("Erreur de connexion au serveur.")}finally{a(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-blue-800 text-white rounded-lg px-4 py-3 inline-block mb-4",children:[s.jsx("span",{className:"block font-bold text-lg",children:"#Vakio_Boky"}),s.jsx("span",{className:"block text-sm font-light",children:"Communaut Littraire"})]}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-blue-900 text-lg font-semibold",children:"Bienvenue dans la communaut littraire"}),m&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-blue-100 border border-blue-300 text-blue-700 px-4 py-3 rounded-lg mb-4 text-sm",children:m})]}),s.jsxs(W.form,{onSubmit:g,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Adresse e-mail"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"email",placeholder:"exemple@email.com",icon:s.jsx($r,{className:"text-blue-400"}),value:r,onChange:v=>e(v.target.value),required:!0})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Mot de passe"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"password",placeholder:"Votre mot de passe",icon:s.jsx(zl,{className:"text-blue-400"}),value:t,onChange:v=>n(v.target.value),required:!0})})]}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:i,className:"w-full",children:i?"Connexion...":"Se connecter"})}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-center",children:s.jsx(W.button,{type:"button",whileHover:{scale:1.05},onClick:c,className:"text-blue-600 text-sm hover:text-blue-800 transition-colors underline",children:"Mot de passe oubli ?"})}),s.jsxs("div",{className:"relative flex items-center py-4",children:[s.jsx("div",{className:"flex-grow border-t border-blue-200"}),s.jsx("span",{className:"flex-shrink mx-4 text-blue-500 text-sm",children:"ou"}),s.jsx("div",{className:"flex-grow border-t border-blue-200"})]}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"outline",size:"lg",type:"button",onClick:h,className:"w-full border-blue-500 text-blue-600 hover:bg-blue-500 hover:text-white",children:"S'inscrire"})})]}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mt-8 text-center",children:s.jsx("p",{className:"text-blue-400 text-xs",children:"Rejoignez notre communaut de passionns de lecture"})})]})})}function oO(){const[r,e]=R.useState({nom:"",email:"",mot_de_passe:"",confirmPassword:"",telephone:"",genre_prefere:"",accepte_newsletter:!1}),[t,n]=R.useState(!1),i=qs(),{login:a}=st(),o=(u,h)=>{e(c=>({...c,[u]:h}))},l=async u=>{if(u.preventDefault(),r.mot_de_passe!==r.confirmPassword){alert("Les mots de passe ne correspondent pas");return}n(!0);try{const h=await fetch("https://vakio-boky-backend.onrender.com/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({nom:r.nom,email:r.email,mot_de_passe:r.mot_de_passe,telephone:r.telephone,genre_prefere:r.genre_prefere,accepte_newsletter:r.accepte_newsletter})}),c=await h.json();if(console.log(" Rponse inscription:",c),h.ok){const f={token:c.token,user:{id:c.user.id,nom:c.user.nom,email:c.user.email,role:c.user.role,telephone:c.user.telephone||"",genre_prefere:c.user.genre_prefere||"",bio:c.user.bio||"",photo_profil:c.user.photo_profil||null}};a(f,!0),i("/explore")}else alert(c.error||"Erreur lors de l'inscription")}catch(h){console.error(" Erreur inscription:",h),alert("Erreur de connexion au serveur")}finally{n(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-blue-800 text-white rounded-lg px-4 py-3 inline-block mb-4",children:[s.jsx("span",{className:"block font-bold text-lg",children:"#Vakio_Boky"}),s.jsx("span",{className:"block text-sm font-light",children:"Communaut Littraire"})]}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-blue-900 text-lg font-semibold",children:"Rejoignez notre communaut"})]}),s.jsxs(W.form,{onSubmit:l,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"space-y-5",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Nom complet *"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",placeholder:"Votre nom et prnom",icon:s.jsx(Qt,{className:"text-blue-400"}),value:r.nom,onChange:u=>o("nom",u.target.value),required:!0})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Adresse email *"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"email",placeholder:"votre@email.com",icon:s.jsx($r,{className:"text-blue-400"}),value:r.email,onChange:u=>o("email",u.target.value),required:!0})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Tlphone (optionnel)"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",placeholder:"06 12 34 56 78",icon:s.jsx(Ju,{className:"text-blue-400"}),value:r.telephone,onChange:u=>o("telephone",u.target.value)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Genre littraire prfr (optionnel)"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",placeholder:"Roman, Posie, Science-fiction...",icon:s.jsx(et,{className:"text-blue-400"}),value:r.genre_prefere,onChange:u=>o("genre_prefere",u.target.value)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Mot de passe *"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"password",placeholder:"Minimum 6 caractres",icon:s.jsx(zl,{className:"text-blue-400"}),value:r.mot_de_passe,onChange:u=>o("mot_de_passe",u.target.value),required:!0,minLength:"6"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Confirmer le mot de passe *"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"password",placeholder:"Rptez votre mot de passe",icon:s.jsx(zl,{className:"text-blue-400"}),value:r.confirmPassword,onChange:u=>o("confirmPassword",u.target.value),required:!0})}),r.confirmPassword&&r.mot_de_passe!==r.confirmPassword&&s.jsx("p",{className:"text-red-500 text-xs",children:"Les mots de passe ne correspondent pas"})]}),s.jsxs(W.div,{whileHover:{scale:1.02},className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"newsletter",checked:r.accepte_newsletter,onChange:u=>o("accepte_newsletter",u.target.checked),className:"w-4 h-4 text-blue-600 bg-blue-100 border-blue-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"newsletter",className:"text-blue-900 text-sm",children:"M'envoyer les actualits littraires et les nouveauts"})]}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:t||r.mot_de_passe!==r.confirmPassword,className:"w-full mt-4 disabled:opacity-50",children:t?"Inscription...":"Crer mon compte"})}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-center",children:s.jsxs("p",{className:"text-blue-900 text-sm",children:["Dj membre ?"," ",s.jsx(W.a,{whileHover:{scale:1.05},href:"/login",className:"text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:"Se connecter"})]})})]})]})})}function lO(){const[r,e]=R.useState(""),[t,n]=R.useState(!1),[i,a]=R.useState(""),o=qs(),l=async u=>{u.preventDefault(),n(!0),a("");try{const h=await fetch("https://vakio-boky-backend.onrender.com/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),c=await h.json();h.ok?(a(" Un code de vrification a t envoy  votre email"),localStorage.setItem("resetEmail",r),setTimeout(()=>{o("/verify-code")},2e3)):a(c.error||"Erreur lors de l'envoi du code")}catch(h){console.error("Erreur:",h),a("Erreur de connexion au serveur")}finally{n(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md",children:[s.jsxs(W.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o("/login"),className:"flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors",children:[s.jsx(Xu,{className:"mr-2"}),"Retour"]}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-blue-800 text-white rounded-lg px-4 py-3 inline-block mb-4",children:[s.jsx("span",{className:"block font-bold text-lg",children:"#Vakio_Boky"}),s.jsx("span",{className:"block text-sm font-light",children:"Communaut Littraire"})]}),s.jsx(W.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-blue-900 text-2xl font-bold mb-2",children:"Mot de passe oubli ?"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-blue-600 text-sm",children:"Entrez votre email pour recevoir un code de vrification"})]}),s.jsxs(W.form,{onSubmit:l,initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Adresse email"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"email",placeholder:"votre@email.com",icon:s.jsx($r,{className:"text-blue-400"}),value:r,onChange:u=>e(u.target.value),required:!0})})]}),i&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:`p-3 rounded-lg text-sm ${i.includes("code")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:t,className:"w-full",children:t?"Envoi en cours...":"Envoyer le code de vrification"})}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-center",children:s.jsxs("p",{className:"text-blue-900 text-sm",children:["Vous vous souvenez ?"," ",s.jsx(W.button,{type:"button",whileHover:{scale:1.05},onClick:()=>o("/login"),className:"text-blue-600 font-semibold hover:text-blue-800 transition-colors underline",children:"Se connecter"})]})})]})]})})}function cO(){const[r,e]=R.useState(["","","","","",""]),[t,n]=R.useState(!1),[i,a]=R.useState(""),[o,l]=R.useState(!1),[u,h]=R.useState(""),c=qs(),f=R.useRef([]);R.useEffect(()=>{const x=localStorage.getItem("resetEmail");x?h(x):c("/forgot-password")},[c]);const m=(x,b)=>{if(b.length<=1&&/^\d*$/.test(b)){const w=[...r];w[x]=b,e(w),b&&x<5&&f.current[x+1].focus(),w.every(k=>k!=="")&&x===5&&v()}},g=(x,b)=>{b.key==="Backspace"&&!r[x]&&x>0&&f.current[x-1].focus()},v=async()=>{const x=r.join("");if(x.length!==6){a("Veuillez entrer le code complet  6 chiffres");return}n(!0),a("");try{const b=await fetch("https://vakio-boky-backend.onrender.com/api/auth/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,code:x})}),w=await b.json();b.ok?(a(" Code vrifi avec succs"),localStorage.setItem("resetToken",w.resetToken),setTimeout(()=>{c("/reset-password")},1e3)):(a(w.error||"Code invalide ou expir"),e(["","","","","",""]),f.current[0].focus())}catch(b){console.error("Erreur:",b),a("Erreur de connexion au serveur")}finally{n(!1)}},y=async()=>{l(!0),a("");try{const x=await fetch("https://vakio-boky-backend.onrender.com/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u})}),b=await x.json();x.ok?a(" Nouveau code envoy  votre email"):a(b.error||"Erreur lors de l'envoi du code")}catch(x){console.error("Erreur:",x),a("Erreur de connexion au serveur")}finally{l(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md",children:[s.jsxs(W.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c("/forgot-password"),className:"flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors",children:[s.jsx(Xu,{className:"mr-2"}),"Retour"]}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-blue-800 text-white rounded-lg px-4 py-3 inline-block mb-4",children:[s.jsx("span",{className:"block font-bold text-lg",children:"#Vakio_Boky"}),s.jsx("span",{className:"block text-sm font-light",children:"Communaut Littraire"})]}),s.jsx(W.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-blue-900 text-2xl font-bold mb-2",children:"Vrification du code"}),s.jsxs(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-blue-600 text-sm",children:["Entrez le code  6 chiffres envoy  ",u]})]}),s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"space-y-6",children:[s.jsx("div",{className:"flex justify-center space-x-2 mb-6",children:r.map((x,b)=>s.jsx(W.input,{ref:w=>f.current[b]=w,type:"text",inputMode:"numeric",maxLength:"1",value:x,onChange:w=>m(b,w.target.value),onKeyDown:w=>g(b,w),className:"w-12 h-12 text-center text-lg font-bold border-2 border-blue-300 rounded-lg focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",whileFocus:{scale:1.05},transition:{type:"spring",stiffness:300},disabled:t},b))}),i&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:`p-3 rounded-lg text-sm text-center ${i.includes("")||i.includes("Nouveau code")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",onClick:v,disabled:t||r.some(x=>x===""),className:"w-full disabled:opacity-50",children:t?"Vrification...":"Vrifier le code"})}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-center",children:s.jsxs(W.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:y,disabled:o,className:"flex items-center justify-center text-blue-600 hover:text-blue-800 transition-colors mx-auto disabled:opacity-50",children:[s.jsx(Wr,{className:`mr-2 ${o?"animate-spin":""}`}),o?"Envoi en cours...":"Renvoyer le code"]})})]}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.9},className:"mt-8 text-center",children:s.jsx("p",{className:"text-blue-400 text-xs",children:"Le code expire dans 15 minutes"})})]})})}function dO(){const[r,e]=R.useState({password:"",confirmPassword:""}),[t,n]=R.useState(!1),[i,a]=R.useState(""),[o,l]=R.useState(!1),[u,h]=R.useState(""),c=qs();R.useEffect(()=>{const g=localStorage.getItem("resetToken"),v=localStorage.getItem("resetEmail");!g||!v?c("/forgot-password"):h(g)},[c]);const f=(g,v)=>{e(y=>({...y,[g]:v}))},m=async g=>{if(g.preventDefault(),r.password!==r.confirmPassword){a("Les mots de passe ne correspondent pas");return}if(r.password.length<6){a("Le mot de passe doit contenir au moins 6 caractres");return}n(!0),a("");try{const v=localStorage.getItem("resetEmail"),y=await fetch("https://vakio-boky-backend.onrender.com/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:v,token:u,newPassword:r.password})}),x=await y.json();y.ok?(l(!0),localStorage.removeItem("resetEmail"),localStorage.removeItem("resetToken"),setTimeout(()=>{c("/login")},3e3)):a(x.error||"Erreur lors de la rinitialisation")}catch(v){console.error("Erreur:",v),a("Erreur de connexion au serveur")}finally{n(!1)}};return o?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md text-center",children:[s.jsx(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-green-500 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:s.jsx(ms,{size:24})}),s.jsx(W.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-2xl font-bold text-blue-900 mb-2",children:"Mot de passe rinitialis !"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-blue-600 mb-6",children:"Vous pouvez maintenant vous connecter avec votre nouveau mot de passe."}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"w-full bg-blue-200 rounded-full h-2 mb-4",children:s.jsx(W.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:3,ease:"linear"},className:"bg-blue-600 h-2 rounded-full"})}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-blue-400 text-sm",children:"Redirection vers la page de connexion..."})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 flex items-center justify-center p-4",children:s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-8 w-full max-w-md",children:[s.jsxs(W.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c("/verify-code"),className:"flex items-center text-blue-600 hover:text-blue-800 mb-6 transition-colors",children:[s.jsx(Xu,{className:"mr-2"}),"Retour"]}),s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"bg-blue-800 text-white rounded-lg px-4 py-3 inline-block mb-4",children:[s.jsx("span",{className:"block font-bold text-lg",children:"#Vakio_Boky"}),s.jsx("span",{className:"block text-sm font-light",children:"Communaut Littraire"})]}),s.jsx(W.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-blue-900 text-2xl font-bold mb-2",children:"Nouveau mot de passe"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-blue-600 text-sm",children:"Choisissez un nouveau mot de passe scuris"})]}),s.jsxs(W.form,{onSubmit:m,initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Nouveau mot de passe"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"password",placeholder:"Minimum 6 caractres",value:r.password,onChange:g=>f("password",g.target.value),icon:s.jsx(zl,{className:"text-blue-400"}),required:!0,minLength:"6"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-blue-900 text-sm font-medium block",children:"Confirmer le mot de passe"}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(Ve,{variant:"primary",size:"lg",type:"password",placeholder:"Rptez le mot de passe",value:r.confirmPassword,onChange:g=>f("confirmPassword",g.target.value),icon:s.jsx(zl,{className:"text-blue-400"}),required:!0})}),r.confirmPassword&&r.password!==r.confirmPassword&&s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},className:"text-red-500 text-xs",children:"Les mots de passe ne correspondent pas"})]}),i&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:`p-3 rounded-lg text-sm ${i.includes("rinitialis")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:i}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:t||!r.password||!r.confirmPassword||r.password!==r.confirmPassword,className:"w-full disabled:opacity-50",children:t?"Rinitialisation...":"Rinitialiser le mot de passe"})})]}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"mt-8 text-center",children:s.jsx("p",{className:"text-blue-400 text-xs",children:"Utilisez un mot de passe fort et unique"})})]})})}function uO(){const[r,e]=R.useState(""),[t,n]=R.useState(""),[i,a]=R.useState(""),[o,l]=R.useState(!1),[u,h]=R.useState(""),c=async f=>{f.preventDefault(),l(!0),h("");try{const m=await fetch("https://vakio-boky-backend.onrender.com/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nom:r,email:t,message:i})}),g=await m.json();m.ok?(h(" Votre message a t envoy !"),e(""),n(""),a("")):h(g.error||"Erreur lors de l'envoi du message.")}catch(m){console.error(m),h("Erreur de connexion au serveur.")}finally{l(!1)}};return s.jsxs(W.form,{onSubmit:c,className:"max-w-lg mx-auto space-y-4",children:[s.jsx(Ve,{type:"text",placeholder:"Votre nom",value:r,onChange:f=>e(f.target.value),required:!0}),s.jsx(Ve,{type:"email",placeholder:"Votre email",value:t,onChange:f=>n(f.target.value),required:!0}),s.jsx("textarea",{placeholder:"Votre message",value:i,onChange:f=>a(f.target.value),required:!0,className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",rows:5}),u&&s.jsx("p",{className:`text-sm ${u.includes("")?"text-green-700":"text-red-700"}`,children:u}),s.jsx(oe,{type:"submit",variant:"primary",size:"lg",disabled:o,children:o?"Envoi en cours...":"Envoyer le message"})]})}function hO({livre:r,isOpen:e,onClose:t}){return!e||!r?null:s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6 relative shadow-lg",children:[s.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-lg font-bold",children:""}),s.jsx("img",{src:r.couverture_url,alt:r.titre,className:"w-full h-60 object-cover rounded mb-4"}),s.jsx("h2",{className:"text-2xl font-bold mb-2",children:r.titre}),s.jsx("p",{className:"text-gray-600 mb-2 line-clamp-4",children:r.description||"Aucune description disponible."}),s.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["Genre: ",r.genre]}),r.isbn&&s.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["ISBN: ",r.isbn]}),s.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Fermer"}),s.jsx("button",{onClick:()=>window.location.href="/login",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Se connecter"})]})]})})}function fO({eventId:r,isOpen:e,onClose:t}){const[n,i]=R.useState(null),[a,o]=R.useState(!1),[l,u]=R.useState(null),h="https://vakio-boky-backend.onrender.com/api";R.useEffect(()=>{e&&r&&c()},[e,r]);const c=async()=>{try{o(!0),u(null);const g=await fetch(`${h}/events/${r}/detail`);if(!g.ok)throw new Error("Erreur lors de la rcupration des dtails");const v=await g.json();if(v.success)i(v.data);else throw new Error(v.message||"Erreur inconnue")}catch(g){console.error("Erreur dtail vnement:",g),u(g.message)}finally{o(!1)}},f=g=>new Date(g).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),m=g=>{const v=parseFloat(g);return v===0?"Gratuit":`${v.toFixed(2)} `};return e?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full p-6 relative shadow-lg max-h-[90vh] overflow-y-auto",children:[s.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-lg font-bold z-10 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-md",children:""}),a&&s.jsx("div",{className:"flex justify-center items-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),l&&s.jsxs("div",{className:"text-center py-8",children:[s.jsxs("p",{className:"text-red-500 mb-4",children:["Erreur: ",l]}),s.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Ressayer"})]}),n&&!a&&s.jsxs("div",{className:"space-y-6",children:[n.image_url&&s.jsx("img",{src:n.image_url,alt:n.title,className:"w-full h-64 object-cover rounded-lg mb-4"}),s.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:n.title}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3 text-lg text-gray-700",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("span",{className:"font-semibold",children:f(n.event_date)})]}),s.jsxs("div",{className:"flex items-center gap-3 text-lg text-gray-700",children:[s.jsxs("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{className:"font-semibold",children:n.location})]}),s.jsxs("div",{className:"flex items-center gap-3 text-lg text-gray-700",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),s.jsx("span",{className:"font-semibold",children:m(n.price)})]}),n.max_participants&&s.jsxs("div",{className:"flex items-center gap-3 text-lg text-gray-700",children:[s.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsxs("span",{className:"font-semibold",children:[n.max_participants," participants maximum"]})]})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:"Description"}),s.jsx("p",{className:"text-gray-600 leading-relaxed text-lg",children:n.description||"Aucune description disponible pour cet vnement."})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[s.jsx("button",{onClick:t,className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 font-semibold transition-colors duration-200",children:"Fermer"}),s.jsx("button",{onClick:()=>window.location.href="/login",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition-colors duration-200 shadow-md hover:shadow-lg",children:"S'inscrire  l'vnement"})]})]})]})}):null}const l1="https://vakio-boky-backend.onrender.com/api";function mO(){const r=qs(),[e,t]=R.useState({testimonials:[],events:[],authors:[],stats:null}),[n,i]=R.useState(!0),[a,o]=R.useState(null),[l,u]=R.useState([]),[h,c]=R.useState(null),[f,m]=R.useState(!1),[g,v]=R.useState(null),[y,x]=R.useState(!1),b=(z,G="book")=>{if(!z||z.includes("via.placeholder.com")||z.includes("placeholder.com"))switch(G){case"book":return"/assets/images/books/book-default.png";case"author":return"/assets/images/authors/author-default.png";case"event":return"/assets/images/events/event-default.png";case"profile":return"/assets/images/profiles/profile-default.png";default:return"/assets/images/default-image.png"}const Y="https://vakio-boky-backend.onrender.com";if(z.startsWith("http"))return z;if(z.startsWith("/uploads/"))return`${Y}${z}`;if(z.includes("//uploads/profiles/")){const H=z.split("/").pop();return`${Y}/uploads/profiles/${H}`}return z};R.useEffect(()=>{(async()=>{try{console.log(" Rcupration des livres rcents depuis l'API...");const G=await fetch(`${l1}/books/recent`);if(!G.ok)throw new Error(`HTTP ${G.status}: ${G.statusText}`);const Y=await G.json();if(console.log(" Rponse API:",Y),Y.success&&Y.books){const H=Y.books.map(V=>({...V,couverture_url:b(V.couverture_url||V.cover,"book")}));console.log(` ${H.length} livres chargs`),u(H)}else if(Array.isArray(Y)){const H=Y.map(V=>({...V,couverture_url:b(V.couverture_url||V.cover,"book")}));console.log(` ${H.length} livres chargs`),u(H)}else console.warn("Format de donnes inattendu:",Y),u([{id:1,titre:"Ny Onja",description:"Roman potique sur la vie  Madagascar",couverture_url:"/assets/images/books/book-default.png",genre:"Roman",auteur:"Johary Ravaloson"},{id:2,titre:"Dernier Crpuscule",description:"Histoire d'une famille malgache",couverture_url:"/assets/images/books/book-default.png",genre:"Roman",auteur:"Michle Rakotoson"},{id:3,titre:"Contes de Madagascar",description:"Contes traditionnels malgaches",couverture_url:"/assets/images/books/book-default.png",genre:"Contes",auteur:"Collectif"}])}catch(G){console.error(" Erreur rcupration livres:",G),u([{id:1,titre:"Ny Onja",description:"Roman potique sur la vie  Madagascar",couverture_url:"/assets/images/books/book-default.png",genre:"Roman",auteur:"Johary Ravaloson"},{id:2,titre:"Dernier Crpuscule",description:"Histoire d'une famille malgache",couverture_url:"/assets/images/books/book-default.png",genre:"Roman",auteur:"Michle Rakotoson"},{id:3,titre:"Contes de Madagascar",description:"Contes traditionnels malgaches",couverture_url:"/assets/images/books/book-default.png",genre:"Contes",auteur:"Collectif"}])}})()},[]),R.useEffect(()=>{(async()=>{try{i(!0),o(null),console.log(" Appel API landing data...");const G=await fetch(`${l1}/landing/data`);if(!G.ok)throw new Error(`Erreur HTTP: ${G.status}`);const Y=await G.json();if(console.log(" Donnes landing reues:",{testimonials:Y.data?.testimonials?.length||0,events:Y.data?.events?.length||0,authors:Y.data?.authors?.length||0,hasStats:!!Y.data?.stats}),Y.success){const H={testimonials:Y.data.testimonials||[],events:(Y.data.events||[]).map(V=>({...V,image_url:b(V.image_url,"event")})),authors:(Y.data.authors||[]).map(V=>({...V,image:b(V.image,"author")})),stats:Y.data.stats||null};t(H)}else throw new Error(Y.message||"Erreur inconnue du serveur")}catch(G){console.error(" Erreur chargement donnes landing:",G),o(G.message),t({testimonials:[],events:[],authors:[],stats:null})}finally{i(!1)}})()},[]);const w=z=>{c(z),m(!0)},k=()=>{c(null),m(!1)},N=z=>{v(z),x(!0)},E=()=>{v(null),x(!1)},S=()=>{r("/login")},A=()=>{r("/register")},C=[{icon:s.jsx(et,{className:"text-3xl mb-4"}),title:"Bibliothque Digitale",description:"Accdez  des milliers de livres numriques et physiques"},{icon:s.jsx(Me,{className:"text-3xl mb-4"}),title:"Communaut Active",description:"changez avec d'autres passionns de lecture"},{icon:s.jsx(Je,{className:"text-3xl mb-4"}),title:"vnements Littraires",description:"Participez  des rencontres et ateliers en ligne"},{icon:s.jsx(lP,{className:"text-3xl mb-4"}),title:"Marketplace",description:"Achetez et vendez vos livres en toute scurit"},{icon:s.jsx($t,{className:"text-3xl mb-4"}),title:"Soutien aux Auteurs",description:"Financez des projets littraires prometteurs"},{icon:s.jsx(fs,{className:"text-3xl mb-4"}),title:"Reconnaissance",description:"Gagnez des badges et dfis de lecture"}],I=[{step:"01",title:"Inscription Rapide",desc:"Crez votre profil en 2 minutes seulement",icon:s.jsx(Ct,{className:"text-blue-600 text-2xl"})},{step:"02",title:"Exploration",desc:"Dcouvrez livres, auteurs et communauts",icon:s.jsx(et,{className:"text-blue-600 text-2xl"})},{step:"03",title:"Interaction",desc:"Participez aux discussions et vnements",icon:s.jsx(Ul,{className:"text-blue-600 text-2xl"})}],L=z=>{try{return new Date(z).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}catch{return"Date  venir"}},M=z=>z.title?.toLowerCase().includes("rencontre")?"Rencontre":z.title?.toLowerCase().includes("webinaire")?"Webinaire":z.title?.toLowerCase().includes("atelier")?"Atelier":"vnement",D=z=>z.author?.charAt(0)?.toUpperCase()||z.name?.charAt(0)?.toUpperCase()||"U",F=z=>z.content||z.contenu||z.message||"Excellent service !",q=z=>z.author||z.name||"Membre",B=z=>z.role||"Membre Vakio Boky";return n?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Qk,{className:"animate-spin text-4xl text-blue-600 mx-auto mb-4"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 blur-lg opacity-20 animate-pulse"})]}),s.jsx("p",{className:"text-gray-600 font-medium",children:"Chargement de votre sanctuaire littraire..."})]})}):s.jsxs("div",{className:"min-h-screen text-gray-900 overflow-hidden bg-white",children:[s.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat blur-sm scale-105",style:{backgroundImage:"url('/assets/images/home.jpeg')"}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-900/60 to-purple-900/40"}),s.jsxs("div",{className:"relative z-10 pt-14 min-h-screen flex flex-col",children:[s.jsx(MS,{}),s.jsx("main",{id:"hero",className:"flex-1 flex flex-col items-center justify-center text-center px-6 py-24 animate-fadeIn",children:s.jsxs(W.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"max-w-6xl mx-auto",children:[s.jsxs("h1",{className:"text-5xl md:text-7xl font-extrabold text-white mb-6 drop-shadow-2xl leading-tight",children:["Votre"," ",s.jsx("span",{className:"text-blue-300 bg-gradient-to-r from-blue-300 to-cyan-300 bg-clip-text text-transparent",children:"Sanctuaire"})]}),s.jsx("h2",{className:"text-6xl md:text-8xl mb-12 text-blue-200 animate-fadeIn delay-200 font-serif italic",style:{fontFamily:"'UnifrakturCook', cursive",fontWeight:700,textShadow:"3px 3px 8px rgba(0,0,0,0.7)"},children:"Littraire"}),s.jsx("div",{className:"max-w-4xl mx-auto space-y-4 animate-fadeIn delay-400",children:s.jsx("p",{className:"text-xl md:text-2xl leading-relaxed font-light text-gray-100 bg-black/20 backdrop-blur-sm rounded-2xl p-6 border border-white/10",children:" Plongez dans un univers o les mots prennent vie et les discussions veillent les esprits. Rejoignez notre cercle d'auteurs, de lecteurs et de passionns des livres. "})}),s.jsx("div",{className:"flex flex-wrap gap-6 justify-center mt-12 animate-fadeIn delay-600",children:s.jsx(oe,{variant:"primary",size:"lg",onClick:S,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300",children:"Dcouvrir la plateforme"})})]})})]})]}),s.jsx(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-gradient-to-br from-white to-blue-50/30",id:"features",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsxs("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:["Pourquoi rejoindre"," ",s.jsx("span",{className:"text-blue-600",children:"Vakio Boky"})," ?"]}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Dcouvrez une plateforme complte ddie  la littrature malagasy et francophone"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:C.map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:G*.1},whileHover:{scale:1.05,y:-5},className:"group bg-white rounded-2xl p-8 text-center shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-100",children:[s.jsx("div",{className:"text-blue-600 flex justify-center group-hover:scale-110 transition-transform duration-300",children:z.icon}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4 group-hover:text-blue-600 transition-colors",children:z.title}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:z.description})]},G))})]})}),s.jsx(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-gradient-to-br from-gray-50 to-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:"Comment fonctionne Vakio Boky ?"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Rejoignez notre communaut en 3 tapes simples"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mt-12",children:I.map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:G*.2},whileHover:{y:-8},className:"relative text-center bg-white p-8 rounded-2xl shadow-xl border border-gray-100 group",children:[s.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full flex items-center justify-center text-lg font-bold shadow-lg",children:z.step}),s.jsx("div",{className:"flex justify-center mb-6 text-blue-600 group-hover:scale-110 transition-transform duration-300",children:z.icon}),s.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-800 group-hover:text-blue-600 transition-colors",children:z.title}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:z.desc})]},G))}),s.jsx("div",{className:"text-center mt-16",children:s.jsxs(oe,{variant:"primary",size:"lg",onClick:S,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl",children:["Commencer maintenant"," ",s.jsx(GD,{className:"ml-3 group-hover:translate-x-1 transition-transform"})]})})]})}),e.stats&&s.jsxs(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-20 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 text-white relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black/10"}),s.jsx("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[{value:e.stats?.total_books||0,label:"Livres disponibles"},{value:e.stats?.total_users||0,label:"Membres actifs"},{value:e.stats?.total_authors||0,label:"Auteurs locaux"},{value:e.stats?.upcoming_events||0,label:"vnements  venir"}].map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},transition:{duration:.5,delay:G*.1},className:"text-center",children:[s.jsxs("div",{className:"text-4xl md:text-5xl font-bold mb-3 text-white drop-shadow-lg",children:[z.value,"+"]}),s.jsx("div",{className:"text-blue-100 font-medium text-lg",children:z.label})]},G))})})]}),s.jsx(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:"Ils parlent de nous"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Dcouvrez les expriences de notre communaut"})]}),e?.testimonials?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.testimonials.slice(0,6).map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:G*.1},whileHover:{scale:1.02,y:-5},className:"bg-gradient-to-br from-white to-blue-50 p-8 rounded-2xl border border-blue-100 shadow-lg hover:shadow-xl transition-all duration-300",children:[s.jsx("div",{className:"flex items-center gap-2 mb-4",children:[...Array(5)].map((Y,H)=>s.jsx(Nt,{className:H<(z.rating||5)?"text-yellow-400 fill-current":"text-gray-300"},H))}),s.jsxs("p",{className:"text-gray-700 italic text-lg leading-relaxed mb-6",children:['"',F(z),'"']}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg shadow-lg",children:D(z)}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-gray-800 text-lg",children:q(z)}),s.jsx("div",{className:"text-blue-600 font-medium",children:B(z)})]})]})]},z.id||G))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Aucun tmoignage slectionn pour le moment."}),a&&s.jsxs("p",{className:"text-sm text-red-500",children:["Erreur: ",a]})]})]})}),s.jsxs(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 text-white relative overflow-hidden",id:"events",children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-white",children:"vnements  ne pas manquer"}),s.jsx("p",{className:"text-xl text-blue-100 max-w-3xl mx-auto",children:"Dcouvrez les prochains vnements gnraux et de clubs"})]}),e?.events?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-12",children:e.events.slice(0,6).map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:G*.1},whileHover:{scale:1.05,y:-5},className:"bg-white/10 backdrop-blur-lg p-8 rounded-2xl border border-white/20 shadow-xl hover:shadow-2xl transition-all duration-300",children:[z.image_url?s.jsx("img",{src:z.image_url,alt:z.title,className:"w-full h-48 object-cover rounded-xl mb-6 shadow-lg",onError:Y=>{Y.target.onerror=null,Y.target.src="/assets/images/events/event-default.png"}}):s.jsx("div",{className:"w-full h-48 bg-gradient-to-r from-blue-500/30 to-purple-500/30 rounded-xl mb-6 flex items-center justify-center",children:s.jsx(Je,{className:"text-white/50 text-4xl"})}),s.jsx("div",{className:"text-2xl font-bold text-blue-200 mb-2",children:L(z.event_date)}),s.jsx("div",{className:"inline-block bg-white/20 text-white text-sm px-4 py-2 rounded-full mb-4 backdrop-blur-sm",children:M(z)}),s.jsx("h3",{className:"text-2xl font-bold mt-2 mb-4 text-white leading-tight line-clamp-2",children:z.title||"vnement sans titre"}),z.description&&s.jsx("p",{className:"text-blue-100 text-base mb-4 leading-relaxed line-clamp-3",children:z.description}),s.jsxs("div",{className:"space-y-3 text-blue-100 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Mn,{className:"text-blue-200 text-lg"}),s.jsx("span",{className:"text-base",children:z.location||"En ligne"})]}),z.max_participants&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Me,{className:"text-blue-200 text-lg"}),s.jsxs("span",{className:"text-base",children:[z.current_participants||0," participants",` / ${z.max_participants} max`]})]})]}),s.jsx(oe,{variant:"outline",size:"lg",onClick:()=>N(z.id),className:"w-full bg-white/10 hover:bg-white/20 border-white/30 text-white font-semibold py-3 rounded-xl transition-all duration-300",children:"Voir dtails"})]},z.id||G))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsxs("div",{className:"inline-block p-8 bg-white/10 backdrop-blur-sm rounded-2xl",children:[s.jsx(Je,{className:"text-blue-200 text-4xl mx-auto mb-4"}),s.jsx("p",{className:"text-blue-100 text-lg mb-2",children:"Aucun vnement  venir pour le moment."}),s.jsx("p",{className:"text-blue-200 text-sm",children:"Revenez bientt pour dcouvrir nos prochains vnements"})]}),a&&s.jsxs("p",{className:"text-sm text-blue-200 mt-4",children:["Erreur de chargement: ",a]})]}),s.jsx(fO,{eventId:g,isOpen:y,onClose:E})]})]}),s.jsx(W.section,{id:"about",className:"py-24 bg-gradient-to-br from-gray-50 to-white",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},children:s.jsx("div",{className:"max-w-4xl mx-auto px-6 text-center",children:s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-8",children:" propos de Vakio Boky"}),s.jsx("p",{className:"text-gray-600 text-xl leading-relaxed bg-white/50 backdrop-blur-sm rounded-2xl p-8 border border-gray-100 shadow-lg",children:"Vakio Boky est la plateforme incontournable pour les passionns de lecture  Madagascar. Nous runissons lecteurs, auteurs et crateurs dans un espace numrique o chaque livre prend vie. Explorez des ebooks locaux et internationaux, participez  des vnements littraires et soutenez les talents mergents. Notre objectif? Rendre la lecture accessible, interactive et inspirante pour tous. Chez Vakio Boky, nous croyons que la lecture transforme les ides, les communauts et les vies. Rejoignez notre univers et laissez vos mots s'envoler."})]})})}),s.jsx(W.section,{id:"catalogue",className:"py-24 bg-white",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},children:s.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:"Catalogue d'ebooks"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Dcouvrez une slection de nos livres les plus populaires"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:l.length>0?l.slice(0,6).map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:G*.1},whileHover:{y:-8},className:"bg-white rounded-2xl shadow-lg hover:shadow-2xl border border-gray-100 overflow-hidden transition-all duration-300 group",children:[s.jsxs("div",{className:"relative overflow-hidden h-64",children:[s.jsx("img",{src:z.couverture_url,alt:z.titre||"Livre",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:Y=>{Y.target.onerror=null,Y.target.src="/assets/images/books/book-default.png"}}),s.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors duration-300"})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"font-bold text-xl text-gray-800 mb-3 group-hover:text-blue-600 transition-colors line-clamp-2",children:z.titre||"Titre non disponible"}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3 leading-relaxed",children:z.description||"Aucune description disponible."}),z.genre&&s.jsx("span",{className:"inline-block bg-gradient-to-r from-blue-100 to-purple-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-4",children:z.genre}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("button",{onClick:()=>w(z),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl font-semibold",children:"Voir plus"}),s.jsx("button",{onClick:()=>r("/login"),className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors duration-300",children:"Se connecter"})]})]})]},z.id||G)):s.jsx("div",{className:"col-span-full text-center py-12",children:s.jsxs("div",{className:"inline-block p-8 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl",children:[s.jsx(et,{className:"text-4xl text-blue-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Aucun livre disponible pour le moment."}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Nos livres seront bientt disponibles"})]})})}),s.jsx(hO,{livre:h,isOpen:f,onClose:k})]})}),s.jsx(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-gradient-to-br from-amber-50 to-orange-50",id:"auteur",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsxs("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:["Dcouvrez nos"," ",s.jsx("span",{className:"text-amber-600",children:"auteurs promus"})]}),s.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Soutenez la littrature locale et dcouvrez des talents exceptionnels"})]}),e?.authors?.length>0?s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:e.authors.map((z,G)=>s.jsxs(W.div,{initial:{opacity:0,scale:.8},whileInView:{opacity:1,scale:1},transition:{duration:.6,delay:G*.1},whileHover:{y:-8,scale:1.05},className:"text-center bg-white p-8 rounded-2xl shadow-lg hover:shadow-2xl border border-amber-100 transition-all duration-300 group",children:[s.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-amber-200 to-orange-200 rounded-full mx-auto mb-6 flex items-center justify-center text-amber-800 font-bold text-2xl overflow-hidden shadow-lg group-hover:shadow-xl transition-all duration-300",children:z.image?s.jsx("img",{src:z.image,alt:z.name,className:"w-full h-full object-cover",onError:Y=>{Y.target.onerror=null,Y.target.src="/assets/images/authors/author-default.png"}}):s.jsx(Vj,{className:"text-amber-600 text-2xl"})}),s.jsx("h3",{className:"font-bold text-xl text-gray-800 mb-2 group-hover:text-amber-600 transition-colors line-clamp-2",children:z.name||"Auteur inconnu"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3 font-medium line-clamp-2",children:z.author_genre||"Auteur"}),z.bio&&s.jsx("p",{className:"text-sm text-gray-500 mb-4 leading-relaxed line-clamp-3",children:z.bio}),s.jsxs("div",{className:"text-sm font-semibold text-amber-600 bg-amber-50 px-4 py-2 rounded-full",children:[z.published_works||1," uvre(s)"]})]},z.id||G))}):s.jsx("div",{className:"text-center py-12",children:s.jsxs("div",{className:"inline-block p-8 bg-white/80 backdrop-blur-sm rounded-2xl",children:[s.jsx(Vj,{className:"text-amber-400 text-4xl mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg mb-2",children:"Aucun auteur disponible pour le moment."}),s.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Nos auteurs seront bientt prsents ici."}),a&&s.jsxs("p",{className:"text-sm text-red-500 mt-2",children:["Erreur: ",a]})]})})]})}),s.jsx(W.section,{id:"contact",className:"py-24 bg-gradient-to-br from-gray-50 to-blue-50",initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},children:s.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-16",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-800 mb-6",children:"Contact"}),s.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Vous avez des questions ? Notre quipe est l pour vous aider."})]}),s.jsx(uO,{})]})}),s.jsxs(W.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.8},className:"py-24 px-6 bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 text-white text-center relative overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsx("div",{className:"max-w-5xl mx-auto relative z-10",children:s.jsxs(W.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-8 text-white drop-shadow-lg",children:"Prt  commencer votre aventure littraire ?"}),s.jsx("p",{className:"text-xl text-blue-100 mb-12 max-w-3xl mx-auto leading-relaxed",children:"Rejoignez ds maintenant la communaut Vakio Boky et transformez votre passion pour la lecture en exprience enrichissante."}),s.jsx("div",{className:"flex flex-wrap gap-6 justify-center",children:s.jsx(oe,{variant:"primary",size:"lg",onClick:A,className:"bg-white text-blue-600 hover:bg-gray-100 hover:text-blue-700 shadow-2xl hover:shadow-3xl transform hover:scale-105 transition-all duration-300 font-bold px-8 py-4 text-lg rounded-2xl",children:"Crer mon compte gratuit"})}),s.jsx("p",{className:"text-blue-200 text-lg mt-8 font-medium",children:"Aucune carte de crdit requise  Essai gratuit  Annulation  tout moment"})]})})]})]})}const OS=()=>{const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState(!1),[o,l]=R.useState(""),[u,h]=R.useState(""),f=st().user?.token,m=()=>{const C={"Content-Type":"application/json"};return f&&(C.Authorization=`Bearer ${f}`),C},g=C=>{h(C),setTimeout(()=>h(""),3e3)},v=(C,I)=>{const L=C.message||I;throw l(L),console.error("Erreur livres:",C),new Error(L)},y=async()=>{try{a(!0),l("");const C=await fetch("https://vakio-boky-backend.onrender.com/api/books",{method:"GET",headers:m()});if(!C.ok)throw new Error(`Erreur ${C.status}: ${C.statusText}`);const I=await C.json();return e(Array.isArray(I)?I:[]),I}catch(C){v(C,"Erreur lors du chargement des livres")}finally{a(!1)}},x=async()=>{try{a(!0),l("");const C=await fetch("https://vakio-boky-backend.onrender.com/api/books/mes-livres",{method:"GET",headers:m()});if(!C.ok)throw new Error(`Erreur ${C.status}: ${C.statusText}`);const I=await C.json(),L=I.books||I||[];return n(Array.isArray(L)?L:[]),L}catch(C){v(C,"Erreur lors du chargement de vos livres")}finally{a(!1)}};return{books:r,myBooks:t,loading:i,error:o,success:u,fetchBooks:y,fetchMyBooks:x,fetchBook:async C=>{try{a(!0),l("");const I=await fetch(`https://vakio-boky-backend.onrender.com/api/books/${C}`,{method:"GET",headers:m()});if(!I.ok)throw new Error(`Erreur ${I.status}: ${I.statusText}`);const L=await I.json();return L.book||L}catch(I){v(I,"Erreur lors du chargement du livre")}finally{a(!1)}},createBook:async C=>{try{a(!0),l("");const I=await fetch("https://vakio-boky-backend.onrender.com/api/books",{method:"POST",headers:m(),body:JSON.stringify(C)});if(!I.ok)throw new Error(`Erreur ${I.status}: ${I.statusText}`);const L=await I.json();return g(L.message||"Livre cr avec succs"),await x(),L}catch(I){v(I,"Erreur lors de la cration du livre")}finally{a(!1)}},updateBook:async(C,I)=>{try{a(!0),l("");const L=await fetch(`https://vakio-boky-backend.onrender.com/api/books/${C}`,{method:"PUT",headers:m(),body:JSON.stringify(I)});if(!L.ok)throw new Error(`Erreur ${L.status}: ${L.statusText}`);const M=await L.json();return g(M.message||"Livre modifi avec succs"),await Promise.all([y(),x()]),M}catch(L){v(L,"Erreur lors de la modification du livre")}finally{a(!1)}},deleteBook:async C=>{try{a(!0),l("");const I=await fetch(`https://vakio-boky-backend.onrender.com/api/books/${C}`,{method:"DELETE",headers:m()});if(!I.ok)throw new Error(`Erreur ${I.status}: ${I.statusText}`);const L=await I.json();return g(L.message||"Livre supprim avec succs"),await Promise.all([y(),x()]),L}catch(I){v(I,"Erreur lors de la suppression du livre")}finally{a(!1)}},clearError:()=>l(""),clearSuccess:()=>h(""),reset:()=>{e([]),n([]),l(""),h(""),a(!1)},setBooks:e,setMyBooks:n}},LS=({book:r,onEdit:e,onDelete:t,showActions:n=!1})=>s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[r.couverture_url&&s.jsx("img",{src:r.couverture_url,alt:r.titre,className:"w-full h-48 object-cover rounded-md mb-4"}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:r.titre}),s.jsxs("p",{className:"text-gray-600 mb-2",children:["Auteur: ",r.auteur_nom]}),s.jsxs("p",{className:"text-gray-500 text-sm mb-3",children:["Genre: ",r.genre]}),r.description&&s.jsx("p",{className:"text-gray-700 mb-4 line-clamp-3",children:r.description}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.statut==="publi"?"bg-green-100 text-green-800":r.statut==="brouillon"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:r.statut}),n&&s.jsxs("div",{className:"space-x-2",children:[s.jsx("button",{onClick:()=>e(r),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"Modifier"}),s.jsx("button",{onClick:()=>t(r.id),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm",children:"Supprimer"})]})]})]});function rh(){const[r,e]=R.useState(!1),[t,n]=R.useState(null),a=st().user?.token;return{uploading:r,error:t,uploadMedias:async h=>{if(!a)return{success:!1,error:"Non authentifi"};if(!h||h.length===0)return{success:!1,error:"Aucun fichier slectionn"};e(!0),n(null);try{const c=new FormData;for(let g=0;g<h.length;g++)c.append("fichiers",h[g]);console.log(" [useMedias] Dbut upload de",h.length,"fichier(s)");const m=await(await fetch("https://vakio-boky-backend.onrender.com/api/medias/upload",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:c})).json();return console.log(" [useMedias] Rponse upload:",m),m.success?(console.log(" [useMedias] Upload russi:",m.medias.length,"mdia(s)"),{success:!0,medias:m.medias}):(n(m.error),console.log(" [useMedias] Erreur upload:",m.error),{success:!1,error:m.error})}catch(c){const f="Erreur de connexion lors de l'upload";return n(f),console.error(" [useMedias] Erreur upload:",c),{success:!1,error:f}}finally{e(!1)}},setLivreCouverture:async(h,c)=>{if(!a)return{success:!1,error:"Non authentifi"};try{console.log(" [useMedias] Association couverture:",{livreId:h,mediaId:c});const m=await(await fetch(`https://vakio-boky-backend.onrender.com/api/medias/livres/${h}/couverture`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({mediaId:c})})).json();return m.success?(console.log(" [useMedias] Couverture associe avec succs"),{success:!0,couverture:m.couverture}):(console.log(" [useMedias] Erreur association:",m.error),{success:!1,error:m.error})}catch(f){return console.error(" [useMedias] Erreur association couverture:",f),{success:!1,error:"Erreur de connexion"}}},deleteMedia:async h=>{if(!a)return{success:!1,error:"Non authentifi"};try{console.log(" [useMedias] Suppression mdia:",h);const f=await(await fetch(`https://vakio-boky-backend.onrender.com/api/medias/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})).json();return f.success?(console.log(" [useMedias] Mdia supprim avec succs"),{success:!0}):(console.log(" [useMedias] Erreur suppression:",f.error),{success:!1,error:f.error})}catch(c){return console.error(" [useMedias] Erreur suppression mdia:",c),{success:!1,error:"Erreur de connexion"}}}}}const IS=({book:r,onSubmit:e,onCancel:t})=>{const{uploadMedias:n,uploading:i}=rh(),[a,o]=R.useState({titre:"",description:"",couverture_url:"",genre:"",isbn:"",statut:"brouillon"}),[l,u]=R.useState(null),[h,c]=R.useState(""),[f,m]=R.useState(!1);R.useEffect(()=>{r&&(o(r),r.couverture_url&&c(r.couverture_url))},[r]);const g=w=>{const k=w.target.files[0];if(k){if(!k.type.startsWith("image/")){alert("Veuillez slectionner une image valide (JPEG, PNG, etc.)");return}if(k.size>5*1024*1024){alert("L'image ne doit pas dpasser 5MB");return}u(k);const N=new FileReader;N.onload=E=>c(E.target.result),N.readAsDataURL(k),o(E=>({...E,couverture_url:""}))}},v=async()=>{if(!l)return null;m(!0);try{const w=await n([l]);return w.success&&w.medias&&w.medias.length>0?w.medias[0].url:(console.error("Erreur upload:",w.error),null)}catch(w){return console.error("Erreur lors de l'upload:",w),null}finally{m(!1)}},y=w=>{const{name:k,value:N}=w.target;o(E=>({...E,[k]:N}))},x=async w=>{w.preventDefault();let k={...a};if(l){const N=await v();if(N)k.couverture_url=N;else{alert("Erreur lors de l'upload de l'image");return}}e(k)},b=()=>{u(null),c(""),o(w=>({...w,couverture_url:""}))};return s.jsxs("form",{onSubmit:x,className:"bg-white p-6 rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:r?"Modifier le livre":"Nouveau livre"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Couverture du livre"}),s.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:h?s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("img",{src:h,alt:"Aperu de la couverture",className:"max-h-40 max-w-full object-contain mb-2 rounded"}),s.jsx("button",{type:"button",onClick:b,className:"text-sm text-red-600 hover:text-red-800",children:"Supprimer l'image"})]}):s.jsxs("div",{children:[s.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",id:"cover-upload"}),s.jsx("label",{htmlFor:"cover-upload",className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"Cliquez pour slectionner une image"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Formats accepts: JPEG, PNG, WebP (max 5MB)"})]})}),f&&s.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Upload en cours..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"OU URL de la couverture"}),s.jsx("input",{type:"url",name:"couverture_url",value:a.couverture_url,onChange:y,placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!l}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Utilisez ce champ si vous avez dj une URL d'image"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre *"}),s.jsx("input",{type:"text",name:"titre",value:a.titre,onChange:y,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{name:"description",value:a.description,onChange:y,rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Genre"}),s.jsx("input",{type:"text",name:"genre",value:a.genre,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISBN"}),s.jsx("input",{type:"text",name:"isbn",value:a.isbn,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),s.jsxs("select",{name:"statut",value:a.statut,onChange:y,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"publi",children:"Publi"}),s.jsx("option",{value:"archiv",children:"Archiv"})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:f,children:"Annuler"}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-400",disabled:f||i,children:f?"Upload...":r?"Modifier":"Crer"})]})]})};function BS(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),o=st(),l=o.user?.token;o.user?.user;const u=async()=>{if(!l){a("Veuillez vous reconnecter");return}try{n(!0),a(null);const g=await(await fetch("https://vakio-boky-backend.onrender.com/api/posts",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}})).json();g.posts?e(g.posts):a(g.error||"Erreur inconnue du serveur")}catch(m){console.error("Erreur chargement posts:",m),a("Impossible de se connecter au serveur")}finally{n(!1)}},h=async m=>{if(!l)return{success:!1,error:"Non authentifi"};try{const v=await(await fetch("https://vakio-boky-backend.onrender.com/api/posts",{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(m)})).json();return v.post?(e(y=>[v.post,...y]),{success:!0,post:v.post}):{success:!1,error:v.error}}catch(g){return console.error("Erreur cration post:",g),{success:!1,error:"Erreur de connexion"}}},c=async m=>{if(!l)return{success:!1,error:"Non authentifi"};try{const v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${m}/like`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}})).json();return v.liked!==void 0?(e(y=>y.map(x=>x.id===m?{...x,user_liked:v.liked,likes_count:v.likes_count||0}:x)),{success:!0,liked:v.liked}):{success:!1,error:v.error}}catch(g){return console.error("Erreur like post:",g),{success:!1,error:"Erreur de connexion"}}},f=async m=>{if(!l)return{success:!1,error:"Non authentifi"};try{const v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${m}/share`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}})).json();return v.message?{success:!0,message:v.message}:{success:!1,error:v.error}}catch(g){return console.error("Erreur partage post:",g),{success:!1,error:"Erreur de connexion"}}};return R.useEffect(()=>{l?u():n(!1)},[l]),{posts:r,loading:t,error:i,createPost:h,toggleLike:c,sharePost:f,refetch:u}}function pO(){const[r,e]=R.useState(!1),n=st().user?.token;return{loading:r,toggleLike:async u=>{if(!n)return{success:!1,error:"Non authentifi"};e(!0);try{return await(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${u}/like`,{method:"POST",headers:{Authorization:`Bearer ${n}`}})).json()}catch(h){return console.error("Erreur like commentaire:",h),{success:!1,error:"Erreur de connexion"}}finally{e(!1)}},updateComment:async(u,h)=>{if(!n)return{success:!1,error:"Non authentifi"};e(!0);try{return await(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${u}`,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({contenu:h})})).json()}catch(c){return console.error("Erreur modification commentaire:",c),{success:!1,error:"Erreur de connexion"}}finally{e(!1)}},deleteComment:async u=>{if(!n)return{success:!1,error:"Non authentifi"};e(!0);try{const h=await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${u}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}});return h.ok?{success:!0}:{success:!1,error:(await h.json()).error}}catch(h){return console.error("Erreur suppression commentaire:",h),{success:!1,error:"Erreur de connexion"}}finally{e(!1)}},replyToComment:async(u,h)=>{if(!n)return{success:!1,error:"Non authentifi"};e(!0);try{return await(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${u}/replies`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({contenu:h})})).json()}catch(c){return console.error("Erreur rponse commentaire:",c),{success:!1,error:"Erreur de connexion"}}finally{e(!1)}}}}function gO({contentId:r,contentType:e,reportedUserId:t,reportedUserName:n,onClose:i}){const[a,o]=R.useState(""),[l,u]=R.useState(""),[h,c]=R.useState(!1),f={post:["Contenu inappropri","Harclement","Spam","Autre"],comment:["Commentaire inappropri","Harclement","Spam","Autre"],user:["Compte faux","Harclement","Contenu inappropri","Autre"]},m=async g=>{if(g.preventDefault(),!!a){c(!0);try{const v=localStorage.getItem("vakio_token"),x=await(await fetch("https://vakio-boky-backend.onrender.com/api/reports",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({content_id:r,content_type:e,reason:a,description:l,reported_user_id:t})})).json();x.success?(alert("Signalement envoy !"),i()):alert(x.error||"Erreur")}catch{alert("Erreur de connexion")}finally{c(!1)}}};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 text-red-600 rounded-lg",children:s.jsx(pi,{className:"w-6 h-6"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:"Signaler"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Aidez-nous  modrer"})]})]}),s.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(ot,{className:"w-5 h-5"})})]})}),s.jsxs("form",{onSubmit:m,className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block font-medium mb-3",children:"Raison *"}),s.jsx("div",{className:"space-y-2",children:f[e]?.map(g=>s.jsxs("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[s.jsx("input",{type:"radio",name:"reason",value:g,checked:a===g,onChange:v=>o(v.target.value),className:"mr-3 text-red-600"}),s.jsx("span",{children:g})]},g))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block font-medium mb-2",children:"Description (optionnel)"}),s.jsx("textarea",{value:l,onChange:g=>u(g.target.value),placeholder:"Dtails...",rows:3,className:"w-full p-3 border rounded-lg"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-3 border rounded-lg",children:"Annuler"}),s.jsx("button",{type:"submit",disabled:h||!a,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg disabled:opacity-50",children:h?"Envoi...":"Envoyer"})]})]})]})})}function FS({contentId:r,contentType:e,reportedUserId:t,reportedUserName:n,contentPreview:i="",className:a="",variant:o="icon"}){const[l,u]=R.useState(!1),h=()=>{if(!localStorage.getItem("vakio_token")){alert("Veuillez vous connecter pour signaler");return}u(!0)};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:h,className:`${o==="icon"?"p-2 text-gray-500 hover:text-red-500 hover:bg-red-50 rounded-lg":"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg"} ${a}`,title:"Signaler ce contenu",children:[s.jsx(pi,{className:"w-4 h-4"}),o!=="icon"&&s.jsx("span",{children:"Signaler"})]}),l&&s.jsx(gO,{contentId:r,contentType:e,reportedUserId:t,reportedUserName:n,contentPreview:i,onClose:()=>u(!1)})]})}function xO({comment:r,currentUserId:e,onUpdate:t,onDelete:n,onReply:i,showReply:a=!0}){const[o,l]=R.useState(!1),[u,h]=R.useState(r.contenu),[c,f]=R.useState(!1),[m,g]=R.useState(""),{loading:v,toggleLike:y,updateComment:x,deleteComment:b,replyToComment:w}=pO(),k=e===r.user_id,N=async()=>{const C=await y(r.id);C.success?t({...r,user_liked:C.liked,likes_count:C.likes_count}):console.error(" Erreur like:",C.error)},E=async()=>{if(!u.trim())return;const C=await x(r.id,u);C.success&&t&&(t(C.comment),l(!1))},S=async()=>{if(!confirm("Supprimer ce commentaire ?"))return;(await b(r.id)).success&&n&&n(r.id)},A=async()=>{if(!m.trim())return;const C=await w(r.id,m);C.success&&i&&(i(C.reply),f(!1),g(""))};return o?s.jsxs("div",{className:"mt-2 space-y-2",children:[s.jsx("textarea",{value:u,onChange:C=>h(C.target.value),className:"w-full border border-blue-300 rounded-lg p-2 text-sm focus:outline-none focus:border-blue-500 resize-none",rows:"2",autoFocus:!0}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:E,disabled:v||!u.trim(),className:"flex items-center gap-1 px-3 py-1 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600 disabled:opacity-50",children:[s.jsx(Er,{size:12}),"Sauvegarder"]}),s.jsxs("button",{onClick:()=>l(!1),className:"flex items-center gap-1 px-3 py-1 bg-gray-500 text-white rounded-lg text-sm hover:bg-gray-600",children:[s.jsx(ot,{size:12}),"Annuler"]})]})]}):s.jsxs("div",{className:"mt-2",children:[s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsxs("button",{onClick:N,disabled:v,className:`flex items-center gap-1 ${r.user_liked?"text-red-500 font-semibold":"text-gray-500 hover:text-red-500"}`,children:[s.jsx($t,{size:14,fill:r.user_liked?"currentColor":"none"}),s.jsx("span",{children:r.likes_count||0})]}),a&&s.jsx("button",{onClick:()=>f(!c),className:"flex items-center gap-1 text-gray-500 hover:text-blue-500",children:s.jsx("span",{children:"Rpondre"})}),k?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-1 text-gray-500 hover:text-blue-500",children:[s.jsx(as,{size:14}),s.jsx("span",{children:"Modifier"})]}),s.jsxs("button",{onClick:S,className:"flex items-center gap-1 text-gray-500 hover:text-red-500",children:[s.jsx(zt,{size:14}),s.jsx("span",{children:"Supprimer"})]})]}):s.jsx(FS,{contentId:r.id,contentType:"comment",reportedUserId:r.user_id,reportedUserName:r.user_nom,contentPreview:r.contenu,variant:"text",size:"sm",className:"flex items-center gap-1 text-gray-500 hover:text-red-500"})]}),c&&s.jsxs("div",{className:"mt-3 flex gap-2",children:[s.jsx("input",{type:"text",value:m,onChange:C=>g(C.target.value),placeholder:"crivez votre rponse...",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-blue-500"}),s.jsx("button",{onClick:A,disabled:v||!m.trim(),className:"bg-blue-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-blue-600 disabled:opacity-50",children:"Rpondre"}),s.jsx("button",{onClick:()=>f(!1),className:"bg-gray-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-gray-600",children:"Annuler"})]})]})}function zS({post:r,isOpen:e,onClose:t,onCommentAdded:n}){const[i,a]=R.useState([]),[o,l]=R.useState(""),[u,h]=R.useState(!1),[c,f]=R.useState(!0),m=st(),g=m.user?.user,v=m.user?.token,y=k=>{if(!k||!Array.isArray(k))return console.log(" flatComments n'est pas un tableau:",k),[];console.log(" Organisation de",k.length,"commentaires");const N=new Map,E=[];return k.forEach(S=>{S&&S.id&&N.set(S.id,{...S,replies:[]})}),k.forEach(S=>{if(S)if(S.parent_id){const A=N.get(S.parent_id);A&&A.replies.push(N.get(S.id))}else E.push(N.get(S.id))}),E.sort((S,A)=>new Date(A.created_at)-new Date(S.created_at)),console.log(" Arborescence organise:",E.length,"commentaires racine"),E},x=async()=>{if(!r?.id){console.log(" Pas d'ID de post");return}f(!0);try{console.log(" Chargement des commentaires pour le post:",r.id);const k=await fetch(`https://vakio-boky-backend.onrender.com/api/comments/posts/${r.id}/comments`);if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);const N=await k.json();if(console.log(" Donnes reues du serveur:",N),N.success&&N.comments){console.log(" Commentaires chargs:",N.comments.length);const E=y(N.comments);a(E)}else console.error(" Erreur dans la rponse:",N),a([])}catch(k){console.error(" Erreur chargement commentaires:",k),a([])}finally{f(!1)}},b=async k=>{if(k.preventDefault(),!!o.trim()){h(!0);try{console.log(" Ajout d'un commentaire:",o);const N=await fetch(`https://vakio-boky-backend.onrender.com/api/comments/posts/${r.id}/comments`,{method:"POST",headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"},body:JSON.stringify({contenu:o})});if(!N.ok)throw new Error(`HTTP error! status: ${N.status}`);const E=await N.json();console.log(" Rponse ajout commentaire:",E),E.success?(await x(),l(""),n?.(E.comment)):(console.error(" Erreur lors de l'ajout:",E.error),alert(E.error||"Erreur lors de l'ajout du commentaire"))}catch(N){console.error(" Erreur ajout commentaire:",N),alert("Erreur de connexion lors de l'ajout du commentaire")}finally{h(!1)}}},w=(k,N=0)=>{if(!k)return null;const E=N>0;return s.jsxs("div",{className:`${E?"ml-8 border-l-2 border-gray-200 pl-4 mt-3":"mb-6"}`,children:[s.jsxs("div",{className:"flex gap-3 group",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsxs("div",{className:`${E?"w-8 h-8":"w-10 h-10"} bg-blue-100 rounded-full flex items-center justify-center border border-blue-200`,children:[k.user_avatar?s.jsx("img",{src:k.user_avatar,alt:k.user_nom,className:`${E?"w-8 h-8":"w-10 h-10"} rounded-full object-cover`,onError:S=>{S.target.style.display="none",S.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:`${k.user_avatar?"hidden":"flex"} items-center justify-center w-full h-full`,children:s.jsx(Qt,{className:`text-blue-600 ${E?"text-sm":"text-base"}`})})]})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex justify-between items-start mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:`font-semibold ${E?"text-sm":"text-base"} text-blue-900`,children:k.user_nom||"Utilisateur"}),E&&s.jsx("span",{className:"text-gray-500 text-xs bg-gray-100 px-2 py-1 rounded-full",children:"rponse"})]}),s.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:[new Date(k.created_at).toLocaleString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),k.updated_at&&k.updated_at!==k.created_at&&s.jsx("span",{className:"text-gray-400 ml-2",children:" modifi"})]})]})}),s.jsx("div",{className:"bg-gray-50 rounded-xl p-4 group-hover:bg-gray-100 transition-colors border border-gray-200",children:s.jsx("p",{className:`text-gray-800 ${E?"text-sm":"text-base"} leading-relaxed`,children:k.contenu})}),s.jsx("div",{className:"mt-3",children:s.jsx(xO,{comment:k,currentUserId:g?.id,onUpdate:S=>{console.log(" Mise  jour du commentaire:",S),x()},onDelete:S=>{console.log(" Suppression du commentaire:",S),x()},onReply:S=>{console.log(" Nouvelle rponse:",S),x()},showReply:!0})})]})]}),k.replies&&k.replies.length>0&&s.jsx("div",{className:"mt-4 space-y-4",children:k.replies.map(S=>w(S,N+1))})]},k.id)};return R.useEffect(()=>{e&&r?(console.log(" Ouverture de la modal pour le post:",r.id),x()):(a([]),l(""))},[e,r]),e?s.jsx(zs,{children:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-white rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl",onClick:k=>k.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-blue-100 rounded-t-2xl",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-blue-900",children:"Commentaires"}),s.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:["Publication de ",r.auteur_nom]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-white/50 rounded-full transition-colors duration-200",children:s.jsx(ot,{size:24,className:"text-blue-700"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement des commentaires..."})]}):i.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ZD,{className:"mx-auto text-gray-300 mb-4",size:48}),s.jsx("p",{className:"text-gray-600 text-lg font-medium mb-2",children:"Aucun commentaire"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Soyez le premier  commenter cette publication !"})]}):s.jsx("div",{className:"space-y-6",children:i.map(k=>w(k))})}),s.jsx("form",{onSubmit:b,className:"p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center border border-blue-200",children:g?.photo_profil?s.jsx("img",{src:g.photo_profil,alt:g.nom,className:"w-10 h-10 rounded-full object-cover"}):s.jsx(Qt,{className:"text-blue-600 text-base"})})}),s.jsxs("div",{className:"flex-1 flex gap-3",children:[s.jsx("input",{type:"text",value:o,onChange:k=>l(k.target.value),placeholder:`crivez votre commentaire... ${g?`en tant que ${g.nom}`:""}`,className:"flex-1 border border-gray-300 rounded-xl px-4 py-3 text-base focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200",required:!0,disabled:u}),s.jsxs("button",{type:"submit",disabled:u||!o.trim(),className:"bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all duration-200 font-medium",children:[s.jsx(i0,{size:18}),u?"...":"Publier"]})]})]})})]})})}):null}function US({onMediasUploaded:r,maxFiles:e=1,accept:t="image/*,video/*,application/pdf,.doc,.docx,.txt"}){const[n,i]=R.useState([]),[a,o]=R.useState([]),l=R.useRef(null),{uploadMedias:u,uploading:h,error:c}=rh(),f=y=>{const x=Array.from(y.target.files);if(x.length>e){alert(`Maximum ${e} fichier autoris`);return}i([]),o([]);const b=x.map(w=>{let k="document";return w.type.startsWith("image/")?k="image":w.type.startsWith("video/")&&(k="video"),{file:w,id:Math.random(),type:k}});i(b),b.forEach(w=>{const k=new FileReader;k.onload=N=>{o(E=>[...E,{id:w.id,url:N.target.result,type:w.type}])},k.readAsDataURL(w.file)})},m=y=>{i(x=>x.filter(b=>b.id!==y)),o(x=>x.filter(b=>b.id!==y)),l.current&&(l.current.value="")},g=async()=>{if(n.length===0){alert("Veuillez slectionner un fichier");return}const y=n.map(b=>b.file);console.log(" UploadMedia: Dbut upload",y);const x=await u(y);if(console.log(" UploadMedia: Rsultat upload",x),x.success){console.log(" Upload russi, mdias:",x.medias);const b=x.medias.map(w=>({url:w.url||w.filePath,type:w.fileType||n[0].type}));r(b),i([]),o([]),l.current&&(l.current.value="")}else alert(`Erreur upload: ${x.error}`)},v=y=>{switch(y){case"image":return s.jsx(Fl,{className:"text-blue-500",size:20});case"video":return s.jsx(Ur,{className:"text-purple-500",size:20});case"document":return s.jsx(dn,{className:"text-green-500",size:20});default:return s.jsx(dn,{className:"text-gray-500",size:20})}};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[s.jsx("input",{ref:l,type:"file",multiple:e>1,accept:t,onChange:f,className:"hidden"}),s.jsx(qj,{className:"mx-auto text-3xl text-gray-400 mb-2"}),s.jsx("p",{className:"text-gray-600 mb-2",children:"Glissez-dposez votre fichier ici ou cliquez pour slectionner"}),s.jsx(oe,{variant:"outline",onClick:()=>l.current?.click(),children:"Choisir un fichier"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Formats: Images (JPG, PNG), Vidos (MP4), Documents (PDF, Word, TXT)",s.jsx("br",{}),"Max: ",e," fichier  50MB par fichier"]})]}),n.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Fichier slectionn"}),n.map(y=>{const x=a.find(b=>b.id===y.id);return s.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[x&&y.type==="image"?s.jsx("img",{src:x.url,alt:"Preview",className:"w-12 h-12 object-cover rounded"}):s.jsx("div",{className:"w-12 h-12 bg-white rounded border flex items-center justify-center",children:v(y.type)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm truncate max-w-xs",children:y.file.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[(y.file.size/1024/1024).toFixed(2)," MB "," ",y.type]})]})]}),s.jsx("button",{onClick:()=>m(y.id),className:"text-red-500 hover:text-red-700 p-1",children:s.jsx(ot,{size:18})})]},y.id)}),s.jsx(oe,{onClick:g,disabled:h,className:"w-full flex items-center justify-center gap-2",variant:"primary",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Upload en cours..."]}):s.jsxs(s.Fragment,{children:[s.jsx(qj,{size:16}),"Upload le fichier"]})}),c&&s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded text-sm",children:c})]})]})}var Om,c1;function yO(){if(c1)return Om;c1=1;function r(){this.__data__=[],this.size=0}return Om=r,Om}var Lm,d1;function HS(){if(d1)return Lm;d1=1;function r(e,t){return e===t||e!==e&&t!==t}return Lm=r,Lm}var Im,u1;function nh(){if(u1)return Im;u1=1;var r=HS();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return Im=e,Im}var Bm,h1;function vO(){if(h1)return Bm;h1=1;var r=nh(),e=Array.prototype,t=e.splice;function n(i){var a=this.__data__,o=r(a,i);if(o<0)return!1;var l=a.length-1;return o==l?a.pop():t.call(a,o,1),--this.size,!0}return Bm=n,Bm}var Fm,f1;function bO(){if(f1)return Fm;f1=1;var r=nh();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return Fm=e,Fm}var zm,m1;function jO(){if(m1)return zm;m1=1;var r=nh();function e(t){return r(this.__data__,t)>-1}return zm=e,zm}var Um,p1;function wO(){if(p1)return Um;p1=1;var r=nh();function e(t,n){var i=this.__data__,a=r(i,t);return a<0?(++this.size,i.push([t,n])):i[a][1]=n,this}return Um=e,Um}var Hm,g1;function ih(){if(g1)return Hm;g1=1;var r=yO(),e=vO(),t=bO(),n=jO(),i=wO();function a(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var h=o[l];this.set(h[0],h[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,Hm=a,Hm}var Vm,x1;function NO(){if(x1)return Vm;x1=1;var r=ih();function e(){this.__data__=new r,this.size=0}return Vm=e,Vm}var qm,y1;function kO(){if(y1)return qm;y1=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return qm=r,qm}var $m,v1;function EO(){if(v1)return $m;v1=1;function r(e){return this.__data__.get(e)}return $m=r,$m}var Wm,b1;function SO(){if(b1)return Wm;b1=1;function r(e){return this.__data__.has(e)}return Wm=r,Wm}var Gm,j1;function VS(){if(j1)return Gm;j1=1;var r=typeof Rd=="object"&&Rd&&Rd.Object===Object&&Rd;return Gm=r,Gm}var Ym,w1;function Fn(){if(w1)return Ym;w1=1;var r=VS(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return Ym=t,Ym}var Km,N1;function U0(){if(N1)return Km;N1=1;var r=Fn(),e=r.Symbol;return Km=e,Km}var Xm,k1;function _O(){if(k1)return Xm;k1=1;var r=U0(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function a(o){var l=t.call(o,i),u=o[i];try{o[i]=void 0;var h=!0}catch{}var c=n.call(o);return h&&(l?o[i]=u:delete o[i]),c}return Xm=a,Xm}var Qm,E1;function AO(){if(E1)return Qm;E1=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return Qm=t,Qm}var Jm,S1;function ah(){if(S1)return Jm;S1=1;var r=U0(),e=_O(),t=AO(),n="[object Null]",i="[object Undefined]",a=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:a&&a in Object(l)?e(l):t(l)}return Jm=o,Jm}var Zm,_1;function qS(){if(_1)return Zm;_1=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Zm=r,Zm}var ep,A1;function $S(){if(A1)return ep;A1=1;var r=ah(),e=qS(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function o(l){if(!e(l))return!1;var u=r(l);return u==n||u==i||u==t||u==a}return ep=o,ep}var tp,C1;function CO(){if(C1)return tp;C1=1;var r=Fn(),e=r["__core-js_shared__"];return tp=e,tp}var sp,T1;function TO(){if(T1)return sp;T1=1;var r=CO(),e=(function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function t(n){return!!e&&e in n}return sp=t,sp}var rp,R1;function WS(){if(R1)return rp;R1=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return rp=t,rp}var np,D1;function RO(){if(D1)return np;D1=1;var r=$S(),e=TO(),t=qS(),n=WS(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,u=o.toString,h=l.hasOwnProperty,c=RegExp("^"+u.call(h).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(m){if(!t(m)||e(m))return!1;var g=r(m)?c:a;return g.test(n(m))}return np=f,np}var ip,P1;function DO(){if(P1)return ip;P1=1;function r(e,t){return e?.[t]}return ip=r,ip}var ap,M1;function Ao(){if(M1)return ap;M1=1;var r=RO(),e=DO();function t(n,i){var a=e(n,i);return r(a)?a:void 0}return ap=t,ap}var op,O1;function H0(){if(O1)return op;O1=1;var r=Ao(),e=Fn(),t=r(e,"Map");return op=t,op}var lp,L1;function oh(){if(L1)return lp;L1=1;var r=Ao(),e=r(Object,"create");return lp=e,lp}var cp,I1;function PO(){if(I1)return cp;I1=1;var r=oh();function e(){this.__data__=r?r(null):{},this.size=0}return cp=e,cp}var dp,B1;function MO(){if(B1)return dp;B1=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return dp=r,dp}var up,F1;function OO(){if(F1)return up;F1=1;var r=oh(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(a){var o=this.__data__;if(r){var l=o[a];return l===e?void 0:l}return n.call(o,a)?o[a]:void 0}return up=i,up}var hp,z1;function LO(){if(z1)return hp;z1=1;var r=oh(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var a=this.__data__;return r?a[i]!==void 0:t.call(a,i)}return hp=n,hp}var fp,U1;function IO(){if(U1)return fp;U1=1;var r=oh(),e="__lodash_hash_undefined__";function t(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r&&i===void 0?e:i,this}return fp=t,fp}var mp,H1;function BO(){if(H1)return mp;H1=1;var r=PO(),e=MO(),t=OO(),n=LO(),i=IO();function a(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var h=o[l];this.set(h[0],h[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,mp=a,mp}var pp,V1;function FO(){if(V1)return pp;V1=1;var r=BO(),e=ih(),t=H0();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return pp=n,pp}var gp,q1;function zO(){if(q1)return gp;q1=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return gp=r,gp}var xp,$1;function lh(){if($1)return xp;$1=1;var r=zO();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return xp=e,xp}var yp,W1;function UO(){if(W1)return yp;W1=1;var r=lh();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return yp=e,yp}var vp,G1;function HO(){if(G1)return vp;G1=1;var r=lh();function e(t){return r(this,t).get(t)}return vp=e,vp}var bp,Y1;function VO(){if(Y1)return bp;Y1=1;var r=lh();function e(t){return r(this,t).has(t)}return bp=e,bp}var jp,K1;function qO(){if(K1)return jp;K1=1;var r=lh();function e(t,n){var i=r(this,t),a=i.size;return i.set(t,n),this.size+=i.size==a?0:1,this}return jp=e,jp}var wp,X1;function GS(){if(X1)return wp;X1=1;var r=FO(),e=UO(),t=HO(),n=VO(),i=qO();function a(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var h=o[l];this.set(h[0],h[1])}}return a.prototype.clear=r,a.prototype.delete=e,a.prototype.get=t,a.prototype.has=n,a.prototype.set=i,wp=a,wp}var Np,Q1;function $O(){if(Q1)return Np;Q1=1;var r=ih(),e=H0(),t=GS(),n=200;function i(a,o){var l=this.__data__;if(l instanceof r){var u=l.__data__;if(!e||u.length<n-1)return u.push([a,o]),this.size=++l.size,this;l=this.__data__=new t(u)}return l.set(a,o),this.size=l.size,this}return Np=i,Np}var kp,J1;function WO(){if(J1)return kp;J1=1;var r=ih(),e=NO(),t=kO(),n=EO(),i=SO(),a=$O();function o(l){var u=this.__data__=new r(l);this.size=u.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=i,o.prototype.set=a,kp=o,kp}var Ep,Z1;function GO(){if(Z1)return Ep;Z1=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return Ep=e,Ep}var Sp,eN;function YO(){if(eN)return Sp;eN=1;function r(e){return this.__data__.has(e)}return Sp=r,Sp}var _p,tN;function KO(){if(tN)return _p;tN=1;var r=GS(),e=GO(),t=YO();function n(i){var a=-1,o=i==null?0:i.length;for(this.__data__=new r;++a<o;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,_p=n,_p}var Ap,sN;function XO(){if(sN)return Ap;sN=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return Ap=r,Ap}var Cp,rN;function QO(){if(rN)return Cp;rN=1;function r(e,t){return e.has(t)}return Cp=r,Cp}var Tp,nN;function YS(){if(nN)return Tp;nN=1;var r=KO(),e=XO(),t=QO(),n=1,i=2;function a(o,l,u,h,c,f){var m=u&n,g=o.length,v=l.length;if(g!=v&&!(m&&v>g))return!1;var y=f.get(o),x=f.get(l);if(y&&x)return y==l&&x==o;var b=-1,w=!0,k=u&i?new r:void 0;for(f.set(o,l),f.set(l,o);++b<g;){var N=o[b],E=l[b];if(h)var S=m?h(E,N,b,l,o,f):h(N,E,b,o,l,f);if(S!==void 0){if(S)continue;w=!1;break}if(k){if(!e(l,function(A,C){if(!t(k,C)&&(N===A||c(N,A,u,h,f)))return k.push(C)})){w=!1;break}}else if(!(N===E||c(N,E,u,h,f))){w=!1;break}}return f.delete(o),f.delete(l),w}return Tp=a,Tp}var Rp,iN;function JO(){if(iN)return Rp;iN=1;var r=Fn(),e=r.Uint8Array;return Rp=e,Rp}var Dp,aN;function ZO(){if(aN)return Dp;aN=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,a){n[++t]=[a,i]}),n}return Dp=r,Dp}var Pp,oN;function eL(){if(oN)return Pp;oN=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return Pp=r,Pp}var Mp,lN;function tL(){if(lN)return Mp;lN=1;var r=U0(),e=JO(),t=HS(),n=YS(),i=ZO(),a=eL(),o=1,l=2,u="[object Boolean]",h="[object Date]",c="[object Error]",f="[object Map]",m="[object Number]",g="[object RegExp]",v="[object Set]",y="[object String]",x="[object Symbol]",b="[object ArrayBuffer]",w="[object DataView]",k=r?r.prototype:void 0,N=k?k.valueOf:void 0;function E(S,A,C,I,L,M,D){switch(C){case w:if(S.byteLength!=A.byteLength||S.byteOffset!=A.byteOffset)return!1;S=S.buffer,A=A.buffer;case b:return!(S.byteLength!=A.byteLength||!M(new e(S),new e(A)));case u:case h:case m:return t(+S,+A);case c:return S.name==A.name&&S.message==A.message;case g:case y:return S==A+"";case f:var F=i;case v:var q=I&o;if(F||(F=a),S.size!=A.size&&!q)return!1;var B=D.get(S);if(B)return B==A;I|=l,D.set(S,A);var z=n(F(S),F(A),I,L,M,D);return D.delete(S),z;case x:if(N)return N.call(S)==N.call(A)}return!1}return Mp=E,Mp}var Op,cN;function sL(){if(cN)return Op;cN=1;function r(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}return Op=r,Op}var Lp,dN;function V0(){if(dN)return Lp;dN=1;var r=Array.isArray;return Lp=r,Lp}var Ip,uN;function rL(){if(uN)return Ip;uN=1;var r=sL(),e=V0();function t(n,i,a){var o=i(n);return e(n)?o:r(o,a(n))}return Ip=t,Ip}var Bp,hN;function nL(){if(hN)return Bp;hN=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=0,o=[];++n<i;){var l=e[n];t(l,n,e)&&(o[a++]=l)}return o}return Bp=r,Bp}var Fp,fN;function iL(){if(fN)return Fp;fN=1;function r(){return[]}return Fp=r,Fp}var zp,mN;function aL(){if(mN)return zp;mN=1;var r=nL(),e=iL(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(o){return o==null?[]:(o=Object(o),r(i(o),function(l){return n.call(o,l)}))}:e;return zp=a,zp}var Up,pN;function oL(){if(pN)return Up;pN=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return Up=r,Up}var Hp,gN;function ch(){if(gN)return Hp;gN=1;function r(e){return e!=null&&typeof e=="object"}return Hp=r,Hp}var Vp,xN;function lL(){if(xN)return Vp;xN=1;var r=ah(),e=ch(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return Vp=n,Vp}var qp,yN;function cL(){if(yN)return qp;yN=1;var r=lL(),e=ch(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,a=r((function(){return arguments})())?r:function(o){return e(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return qp=a,qp}var Nl={exports:{}},$p,vN;function dL(){if(vN)return $p;vN=1;function r(){return!1}return $p=r,$p}Nl.exports;var bN;function KS(){return bN||(bN=1,(function(r,e){var t=Fn(),n=dL(),i=e&&!e.nodeType&&e,a=i&&!0&&r&&!r.nodeType&&r,o=a&&a.exports===i,l=o?t.Buffer:void 0,u=l?l.isBuffer:void 0,h=u||n;r.exports=h})(Nl,Nl.exports)),Nl.exports}var Wp,jN;function uL(){if(jN)return Wp;jN=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return Wp=t,Wp}var Gp,wN;function XS(){if(wN)return Gp;wN=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return Gp=e,Gp}var Yp,NN;function hL(){if(NN)return Yp;NN=1;var r=ah(),e=XS(),t=ch(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",o="[object Date]",l="[object Error]",u="[object Function]",h="[object Map]",c="[object Number]",f="[object Object]",m="[object RegExp]",g="[object Set]",v="[object String]",y="[object WeakMap]",x="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",k="[object Float64Array]",N="[object Int8Array]",E="[object Int16Array]",S="[object Int32Array]",A="[object Uint8Array]",C="[object Uint8ClampedArray]",I="[object Uint16Array]",L="[object Uint32Array]",M={};M[w]=M[k]=M[N]=M[E]=M[S]=M[A]=M[C]=M[I]=M[L]=!0,M[n]=M[i]=M[x]=M[a]=M[b]=M[o]=M[l]=M[u]=M[h]=M[c]=M[f]=M[m]=M[g]=M[v]=M[y]=!1;function D(F){return t(F)&&e(F.length)&&!!M[r(F)]}return Yp=D,Yp}var Kp,kN;function fL(){if(kN)return Kp;kN=1;function r(e){return function(t){return e(t)}}return Kp=r,Kp}var kl={exports:{}};kl.exports;var EN;function mL(){return EN||(EN=1,(function(r,e){var t=VS(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,o=a&&t.process,l=(function(){try{var u=i&&i.require&&i.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}})();r.exports=l})(kl,kl.exports)),kl.exports}var Xp,SN;function QS(){if(SN)return Xp;SN=1;var r=hL(),e=fL(),t=mL(),n=t&&t.isTypedArray,i=n?e(n):r;return Xp=i,Xp}var Qp,_N;function pL(){if(_N)return Qp;_N=1;var r=oL(),e=cL(),t=V0(),n=KS(),i=uL(),a=QS(),o=Object.prototype,l=o.hasOwnProperty;function u(h,c){var f=t(h),m=!f&&e(h),g=!f&&!m&&n(h),v=!f&&!m&&!g&&a(h),y=f||m||g||v,x=y?r(h.length,String):[],b=x.length;for(var w in h)(c||l.call(h,w))&&!(y&&(w=="length"||g&&(w=="offset"||w=="parent")||v&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||i(w,b)))&&x.push(w);return x}return Qp=u,Qp}var Jp,AN;function gL(){if(AN)return Jp;AN=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return Jp=e,Jp}var Zp,CN;function xL(){if(CN)return Zp;CN=1;function r(e,t){return function(n){return e(t(n))}}return Zp=r,Zp}var eg,TN;function yL(){if(TN)return eg;TN=1;var r=xL(),e=r(Object.keys,Object);return eg=e,eg}var tg,RN;function vL(){if(RN)return tg;RN=1;var r=gL(),e=yL(),t=Object.prototype,n=t.hasOwnProperty;function i(a){if(!r(a))return e(a);var o=[];for(var l in Object(a))n.call(a,l)&&l!="constructor"&&o.push(l);return o}return tg=i,tg}var sg,DN;function bL(){if(DN)return sg;DN=1;var r=$S(),e=XS();function t(n){return n!=null&&e(n.length)&&!r(n)}return sg=t,sg}var rg,PN;function jL(){if(PN)return rg;PN=1;var r=pL(),e=vL(),t=bL();function n(i){return t(i)?r(i):e(i)}return rg=n,rg}var ng,MN;function wL(){if(MN)return ng;MN=1;var r=rL(),e=aL(),t=jL();function n(i){return r(i,t,e)}return ng=n,ng}var ig,ON;function NL(){if(ON)return ig;ON=1;var r=wL(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(a,o,l,u,h,c){var f=l&e,m=r(a),g=m.length,v=r(o),y=v.length;if(g!=y&&!f)return!1;for(var x=g;x--;){var b=m[x];if(!(f?b in o:n.call(o,b)))return!1}var w=c.get(a),k=c.get(o);if(w&&k)return w==o&&k==a;var N=!0;c.set(a,o),c.set(o,a);for(var E=f;++x<g;){b=m[x];var S=a[b],A=o[b];if(u)var C=f?u(A,S,b,o,a,c):u(S,A,b,a,o,c);if(!(C===void 0?S===A||h(S,A,l,u,c):C)){N=!1;break}E||(E=b=="constructor")}if(N&&!E){var I=a.constructor,L=o.constructor;I!=L&&"constructor"in a&&"constructor"in o&&!(typeof I=="function"&&I instanceof I&&typeof L=="function"&&L instanceof L)&&(N=!1)}return c.delete(a),c.delete(o),N}return ig=i,ig}var ag,LN;function kL(){if(LN)return ag;LN=1;var r=Ao(),e=Fn(),t=r(e,"DataView");return ag=t,ag}var og,IN;function EL(){if(IN)return og;IN=1;var r=Ao(),e=Fn(),t=r(e,"Promise");return og=t,og}var lg,BN;function SL(){if(BN)return lg;BN=1;var r=Ao(),e=Fn(),t=r(e,"Set");return lg=t,lg}var cg,FN;function _L(){if(FN)return cg;FN=1;var r=Ao(),e=Fn(),t=r(e,"WeakMap");return cg=t,cg}var dg,zN;function AL(){if(zN)return dg;zN=1;var r=kL(),e=H0(),t=EL(),n=SL(),i=_L(),a=ah(),o=WS(),l="[object Map]",u="[object Object]",h="[object Promise]",c="[object Set]",f="[object WeakMap]",m="[object DataView]",g=o(r),v=o(e),y=o(t),x=o(n),b=o(i),w=a;return(r&&w(new r(new ArrayBuffer(1)))!=m||e&&w(new e)!=l||t&&w(t.resolve())!=h||n&&w(new n)!=c||i&&w(new i)!=f)&&(w=function(k){var N=a(k),E=N==u?k.constructor:void 0,S=E?o(E):"";if(S)switch(S){case g:return m;case v:return l;case y:return h;case x:return c;case b:return f}return N}),dg=w,dg}var ug,UN;function CL(){if(UN)return ug;UN=1;var r=WO(),e=YS(),t=tL(),n=NL(),i=AL(),a=V0(),o=KS(),l=QS(),u=1,h="[object Arguments]",c="[object Array]",f="[object Object]",m=Object.prototype,g=m.hasOwnProperty;function v(y,x,b,w,k,N){var E=a(y),S=a(x),A=E?c:i(y),C=S?c:i(x);A=A==h?f:A,C=C==h?f:C;var I=A==f,L=C==f,M=A==C;if(M&&o(y)){if(!o(x))return!1;E=!0,I=!1}if(M&&!I)return N||(N=new r),E||l(y)?e(y,x,b,w,k,N):t(y,x,A,b,w,k,N);if(!(b&u)){var D=I&&g.call(y,"__wrapped__"),F=L&&g.call(x,"__wrapped__");if(D||F){var q=D?y.value():y,B=F?x.value():x;return N||(N=new r),k(q,B,b,w,N)}}return M?(N||(N=new r),n(y,x,b,w,k,N)):!1}return ug=v,ug}var hg,HN;function TL(){if(HN)return hg;HN=1;var r=CL(),e=ch();function t(n,i,a,o,l){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,a,o,t,l)}return hg=t,hg}var fg,VN;function RL(){if(VN)return fg;VN=1;var r=TL();function e(t,n){return r(t,n)}return fg=e,fg}var iu={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var DL=iu.exports,qN;function PL(){return qN||(qN=1,(function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:DL,function(){return(function(t){var n={};function i(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(a,o,l){i.o(a,o)||Object.defineProperty(a,o,{configurable:!1,enumerable:!0,get:l})},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=109)})([(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(17),o=i(18),l=i(19),u=i(45),h=i(46),c=i(47),f=i(48),m=i(49),g=i(12),v=i(32),y=i(33),x=i(31),b=i(1),w={Scope:b.Scope,create:b.create,find:b.find,query:b.query,register:b.register,Container:a.default,Format:o.default,Leaf:l.default,Embed:f.default,Scroll:u.default,Block:c.default,Inline:h.default,Text:m.default,Attributor:{Attribute:g.default,Class:v.default,Style:y.default,Store:x.default}};n.default=w}),(function(t,n,i){var a=this&&this.__extends||(function(){var x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var k in w)w.hasOwnProperty(k)&&(b[k]=w[k])};return function(b,w){x(b,w);function k(){this.constructor=b}b.prototype=w===null?Object.create(w):(k.prototype=w.prototype,new k)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=(function(x){a(b,x);function b(w){var k=this;return w="[Parchment] "+w,k=x.call(this,w)||this,k.message=w,k.name=k.constructor.name,k}return b})(Error);n.ParchmentError=o;var l={},u={},h={},c={};n.DATA_KEY="__blot";var f;(function(x){x[x.TYPE=3]="TYPE",x[x.LEVEL=12]="LEVEL",x[x.ATTRIBUTE=13]="ATTRIBUTE",x[x.BLOT=14]="BLOT",x[x.INLINE=7]="INLINE",x[x.BLOCK=11]="BLOCK",x[x.BLOCK_BLOT=10]="BLOCK_BLOT",x[x.INLINE_BLOT=6]="INLINE_BLOT",x[x.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",x[x.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",x[x.ANY=15]="ANY"})(f=n.Scope||(n.Scope={}));function m(x,b){var w=v(x);if(w==null)throw new o("Unable to create "+x+" blot");var k=w,N=x instanceof Node||x.nodeType===Node.TEXT_NODE?x:k.create(b);return new k(N,b)}n.create=m;function g(x,b){return b===void 0&&(b=!1),x==null?null:x[n.DATA_KEY]!=null?x[n.DATA_KEY].blot:b?g(x.parentNode,b):null}n.find=g;function v(x,b){b===void 0&&(b=f.ANY);var w;if(typeof x=="string")w=c[x]||l[x];else if(x instanceof Text||x.nodeType===Node.TEXT_NODE)w=c.text;else if(typeof x=="number")x&f.LEVEL&f.BLOCK?w=c.block:x&f.LEVEL&f.INLINE&&(w=c.inline);else if(x instanceof HTMLElement){var k=(x.getAttribute("class")||"").split(/\s+/);for(var N in k)if(w=u[k[N]],w)break;w=w||h[x.tagName]}return w==null?null:b&f.LEVEL&w.scope&&b&f.TYPE&w.scope?w:null}n.query=v;function y(){for(var x=[],b=0;b<arguments.length;b++)x[b]=arguments[b];if(x.length>1)return x.map(function(N){return y(N)});var w=x[0];if(typeof w.blotName!="string"&&typeof w.attrName!="string")throw new o("Invalid definition");if(w.blotName==="abstract")throw new o("Cannot register abstract class");if(c[w.blotName||w.attrName]=w,typeof w.keyName=="string")l[w.keyName]=w;else if(w.className!=null&&(u[w.className]=w),w.tagName!=null){Array.isArray(w.tagName)?w.tagName=w.tagName.map(function(N){return N.toUpperCase()}):w.tagName=w.tagName.toUpperCase();var k=Array.isArray(w.tagName)?w.tagName:[w.tagName];k.forEach(function(N){(h[N]==null||w.className==null)&&(h[N]=w)})}return w}n.register=y}),(function(t,n,i){var a=i(51),o=i(11),l=i(3),u=i(20),h="\0",c=function(f){Array.isArray(f)?this.ops=f:f!=null&&Array.isArray(f.ops)?this.ops=f.ops:this.ops=[]};c.prototype.insert=function(f,m){var g={};return f.length===0?this:(g.insert=f,m!=null&&typeof m=="object"&&Object.keys(m).length>0&&(g.attributes=m),this.push(g))},c.prototype.delete=function(f){return f<=0?this:this.push({delete:f})},c.prototype.retain=function(f,m){if(f<=0)return this;var g={retain:f};return m!=null&&typeof m=="object"&&Object.keys(m).length>0&&(g.attributes=m),this.push(g)},c.prototype.push=function(f){var m=this.ops.length,g=this.ops[m-1];if(f=l(!0,{},f),typeof g=="object"){if(typeof f.delete=="number"&&typeof g.delete=="number")return this.ops[m-1]={delete:g.delete+f.delete},this;if(typeof g.delete=="number"&&f.insert!=null&&(m-=1,g=this.ops[m-1],typeof g!="object"))return this.ops.unshift(f),this;if(o(f.attributes,g.attributes)){if(typeof f.insert=="string"&&typeof g.insert=="string")return this.ops[m-1]={insert:g.insert+f.insert},typeof f.attributes=="object"&&(this.ops[m-1].attributes=f.attributes),this;if(typeof f.retain=="number"&&typeof g.retain=="number")return this.ops[m-1]={retain:g.retain+f.retain},typeof f.attributes=="object"&&(this.ops[m-1].attributes=f.attributes),this}}return m===this.ops.length?this.ops.push(f):this.ops.splice(m,0,f),this},c.prototype.chop=function(){var f=this.ops[this.ops.length-1];return f&&f.retain&&!f.attributes&&this.ops.pop(),this},c.prototype.filter=function(f){return this.ops.filter(f)},c.prototype.forEach=function(f){this.ops.forEach(f)},c.prototype.map=function(f){return this.ops.map(f)},c.prototype.partition=function(f){var m=[],g=[];return this.forEach(function(v){var y=f(v)?m:g;y.push(v)}),[m,g]},c.prototype.reduce=function(f,m){return this.ops.reduce(f,m)},c.prototype.changeLength=function(){return this.reduce(function(f,m){return m.insert?f+u.length(m):m.delete?f-m.delete:f},0)},c.prototype.length=function(){return this.reduce(function(f,m){return f+u.length(m)},0)},c.prototype.slice=function(f,m){f=f||0,typeof m!="number"&&(m=1/0);for(var g=[],v=u.iterator(this.ops),y=0;y<m&&v.hasNext();){var x;y<f?x=v.next(f-y):(x=v.next(m-y),g.push(x)),y+=u.length(x)}return new c(g)},c.prototype.compose=function(f){var m=u.iterator(this.ops),g=u.iterator(f.ops),v=[],y=g.peek();if(y!=null&&typeof y.retain=="number"&&y.attributes==null){for(var x=y.retain;m.peekType()==="insert"&&m.peekLength()<=x;)x-=m.peekLength(),v.push(m.next());y.retain-x>0&&g.next(y.retain-x)}for(var b=new c(v);m.hasNext()||g.hasNext();)if(g.peekType()==="insert")b.push(g.next());else if(m.peekType()==="delete")b.push(m.next());else{var w=Math.min(m.peekLength(),g.peekLength()),k=m.next(w),N=g.next(w);if(typeof N.retain=="number"){var E={};typeof k.retain=="number"?E.retain=w:E.insert=k.insert;var S=u.attributes.compose(k.attributes,N.attributes,typeof k.retain=="number");if(S&&(E.attributes=S),b.push(E),!g.hasNext()&&o(b.ops[b.ops.length-1],E)){var A=new c(m.rest());return b.concat(A).chop()}}else typeof N.delete=="number"&&typeof k.retain=="number"&&b.push(N)}return b.chop()},c.prototype.concat=function(f){var m=new c(this.ops.slice());return f.ops.length>0&&(m.push(f.ops[0]),m.ops=m.ops.concat(f.ops.slice(1))),m},c.prototype.diff=function(f,m){if(this.ops===f.ops)return new c;var g=[this,f].map(function(w){return w.map(function(k){if(k.insert!=null)return typeof k.insert=="string"?k.insert:h;var N=w===f?"on":"with";throw new Error("diff() called "+N+" non-document")}).join("")}),v=new c,y=a(g[0],g[1],m),x=u.iterator(this.ops),b=u.iterator(f.ops);return y.forEach(function(w){for(var k=w[1].length;k>0;){var N=0;switch(w[0]){case a.INSERT:N=Math.min(b.peekLength(),k),v.push(b.next(N));break;case a.DELETE:N=Math.min(k,x.peekLength()),x.next(N),v.delete(N);break;case a.EQUAL:N=Math.min(x.peekLength(),b.peekLength(),k);var E=x.next(N),S=b.next(N);o(E.insert,S.insert)?v.retain(N,u.attributes.diff(E.attributes,S.attributes)):v.push(S).delete(N);break}k-=N}}),v.chop()},c.prototype.eachLine=function(f,m){m=m||`
`;for(var g=u.iterator(this.ops),v=new c,y=0;g.hasNext();){if(g.peekType()!=="insert")return;var x=g.peek(),b=u.length(x)-g.peekLength(),w=typeof x.insert=="string"?x.insert.indexOf(m,b)-b:-1;if(w<0)v.push(g.next());else if(w>0)v.push(g.next(w));else{if(f(v,g.next(1).attributes||{},y)===!1)return;y+=1,v=new c}}v.length()>0&&f(v,{},y)},c.prototype.transform=function(f,m){if(m=!!m,typeof f=="number")return this.transformPosition(f,m);for(var g=u.iterator(this.ops),v=u.iterator(f.ops),y=new c;g.hasNext()||v.hasNext();)if(g.peekType()==="insert"&&(m||v.peekType()!=="insert"))y.retain(u.length(g.next()));else if(v.peekType()==="insert")y.push(v.next());else{var x=Math.min(g.peekLength(),v.peekLength()),b=g.next(x),w=v.next(x);if(b.delete)continue;w.delete?y.push(w):y.retain(x,u.attributes.transform(b.attributes,w.attributes,m))}return y.chop()},c.prototype.transformPosition=function(f,m){m=!!m;for(var g=u.iterator(this.ops),v=0;g.hasNext()&&v<=f;){var y=g.peekLength(),x=g.peekType();if(g.next(),x==="delete"){f-=Math.min(y,f-v);continue}else x==="insert"&&(v<f||!m)&&(f+=y);v+=y}return f},t.exports=c}),(function(t,n){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u=function(g){return typeof Array.isArray=="function"?Array.isArray(g):a.call(g)==="[object Array]"},h=function(g){if(!g||a.call(g)!=="[object Object]")return!1;var v=i.call(g,"constructor"),y=g.constructor&&g.constructor.prototype&&i.call(g.constructor.prototype,"isPrototypeOf");if(g.constructor&&!v&&!y)return!1;var x;for(x in g);return typeof x>"u"||i.call(g,x)},c=function(g,v){o&&v.name==="__proto__"?o(g,v.name,{enumerable:!0,configurable:!0,value:v.newValue,writable:!0}):g[v.name]=v.newValue},f=function(g,v){if(v==="__proto__")if(i.call(g,v)){if(l)return l(g,v).value}else return;return g[v]};t.exports=function m(){var g,v,y,x,b,w,k=arguments[0],N=1,E=arguments.length,S=!1;for(typeof k=="boolean"&&(S=k,k=arguments[1]||{},N=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});N<E;++N)if(g=arguments[N],g!=null)for(v in g)y=f(k,v),x=f(g,v),k!==x&&(S&&x&&(h(x)||(b=u(x)))?(b?(b=!1,w=y&&u(y)?y:[]):w=y&&h(y)?y:{},c(k,{name:v,newValue:m(S,w,x)})):typeof x<"u"&&c(k,{name:v,newValue:x}));return k}}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var a=(function(){function M(D,F){for(var q=0;q<F.length;q++){var B=F[q];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}return function(D,F,q){return F&&M(D.prototype,F),q&&M(D,q),D}})(),o=function M(D,F,q){D===null&&(D=Function.prototype);var B=Object.getOwnPropertyDescriptor(D,F);if(B===void 0){var z=Object.getPrototypeOf(D);return z===null?void 0:M(z,F,q)}else{if("value"in B)return B.value;var G=B.get;return G===void 0?void 0:G.call(q)}},l=i(3),u=k(l),h=i(2),c=k(h),f=i(0),m=k(f),g=i(16),v=k(g),y=i(6),x=k(y),b=i(7),w=k(b);function k(M){return M&&M.__esModule?M:{default:M}}function N(M,D){if(!(M instanceof D))throw new TypeError("Cannot call a class as a function")}function E(M,D){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:M}function S(M,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);M.prototype=Object.create(D&&D.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(M,D):M.__proto__=D)}var A=1,C=(function(M){S(D,M);function D(){return N(this,D),E(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return a(D,[{key:"attach",value:function(){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"attach",this).call(this),this.attributes=new m.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new c.default().insert(this.value(),(0,u.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(q,B){var z=m.default.query(q,m.default.Scope.BLOCK_ATTRIBUTE);z!=null&&this.attributes.attribute(z,B)}},{key:"formatAt",value:function(q,B,z,G){this.format(z,G)}},{key:"insertAt",value:function(q,B,z){if(typeof B=="string"&&B.endsWith(`
`)){var G=m.default.create(I.blotName);this.parent.insertBefore(G,q===0?this:this.next),G.insertAt(0,B.slice(0,-1))}else o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,q,B,z)}}]),D})(m.default.Embed);C.scope=m.default.Scope.BLOCK_BLOT;var I=(function(M){S(D,M);function D(F){N(this,D);var q=E(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,F));return q.cache={},q}return a(D,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(m.default.Leaf).reduce(function(q,B){return B.length()===0?q:q.insert(B.value(),L(B))},new c.default).insert(`
`,L(this))),this.cache.delta}},{key:"deleteAt",value:function(q,B){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"deleteAt",this).call(this,q,B),this.cache={}}},{key:"formatAt",value:function(q,B,z,G){B<=0||(m.default.query(z,m.default.Scope.BLOCK)?q+B===this.length()&&this.format(z,G):o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"formatAt",this).call(this,q,Math.min(B,this.length()-q-1),z,G),this.cache={})}},{key:"insertAt",value:function(q,B,z){if(z!=null)return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,q,B,z);if(B.length!==0){var G=B.split(`
`),Y=G.shift();Y.length>0&&(q<this.length()-1||this.children.tail==null?o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,Math.min(q,this.length()-1),Y):this.children.tail.insertAt(this.children.tail.length(),Y),this.cache={});var H=this;G.reduce(function(V,O){return H=H.split(V,!0),H.insertAt(0,O),O.length},q+Y.length)}}},{key:"insertBefore",value:function(q,B){var z=this.children.head;o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertBefore",this).call(this,q,B),z instanceof v.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"length",this).call(this)+A),this.cache.length}},{key:"moveChildren",value:function(q,B){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"moveChildren",this).call(this,q,B),this.cache={}}},{key:"optimize",value:function(q){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"optimize",this).call(this,q),this.cache={}}},{key:"path",value:function(q){return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"path",this).call(this,q,!0)}},{key:"removeChild",value:function(q){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"removeChild",this).call(this,q),this.cache={}}},{key:"split",value:function(q){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(B&&(q===0||q>=this.length()-A)){var z=this.clone();return q===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var G=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"split",this).call(this,q,B);return this.cache={},G}}}]),D})(m.default.Block);I.blotName="block",I.tagName="P",I.defaultChild="break",I.allowedChildren=[x.default,m.default.Embed,w.default];function L(M){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return M==null||(typeof M.formats=="function"&&(D=(0,u.default)(D,M.formats())),M.parent==null||M.parent.blotName=="scroll"||M.parent.statics.scope!==M.statics.scope)?D:L(M.parent,D)}n.bubbleFormats=L,n.BlockEmbed=C,n.default=I}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},o=(function(){function H(V,O){var U=[],K=!0,se=!1,te=void 0;try{for(var X=V[Symbol.iterator](),Q;!(K=(Q=X.next()).done)&&(U.push(Q.value),!(O&&U.length===O));K=!0);}catch(ae){se=!0,te=ae}finally{try{!K&&X.return&&X.return()}finally{if(se)throw te}}return U}return function(V,O){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return H(V,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function H(V,O){for(var U=0;U<O.length;U++){var K=O[U];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(V,K.key,K)}}return function(V,O,U){return O&&H(V.prototype,O),U&&H(V,U),V}})();i(50);var u=i(2),h=L(u),c=i(14),f=L(c),m=i(8),g=L(m),v=i(9),y=L(v),x=i(0),b=L(x),w=i(15),k=L(w),N=i(3),E=L(N),S=i(10),A=L(S),C=i(34),I=L(C);function L(H){return H&&H.__esModule?H:{default:H}}function M(H,V,O){return V in H?Object.defineProperty(H,V,{value:O,enumerable:!0,configurable:!0,writable:!0}):H[V]=O,H}function D(H,V){if(!(H instanceof V))throw new TypeError("Cannot call a class as a function")}var F=(0,A.default)("quill"),q=(function(){l(H,null,[{key:"debug",value:function(O){O===!0&&(O="log"),A.default.level(O)}},{key:"find",value:function(O){return O.__quill||b.default.find(O)}},{key:"import",value:function(O){return this.imports[O]==null&&F.error("Cannot import "+O+". Are you sure it was registered?"),this.imports[O]}},{key:"register",value:function(O,U){var K=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof O!="string"){var te=O.attrName||O.blotName;typeof te=="string"?this.register("formats/"+te,O,U):Object.keys(O).forEach(function(X){K.register(X,O[X],U)})}else this.imports[O]!=null&&!se&&F.warn("Overwriting "+O+" with",U),this.imports[O]=U,(O.startsWith("blots/")||O.startsWith("formats/"))&&U.blotName!=="abstract"?b.default.register(U):O.startsWith("modules")&&typeof U.register=="function"&&U.register()}}]);function H(V){var O=this,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(this,H),this.options=B(V,U),this.container=this.options.container,this.container==null)return F.error("Invalid Quill container",V);this.options.debug&&H.debug(this.options.debug);var K=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new g.default,this.scroll=b.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new f.default(this.scroll),this.selection=new k.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(g.default.events.EDITOR_CHANGE,function(te){te===g.default.events.TEXT_CHANGE&&O.root.classList.toggle("ql-blank",O.editor.isBlank())}),this.emitter.on(g.default.events.SCROLL_UPDATE,function(te,X){var Q=O.selection.lastRange,ae=Q&&Q.length===0?Q.index:void 0;z.call(O,function(){return O.editor.update(null,X,ae)},te)});var se=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+K+"<p><br></p></div>");this.setContents(se),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(H,[{key:"addContainer",value:function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof O=="string"){var K=O;O=document.createElement("div"),O.classList.add(K)}return this.container.insertBefore(O,U),O}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(O,U,K){var se=this,te=G(O,U,K),X=o(te,4);return O=X[0],U=X[1],K=X[3],z.call(this,function(){return se.editor.deleteText(O,U)},K,O,-1*U)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(O),this.container.classList.toggle("ql-disabled",!O)}},{key:"focus",value:function(){var O=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=O,this.scrollIntoView()}},{key:"format",value:function(O,U){var K=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;return z.call(this,function(){var te=K.getSelection(!0),X=new h.default;if(te==null)return X;if(b.default.query(O,b.default.Scope.BLOCK))X=K.editor.formatLine(te.index,te.length,M({},O,U));else{if(te.length===0)return K.selection.format(O,U),X;X=K.editor.formatText(te.index,te.length,M({},O,U))}return K.setSelection(te,g.default.sources.SILENT),X},se)}},{key:"formatLine",value:function(O,U,K,se,te){var X=this,Q=void 0,ae=G(O,U,K,se,te),J=o(ae,4);return O=J[0],U=J[1],Q=J[2],te=J[3],z.call(this,function(){return X.editor.formatLine(O,U,Q)},te,O,0)}},{key:"formatText",value:function(O,U,K,se,te){var X=this,Q=void 0,ae=G(O,U,K,se,te),J=o(ae,4);return O=J[0],U=J[1],Q=J[2],te=J[3],z.call(this,function(){return X.editor.formatText(O,U,Q)},te,O,0)}},{key:"getBounds",value:function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,K=void 0;typeof O=="number"?K=this.selection.getBounds(O,U):K=this.selection.getBounds(O.index,O.length);var se=this.container.getBoundingClientRect();return{bottom:K.bottom-se.top,height:K.height,left:K.left-se.left,right:K.right-se.left,top:K.top-se.top,width:K.width}}},{key:"getContents",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-O,K=G(O,U),se=o(K,2);return O=se[0],U=se[1],this.editor.getContents(O,U)}},{key:"getFormat",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof O=="number"?this.editor.getFormat(O,U):this.editor.getFormat(O.index,O.length)}},{key:"getIndex",value:function(O){return O.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(O){return this.scroll.leaf(O)}},{key:"getLine",value:function(O){return this.scroll.line(O)}},{key:"getLines",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof O!="number"?this.scroll.lines(O.index,O.length):this.scroll.lines(O,U)}},{key:"getModule",value:function(O){return this.theme.modules[O]}},{key:"getSelection",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return O&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-O,K=G(O,U),se=o(K,2);return O=se[0],U=se[1],this.editor.getText(O,U)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(O,U,K){var se=this,te=arguments.length>3&&arguments[3]!==void 0?arguments[3]:H.sources.API;return z.call(this,function(){return se.editor.insertEmbed(O,U,K)},te,O)}},{key:"insertText",value:function(O,U,K,se,te){var X=this,Q=void 0,ae=G(O,0,K,se,te),J=o(ae,4);return O=J[0],Q=J[2],te=J[3],z.call(this,function(){return X.editor.insertText(O,U,Q)},te,O,U.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(O,U,K){this.clipboard.dangerouslyPasteHTML(O,U,K)}},{key:"removeFormat",value:function(O,U,K){var se=this,te=G(O,U,K),X=o(te,4);return O=X[0],U=X[1],K=X[3],z.call(this,function(){return se.editor.removeFormat(O,U)},K,O)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(O){var U=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API;return z.call(this,function(){O=new h.default(O);var se=U.getLength(),te=U.editor.deleteText(0,se),X=U.editor.applyDelta(O),Q=X.ops[X.ops.length-1];Q!=null&&typeof Q.insert=="string"&&Q.insert[Q.insert.length-1]===`
`&&(U.editor.deleteText(U.getLength()-1,1),X.delete(1));var ae=te.compose(X);return ae},K)}},{key:"setSelection",value:function(O,U,K){if(O==null)this.selection.setRange(null,U||H.sources.API);else{var se=G(O,U,K),te=o(se,4);O=te[0],U=te[1],K=te[3],this.selection.setRange(new w.Range(O,U),K),K!==g.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API,K=new h.default().insert(O);return this.setContents(K,U)}},{key:"update",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g.default.sources.USER,U=this.scroll.update(O);return this.selection.update(O),U}},{key:"updateContents",value:function(O){var U=this,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g.default.sources.API;return z.call(this,function(){return O=new h.default(O),U.editor.applyDelta(O,K)},K,!0)}}]),H})();q.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},q.events=g.default.events,q.sources=g.default.sources,q.version="1.3.7",q.imports={delta:h.default,parchment:b.default,"core/module":y.default,"core/theme":I.default};function B(H,V){if(V=(0,E.default)(!0,{container:H,modules:{clipboard:!0,keyboard:!0,history:!0}},V),!V.theme||V.theme===q.DEFAULTS.theme)V.theme=I.default;else if(V.theme=q.import("themes/"+V.theme),V.theme==null)throw new Error("Invalid theme "+V.theme+". Did you register it?");var O=(0,E.default)(!0,{},V.theme.DEFAULTS);[O,V].forEach(function(se){se.modules=se.modules||{},Object.keys(se.modules).forEach(function(te){se.modules[te]===!0&&(se.modules[te]={})})});var U=Object.keys(O.modules).concat(Object.keys(V.modules)),K=U.reduce(function(se,te){var X=q.import("modules/"+te);return X==null?F.error("Cannot load "+te+" module. Are you sure you registered it?"):se[te]=X.DEFAULTS||{},se},{});return V.modules!=null&&V.modules.toolbar&&V.modules.toolbar.constructor!==Object&&(V.modules.toolbar={container:V.modules.toolbar}),V=(0,E.default)(!0,{},q.DEFAULTS,{modules:K},O,V),["bounds","container","scrollingContainer"].forEach(function(se){typeof V[se]=="string"&&(V[se]=document.querySelector(V[se]))}),V.modules=Object.keys(V.modules).reduce(function(se,te){return V.modules[te]&&(se[te]=V.modules[te]),se},{}),V}function z(H,V,O,U){if(this.options.strict&&!this.isEnabled()&&V===g.default.sources.USER)return new h.default;var K=O==null?null:this.getSelection(),se=this.editor.delta,te=H();if(K!=null&&(O===!0&&(O=K.index),U==null?K=Y(K,te,V):U!==0&&(K=Y(K,O,U,V)),this.setSelection(K,g.default.sources.SILENT)),te.length()>0){var X,Q=[g.default.events.TEXT_CHANGE,te,se,V];if((X=this.emitter).emit.apply(X,[g.default.events.EDITOR_CHANGE].concat(Q)),V!==g.default.sources.SILENT){var ae;(ae=this.emitter).emit.apply(ae,Q)}}return te}function G(H,V,O,U,K){var se={};return typeof H.index=="number"&&typeof H.length=="number"?typeof V!="number"?(K=U,U=O,O=V,V=H.length,H=H.index):(V=H.length,H=H.index):typeof V!="number"&&(K=U,U=O,O=V,V=0),(typeof O>"u"?"undefined":a(O))==="object"?(se=O,K=U):typeof O=="string"&&(U!=null?se[O]=U:K=O),K=K||g.default.sources.API,[H,V,se,K]}function Y(H,V,O,U){if(H==null)return null;var K=void 0,se=void 0;if(V instanceof h.default){var te=[H.index,H.index+H.length].map(function(J){return V.transformPosition(J,U!==g.default.sources.USER)}),X=o(te,2);K=X[0],se=X[1]}else{var Q=[H.index,H.index+H.length].map(function(J){return J<V||J===V&&U===g.default.sources.USER?J:O>=0?J+O:Math.max(V,J+O)}),ae=o(Q,2);K=ae[0],se=ae[1]}return new w.Range(K,se-K)}n.expandConfig=B,n.overload=G,n.default=q}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function x(b,w){for(var k=0;k<w.length;k++){var N=w[k];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,w,k){return w&&x(b.prototype,w),k&&x(b,k),b}})(),o=function x(b,w,k){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,w);if(N===void 0){var E=Object.getPrototypeOf(b);return E===null?void 0:x(E,w,k)}else{if("value"in N)return N.value;var S=N.get;return S===void 0?void 0:S.call(k)}},l=i(7),u=f(l),h=i(0),c=f(h);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function g(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function v(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var y=(function(x){v(b,x);function b(){return m(this,b),g(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,[{key:"formatAt",value:function(k,N,E,S){if(b.compare(this.statics.blotName,E)<0&&c.default.query(E,c.default.Scope.BLOT)){var A=this.isolate(k,N);S&&A.wrap(E,S)}else o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"formatAt",this).call(this,k,N,E,S)}},{key:"optimize",value:function(k){if(o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"optimize",this).call(this,k),this.parent instanceof b&&b.compare(this.statics.blotName,this.parent.statics.blotName)>0){var N=this.parent.isolate(this.offset(),this.length());this.moveChildren(N),N.wrap(this)}}}],[{key:"compare",value:function(k,N){var E=b.order.indexOf(k),S=b.order.indexOf(N);return E>=0||S>=0?E-S:k===N?0:k<N?-1:1}}]),b})(c.default.Inline);y.allowedChildren=[y,c.default.Embed,u.default],y.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function h(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function c(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var f=(function(m){c(g,m);function g(){return u(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g})(o.default.Text);n.default=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function w(k,N){for(var E=0;E<N.length;E++){var S=N[E];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(k,S.key,S)}}return function(k,N,E){return N&&w(k.prototype,N),E&&w(k,E),k}})(),o=function w(k,N,E){k===null&&(k=Function.prototype);var S=Object.getOwnPropertyDescriptor(k,N);if(S===void 0){var A=Object.getPrototypeOf(k);return A===null?void 0:w(A,N,E)}else{if("value"in S)return S.value;var C=S.get;return C===void 0?void 0:C.call(E)}},l=i(54),u=f(l),h=i(10),c=f(h);function f(w){return w&&w.__esModule?w:{default:w}}function m(w,k){if(!(w instanceof k))throw new TypeError("Cannot call a class as a function")}function g(w,k){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:w}function v(w,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);w.prototype=Object.create(k&&k.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(w,k):w.__proto__=k)}var y=(0,c.default)("quill:events"),x=["selectionchange","mousedown","mouseup","click"];x.forEach(function(w){document.addEventListener(w,function(){for(var k=arguments.length,N=Array(k),E=0;E<k;E++)N[E]=arguments[E];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(S){if(S.__quill&&S.__quill.emitter){var A;(A=S.__quill.emitter).handleDOM.apply(A,N)}})})});var b=(function(w){v(k,w);function k(){m(this,k);var N=g(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));return N.listeners={},N.on("error",y.error),N}return a(k,[{key:"emit",value:function(){y.log.apply(y,arguments),o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(E){for(var S=arguments.length,A=Array(S>1?S-1:0),C=1;C<S;C++)A[C-1]=arguments[C];(this.listeners[E.type]||[]).forEach(function(I){var L=I.node,M=I.handler;(E.target===L||L.contains(E.target))&&M.apply(void 0,[E].concat(A))})}},{key:"listenDOM",value:function(E,S,A){this.listeners[E]||(this.listeners[E]=[]),this.listeners[E].push({node:S,handler:A})}}]),k})(u.default);b.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources={API:"api",SILENT:"silent",USER:"user"},n.default=b}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function a(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a(this,l),this.quill=u,this.options=h};o.DEFAULTS={},n.default=o}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=["error","warn","log","info"],o="warn";function l(h){if(a.indexOf(h)<=a.indexOf(o)){for(var c,f=arguments.length,m=Array(f>1?f-1:0),g=1;g<f;g++)m[g-1]=arguments[g];(c=console)[h].apply(c,m)}}function u(h){return a.reduce(function(c,f){return c[f]=l.bind(console,f,h),c},{})}l.level=u.level=function(h){o=h},n.default=u}),(function(t,n,i){var a=Array.prototype.slice,o=i(52),l=i(53),u=t.exports=function(m,g,v){return v||(v={}),m===g?!0:m instanceof Date&&g instanceof Date?m.getTime()===g.getTime():!m||!g||typeof m!="object"&&typeof g!="object"?v.strict?m===g:m==g:f(m,g,v)};function h(m){return m==null}function c(m){return!(!m||typeof m!="object"||typeof m.length!="number"||typeof m.copy!="function"||typeof m.slice!="function"||m.length>0&&typeof m[0]!="number")}function f(m,g,v){var y,x;if(h(m)||h(g)||m.prototype!==g.prototype)return!1;if(l(m))return l(g)?(m=a.call(m),g=a.call(g),u(m,g,v)):!1;if(c(m)){if(!c(g)||m.length!==g.length)return!1;for(y=0;y<m.length;y++)if(m[y]!==g[y])return!1;return!0}try{var b=o(m),w=o(g)}catch{return!1}if(b.length!=w.length)return!1;for(b.sort(),w.sort(),y=b.length-1;y>=0;y--)if(b[y]!=w[y])return!1;for(y=b.length-1;y>=0;y--)if(x=b[y],!u(m[x],g[x],v))return!1;return typeof m==typeof g}}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(1),o=(function(){function l(u,h,c){c===void 0&&(c={}),this.attrName=u,this.keyName=h;var f=a.Scope.TYPE&a.Scope.ATTRIBUTE;c.scope!=null?this.scope=c.scope&a.Scope.LEVEL|f:this.scope=a.Scope.ATTRIBUTE,c.whitelist!=null&&(this.whitelist=c.whitelist)}return l.keys=function(u){return[].map.call(u.attributes,function(h){return h.name})},l.prototype.add=function(u,h){return this.canAdd(u,h)?(u.setAttribute(this.keyName,h),!0):!1},l.prototype.canAdd=function(u,h){var c=a.query(u,a.Scope.BLOT&(this.scope|a.Scope.TYPE));return c==null?!1:this.whitelist==null?!0:typeof h=="string"?this.whitelist.indexOf(h.replace(/["']/g,""))>-1:this.whitelist.indexOf(h)>-1},l.prototype.remove=function(u){u.removeAttribute(this.keyName)},l.prototype.value=function(u){var h=u.getAttribute(this.keyName);return this.canAdd(u,h)&&h?h:""},l})();n.default=o}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var a=(function(){function C(I,L){var M=[],D=!0,F=!1,q=void 0;try{for(var B=I[Symbol.iterator](),z;!(D=(z=B.next()).done)&&(M.push(z.value),!(L&&M.length===L));D=!0);}catch(G){F=!0,q=G}finally{try{!D&&B.return&&B.return()}finally{if(F)throw q}}return M}return function(I,L){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return C(I,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function C(I,L){for(var M=0;M<L.length;M++){var D=L[M];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(I,D.key,D)}}return function(I,L,M){return L&&C(I.prototype,L),M&&C(I,M),I}})(),l=function C(I,L,M){I===null&&(I=Function.prototype);var D=Object.getOwnPropertyDescriptor(I,L);if(D===void 0){var F=Object.getPrototypeOf(I);return F===null?void 0:C(F,L,M)}else{if("value"in D)return D.value;var q=D.get;return q===void 0?void 0:q.call(M)}},u=i(2),h=w(u),c=i(0),f=w(c),m=i(4),g=w(m),v=i(6),y=w(v),x=i(7),b=w(x);function w(C){return C&&C.__esModule?C:{default:C}}function k(C,I){if(!(C instanceof I))throw new TypeError("Cannot call a class as a function")}function N(C,I){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:C}function E(C,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);C.prototype=Object.create(I&&I.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(C,I):C.__proto__=I)}var S=(function(C){E(I,C);function I(){return k(this,I),N(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return I})(y.default);S.blotName="code",S.tagName="CODE";var A=(function(C){E(I,C);function I(){return k(this,I),N(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return o(I,[{key:"delta",value:function(){var M=this,D=this.domNode.textContent;return D.endsWith(`
`)&&(D=D.slice(0,-1)),D.split(`
`).reduce(function(F,q){return F.insert(q).insert(`
`,M.formats())},new h.default)}},{key:"format",value:function(M,D){if(!(M===this.statics.blotName&&D)){var F=this.descendant(b.default,this.length()-1),q=a(F,1),B=q[0];B?.deleteAt(B.length()-1,1),l(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"format",this).call(this,M,D)}}},{key:"formatAt",value:function(M,D,F,q){if(D!==0&&!(f.default.query(F,f.default.Scope.BLOCK)==null||F===this.statics.blotName&&q===this.statics.formats(this.domNode))){var B=this.newlineIndex(M);if(!(B<0||B>=M+D)){var z=this.newlineIndex(M,!0)+1,G=B-z+1,Y=this.isolate(z,G),H=Y.next;Y.format(F,q),H instanceof I&&H.formatAt(0,M-z+D-G,F,q)}}}},{key:"insertAt",value:function(M,D,F){if(F==null){var q=this.descendant(b.default,M),B=a(q,2),z=B[0],G=B[1];z.insertAt(G,D)}}},{key:"length",value:function(){var M=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?M:M+1}},{key:"newlineIndex",value:function(M){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(D)return this.domNode.textContent.slice(0,M).lastIndexOf(`
`);var F=this.domNode.textContent.slice(M).indexOf(`
`);return F>-1?M+F:-1}},{key:"optimize",value:function(M){this.domNode.textContent.endsWith(`
`)||this.appendChild(f.default.create("text",`
`)),l(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"optimize",this).call(this,M);var D=this.next;D!=null&&D.prev===this&&D.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===D.statics.formats(D.domNode)&&(D.optimize(M),D.moveChildren(this),D.remove())}},{key:"replace",value:function(M){l(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"replace",this).call(this,M),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(D){var F=f.default.find(D);F==null?D.parentNode.removeChild(D):F instanceof f.default.Embed?F.remove():F.unwrap()})}}],[{key:"create",value:function(M){var D=l(I.__proto__||Object.getPrototypeOf(I),"create",this).call(this,M);return D.setAttribute("spellcheck",!1),D}},{key:"formats",value:function(){return!0}}]),I})(g.default);A.blotName="code-block",A.tagName="PRE",A.TAB="  ",n.Code=S,n.default=A}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},o=(function(){function H(V,O){var U=[],K=!0,se=!1,te=void 0;try{for(var X=V[Symbol.iterator](),Q;!(K=(Q=X.next()).done)&&(U.push(Q.value),!(O&&U.length===O));K=!0);}catch(ae){se=!0,te=ae}finally{try{!K&&X.return&&X.return()}finally{if(se)throw te}}return U}return function(V,O){if(Array.isArray(V))return V;if(Symbol.iterator in Object(V))return H(V,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function H(V,O){for(var U=0;U<O.length;U++){var K=O[U];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(V,K.key,K)}}return function(V,O,U){return O&&H(V.prototype,O),U&&H(V,U),V}})(),u=i(2),h=D(u),c=i(20),f=D(c),m=i(0),g=D(m),v=i(13),y=D(v),x=i(24),b=D(x),w=i(4),k=D(w),N=i(16),E=D(N),S=i(21),A=D(S),C=i(11),I=D(C),L=i(3),M=D(L);function D(H){return H&&H.__esModule?H:{default:H}}function F(H,V,O){return V in H?Object.defineProperty(H,V,{value:O,enumerable:!0,configurable:!0,writable:!0}):H[V]=O,H}function q(H,V){if(!(H instanceof V))throw new TypeError("Cannot call a class as a function")}var B=/^[ -~]*$/,z=(function(){function H(V){q(this,H),this.scroll=V,this.delta=this.getDelta()}return l(H,[{key:"applyDelta",value:function(O){var U=this,K=!1;this.scroll.update();var se=this.scroll.length();return this.scroll.batchStart(),O=Y(O),O.reduce(function(te,X){var Q=X.retain||X.delete||X.insert.length||1,ae=X.attributes||{};if(X.insert!=null){if(typeof X.insert=="string"){var J=X.insert;J.endsWith(`
`)&&K&&(K=!1,J=J.slice(0,-1)),te>=se&&!J.endsWith(`
`)&&(K=!0),U.scroll.insertAt(te,J);var ue=U.scroll.line(te),we=o(ue,2),_e=we[0],Ce=we[1],Le=(0,M.default)({},(0,w.bubbleFormats)(_e));if(_e instanceof k.default){var Qe=_e.descendant(g.default.Leaf,Ce),St=o(Qe,1),at=St[0];Le=(0,M.default)(Le,(0,w.bubbleFormats)(at))}ae=f.default.attributes.diff(Le,ae)||{}}else if(a(X.insert)==="object"){var ee=Object.keys(X.insert)[0];if(ee==null)return te;U.scroll.insertAt(te,ee,X.insert[ee])}se+=Q}return Object.keys(ae).forEach(function(ce){U.scroll.formatAt(te,Q,ce,ae[ce])}),te+Q},0),O.reduce(function(te,X){return typeof X.delete=="number"?(U.scroll.deleteAt(te,X.delete),te):te+(X.retain||X.insert.length||1)},0),this.scroll.batchEnd(),this.update(O)}},{key:"deleteText",value:function(O,U){return this.scroll.deleteAt(O,U),this.update(new h.default().retain(O).delete(U))}},{key:"formatLine",value:function(O,U){var K=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(se).forEach(function(te){if(!(K.scroll.whitelist!=null&&!K.scroll.whitelist[te])){var X=K.scroll.lines(O,Math.max(U,1)),Q=U;X.forEach(function(ae){var J=ae.length();if(!(ae instanceof y.default))ae.format(te,se[te]);else{var ue=O-ae.offset(K.scroll),we=ae.newlineIndex(ue+Q)-ue+1;ae.formatAt(ue,we,te,se[te])}Q-=J})}}),this.scroll.optimize(),this.update(new h.default().retain(O).retain(U,(0,A.default)(se)))}},{key:"formatText",value:function(O,U){var K=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(se).forEach(function(te){K.scroll.formatAt(O,U,te,se[te])}),this.update(new h.default().retain(O).retain(U,(0,A.default)(se)))}},{key:"getContents",value:function(O,U){return this.delta.slice(O,O+U)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(O,U){return O.concat(U.delta())},new h.default)}},{key:"getFormat",value:function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,K=[],se=[];U===0?this.scroll.path(O).forEach(function(X){var Q=o(X,1),ae=Q[0];ae instanceof k.default?K.push(ae):ae instanceof g.default.Leaf&&se.push(ae)}):(K=this.scroll.lines(O,U),se=this.scroll.descendants(g.default.Leaf,O,U));var te=[K,se].map(function(X){if(X.length===0)return{};for(var Q=(0,w.bubbleFormats)(X.shift());Object.keys(Q).length>0;){var ae=X.shift();if(ae==null)return Q;Q=G((0,w.bubbleFormats)(ae),Q)}return Q});return M.default.apply(M.default,te)}},{key:"getText",value:function(O,U){return this.getContents(O,U).filter(function(K){return typeof K.insert=="string"}).map(function(K){return K.insert}).join("")}},{key:"insertEmbed",value:function(O,U,K){return this.scroll.insertAt(O,U,K),this.update(new h.default().retain(O).insert(F({},U,K)))}},{key:"insertText",value:function(O,U){var K=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return U=U.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(O,U),Object.keys(se).forEach(function(te){K.scroll.formatAt(O,U.length,te,se[te])}),this.update(new h.default().retain(O).insert(U,(0,A.default)(se)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var O=this.scroll.children.head;return O.statics.blotName!==k.default.blotName||O.children.length>1?!1:O.children.head instanceof E.default}},{key:"removeFormat",value:function(O,U){var K=this.getText(O,U),se=this.scroll.line(O+U),te=o(se,2),X=te[0],Q=te[1],ae=0,J=new h.default;X!=null&&(X instanceof y.default?ae=X.newlineIndex(Q)-Q+1:ae=X.length()-Q,J=X.delta().slice(Q,Q+ae-1).insert(`
`));var ue=this.getContents(O,U+ae),we=ue.diff(new h.default().insert(K).concat(J)),_e=new h.default().retain(O).concat(we);return this.applyDelta(_e)}},{key:"update",value:function(O){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,se=this.delta;if(U.length===1&&U[0].type==="characterData"&&U[0].target.data.match(B)&&g.default.find(U[0].target)){var te=g.default.find(U[0].target),X=(0,w.bubbleFormats)(te),Q=te.offset(this.scroll),ae=U[0].oldValue.replace(b.default.CONTENTS,""),J=new h.default().insert(ae),ue=new h.default().insert(te.value()),we=new h.default().retain(Q).concat(J.diff(ue,K));O=we.reduce(function(_e,Ce){return Ce.insert?_e.insert(Ce.insert,X):_e.push(Ce)},new h.default),this.delta=se.compose(O)}else this.delta=this.getDelta(),(!O||!(0,I.default)(se.compose(O),this.delta))&&(O=se.diff(this.delta,K));return O}}]),H})();function G(H,V){return Object.keys(V).reduce(function(O,U){return H[U]==null||(V[U]===H[U]?O[U]=V[U]:Array.isArray(V[U])?V[U].indexOf(H[U])<0&&(O[U]=V[U].concat([H[U]])):O[U]=[V[U],H[U]]),O},{})}function Y(H){return H.reduce(function(V,O){if(O.insert===1){var U=(0,A.default)(O.attributes);return delete U.image,V.insert({image:O.attributes.image},U)}if(O.attributes!=null&&(O.attributes.list===!0||O.attributes.bullet===!0)&&(O=(0,A.default)(O),O.attributes.list?O.attributes.list="ordered":(O.attributes.list="bullet",delete O.attributes.bullet)),typeof O.insert=="string"){var K=O.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return V.insert(K,O.attributes)}return V.push(O)},new h.default)}n.default=z}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var a=(function(){function C(I,L){var M=[],D=!0,F=!1,q=void 0;try{for(var B=I[Symbol.iterator](),z;!(D=(z=B.next()).done)&&(M.push(z.value),!(L&&M.length===L));D=!0);}catch(G){F=!0,q=G}finally{try{!D&&B.return&&B.return()}finally{if(F)throw q}}return M}return function(I,L){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return C(I,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function C(I,L){for(var M=0;M<L.length;M++){var D=L[M];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(I,D.key,D)}}return function(I,L,M){return L&&C(I.prototype,L),M&&C(I,M),I}})(),l=i(0),u=b(l),h=i(21),c=b(h),f=i(11),m=b(f),g=i(8),v=b(g),y=i(10),x=b(y);function b(C){return C&&C.__esModule?C:{default:C}}function w(C){if(Array.isArray(C)){for(var I=0,L=Array(C.length);I<C.length;I++)L[I]=C[I];return L}else return Array.from(C)}function k(C,I){if(!(C instanceof I))throw new TypeError("Cannot call a class as a function")}var N=(0,x.default)("quill:selection"),E=function C(I){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;k(this,C),this.index=I,this.length=L},S=(function(){function C(I,L){var M=this;k(this,C),this.emitter=L,this.scroll=I,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=u.default.create("cursor",this),this.lastRange=this.savedRange=new E(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){M.mouseDown||setTimeout(M.update.bind(M,v.default.sources.USER),1)}),this.emitter.on(v.default.events.EDITOR_CHANGE,function(D,F){D===v.default.events.TEXT_CHANGE&&F.length()>0&&M.update(v.default.sources.SILENT)}),this.emitter.on(v.default.events.SCROLL_BEFORE_UPDATE,function(){if(M.hasFocus()){var D=M.getNativeRange();D!=null&&D.start.node!==M.cursor.textNode&&M.emitter.once(v.default.events.SCROLL_UPDATE,function(){try{M.setNativeRange(D.start.node,D.start.offset,D.end.node,D.end.offset)}catch{}})}}),this.emitter.on(v.default.events.SCROLL_OPTIMIZE,function(D,F){if(F.range){var q=F.range,B=q.startNode,z=q.startOffset,G=q.endNode,Y=q.endOffset;M.setNativeRange(B,z,G,Y)}}),this.update(v.default.sources.SILENT)}return o(C,[{key:"handleComposition",value:function(){var L=this;this.root.addEventListener("compositionstart",function(){L.composing=!0}),this.root.addEventListener("compositionend",function(){if(L.composing=!1,L.cursor.parent){var M=L.cursor.restore();if(!M)return;setTimeout(function(){L.setNativeRange(M.startNode,M.startOffset,M.endNode,M.endOffset)},1)}})}},{key:"handleDragging",value:function(){var L=this;this.emitter.listenDOM("mousedown",document.body,function(){L.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){L.mouseDown=!1,L.update(v.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(L,M){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[L])){this.scroll.update();var D=this.getNativeRange();if(!(D==null||!D.native.collapsed||u.default.query(L,u.default.Scope.BLOCK))){if(D.start.node!==this.cursor.textNode){var F=u.default.find(D.start.node,!1);if(F==null)return;if(F instanceof u.default.Leaf){var q=F.split(D.start.offset);F.parent.insertBefore(this.cursor,q)}else F.insertBefore(this.cursor,D.start.node);this.cursor.attach()}this.cursor.format(L,M),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(L){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=this.scroll.length();L=Math.min(L,D-1),M=Math.min(L+M,D-1)-L;var F=void 0,q=this.scroll.leaf(L),B=a(q,2),z=B[0],G=B[1];if(z==null)return null;var Y=z.position(G,!0),H=a(Y,2);F=H[0],G=H[1];var V=document.createRange();if(M>0){V.setStart(F,G);var O=this.scroll.leaf(L+M),U=a(O,2);if(z=U[0],G=U[1],z==null)return null;var K=z.position(G,!0),se=a(K,2);return F=se[0],G=se[1],V.setEnd(F,G),V.getBoundingClientRect()}else{var te="left",X=void 0;return F instanceof Text?(G<F.data.length?(V.setStart(F,G),V.setEnd(F,G+1)):(V.setStart(F,G-1),V.setEnd(F,G),te="right"),X=V.getBoundingClientRect()):(X=z.domNode.getBoundingClientRect(),G>0&&(te="right")),{bottom:X.top+X.height,height:X.height,left:X[te],right:X[te],top:X.top,width:0}}}},{key:"getNativeRange",value:function(){var L=document.getSelection();if(L==null||L.rangeCount<=0)return null;var M=L.getRangeAt(0);if(M==null)return null;var D=this.normalizeNative(M);return N.info("getNativeRange",D),D}},{key:"getRange",value:function(){var L=this.getNativeRange();if(L==null)return[null,null];var M=this.normalizedToRange(L);return[M,L]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(L){var M=this,D=[[L.start.node,L.start.offset]];L.native.collapsed||D.push([L.end.node,L.end.offset]);var F=D.map(function(z){var G=a(z,2),Y=G[0],H=G[1],V=u.default.find(Y,!0),O=V.offset(M.scroll);return H===0?O:V instanceof u.default.Container?O+V.length():O+V.index(Y,H)}),q=Math.min(Math.max.apply(Math,w(F)),this.scroll.length()-1),B=Math.min.apply(Math,[q].concat(w(F)));return new E(B,q-B)}},{key:"normalizeNative",value:function(L){if(!A(this.root,L.startContainer)||!L.collapsed&&!A(this.root,L.endContainer))return null;var M={start:{node:L.startContainer,offset:L.startOffset},end:{node:L.endContainer,offset:L.endOffset},native:L};return[M.start,M.end].forEach(function(D){for(var F=D.node,q=D.offset;!(F instanceof Text)&&F.childNodes.length>0;)if(F.childNodes.length>q)F=F.childNodes[q],q=0;else if(F.childNodes.length===q)F=F.lastChild,q=F instanceof Text?F.data.length:F.childNodes.length+1;else break;D.node=F,D.offset=q}),M}},{key:"rangeToNative",value:function(L){var M=this,D=L.collapsed?[L.index]:[L.index,L.index+L.length],F=[],q=this.scroll.length();return D.forEach(function(B,z){B=Math.min(q-1,B);var G=void 0,Y=M.scroll.leaf(B),H=a(Y,2),V=H[0],O=H[1],U=V.position(O,z!==0),K=a(U,2);G=K[0],O=K[1],F.push(G,O)}),F.length<2&&(F=F.concat(F)),F}},{key:"scrollIntoView",value:function(L){var M=this.lastRange;if(M!=null){var D=this.getBounds(M.index,M.length);if(D!=null){var F=this.scroll.length()-1,q=this.scroll.line(Math.min(M.index,F)),B=a(q,1),z=B[0],G=z;if(M.length>0){var Y=this.scroll.line(Math.min(M.index+M.length,F)),H=a(Y,1);G=H[0]}if(!(z==null||G==null)){var V=L.getBoundingClientRect();D.top<V.top?L.scrollTop-=V.top-D.top:D.bottom>V.bottom&&(L.scrollTop+=D.bottom-V.bottom)}}}}},{key:"setNativeRange",value:function(L,M){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:L,F=arguments.length>3&&arguments[3]!==void 0?arguments[3]:M,q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(N.info("setNativeRange",L,M,D,F),!(L!=null&&(this.root.parentNode==null||L.parentNode==null||D.parentNode==null))){var B=document.getSelection();if(B!=null)if(L!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||q||L!==z.startContainer||M!==z.startOffset||D!==z.endContainer||F!==z.endOffset){L.tagName=="BR"&&(M=[].indexOf.call(L.parentNode.childNodes,L),L=L.parentNode),D.tagName=="BR"&&(F=[].indexOf.call(D.parentNode.childNodes,D),D=D.parentNode);var G=document.createRange();G.setStart(L,M),G.setEnd(D,F),B.removeAllRanges(),B.addRange(G)}}else B.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(L){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.default.sources.API;if(typeof M=="string"&&(D=M,M=!1),N.info("setRange",L),L!=null){var F=this.rangeToNative(L);this.setNativeRange.apply(this,w(F).concat([M]))}else this.setNativeRange(null);this.update(D)}},{key:"update",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.default.sources.USER,M=this.lastRange,D=this.getRange(),F=a(D,2),q=F[0],B=F[1];if(this.lastRange=q,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,m.default)(M,this.lastRange)){var z;!this.composing&&B!=null&&B.native.collapsed&&B.start.node!==this.cursor.textNode&&this.cursor.restore();var G=[v.default.events.SELECTION_CHANGE,(0,c.default)(this.lastRange),(0,c.default)(M),L];if((z=this.emitter).emit.apply(z,[v.default.events.EDITOR_CHANGE].concat(G)),L!==v.default.sources.SILENT){var Y;(Y=this.emitter).emit.apply(Y,G)}}}}]),C})();function A(C,I){try{I.parentNode}catch{return!1}return I instanceof Text&&(I=I.parentNode),C.contains(I)}n.Range=E,n.default=S}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function v(y,x){for(var b=0;b<x.length;b++){var w=x[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,x,b){return x&&v(y.prototype,x),b&&v(y,b),y}})(),o=function v(y,x,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,x);if(w===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:v(k,x,b)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(b)}},l=i(0),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(){return c(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return a(y,[{key:"insertInto",value:function(b,w){b.children.length===0?o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"insertInto",this).call(this,b,w):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),y})(u.default.Embed);g.blotName="break",g.tagName="BR",n.default=g}),(function(t,n,i){var a=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var v in g)g.hasOwnProperty(v)&&(m[v]=g[v])};return function(m,g){f(m,g);function v(){this.constructor=m}m.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),l=i(30),u=i(1),h=(function(f){a(m,f);function m(g){var v=f.call(this,g)||this;return v.build(),v}return m.prototype.appendChild=function(g){this.insertBefore(g)},m.prototype.attach=function(){f.prototype.attach.call(this),this.children.forEach(function(g){g.attach()})},m.prototype.build=function(){var g=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(v){try{var y=c(v);g.insertBefore(y,g.children.head||void 0)}catch(x){if(x instanceof u.ParchmentError)return;throw x}})},m.prototype.deleteAt=function(g,v){if(g===0&&v===this.length())return this.remove();this.children.forEachAt(g,v,function(y,x,b){y.deleteAt(x,b)})},m.prototype.descendant=function(g,v){var y=this.children.find(v),x=y[0],b=y[1];return g.blotName==null&&g(x)||g.blotName!=null&&x instanceof g?[x,b]:x instanceof m?x.descendant(g,b):[null,-1]},m.prototype.descendants=function(g,v,y){v===void 0&&(v=0),y===void 0&&(y=Number.MAX_VALUE);var x=[],b=y;return this.children.forEachAt(v,y,function(w,k,N){(g.blotName==null&&g(w)||g.blotName!=null&&w instanceof g)&&x.push(w),w instanceof m&&(x=x.concat(w.descendants(g,k,b))),b-=N}),x},m.prototype.detach=function(){this.children.forEach(function(g){g.detach()}),f.prototype.detach.call(this)},m.prototype.formatAt=function(g,v,y,x){this.children.forEachAt(g,v,function(b,w,k){b.formatAt(w,k,y,x)})},m.prototype.insertAt=function(g,v,y){var x=this.children.find(g),b=x[0],w=x[1];if(b)b.insertAt(w,v,y);else{var k=y==null?u.create("text",v):u.create(v,y);this.appendChild(k)}},m.prototype.insertBefore=function(g,v){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(y){return g instanceof y}))throw new u.ParchmentError("Cannot insert "+g.statics.blotName+" into "+this.statics.blotName);g.insertInto(this,v)},m.prototype.length=function(){return this.children.reduce(function(g,v){return g+v.length()},0)},m.prototype.moveChildren=function(g,v){this.children.forEach(function(y){g.insertBefore(y,v)})},m.prototype.optimize=function(g){if(f.prototype.optimize.call(this,g),this.children.length===0)if(this.statics.defaultChild!=null){var v=u.create(this.statics.defaultChild);this.appendChild(v),v.optimize(g)}else this.remove()},m.prototype.path=function(g,v){v===void 0&&(v=!1);var y=this.children.find(g,v),x=y[0],b=y[1],w=[[this,g]];return x instanceof m?w.concat(x.path(b,v)):(x!=null&&w.push([x,b]),w)},m.prototype.removeChild=function(g){this.children.remove(g)},m.prototype.replace=function(g){g instanceof m&&g.moveChildren(this),f.prototype.replace.call(this,g)},m.prototype.split=function(g,v){if(v===void 0&&(v=!1),!v){if(g===0)return this;if(g===this.length())return this.next}var y=this.clone();return this.parent.insertBefore(y,this.next),this.children.forEachAt(g,this.length(),function(x,b,w){x=x.split(b,v),y.appendChild(x)}),y},m.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},m.prototype.update=function(g,v){var y=this,x=[],b=[];g.forEach(function(w){w.target===y.domNode&&w.type==="childList"&&(x.push.apply(x,w.addedNodes),b.push.apply(b,w.removedNodes))}),b.forEach(function(w){if(!(w.parentNode!=null&&w.tagName!=="IFRAME"&&document.body.compareDocumentPosition(w)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var k=u.find(w);k!=null&&(k.domNode.parentNode==null||k.domNode.parentNode===y.domNode)&&k.detach()}}),x.filter(function(w){return w.parentNode==y.domNode}).sort(function(w,k){return w===k?0:w.compareDocumentPosition(k)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(w){var k=null;w.nextSibling!=null&&(k=u.find(w.nextSibling));var N=c(w);(N.next!=k||N.next==null)&&(N.parent!=null&&N.parent.removeChild(y),y.insertBefore(N,k||void 0))})},m})(l.default);function c(f){var m=u.find(f);if(m==null)try{m=u.create(f)}catch{m=u.create(u.Scope.INLINE),[].slice.call(f.childNodes).forEach(function(v){m.domNode.appendChild(v)}),f.parentNode&&f.parentNode.replaceChild(m.domNode,f),m.attach()}return m}n.default=h}),(function(t,n,i){var a=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var v in g)g.hasOwnProperty(v)&&(m[v]=g[v])};return function(m,g){f(m,g);function v(){this.constructor=m}m.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),l=i(31),u=i(17),h=i(1),c=(function(f){a(m,f);function m(g){var v=f.call(this,g)||this;return v.attributes=new l.default(v.domNode),v}return m.formats=function(g){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return g.tagName.toLowerCase()},m.prototype.format=function(g,v){var y=h.query(g);y instanceof o.default?this.attributes.attribute(y,v):v&&y!=null&&(g!==this.statics.blotName||this.formats()[g]!==v)&&this.replaceWith(g,v)},m.prototype.formats=function(){var g=this.attributes.values(),v=this.statics.formats(this.domNode);return v!=null&&(g[this.statics.blotName]=v),g},m.prototype.replaceWith=function(g,v){var y=f.prototype.replaceWith.call(this,g,v);return this.attributes.copy(y),y},m.prototype.update=function(g,v){var y=this;f.prototype.update.call(this,g,v),g.some(function(x){return x.target===y.domNode&&x.type==="attributes"})&&this.attributes.build()},m.prototype.wrap=function(g,v){var y=f.prototype.wrap.call(this,g,v);return y instanceof m&&y.statics.scope===this.statics.scope&&this.attributes.move(y),y},m})(u.default);n.default=c}),(function(t,n,i){var a=this&&this.__extends||(function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])};return function(c,f){h(c,f);function m(){this.constructor=c}c.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),l=i(1),u=(function(h){a(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.value=function(f){return!0},c.prototype.index=function(f,m){return this.domNode===f||this.domNode.compareDocumentPosition(f)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(m,1):-1},c.prototype.position=function(f,m){var g=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return f>0&&(g+=1),[this.parent.domNode,g]},c.prototype.value=function(){var f;return f={},f[this.statics.blotName]=this.statics.value(this.domNode)||!0,f},c.scope=l.Scope.INLINE_BLOT,c})(o.default);n.default=u}),(function(t,n,i){var a=i(11),o=i(3),l={attributes:{compose:function(h,c,f){typeof h!="object"&&(h={}),typeof c!="object"&&(c={});var m=o(!0,{},c);f||(m=Object.keys(m).reduce(function(v,y){return m[y]!=null&&(v[y]=m[y]),v},{}));for(var g in h)h[g]!==void 0&&c[g]===void 0&&(m[g]=h[g]);return Object.keys(m).length>0?m:void 0},diff:function(h,c){typeof h!="object"&&(h={}),typeof c!="object"&&(c={});var f=Object.keys(h).concat(Object.keys(c)).reduce(function(m,g){return a(h[g],c[g])||(m[g]=c[g]===void 0?null:c[g]),m},{});return Object.keys(f).length>0?f:void 0},transform:function(h,c,f){if(typeof h!="object")return c;if(typeof c=="object"){if(!f)return c;var m=Object.keys(c).reduce(function(g,v){return h[v]===void 0&&(g[v]=c[v]),g},{});return Object.keys(m).length>0?m:void 0}}},iterator:function(h){return new u(h)},length:function(h){return typeof h.delete=="number"?h.delete:typeof h.retain=="number"?h.retain:typeof h.insert=="string"?h.insert.length:1}};function u(h){this.ops=h,this.index=0,this.offset=0}u.prototype.hasNext=function(){return this.peekLength()<1/0},u.prototype.next=function(h){h||(h=1/0);var c=this.ops[this.index];if(c){var f=this.offset,m=l.length(c);if(h>=m-f?(h=m-f,this.index+=1,this.offset=0):this.offset+=h,typeof c.delete=="number")return{delete:h};var g={};return c.attributes&&(g.attributes=c.attributes),typeof c.retain=="number"?g.retain=h:typeof c.insert=="string"?g.insert=c.insert.substr(f,h):g.insert=c.insert,g}else return{retain:1/0}},u.prototype.peek=function(){return this.ops[this.index]},u.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},u.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},u.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var h=this.offset,c=this.index,f=this.next(),m=this.ops.slice(this.index);return this.offset=h,this.index=c,[f].concat(m)}else return[]},t.exports=l}),(function(t,n){var i=(function(){function a(y,x){return x!=null&&y instanceof x}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var u;try{u=Promise}catch{u=function(){}}function h(y,x,b,w,k){typeof x=="object"&&(b=x.depth,w=x.prototype,k=x.includeNonEnumerable,x=x.circular);var N=[],E=[],S=typeof Buffer<"u";typeof x>"u"&&(x=!0),typeof b>"u"&&(b=1/0);function A(C,I){if(C===null)return null;if(I===0)return C;var L,M;if(typeof C!="object")return C;if(a(C,o))L=new o;else if(a(C,l))L=new l;else if(a(C,u))L=new u(function(V,O){C.then(function(U){V(A(U,I-1))},function(U){O(A(U,I-1))})});else if(h.__isArray(C))L=[];else if(h.__isRegExp(C))L=new RegExp(C.source,v(C)),C.lastIndex&&(L.lastIndex=C.lastIndex);else if(h.__isDate(C))L=new Date(C.getTime());else{if(S&&Buffer.isBuffer(C))return Buffer.allocUnsafe?L=Buffer.allocUnsafe(C.length):L=new Buffer(C.length),C.copy(L),L;a(C,Error)?L=Object.create(C):typeof w>"u"?(M=Object.getPrototypeOf(C),L=Object.create(M)):(L=Object.create(w),M=w)}if(x){var D=N.indexOf(C);if(D!=-1)return E[D];N.push(C),E.push(L)}a(C,o)&&C.forEach(function(V,O){var U=A(O,I-1),K=A(V,I-1);L.set(U,K)}),a(C,l)&&C.forEach(function(V){var O=A(V,I-1);L.add(O)});for(var F in C){var q;M&&(q=Object.getOwnPropertyDescriptor(M,F)),!(q&&q.set==null)&&(L[F]=A(C[F],I-1))}if(Object.getOwnPropertySymbols)for(var B=Object.getOwnPropertySymbols(C),F=0;F<B.length;F++){var z=B[F],G=Object.getOwnPropertyDescriptor(C,z);G&&!G.enumerable&&!k||(L[z]=A(C[z],I-1),G.enumerable||Object.defineProperty(L,z,{enumerable:!1}))}if(k)for(var Y=Object.getOwnPropertyNames(C),F=0;F<Y.length;F++){var H=Y[F],G=Object.getOwnPropertyDescriptor(C,H);G&&G.enumerable||(L[H]=A(C[H],I-1),Object.defineProperty(L,H,{enumerable:!1}))}return L}return A(y,b)}h.clonePrototype=function(x){if(x===null)return null;var b=function(){};return b.prototype=x,new b};function c(y){return Object.prototype.toString.call(y)}h.__objToStr=c;function f(y){return typeof y=="object"&&c(y)==="[object Date]"}h.__isDate=f;function m(y){return typeof y=="object"&&c(y)==="[object Array]"}h.__isArray=m;function g(y){return typeof y=="object"&&c(y)==="[object RegExp]"}h.__isRegExp=g;function v(y){var x="";return y.global&&(x+="g"),y.ignoreCase&&(x+="i"),y.multiline&&(x+="m"),x}return h.__getRegExpFlags=v,h})();typeof t=="object"&&t.exports&&(t.exports=i)}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function L(M,D){var F=[],q=!0,B=!1,z=void 0;try{for(var G=M[Symbol.iterator](),Y;!(q=(Y=G.next()).done)&&(F.push(Y.value),!(D&&F.length===D));q=!0);}catch(H){B=!0,z=H}finally{try{!q&&G.return&&G.return()}finally{if(B)throw z}}return F}return function(M,D){if(Array.isArray(M))return M;if(Symbol.iterator in Object(M))return L(M,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function L(M,D){for(var F=0;F<D.length;F++){var q=D[F];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(M,q.key,q)}}return function(M,D,F){return D&&L(M.prototype,D),F&&L(M,F),M}})(),l=function L(M,D,F){M===null&&(M=Function.prototype);var q=Object.getOwnPropertyDescriptor(M,D);if(q===void 0){var B=Object.getPrototypeOf(M);return B===null?void 0:L(B,D,F)}else{if("value"in q)return q.value;var z=q.get;return z===void 0?void 0:z.call(F)}},u=i(0),h=N(u),c=i(8),f=N(c),m=i(4),g=N(m),v=i(16),y=N(v),x=i(13),b=N(x),w=i(25),k=N(w);function N(L){return L&&L.__esModule?L:{default:L}}function E(L,M){if(!(L instanceof M))throw new TypeError("Cannot call a class as a function")}function S(L,M){if(!L)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M&&(typeof M=="object"||typeof M=="function")?M:L}function A(L,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof M);L.prototype=Object.create(M&&M.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(L,M):L.__proto__=M)}function C(L){return L instanceof g.default||L instanceof m.BlockEmbed}var I=(function(L){A(M,L);function M(D,F){E(this,M);var q=S(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,D));return q.emitter=F.emitter,Array.isArray(F.whitelist)&&(q.whitelist=F.whitelist.reduce(function(B,z){return B[z]=!0,B},{})),q.domNode.addEventListener("DOMNodeInserted",function(){}),q.optimize(),q.enable(),q}return o(M,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(F,q){var B=this.line(F),z=a(B,2),G=z[0],Y=z[1],H=this.line(F+q),V=a(H,1),O=V[0];if(l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"deleteAt",this).call(this,F,q),O!=null&&G!==O&&Y>0){if(G instanceof m.BlockEmbed||O instanceof m.BlockEmbed){this.optimize();return}if(G instanceof b.default){var U=G.newlineIndex(G.length(),!0);if(U>-1&&(G=G.split(U+1),G===O)){this.optimize();return}}else if(O instanceof b.default){var K=O.newlineIndex(0);K>-1&&O.split(K+1)}var se=O.children.head instanceof y.default?null:O.children.head;G.moveChildren(O,se),G.remove()}this.optimize()}},{key:"enable",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",F)}},{key:"formatAt",value:function(F,q,B,z){this.whitelist!=null&&!this.whitelist[B]||(l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"formatAt",this).call(this,F,q,B,z),this.optimize())}},{key:"insertAt",value:function(F,q,B){if(!(B!=null&&this.whitelist!=null&&!this.whitelist[q])){if(F>=this.length())if(B==null||h.default.query(q,h.default.Scope.BLOCK)==null){var z=h.default.create(this.statics.defaultChild);this.appendChild(z),B==null&&q.endsWith(`
`)&&(q=q.slice(0,-1)),z.insertAt(0,q,B)}else{var G=h.default.create(q,B);this.appendChild(G)}else l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertAt",this).call(this,F,q,B);this.optimize()}}},{key:"insertBefore",value:function(F,q){if(F.statics.scope===h.default.Scope.INLINE_BLOT){var B=h.default.create(this.statics.defaultChild);B.appendChild(F),F=B}l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertBefore",this).call(this,F,q)}},{key:"leaf",value:function(F){return this.path(F).pop()||[null,-1]}},{key:"line",value:function(F){return F===this.length()?this.line(F-1):this.descendant(C,F)}},{key:"lines",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,B=function z(G,Y,H){var V=[],O=H;return G.children.forEachAt(Y,H,function(U,K,se){C(U)?V.push(U):U instanceof h.default.Container&&(V=V.concat(z(U,K,O))),O-=se}),V};return B(this,F,q)}},{key:"optimize",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"optimize",this).call(this,F,q),F.length>0&&this.emitter.emit(f.default.events.SCROLL_OPTIMIZE,F,q))}},{key:"path",value:function(F){return l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"path",this).call(this,F).slice(1)}},{key:"update",value:function(F){if(this.batch!==!0){var q=f.default.sources.USER;typeof F=="string"&&(q=F),Array.isArray(F)||(F=this.observer.takeRecords()),F.length>0&&this.emitter.emit(f.default.events.SCROLL_BEFORE_UPDATE,q,F),l(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"update",this).call(this,F.concat([])),F.length>0&&this.emitter.emit(f.default.events.SCROLL_UPDATE,q,F)}}}]),M})(h.default.Scroll);I.blotName="scroll",I.className="ql-editor",I.tagName="DIV",I.defaultChild="block",I.allowedChildren=[g.default,m.BlockEmbed,k.default],n.default=I}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},o=(function(){function X(Q,ae){var J=[],ue=!0,we=!1,_e=void 0;try{for(var Ce=Q[Symbol.iterator](),Le;!(ue=(Le=Ce.next()).done)&&(J.push(Le.value),!(ae&&J.length===ae));ue=!0);}catch(Qe){we=!0,_e=Qe}finally{try{!ue&&Ce.return&&Ce.return()}finally{if(we)throw _e}}return J}return function(Q,ae){if(Array.isArray(Q))return Q;if(Symbol.iterator in Object(Q))return X(Q,ae);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function X(Q,ae){for(var J=0;J<ae.length;J++){var ue=ae[J];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(Q,ue.key,ue)}}return function(Q,ae,J){return ae&&X(Q.prototype,ae),J&&X(Q,J),Q}})(),u=i(21),h=L(u),c=i(11),f=L(c),m=i(3),g=L(m),v=i(2),y=L(v),x=i(20),b=L(x),w=i(0),k=L(w),N=i(5),E=L(N),S=i(10),A=L(S),C=i(9),I=L(C);function L(X){return X&&X.__esModule?X:{default:X}}function M(X,Q,ae){return Q in X?Object.defineProperty(X,Q,{value:ae,enumerable:!0,configurable:!0,writable:!0}):X[Q]=ae,X}function D(X,Q){if(!(X instanceof Q))throw new TypeError("Cannot call a class as a function")}function F(X,Q){if(!X)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Q&&(typeof Q=="object"||typeof Q=="function")?Q:X}function q(X,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Q);X.prototype=Object.create(Q&&Q.prototype,{constructor:{value:X,enumerable:!1,writable:!0,configurable:!0}}),Q&&(Object.setPrototypeOf?Object.setPrototypeOf(X,Q):X.__proto__=Q)}var B=(0,A.default)("quill:keyboard"),z=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",G=(function(X){q(Q,X),l(Q,null,[{key:"match",value:function(J,ue){return ue=te(ue),["altKey","ctrlKey","metaKey","shiftKey"].some(function(we){return!!ue[we]!==J[we]&&ue[we]!==null})?!1:ue.key===(J.which||J.keyCode)}}]);function Q(ae,J){D(this,Q);var ue=F(this,(Q.__proto__||Object.getPrototypeOf(Q)).call(this,ae,J));return ue.bindings={},Object.keys(ue.options.bindings).forEach(function(we){we==="list autofill"&&ae.scroll.whitelist!=null&&!ae.scroll.whitelist.list||ue.options.bindings[we]&&ue.addBinding(ue.options.bindings[we])}),ue.addBinding({key:Q.keys.ENTER,shiftKey:null},U),ue.addBinding({key:Q.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(ue.addBinding({key:Q.keys.BACKSPACE},{collapsed:!0},H),ue.addBinding({key:Q.keys.DELETE},{collapsed:!0},V)):(ue.addBinding({key:Q.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},H),ue.addBinding({key:Q.keys.DELETE},{collapsed:!0,suffix:/^.?$/},V)),ue.addBinding({key:Q.keys.BACKSPACE},{collapsed:!1},O),ue.addBinding({key:Q.keys.DELETE},{collapsed:!1},O),ue.addBinding({key:Q.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},H),ue.listen(),ue}return l(Q,[{key:"addBinding",value:function(J){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_e=te(J);if(_e==null||_e.key==null)return B.warn("Attempted to add invalid keyboard binding",_e);typeof ue=="function"&&(ue={handler:ue}),typeof we=="function"&&(we={handler:we}),_e=(0,g.default)(_e,ue,we),this.bindings[_e.key]=this.bindings[_e.key]||[],this.bindings[_e.key].push(_e)}},{key:"listen",value:function(){var J=this;this.quill.root.addEventListener("keydown",function(ue){if(!ue.defaultPrevented){var we=ue.which||ue.keyCode,_e=(J.bindings[we]||[]).filter(function(gt){return Q.match(ue,gt)});if(_e.length!==0){var Ce=J.quill.getSelection();if(!(Ce==null||!J.quill.hasFocus())){var Le=J.quill.getLine(Ce.index),Qe=o(Le,2),St=Qe[0],at=Qe[1],ee=J.quill.getLeaf(Ce.index),ce=o(ee,2),ge=ce[0],ve=ce[1],pe=Ce.length===0?[ge,ve]:J.quill.getLeaf(Ce.index+Ce.length),Ue=o(pe,2),We=Ue[0],Ge=Ue[1],Jt=ge instanceof k.default.Text?ge.value().slice(0,ve):"",os=We instanceof k.default.Text?We.value().slice(Ge):"",ut={collapsed:Ce.length===0,empty:Ce.length===0&&St.length()<=1,format:J.quill.getFormat(Ce),offset:at,prefix:Jt,suffix:os},Ri=_e.some(function(gt){if(gt.collapsed!=null&&gt.collapsed!==ut.collapsed||gt.empty!=null&&gt.empty!==ut.empty||gt.offset!=null&&gt.offset!==ut.offset)return!1;if(Array.isArray(gt.format)){if(gt.format.every(function(_s){return ut.format[_s]==null}))return!1}else if(a(gt.format)==="object"&&!Object.keys(gt.format).every(function(_s){return gt.format[_s]===!0?ut.format[_s]!=null:gt.format[_s]===!1?ut.format[_s]==null:(0,f.default)(gt.format[_s],ut.format[_s])}))return!1;return gt.prefix!=null&&!gt.prefix.test(ut.prefix)||gt.suffix!=null&&!gt.suffix.test(ut.suffix)?!1:gt.handler.call(J,Ce,ut)!==!0});Ri&&ue.preventDefault()}}}})}}]),Q})(I.default);G.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},G.DEFAULTS={bindings:{bold:se("bold"),italic:se("italic"),underline:se("underline"),indent:{key:G.keys.TAB,format:["blockquote","indent","list"],handler:function(Q,ae){if(ae.collapsed&&ae.offset!==0)return!0;this.quill.format("indent","+1",E.default.sources.USER)}},outdent:{key:G.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(Q,ae){if(ae.collapsed&&ae.offset!==0)return!0;this.quill.format("indent","-1",E.default.sources.USER)}},"outdent backspace":{key:G.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(Q,ae){ae.format.indent!=null?this.quill.format("indent","-1",E.default.sources.USER):ae.format.list!=null&&this.quill.format("list",!1,E.default.sources.USER)}},"indent code-block":K(!0),"outdent code-block":K(!1),"remove tab":{key:G.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(Q){this.quill.deleteText(Q.index-1,1,E.default.sources.USER)}},tab:{key:G.keys.TAB,handler:function(Q){this.quill.history.cutoff();var ae=new y.default().retain(Q.index).delete(Q.length).insert("	");this.quill.updateContents(ae,E.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Q.index+1,E.default.sources.SILENT)}},"list empty enter":{key:G.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(Q,ae){this.quill.format("list",!1,E.default.sources.USER),ae.format.indent&&this.quill.format("indent",!1,E.default.sources.USER)}},"checklist enter":{key:G.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(Q){var ae=this.quill.getLine(Q.index),J=o(ae,2),ue=J[0],we=J[1],_e=(0,g.default)({},ue.formats(),{list:"checked"}),Ce=new y.default().retain(Q.index).insert(`
`,_e).retain(ue.length()-we-1).retain(1,{list:"unchecked"});this.quill.updateContents(Ce,E.default.sources.USER),this.quill.setSelection(Q.index+1,E.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:G.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(Q,ae){var J=this.quill.getLine(Q.index),ue=o(J,2),we=ue[0],_e=ue[1],Ce=new y.default().retain(Q.index).insert(`
`,ae.format).retain(we.length()-_e-1).retain(1,{header:null});this.quill.updateContents(Ce,E.default.sources.USER),this.quill.setSelection(Q.index+1,E.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(Q,ae){var J=ae.prefix.length,ue=this.quill.getLine(Q.index),we=o(ue,2),_e=we[0],Ce=we[1];if(Ce>J)return!0;var Le=void 0;switch(ae.prefix.trim()){case"[]":case"[ ]":Le="unchecked";break;case"[x]":Le="checked";break;case"-":case"*":Le="bullet";break;default:Le="ordered"}this.quill.insertText(Q.index," ",E.default.sources.USER),this.quill.history.cutoff();var Qe=new y.default().retain(Q.index-Ce).delete(J+1).retain(_e.length()-2-Ce).retain(1,{list:Le});this.quill.updateContents(Qe,E.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(Q.index-J,E.default.sources.SILENT)}},"code exit":{key:G.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(Q){var ae=this.quill.getLine(Q.index),J=o(ae,2),ue=J[0],we=J[1],_e=new y.default().retain(Q.index+ue.length()-we-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(_e,E.default.sources.USER)}},"embed left":Y(G.keys.LEFT,!1),"embed left shift":Y(G.keys.LEFT,!0),"embed right":Y(G.keys.RIGHT,!1),"embed right shift":Y(G.keys.RIGHT,!0)}};function Y(X,Q){var ae,J=X===G.keys.LEFT?"prefix":"suffix";return ae={key:X,shiftKey:Q,altKey:null},M(ae,J,/^$/),M(ae,"handler",function(we){var _e=we.index;X===G.keys.RIGHT&&(_e+=we.length+1);var Ce=this.quill.getLeaf(_e),Le=o(Ce,1),Qe=Le[0];return Qe instanceof k.default.Embed?(X===G.keys.LEFT?Q?this.quill.setSelection(we.index-1,we.length+1,E.default.sources.USER):this.quill.setSelection(we.index-1,E.default.sources.USER):Q?this.quill.setSelection(we.index,we.length+1,E.default.sources.USER):this.quill.setSelection(we.index+we.length+1,E.default.sources.USER),!1):!0}),ae}function H(X,Q){if(!(X.index===0||this.quill.getLength()<=1)){var ae=this.quill.getLine(X.index),J=o(ae,1),ue=J[0],we={};if(Q.offset===0){var _e=this.quill.getLine(X.index-1),Ce=o(_e,1),Le=Ce[0];if(Le!=null&&Le.length()>1){var Qe=ue.formats(),St=this.quill.getFormat(X.index-1,1);we=b.default.attributes.diff(Qe,St)||{}}}var at=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(Q.prefix)?2:1;this.quill.deleteText(X.index-at,at,E.default.sources.USER),Object.keys(we).length>0&&this.quill.formatLine(X.index-at,at,we,E.default.sources.USER),this.quill.focus()}}function V(X,Q){var ae=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(Q.suffix)?2:1;if(!(X.index>=this.quill.getLength()-ae)){var J={},ue=0,we=this.quill.getLine(X.index),_e=o(we,1),Ce=_e[0];if(Q.offset>=Ce.length()-1){var Le=this.quill.getLine(X.index+1),Qe=o(Le,1),St=Qe[0];if(St){var at=Ce.formats(),ee=this.quill.getFormat(X.index,1);J=b.default.attributes.diff(at,ee)||{},ue=St.length()}}this.quill.deleteText(X.index,ae,E.default.sources.USER),Object.keys(J).length>0&&this.quill.formatLine(X.index+ue-1,ae,J,E.default.sources.USER)}}function O(X){var Q=this.quill.getLines(X),ae={};if(Q.length>1){var J=Q[0].formats(),ue=Q[Q.length-1].formats();ae=b.default.attributes.diff(ue,J)||{}}this.quill.deleteText(X,E.default.sources.USER),Object.keys(ae).length>0&&this.quill.formatLine(X.index,1,ae,E.default.sources.USER),this.quill.setSelection(X.index,E.default.sources.SILENT),this.quill.focus()}function U(X,Q){var ae=this;X.length>0&&this.quill.scroll.deleteAt(X.index,X.length);var J=Object.keys(Q.format).reduce(function(ue,we){return k.default.query(we,k.default.Scope.BLOCK)&&!Array.isArray(Q.format[we])&&(ue[we]=Q.format[we]),ue},{});this.quill.insertText(X.index,`
`,J,E.default.sources.USER),this.quill.setSelection(X.index+1,E.default.sources.SILENT),this.quill.focus(),Object.keys(Q.format).forEach(function(ue){J[ue]==null&&(Array.isArray(Q.format[ue])||ue!=="link"&&ae.quill.format(ue,Q.format[ue],E.default.sources.USER))})}function K(X){return{key:G.keys.TAB,shiftKey:!X,format:{"code-block":!0},handler:function(ae){var J=k.default.query("code-block"),ue=ae.index,we=ae.length,_e=this.quill.scroll.descendant(J,ue),Ce=o(_e,2),Le=Ce[0],Qe=Ce[1];if(Le!=null){var St=this.quill.getIndex(Le),at=Le.newlineIndex(Qe,!0)+1,ee=Le.newlineIndex(St+Qe+we),ce=Le.domNode.textContent.slice(at,ee).split(`
`);Qe=0,ce.forEach(function(ge,ve){X?(Le.insertAt(at+Qe,J.TAB),Qe+=J.TAB.length,ve===0?ue+=J.TAB.length:we+=J.TAB.length):ge.startsWith(J.TAB)&&(Le.deleteAt(at+Qe,J.TAB.length),Qe-=J.TAB.length,ve===0?ue-=J.TAB.length:we-=J.TAB.length),Qe+=ge.length+1}),this.quill.update(E.default.sources.USER),this.quill.setSelection(ue,we,E.default.sources.SILENT)}}}}function se(X){return{key:X[0].toUpperCase(),shortKey:!0,handler:function(ae,J){this.quill.format(X,!J.format[X],E.default.sources.USER)}}}function te(X){if(typeof X=="string"||typeof X=="number")return te({key:X});if((typeof X>"u"?"undefined":a(X))==="object"&&(X=(0,h.default)(X,!1)),typeof X.key=="string")if(G.keys[X.key.toUpperCase()]!=null)X.key=G.keys[X.key.toUpperCase()];else if(X.key.length===1)X.key=X.key.toUpperCase().charCodeAt(0);else return null;return X.shortKey&&(X[z]=X.shortKey,delete X.shortKey),X}n.default=G,n.SHORTKEY=z}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function b(w,k){var N=[],E=!0,S=!1,A=void 0;try{for(var C=w[Symbol.iterator](),I;!(E=(I=C.next()).done)&&(N.push(I.value),!(k&&N.length===k));E=!0);}catch(L){S=!0,A=L}finally{try{!E&&C.return&&C.return()}finally{if(S)throw A}}return N}return function(w,k){if(Array.isArray(w))return w;if(Symbol.iterator in Object(w))return b(w,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=function b(w,k,N){w===null&&(w=Function.prototype);var E=Object.getOwnPropertyDescriptor(w,k);if(E===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:b(S,k,N)}else{if("value"in E)return E.value;var A=E.get;return A===void 0?void 0:A.call(N)}},l=(function(){function b(w,k){for(var N=0;N<k.length;N++){var E=k[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,k,N){return k&&b(w.prototype,k),N&&b(w,N),w}})(),u=i(0),h=m(u),c=i(7),f=m(c);function m(b){return b&&b.__esModule?b:{default:b}}function g(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function v(b,w){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:b}function y(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(b,w):b.__proto__=w)}var x=(function(b){y(w,b),l(w,null,[{key:"value",value:function(){}}]);function w(k,N){g(this,w);var E=v(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,k));return E.selection=N,E.textNode=document.createTextNode(w.CONTENTS),E.domNode.appendChild(E.textNode),E._length=0,E}return l(w,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(N,E){if(this._length!==0)return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,N,E);for(var S=this,A=0;S!=null&&S.statics.scope!==h.default.Scope.BLOCK_BLOT;)A+=S.offset(S.parent),S=S.parent;S!=null&&(this._length=w.CONTENTS.length,S.optimize(),S.formatAt(A,w.CONTENTS.length,N,E),this._length=0)}},{key:"index",value:function(N,E){return N===this.textNode?0:o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"index",this).call(this,N,E)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var N=this.textNode,E=this.selection.getNativeRange(),S=void 0,A=void 0,C=void 0;if(E!=null&&E.start.node===N&&E.end.node===N){var I=[N,E.start.offset,E.end.offset];S=I[0],A=I[1],C=I[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==w.CONTENTS){var L=this.textNode.data.split(w.CONTENTS).join("");this.next instanceof f.default?(S=this.next.domNode,this.next.insertAt(0,L),this.textNode.data=w.CONTENTS):(this.textNode.data=L,this.parent.insertBefore(h.default.create(this.textNode),this),this.textNode=document.createTextNode(w.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),A!=null){var M=[A,C].map(function(F){return Math.max(0,Math.min(S.data.length,F-1))}),D=a(M,2);return A=D[0],C=D[1],{startNode:S,startOffset:A,endNode:S,endOffset:C}}}}},{key:"update",value:function(N,E){var S=this;if(N.some(function(C){return C.type==="characterData"&&C.target===S.textNode})){var A=this.restore();A&&(E.range=A)}}},{key:"value",value:function(){return""}}]),w})(h.default.Embed);x.blotName="cursor",x.className="ql-cursor",x.tagName="span",x.CONTENTS="\uFEFF",n.default=x}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=h(a),l=i(4),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(){return c(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return y})(o.default.Container);g.allowedChildren=[u.default,l.BlockEmbed,g],n.default=g}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var a=(function(){function x(b,w){for(var k=0;k<w.length;k++){var N=w[k];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,w,k){return w&&x(b.prototype,w),k&&x(b,k),b}})(),o=function x(b,w,k){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,w);if(N===void 0){var E=Object.getPrototypeOf(b);return E===null?void 0:x(E,w,k)}else{if("value"in N)return N.value;var S=N.get;return S===void 0?void 0:S.call(k)}},l=i(0),u=h(l);function h(x){return x&&x.__esModule?x:{default:x}}function c(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function f(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function m(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var g=(function(x){m(b,x);function b(){return c(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,[{key:"value",value:function(k){var N=o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,k);return N.startsWith("rgb(")?(N=N.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+N.split(",").map(function(E){return("00"+parseInt(E).toString(16)).slice(-2)}).join("")):N}}]),b})(u.default.Attributor.Style),v=new u.default.Attributor.Class("color","ql-color",{scope:u.default.Scope.INLINE}),y=new g("color","color",{scope:u.default.Scope.INLINE});n.ColorAttributor=g,n.ColorClass=v,n.ColorStyle=y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var a=(function(){function y(x,b){for(var w=0;w<b.length;w++){var k=b[w];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}return function(x,b,w){return b&&y(x.prototype,b),w&&y(x,w),x}})(),o=function y(x,b,w){x===null&&(x=Function.prototype);var k=Object.getOwnPropertyDescriptor(x,b);if(k===void 0){var N=Object.getPrototypeOf(x);return N===null?void 0:y(N,b,w)}else{if("value"in k)return k.value;var E=k.get;return E===void 0?void 0:E.call(w)}},l=i(6),u=h(l);function h(y){return y&&y.__esModule?y:{default:y}}function c(y,x){if(!(y instanceof x))throw new TypeError("Cannot call a class as a function")}function f(y,x){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:y}function m(y,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x)}var g=(function(y){m(x,y);function x(){return c(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return a(x,[{key:"format",value:function(w,k){if(w!==this.statics.blotName||!k)return o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"format",this).call(this,w,k);k=this.constructor.sanitize(k),this.domNode.setAttribute("href",k)}}],[{key:"create",value:function(w){var k=o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,w);return w=this.sanitize(w),k.setAttribute("href",w),k.setAttribute("rel","noopener noreferrer"),k.setAttribute("target","_blank"),k}},{key:"formats",value:function(w){return w.getAttribute("href")}},{key:"sanitize",value:function(w){return v(w,this.PROTOCOL_WHITELIST)?w:this.SANITIZED_URL}}]),x})(u.default);g.blotName="link",g.tagName="A",g.SANITIZED_URL="about:blank",g.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function v(y,x){var b=document.createElement("a");b.href=y;var w=b.href.slice(0,b.href.indexOf(":"));return x.indexOf(w)>-1}n.default=g,n.sanitize=v}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},o=(function(){function x(b,w){for(var k=0;k<w.length;k++){var N=w[k];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,w,k){return w&&x(b.prototype,w),k&&x(b,k),b}})(),l=i(23),u=f(l),h=i(107),c=f(h);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}var g=0;function v(x,b){x.setAttribute(b,x.getAttribute(b)!=="true")}var y=(function(){function x(b){var w=this;m(this,x),this.select=b,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){w.togglePicker()}),this.label.addEventListener("keydown",function(k){switch(k.keyCode){case u.default.keys.ENTER:w.togglePicker();break;case u.default.keys.ESCAPE:w.escape(),k.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(x,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),v(this.label,"aria-expanded"),v(this.options,"aria-hidden")}},{key:"buildItem",value:function(w){var k=this,N=document.createElement("span");return N.tabIndex="0",N.setAttribute("role","button"),N.classList.add("ql-picker-item"),w.hasAttribute("value")&&N.setAttribute("data-value",w.getAttribute("value")),w.textContent&&N.setAttribute("data-label",w.textContent),N.addEventListener("click",function(){k.selectItem(N,!0)}),N.addEventListener("keydown",function(E){switch(E.keyCode){case u.default.keys.ENTER:k.selectItem(N,!0),E.preventDefault();break;case u.default.keys.ESCAPE:k.escape(),E.preventDefault();break}}),N}},{key:"buildLabel",value:function(){var w=document.createElement("span");return w.classList.add("ql-picker-label"),w.innerHTML=c.default,w.tabIndex="0",w.setAttribute("role","button"),w.setAttribute("aria-expanded","false"),this.container.appendChild(w),w}},{key:"buildOptions",value:function(){var w=this,k=document.createElement("span");k.classList.add("ql-picker-options"),k.setAttribute("aria-hidden","true"),k.tabIndex="-1",k.id="ql-picker-options-"+g,g+=1,this.label.setAttribute("aria-controls",k.id),this.options=k,[].slice.call(this.select.options).forEach(function(N){var E=w.buildItem(N);k.appendChild(E),N.selected===!0&&w.selectItem(E)}),this.container.appendChild(k)}},{key:"buildPicker",value:function(){var w=this;[].slice.call(this.select.attributes).forEach(function(k){w.container.setAttribute(k.name,k.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var w=this;this.close(),setTimeout(function(){return w.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(w){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=this.container.querySelector(".ql-selected");if(w!==N&&(N?.classList.remove("ql-selected"),w!=null&&(w.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(w.parentNode.children,w),w.hasAttribute("data-value")?this.label.setAttribute("data-value",w.getAttribute("data-value")):this.label.removeAttribute("data-value"),w.hasAttribute("data-label")?this.label.setAttribute("data-label",w.getAttribute("data-label")):this.label.removeAttribute("data-label"),k))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":a(Event))==="object"){var E=document.createEvent("Event");E.initEvent("change",!0,!0),this.select.dispatchEvent(E)}this.close()}}},{key:"update",value:function(){var w=void 0;if(this.select.selectedIndex>-1){var k=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];w=this.select.options[this.select.selectedIndex],this.selectItem(k)}else this.selectItem(null);var N=w!=null&&w!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",N)}}]),x})();n.default=y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=B(a),l=i(5),u=B(l),h=i(4),c=B(h),f=i(16),m=B(f),g=i(25),v=B(g),y=i(24),x=B(y),b=i(35),w=B(b),k=i(6),N=B(k),E=i(22),S=B(E),A=i(7),C=B(A),I=i(55),L=B(I),M=i(42),D=B(M),F=i(23),q=B(F);function B(z){return z&&z.__esModule?z:{default:z}}u.default.register({"blots/block":c.default,"blots/block/embed":h.BlockEmbed,"blots/break":m.default,"blots/container":v.default,"blots/cursor":x.default,"blots/embed":w.default,"blots/inline":N.default,"blots/scroll":S.default,"blots/text":C.default,"modules/clipboard":L.default,"modules/history":D.default,"modules/keyboard":q.default}),o.default.register(c.default,m.default,x.default,N.default,S.default,C.default),n.default=u.default}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(1),o=(function(){function l(u){this.domNode=u,this.domNode[a.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(u){if(this.tagName==null)throw new a.ParchmentError("Blot definition missing tagName");var h;return Array.isArray(this.tagName)?(typeof u=="string"&&(u=u.toUpperCase(),parseInt(u).toString()===u&&(u=parseInt(u))),typeof u=="number"?h=document.createElement(this.tagName[u-1]):this.tagName.indexOf(u)>-1?h=document.createElement(u):h=document.createElement(this.tagName[0])):h=document.createElement(this.tagName),this.className&&h.classList.add(this.className),h},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var u=this.domNode.cloneNode(!1);return a.create(u)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[a.DATA_KEY]},l.prototype.deleteAt=function(u,h){var c=this.isolate(u,h);c.remove()},l.prototype.formatAt=function(u,h,c,f){var m=this.isolate(u,h);if(a.query(c,a.Scope.BLOT)!=null&&f)m.wrap(c,f);else if(a.query(c,a.Scope.ATTRIBUTE)!=null){var g=a.create(this.statics.scope);m.wrap(g),g.format(c,f)}},l.prototype.insertAt=function(u,h,c){var f=c==null?a.create("text",h):a.create(h,c),m=this.split(u);this.parent.insertBefore(f,m)},l.prototype.insertInto=function(u,h){h===void 0&&(h=null),this.parent!=null&&this.parent.children.remove(this);var c=null;u.children.insertBefore(this,h),h!=null&&(c=h.domNode),(this.domNode.parentNode!=u.domNode||this.domNode.nextSibling!=c)&&u.domNode.insertBefore(this.domNode,c),this.parent=u,this.attach()},l.prototype.isolate=function(u,h){var c=this.split(u);return c.split(h),c},l.prototype.length=function(){return 1},l.prototype.offset=function(u){return u===void 0&&(u=this.parent),this.parent==null||this==u?0:this.parent.children.offset(this)+this.parent.offset(u)},l.prototype.optimize=function(u){this.domNode[a.DATA_KEY]!=null&&delete this.domNode[a.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(u){u.parent!=null&&(u.parent.insertBefore(this,u.next),u.remove())},l.prototype.replaceWith=function(u,h){var c=typeof u=="string"?a.create(u,h):u;return c.replace(this),c},l.prototype.split=function(u,h){return u===0?this:this.next},l.prototype.update=function(u,h){},l.prototype.wrap=function(u,h){var c=typeof u=="string"?a.create(u,h):u;return this.parent!=null&&this.parent.insertBefore(c,this.next),c.appendChild(this),c},l.blotName="abstract",l})();n.default=o}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(12),o=i(32),l=i(33),u=i(1),h=(function(){function c(f){this.attributes={},this.domNode=f,this.build()}return c.prototype.attribute=function(f,m){m?f.add(this.domNode,m)&&(f.value(this.domNode)!=null?this.attributes[f.attrName]=f:delete this.attributes[f.attrName]):(f.remove(this.domNode),delete this.attributes[f.attrName])},c.prototype.build=function(){var f=this;this.attributes={};var m=a.default.keys(this.domNode),g=o.default.keys(this.domNode),v=l.default.keys(this.domNode);m.concat(g).concat(v).forEach(function(y){var x=u.query(y,u.Scope.ATTRIBUTE);x instanceof a.default&&(f.attributes[x.attrName]=x)})},c.prototype.copy=function(f){var m=this;Object.keys(this.attributes).forEach(function(g){var v=m.attributes[g].value(m.domNode);f.format(g,v)})},c.prototype.move=function(f){var m=this;this.copy(f),Object.keys(this.attributes).forEach(function(g){m.attributes[g].remove(m.domNode)}),this.attributes={}},c.prototype.values=function(){var f=this;return Object.keys(this.attributes).reduce(function(m,g){return m[g]=f.attributes[g].value(f.domNode),m},{})},c})();n.default=h}),(function(t,n,i){var a=this&&this.__extends||(function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])};return function(c,f){h(c,f);function m(){this.constructor=c}c.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(h,c){var f=h.getAttribute("class")||"";return f.split(/\s+/).filter(function(m){return m.indexOf(c+"-")===0})}var u=(function(h){a(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.keys=function(f){return(f.getAttribute("class")||"").split(/\s+/).map(function(m){return m.split("-").slice(0,-1).join("-")})},c.prototype.add=function(f,m){return this.canAdd(f,m)?(this.remove(f),f.classList.add(this.keyName+"-"+m),!0):!1},c.prototype.remove=function(f){var m=l(f,this.keyName);m.forEach(function(g){f.classList.remove(g)}),f.classList.length===0&&f.removeAttribute("class")},c.prototype.value=function(f){var m=l(f,this.keyName)[0]||"",g=m.slice(this.keyName.length+1);return this.canAdd(f,g)?g:""},c})(o.default);n.default=u}),(function(t,n,i){var a=this&&this.__extends||(function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])};return function(c,f){h(c,f);function m(){this.constructor=c}c.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(h){var c=h.split("-"),f=c.slice(1).map(function(m){return m[0].toUpperCase()+m.slice(1)}).join("");return c[0]+f}var u=(function(h){a(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.keys=function(f){return(f.getAttribute("style")||"").split(";").map(function(m){var g=m.split(":");return g[0].trim()})},c.prototype.add=function(f,m){return this.canAdd(f,m)?(f.style[l(this.keyName)]=m,!0):!1},c.prototype.remove=function(f){f.style[l(this.keyName)]="",f.getAttribute("style")||f.removeAttribute("style")},c.prototype.value=function(f){var m=f.style[l(this.keyName)];return this.canAdd(f,m)?m:""},c})(o.default);n.default=u}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function u(h,c){for(var f=0;f<c.length;f++){var m=c[f];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(h,m.key,m)}}return function(h,c,f){return c&&u(h.prototype,c),f&&u(h,f),h}})();function o(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}var l=(function(){function u(h,c){o(this,u),this.quill=h,this.options=c,this.modules={}}return a(u,[{key:"init",value:function(){var c=this;Object.keys(this.options.modules).forEach(function(f){c.modules[f]==null&&c.addModule(f)})}},{key:"addModule",value:function(c){var f=this.quill.constructor.import("modules/"+c);return this.modules[c]=new f(this.quill,this.options.modules[c]||{}),this.modules[c]}}]),u})();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function b(w,k){for(var N=0;N<k.length;N++){var E=k[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,k,N){return k&&b(w.prototype,k),N&&b(w,N),w}})(),o=function b(w,k,N){w===null&&(w=Function.prototype);var E=Object.getOwnPropertyDescriptor(w,k);if(E===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:b(S,k,N)}else{if("value"in E)return E.value;var A=E.get;return A===void 0?void 0:A.call(N)}},l=i(0),u=f(l),h=i(7),c=f(h);function f(b){return b&&b.__esModule?b:{default:b}}function m(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function g(b,w){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:b}function v(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(b,w):b.__proto__=w)}var y="\uFEFF",x=(function(b){v(w,b);function w(k){m(this,w);var N=g(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,k));return N.contentNode=document.createElement("span"),N.contentNode.setAttribute("contenteditable",!1),[].slice.call(N.domNode.childNodes).forEach(function(E){N.contentNode.appendChild(E)}),N.leftGuard=document.createTextNode(y),N.rightGuard=document.createTextNode(y),N.domNode.appendChild(N.leftGuard),N.domNode.appendChild(N.contentNode),N.domNode.appendChild(N.rightGuard),N}return a(w,[{key:"index",value:function(N,E){return N===this.leftGuard?0:N===this.rightGuard?1:o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"index",this).call(this,N,E)}},{key:"restore",value:function(N){var E=void 0,S=void 0,A=N.data.split(y).join("");if(N===this.leftGuard)if(this.prev instanceof c.default){var C=this.prev.length();this.prev.insertAt(C,A),E={startNode:this.prev.domNode,startOffset:C+A.length}}else S=document.createTextNode(A),this.parent.insertBefore(u.default.create(S),this),E={startNode:S,startOffset:A.length};else N===this.rightGuard&&(this.next instanceof c.default?(this.next.insertAt(0,A),E={startNode:this.next.domNode,startOffset:A.length}):(S=document.createTextNode(A),this.parent.insertBefore(u.default.create(S),this.next),E={startNode:S,startOffset:A.length}));return N.data=y,E}},{key:"update",value:function(N,E){var S=this;N.forEach(function(A){if(A.type==="characterData"&&(A.target===S.leftGuard||A.target===S.rightGuard)){var C=S.restore(A.target);C&&(E.range=C)}})}}]),w})(u.default.Embed);n.default=x}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var a=i(0),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}var u={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},h=new o.default.Attributor.Attribute("align","align",u),c=new o.default.Attributor.Class("align","ql-align",u),f=new o.default.Attributor.Style("align","text-align",u);n.AlignAttribute=h,n.AlignClass=c,n.AlignStyle=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var a=i(0),o=u(a),l=i(26);function u(f){return f&&f.__esModule?f:{default:f}}var h=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),c=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=h,n.BackgroundStyle=c}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var a=i(0),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}var u={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},h=new o.default.Attributor.Attribute("direction","dir",u),c=new o.default.Attributor.Class("direction","ql-direction",u),f=new o.default.Attributor.Style("direction","direction",u);n.DirectionAttribute=h,n.DirectionClass=c,n.DirectionStyle=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var a=(function(){function b(w,k){for(var N=0;N<k.length;N++){var E=k[N];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(w,E.key,E)}}return function(w,k,N){return k&&b(w.prototype,k),N&&b(w,N),w}})(),o=function b(w,k,N){w===null&&(w=Function.prototype);var E=Object.getOwnPropertyDescriptor(w,k);if(E===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:b(S,k,N)}else{if("value"in E)return E.value;var A=E.get;return A===void 0?void 0:A.call(N)}},l=i(0),u=h(l);function h(b){return b&&b.__esModule?b:{default:b}}function c(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function f(b,w){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:b}function m(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(b,w):b.__proto__=w)}var g={scope:u.default.Scope.INLINE,whitelist:["serif","monospace"]},v=new u.default.Attributor.Class("font","ql-font",g),y=(function(b){m(w,b);function w(){return c(this,w),f(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return a(w,[{key:"value",value:function(N){return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"value",this).call(this,N).replace(/["']/g,"")}}]),w})(u.default.Attributor.Style),x=new y("font","font-family",g);n.FontStyle=x,n.FontClass=v}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var a=i(0),o=l(a);function l(c){return c&&c.__esModule?c:{default:c}}var u=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),h=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=u,n.SizeStyle=h}),(function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var a=(function(){function k(N,E){for(var S=0;S<E.length;S++){var A=E[S];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(N,A.key,A)}}return function(N,E,S){return E&&k(N.prototype,E),S&&k(N,S),N}})(),o=i(0),l=m(o),u=i(5),h=m(u),c=i(9),f=m(c);function m(k){return k&&k.__esModule?k:{default:k}}function g(k,N){if(!(k instanceof N))throw new TypeError("Cannot call a class as a function")}function v(k,N){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:k}function y(k,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);k.prototype=Object.create(N&&N.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(k,N):k.__proto__=N)}var x=(function(k){y(N,k);function N(E,S){g(this,N);var A=v(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,E,S));return A.lastRecorded=0,A.ignoreChange=!1,A.clear(),A.quill.on(h.default.events.EDITOR_CHANGE,function(C,I,L,M){C!==h.default.events.TEXT_CHANGE||A.ignoreChange||(!A.options.userOnly||M===h.default.sources.USER?A.record(I,L):A.transform(I))}),A.quill.keyboard.addBinding({key:"Z",shortKey:!0},A.undo.bind(A)),A.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},A.redo.bind(A)),/Win/i.test(navigator.platform)&&A.quill.keyboard.addBinding({key:"Y",shortKey:!0},A.redo.bind(A)),A}return a(N,[{key:"change",value:function(S,A){if(this.stack[S].length!==0){var C=this.stack[S].pop();this.stack[A].push(C),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(C[S],h.default.sources.USER),this.ignoreChange=!1;var I=w(C[S]);this.quill.setSelection(I)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(S,A){if(S.ops.length!==0){this.stack.redo=[];var C=this.quill.getContents().diff(A),I=Date.now();if(this.lastRecorded+this.options.delay>I&&this.stack.undo.length>0){var L=this.stack.undo.pop();C=C.compose(L.undo),S=L.redo.compose(S)}else this.lastRecorded=I;this.stack.undo.push({redo:S,undo:C}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(S){this.stack.undo.forEach(function(A){A.undo=S.transform(A.undo,!0),A.redo=S.transform(A.redo,!0)}),this.stack.redo.forEach(function(A){A.undo=S.transform(A.undo,!0),A.redo=S.transform(A.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),N})(f.default);x.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function b(k){var N=k.ops[k.ops.length-1];return N==null?!1:N.insert!=null?typeof N.insert=="string"&&N.insert.endsWith(`
`):N.attributes!=null?Object.keys(N.attributes).some(function(E){return l.default.query(E,l.default.Scope.BLOCK)!=null}):!1}function w(k){var N=k.reduce(function(S,A){return S+=A.delete||0,S},0),E=k.length()-N;return b(k)&&(E-=1),E}n.default=x,n.getLastChangeIndex=w}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var a=(function(){function U(K,se){for(var te=0;te<se.length;te++){var X=se[te];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(K,X.key,X)}}return function(K,se,te){return se&&U(K.prototype,se),te&&U(K,te),K}})(),o=function U(K,se,te){K===null&&(K=Function.prototype);var X=Object.getOwnPropertyDescriptor(K,se);if(X===void 0){var Q=Object.getPrototypeOf(K);return Q===null?void 0:U(Q,se,te)}else{if("value"in X)return X.value;var ae=X.get;return ae===void 0?void 0:ae.call(te)}},l=i(3),u=I(l),h=i(2),c=I(h),f=i(8),m=I(f),g=i(23),v=I(g),y=i(34),x=I(y),b=i(59),w=I(b),k=i(60),N=I(k),E=i(28),S=I(E),A=i(61),C=I(A);function I(U){return U&&U.__esModule?U:{default:U}}function L(U,K){if(!(U instanceof K))throw new TypeError("Cannot call a class as a function")}function M(U,K){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K&&(typeof K=="object"||typeof K=="function")?K:U}function D(U,K){if(typeof K!="function"&&K!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof K);U.prototype=Object.create(K&&K.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),K&&(Object.setPrototypeOf?Object.setPrototypeOf(U,K):U.__proto__=K)}var F=[!1,"center","right","justify"],q=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],B=[!1,"serif","monospace"],z=["1","2","3",!1],G=["small",!1,"large","huge"],Y=(function(U){D(K,U);function K(se,te){L(this,K);var X=M(this,(K.__proto__||Object.getPrototypeOf(K)).call(this,se,te)),Q=function ae(J){if(!document.body.contains(se.root))return document.body.removeEventListener("click",ae);X.tooltip!=null&&!X.tooltip.root.contains(J.target)&&document.activeElement!==X.tooltip.textbox&&!X.quill.hasFocus()&&X.tooltip.hide(),X.pickers!=null&&X.pickers.forEach(function(ue){ue.container.contains(J.target)||ue.close()})};return se.emitter.listenDOM("click",document.body,Q),X}return a(K,[{key:"addModule",value:function(te){var X=o(K.prototype.__proto__||Object.getPrototypeOf(K.prototype),"addModule",this).call(this,te);return te==="toolbar"&&this.extendToolbar(X),X}},{key:"buildButtons",value:function(te,X){te.forEach(function(Q){var ae=Q.getAttribute("class")||"";ae.split(/\s+/).forEach(function(J){if(J.startsWith("ql-")&&(J=J.slice(3),X[J]!=null))if(J==="direction")Q.innerHTML=X[J][""]+X[J].rtl;else if(typeof X[J]=="string")Q.innerHTML=X[J];else{var ue=Q.value||"";ue!=null&&X[J][ue]&&(Q.innerHTML=X[J][ue])}})})}},{key:"buildPickers",value:function(te,X){var Q=this;this.pickers=te.map(function(J){if(J.classList.contains("ql-align"))return J.querySelector("option")==null&&O(J,F),new N.default(J,X.align);if(J.classList.contains("ql-background")||J.classList.contains("ql-color")){var ue=J.classList.contains("ql-background")?"background":"color";return J.querySelector("option")==null&&O(J,q,ue==="background"?"#ffffff":"#000000"),new w.default(J,X[ue])}else return J.querySelector("option")==null&&(J.classList.contains("ql-font")?O(J,B):J.classList.contains("ql-header")?O(J,z):J.classList.contains("ql-size")&&O(J,G)),new S.default(J)});var ae=function(){Q.pickers.forEach(function(ue){ue.update()})};this.quill.on(m.default.events.EDITOR_CHANGE,ae)}}]),K})(x.default);Y.DEFAULTS=(0,u.default)(!0,{},x.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var K=this,se=this.container.querySelector("input.ql-image[type=file]");se==null&&(se=document.createElement("input"),se.setAttribute("type","file"),se.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),se.classList.add("ql-image"),se.addEventListener("change",function(){if(se.files!=null&&se.files[0]!=null){var te=new FileReader;te.onload=function(X){var Q=K.quill.getSelection(!0);K.quill.updateContents(new c.default().retain(Q.index).delete(Q.length).insert({image:X.target.result}),m.default.sources.USER),K.quill.setSelection(Q.index+1,m.default.sources.SILENT),se.value=""},te.readAsDataURL(se.files[0])}}),this.container.appendChild(se)),se.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var H=(function(U){D(K,U);function K(se,te){L(this,K);var X=M(this,(K.__proto__||Object.getPrototypeOf(K)).call(this,se,te));return X.textbox=X.root.querySelector('input[type="text"]'),X.listen(),X}return a(K,[{key:"listen",value:function(){var te=this;this.textbox.addEventListener("keydown",function(X){v.default.match(X,"enter")?(te.save(),X.preventDefault()):v.default.match(X,"escape")&&(te.cancel(),X.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),X!=null?this.textbox.value=X:te!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+te)||""),this.root.setAttribute("data-mode",te)}},{key:"restoreFocus",value:function(){var te=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=te}},{key:"save",value:function(){var te=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var X=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",te,m.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",te,m.default.sources.USER)),this.quill.root.scrollTop=X;break}case"video":te=V(te);case"formula":{if(!te)break;var Q=this.quill.getSelection(!0);if(Q!=null){var ae=Q.index+Q.length;this.quill.insertEmbed(ae,this.root.getAttribute("data-mode"),te,m.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(ae+1," ",m.default.sources.USER),this.quill.setSelection(ae+2,m.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),K})(C.default);function V(U){var K=U.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||U.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return K?(K[1]||"https")+"://www.youtube.com/embed/"+K[2]+"?showinfo=0":(K=U.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(K[1]||"https")+"://player.vimeo.com/video/"+K[2]+"/":U}function O(U,K){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;K.forEach(function(te){var X=document.createElement("option");te===se?X.setAttribute("selected","selected"):X.setAttribute("value",te),U.appendChild(X)})}n.BaseTooltip=H,n.default=Y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var u,h=this.iterator();u=h();)if(u===l)return!0;return!1},o.prototype.insertBefore=function(l,u){l&&(l.next=u,u!=null?(l.prev=u.prev,u.prev!=null&&(u.prev.next=l),u.prev=l,u===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var u=0,h=this.head;h!=null;){if(h===l)return u;u+=h.length(),h=h.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var u=l;return l!=null&&(l=l.next),u}},o.prototype.find=function(l,u){u===void 0&&(u=!1);for(var h,c=this.iterator();h=c();){var f=h.length();if(l<f||u&&l===f&&(h.next==null||h.next.length()!==0))return[h,l];l-=f}return[null,0]},o.prototype.forEach=function(l){for(var u,h=this.iterator();u=h();)l(u)},o.prototype.forEachAt=function(l,u,h){if(!(u<=0))for(var c=this.find(l),f=c[0],m=c[1],g,v=l-m,y=this.iterator(f);(g=y())&&v<l+u;){var x=g.length();l>v?h(g,l-v,Math.min(u,v+x-l)):h(g,0,Math.min(x,l+u-v)),v+=x}},o.prototype.map=function(l){return this.reduce(function(u,h){return u.push(l(h)),u},[])},o.prototype.reduce=function(l,u){for(var h,c=this.iterator();h=c();)u=l(u,h);return u},o})();n.default=a}),(function(t,n,i){var a=this&&this.__extends||(function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var v in g)g.hasOwnProperty(v)&&(m[v]=g[v])};return function(m,g){f(m,g);function v(){this.constructor=m}m.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),l=i(1),u={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},h=100,c=(function(f){a(m,f);function m(g){var v=f.call(this,g)||this;return v.scroll=v,v.observer=new MutationObserver(function(y){v.update(y)}),v.observer.observe(v.domNode,u),v.attach(),v}return m.prototype.detach=function(){f.prototype.detach.call(this),this.observer.disconnect()},m.prototype.deleteAt=function(g,v){this.update(),g===0&&v===this.length()?this.children.forEach(function(y){y.remove()}):f.prototype.deleteAt.call(this,g,v)},m.prototype.formatAt=function(g,v,y,x){this.update(),f.prototype.formatAt.call(this,g,v,y,x)},m.prototype.insertAt=function(g,v,y){this.update(),f.prototype.insertAt.call(this,g,v,y)},m.prototype.optimize=function(g,v){var y=this;g===void 0&&(g=[]),v===void 0&&(v={}),f.prototype.optimize.call(this,v);for(var x=[].slice.call(this.observer.takeRecords());x.length>0;)g.push(x.pop());for(var b=function(E,S){S===void 0&&(S=!0),!(E==null||E===y)&&E.domNode.parentNode!=null&&(E.domNode[l.DATA_KEY].mutations==null&&(E.domNode[l.DATA_KEY].mutations=[]),S&&b(E.parent))},w=function(E){E.domNode[l.DATA_KEY]==null||E.domNode[l.DATA_KEY].mutations==null||(E instanceof o.default&&E.children.forEach(w),E.optimize(v))},k=g,N=0;k.length>0;N+=1){if(N>=h)throw new Error("[Parchment] Maximum optimize iterations reached");for(k.forEach(function(E){var S=l.find(E.target,!0);S!=null&&(S.domNode===E.target&&(E.type==="childList"?(b(l.find(E.previousSibling,!1)),[].forEach.call(E.addedNodes,function(A){var C=l.find(A,!1);b(C,!1),C instanceof o.default&&C.children.forEach(function(I){b(I,!1)})})):E.type==="attributes"&&b(S.prev)),b(S))}),this.children.forEach(w),k=[].slice.call(this.observer.takeRecords()),x=k.slice();x.length>0;)g.push(x.pop())}},m.prototype.update=function(g,v){var y=this;v===void 0&&(v={}),g=g||this.observer.takeRecords(),g.map(function(x){var b=l.find(x.target,!0);return b==null?null:b.domNode[l.DATA_KEY].mutations==null?(b.domNode[l.DATA_KEY].mutations=[x],b):(b.domNode[l.DATA_KEY].mutations.push(x),null)}).forEach(function(x){x==null||x===y||x.domNode[l.DATA_KEY]==null||x.update(x.domNode[l.DATA_KEY].mutations||[],v)}),this.domNode[l.DATA_KEY].mutations!=null&&f.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,v),this.optimize(g,v)},m.blotName="scroll",m.defaultChild="block",m.scope=l.Scope.BLOCK_BLOT,m.tagName="DIV",m})(o.default);n.default=c}),(function(t,n,i){var a=this&&this.__extends||(function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,m){f.__proto__=m}||function(f,m){for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g])};return function(f,m){c(f,m);function g(){this.constructor=f}f.prototype=m===null?Object.create(m):(g.prototype=m.prototype,new g)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1);function u(c,f){if(Object.keys(c).length!==Object.keys(f).length)return!1;for(var m in c)if(c[m]!==f[m])return!1;return!0}var h=(function(c){a(f,c);function f(){return c!==null&&c.apply(this,arguments)||this}return f.formats=function(m){if(m.tagName!==f.tagName)return c.formats.call(this,m)},f.prototype.format=function(m,g){var v=this;m===this.statics.blotName&&!g?(this.children.forEach(function(y){y instanceof o.default||(y=y.wrap(f.blotName,!0)),v.attributes.copy(y)}),this.unwrap()):c.prototype.format.call(this,m,g)},f.prototype.formatAt=function(m,g,v,y){if(this.formats()[v]!=null||l.query(v,l.Scope.ATTRIBUTE)){var x=this.isolate(m,g);x.format(v,y)}else c.prototype.formatAt.call(this,m,g,v,y)},f.prototype.optimize=function(m){c.prototype.optimize.call(this,m);var g=this.formats();if(Object.keys(g).length===0)return this.unwrap();var v=this.next;v instanceof f&&v.prev===this&&u(g,v.formats())&&(v.moveChildren(this),v.remove())},f.blotName="inline",f.scope=l.Scope.INLINE_BLOT,f.tagName="SPAN",f})(o.default);n.default=h}),(function(t,n,i){var a=this&&this.__extends||(function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])};return function(c,f){h(c,f);function m(){this.constructor=c}c.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1),u=(function(h){a(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.formats=function(f){var m=l.query(c.blotName).tagName;if(f.tagName!==m)return h.formats.call(this,f)},c.prototype.format=function(f,m){l.query(f,l.Scope.BLOCK)!=null&&(f===this.statics.blotName&&!m?this.replaceWith(c.blotName):h.prototype.format.call(this,f,m))},c.prototype.formatAt=function(f,m,g,v){l.query(g,l.Scope.BLOCK)!=null?this.format(g,v):h.prototype.formatAt.call(this,f,m,g,v)},c.prototype.insertAt=function(f,m,g){if(g==null||l.query(m,l.Scope.INLINE)!=null)h.prototype.insertAt.call(this,f,m,g);else{var v=this.split(f),y=l.create(m,g);v.parent.insertBefore(y,v)}},c.prototype.update=function(f,m){navigator.userAgent.match(/Trident/)?this.build():h.prototype.update.call(this,f,m)},c.blotName="block",c.scope=l.Scope.BLOCK_BLOT,c.tagName="P",c})(o.default);n.default=u}),(function(t,n,i){var a=this&&this.__extends||(function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,c){h.__proto__=c}||function(h,c){for(var f in c)c.hasOwnProperty(f)&&(h[f]=c[f])};return function(h,c){u(h,c);function f(){this.constructor=h}h.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=(function(u){a(h,u);function h(){return u!==null&&u.apply(this,arguments)||this}return h.formats=function(c){},h.prototype.format=function(c,f){u.prototype.formatAt.call(this,0,this.length(),c,f)},h.prototype.formatAt=function(c,f,m,g){c===0&&f===this.length()?this.format(m,g):u.prototype.formatAt.call(this,c,f,m,g)},h.prototype.formats=function(){return this.statics.formats(this.domNode)},h})(o.default);n.default=l}),(function(t,n,i){var a=this&&this.__extends||(function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])};return function(c,f){h(c,f);function m(){this.constructor=c}c.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)}})();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=i(1),u=(function(h){a(c,h);function c(f){var m=h.call(this,f)||this;return m.text=m.statics.value(m.domNode),m}return c.create=function(f){return document.createTextNode(f)},c.value=function(f){var m=f.data;return m.normalize&&(m=m.normalize()),m},c.prototype.deleteAt=function(f,m){this.domNode.data=this.text=this.text.slice(0,f)+this.text.slice(f+m)},c.prototype.index=function(f,m){return this.domNode===f?m:-1},c.prototype.insertAt=function(f,m,g){g==null?(this.text=this.text.slice(0,f)+m+this.text.slice(f),this.domNode.data=this.text):h.prototype.insertAt.call(this,f,m,g)},c.prototype.length=function(){return this.text.length},c.prototype.optimize=function(f){h.prototype.optimize.call(this,f),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof c&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},c.prototype.position=function(f,m){return[this.domNode,f]},c.prototype.split=function(f,m){if(m===void 0&&(m=!1),!m){if(f===0)return this;if(f===this.length())return this.next}var g=l.create(this.domNode.splitText(f));return this.parent.insertBefore(g,this.next),this.text=this.statics.value(this.domNode),g},c.prototype.update=function(f,m){var g=this;f.some(function(v){return v.type==="characterData"&&v.target===g.domNode})&&(this.text=this.statics.value(this.domNode))},c.prototype.value=function(){return this.text},c.blotName="text",c.scope=l.Scope.INLINE_BLOT,c})(o.default);n.default=u}),(function(t,n,i){var a=document.createElement("div");if(a.classList.toggle("test-class",!1),a.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,u){return arguments.length>1&&!this.contains(l)==!u?u:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,u){return u=u||0,this.substr(u,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,u){var h=this.toString();(typeof u!="number"||!isFinite(u)||Math.floor(u)!==u||u>h.length)&&(u=h.length),u-=l.length;var c=h.indexOf(l,u);return c!==-1&&c===u}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(u){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof u!="function")throw new TypeError("predicate must be a function");for(var h=Object(this),c=h.length>>>0,f=arguments[1],m,g=0;g<c;g++)if(m=h[g],u.call(f,m,g,h))return m}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})}),(function(t,n){var i=-1,a=1,o=0;function l(N,E,S){if(N==E)return N?[[o,N]]:[];(S<0||N.length<S)&&(S=null);var A=f(N,E),C=N.substring(0,A);N=N.substring(A),E=E.substring(A),A=m(N,E);var I=N.substring(N.length-A);N=N.substring(0,N.length-A),E=E.substring(0,E.length-A);var L=u(N,E);return C&&L.unshift([o,C]),I&&L.push([o,I]),v(L),S!=null&&(L=b(L,S)),L=w(L),L}function u(N,E){var S;if(!N)return[[a,E]];if(!E)return[[i,N]];var A=N.length>E.length?N:E,C=N.length>E.length?E:N,I=A.indexOf(C);if(I!=-1)return S=[[a,A.substring(0,I)],[o,C],[a,A.substring(I+C.length)]],N.length>E.length&&(S[0][0]=S[2][0]=i),S;if(C.length==1)return[[i,N],[a,E]];var L=g(N,E);if(L){var M=L[0],D=L[1],F=L[2],q=L[3],B=L[4],z=l(M,F),G=l(D,q);return z.concat([[o,B]],G)}return h(N,E)}function h(N,E){for(var S=N.length,A=E.length,C=Math.ceil((S+A)/2),I=C,L=2*C,M=new Array(L),D=new Array(L),F=0;F<L;F++)M[F]=-1,D[F]=-1;M[I+1]=0,D[I+1]=0;for(var q=S-A,B=q%2!=0,z=0,G=0,Y=0,H=0,V=0;V<C;V++){for(var O=-V+z;O<=V-G;O+=2){var U=I+O,K;O==-V||O!=V&&M[U-1]<M[U+1]?K=M[U+1]:K=M[U-1]+1;for(var se=K-O;K<S&&se<A&&N.charAt(K)==E.charAt(se);)K++,se++;if(M[U]=K,K>S)G+=2;else if(se>A)z+=2;else if(B){var te=I+q-O;if(te>=0&&te<L&&D[te]!=-1){var X=S-D[te];if(K>=X)return c(N,E,K,se)}}}for(var Q=-V+Y;Q<=V-H;Q+=2){var te=I+Q,X;Q==-V||Q!=V&&D[te-1]<D[te+1]?X=D[te+1]:X=D[te-1]+1;for(var ae=X-Q;X<S&&ae<A&&N.charAt(S-X-1)==E.charAt(A-ae-1);)X++,ae++;if(D[te]=X,X>S)H+=2;else if(ae>A)Y+=2;else if(!B){var U=I+q-Q;if(U>=0&&U<L&&M[U]!=-1){var K=M[U],se=I+K-U;if(X=S-X,K>=X)return c(N,E,K,se)}}}}return[[i,N],[a,E]]}function c(N,E,S,A){var C=N.substring(0,S),I=E.substring(0,A),L=N.substring(S),M=E.substring(A),D=l(C,I),F=l(L,M);return D.concat(F)}function f(N,E){if(!N||!E||N.charAt(0)!=E.charAt(0))return 0;for(var S=0,A=Math.min(N.length,E.length),C=A,I=0;S<C;)N.substring(I,C)==E.substring(I,C)?(S=C,I=S):A=C,C=Math.floor((A-S)/2+S);return C}function m(N,E){if(!N||!E||N.charAt(N.length-1)!=E.charAt(E.length-1))return 0;for(var S=0,A=Math.min(N.length,E.length),C=A,I=0;S<C;)N.substring(N.length-C,N.length-I)==E.substring(E.length-C,E.length-I)?(S=C,I=S):A=C,C=Math.floor((A-S)/2+S);return C}function g(N,E){var S=N.length>E.length?N:E,A=N.length>E.length?E:N;if(S.length<4||A.length*2<S.length)return null;function C(G,Y,H){for(var V=G.substring(H,H+Math.floor(G.length/4)),O=-1,U="",K,se,te,X;(O=Y.indexOf(V,O+1))!=-1;){var Q=f(G.substring(H),Y.substring(O)),ae=m(G.substring(0,H),Y.substring(0,O));U.length<ae+Q&&(U=Y.substring(O-ae,O)+Y.substring(O,O+Q),K=G.substring(0,H-ae),se=G.substring(H+Q),te=Y.substring(0,O-ae),X=Y.substring(O+Q))}return U.length*2>=G.length?[K,se,te,X,U]:null}var I=C(S,A,Math.ceil(S.length/4)),L=C(S,A,Math.ceil(S.length/2)),M;if(!I&&!L)return null;L?I?M=I[4].length>L[4].length?I:L:M=L:M=I;var D,F,q,B;N.length>E.length?(D=M[0],F=M[1],q=M[2],B=M[3]):(q=M[0],B=M[1],D=M[2],F=M[3]);var z=M[4];return[D,F,q,B,z]}function v(N){N.push([o,""]);for(var E=0,S=0,A=0,C="",I="",L;E<N.length;)switch(N[E][0]){case a:A++,I+=N[E][1],E++;break;case i:S++,C+=N[E][1],E++;break;case o:S+A>1?(S!==0&&A!==0&&(L=f(I,C),L!==0&&(E-S-A>0&&N[E-S-A-1][0]==o?N[E-S-A-1][1]+=I.substring(0,L):(N.splice(0,0,[o,I.substring(0,L)]),E++),I=I.substring(L),C=C.substring(L)),L=m(I,C),L!==0&&(N[E][1]=I.substring(I.length-L)+N[E][1],I=I.substring(0,I.length-L),C=C.substring(0,C.length-L))),S===0?N.splice(E-A,S+A,[a,I]):A===0?N.splice(E-S,S+A,[i,C]):N.splice(E-S-A,S+A,[i,C],[a,I]),E=E-S-A+(S?1:0)+(A?1:0)+1):E!==0&&N[E-1][0]==o?(N[E-1][1]+=N[E][1],N.splice(E,1)):E++,A=0,S=0,C="",I="";break}N[N.length-1][1]===""&&N.pop();var M=!1;for(E=1;E<N.length-1;)N[E-1][0]==o&&N[E+1][0]==o&&(N[E][1].substring(N[E][1].length-N[E-1][1].length)==N[E-1][1]?(N[E][1]=N[E-1][1]+N[E][1].substring(0,N[E][1].length-N[E-1][1].length),N[E+1][1]=N[E-1][1]+N[E+1][1],N.splice(E-1,1),M=!0):N[E][1].substring(0,N[E+1][1].length)==N[E+1][1]&&(N[E-1][1]+=N[E+1][1],N[E][1]=N[E][1].substring(N[E+1][1].length)+N[E+1][1],N.splice(E+1,1),M=!0)),E++;M&&v(N)}var y=l;y.INSERT=a,y.DELETE=i,y.EQUAL=o,t.exports=y;function x(N,E){if(E===0)return[o,N];for(var S=0,A=0;A<N.length;A++){var C=N[A];if(C[0]===i||C[0]===o){var I=S+C[1].length;if(E===I)return[A+1,N];if(E<I){N=N.slice();var L=E-S,M=[C[0],C[1].slice(0,L)],D=[C[0],C[1].slice(L)];return N.splice(A,1,M,D),[A+1,N]}else S=I}}throw new Error("cursor_pos is out of bounds!")}function b(N,E){var S=x(N,E),A=S[1],C=S[0],I=A[C],L=A[C+1];if(I==null)return N;if(I[0]!==o)return N;if(L!=null&&I[1]+L[1]===L[1]+I[1])return A.splice(C,2,L,I),k(A,C,2);if(L!=null&&L[1].indexOf(I[1])===0){A.splice(C,2,[L[0],I[1]],[0,I[1]]);var M=L[1].slice(I[1].length);return M.length>0&&A.splice(C+2,0,[L[0],M]),k(A,C,3)}else return N}function w(N){for(var E=!1,S=function(L){return L.charCodeAt(0)>=56320&&L.charCodeAt(0)<=57343},A=function(L){return L.charCodeAt(L.length-1)>=55296&&L.charCodeAt(L.length-1)<=56319},C=2;C<N.length;C+=1)N[C-2][0]===o&&A(N[C-2][1])&&N[C-1][0]===i&&S(N[C-1][1])&&N[C][0]===a&&S(N[C][1])&&(E=!0,N[C-1][1]=N[C-2][1].slice(-1)+N[C-1][1],N[C][1]=N[C-2][1].slice(-1)+N[C][1],N[C-2][1]=N[C-2][1].slice(0,-1));if(!E)return N;for(var I=[],C=0;C<N.length;C+=1)N[C][1].length>0&&I.push(N[C]);return I}function k(N,E,S){for(var A=E+S-1;A>=0&&A>=E-1;A--)if(A+1<N.length){var C=N[A],I=N[A+1];C[0]===I[1]&&N.splice(A,2,[C[0],C[1]+I[1]])}return N}}),(function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(a){var o=[];for(var l in a)o.push(l);return o}}),(function(t,n){var i=(function(){return Object.prototype.toString.call(arguments)})()=="[object Arguments]";n=t.exports=i?a:o,n.supported=a;function a(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}}),(function(t,n){var i=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(h,c,f){this.fn=h,this.context=c,this.once=f||!1}function u(){this._events=new o,this._eventsCount=0}u.prototype.eventNames=function(){var c=[],f,m;if(this._eventsCount===0)return c;for(m in f=this._events)i.call(f,m)&&c.push(a?m.slice(1):m);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(f)):c},u.prototype.listeners=function(c,f){var m=a?a+c:c,g=this._events[m];if(f)return!!g;if(!g)return[];if(g.fn)return[g.fn];for(var v=0,y=g.length,x=new Array(y);v<y;v++)x[v]=g[v].fn;return x},u.prototype.emit=function(c,f,m,g,v,y){var x=a?a+c:c;if(!this._events[x])return!1;var b=this._events[x],w=arguments.length,k,N;if(b.fn){switch(b.once&&this.removeListener(c,b.fn,void 0,!0),w){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,m),!0;case 4:return b.fn.call(b.context,f,m,g),!0;case 5:return b.fn.call(b.context,f,m,g,v),!0;case 6:return b.fn.call(b.context,f,m,g,v,y),!0}for(N=1,k=new Array(w-1);N<w;N++)k[N-1]=arguments[N];b.fn.apply(b.context,k)}else{var E=b.length,S;for(N=0;N<E;N++)switch(b[N].once&&this.removeListener(c,b[N].fn,void 0,!0),w){case 1:b[N].fn.call(b[N].context);break;case 2:b[N].fn.call(b[N].context,f);break;case 3:b[N].fn.call(b[N].context,f,m);break;case 4:b[N].fn.call(b[N].context,f,m,g);break;default:if(!k)for(S=1,k=new Array(w-1);S<w;S++)k[S-1]=arguments[S];b[N].fn.apply(b[N].context,k)}}return!0},u.prototype.on=function(c,f,m){var g=new l(f,m||this),v=a?a+c:c;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],g]:this._events[v].push(g):(this._events[v]=g,this._eventsCount++),this},u.prototype.once=function(c,f,m){var g=new l(f,m||this,!0),v=a?a+c:c;return this._events[v]?this._events[v].fn?this._events[v]=[this._events[v],g]:this._events[v].push(g):(this._events[v]=g,this._eventsCount++),this},u.prototype.removeListener=function(c,f,m,g){var v=a?a+c:c;if(!this._events[v])return this;if(!f)return--this._eventsCount===0?this._events=new o:delete this._events[v],this;var y=this._events[v];if(y.fn)y.fn===f&&(!g||y.once)&&(!m||y.context===m)&&(--this._eventsCount===0?this._events=new o:delete this._events[v]);else{for(var x=0,b=[],w=y.length;x<w;x++)(y[x].fn!==f||g&&!y[x].once||m&&y[x].context!==m)&&b.push(y[x]);b.length?this._events[v]=b.length===1?b[0]:b:--this._eventsCount===0?this._events=new o:delete this._events[v]}return this},u.prototype.removeAllListeners=function(c){var f;return c?(f=a?a+c:c,this._events[f]&&(--this._eventsCount===0?this._events=new o:delete this._events[f])):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=a,u.EventEmitter=u,typeof t<"u"&&(t.exports=u)}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},o=(function(){function ee(ce,ge){var ve=[],pe=!0,Ue=!1,We=void 0;try{for(var Ge=ce[Symbol.iterator](),Jt;!(pe=(Jt=Ge.next()).done)&&(ve.push(Jt.value),!(ge&&ve.length===ge));pe=!0);}catch(os){Ue=!0,We=os}finally{try{!pe&&Ge.return&&Ge.return()}finally{if(Ue)throw We}}return ve}return function(ce,ge){if(Array.isArray(ce))return ce;if(Symbol.iterator in Object(ce))return ee(ce,ge);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),l=(function(){function ee(ce,ge){for(var ve=0;ve<ge.length;ve++){var pe=ge[ve];pe.enumerable=pe.enumerable||!1,pe.configurable=!0,"value"in pe&&(pe.writable=!0),Object.defineProperty(ce,pe.key,pe)}}return function(ce,ge,ve){return ge&&ee(ce.prototype,ge),ve&&ee(ce,ve),ce}})(),u=i(3),h=D(u),c=i(2),f=D(c),m=i(0),g=D(m),v=i(5),y=D(v),x=i(10),b=D(x),w=i(9),k=D(w),N=i(36),E=i(37),S=i(13),A=D(S),C=i(26),I=i(38),L=i(39),M=i(40);function D(ee){return ee&&ee.__esModule?ee:{default:ee}}function F(ee,ce,ge){return ce in ee?Object.defineProperty(ee,ce,{value:ge,enumerable:!0,configurable:!0,writable:!0}):ee[ce]=ge,ee}function q(ee,ce){if(!(ee instanceof ce))throw new TypeError("Cannot call a class as a function")}function B(ee,ce){if(!ee)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce&&(typeof ce=="object"||typeof ce=="function")?ce:ee}function z(ee,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ce);ee.prototype=Object.create(ce&&ce.prototype,{constructor:{value:ee,enumerable:!1,writable:!0,configurable:!0}}),ce&&(Object.setPrototypeOf?Object.setPrototypeOf(ee,ce):ee.__proto__=ce)}var G=(0,b.default)("quill:clipboard"),Y="__ql-matcher",H=[[Node.TEXT_NODE,at],[Node.TEXT_NODE,Le],["br",we],[Node.ELEMENT_NODE,Le],[Node.ELEMENT_NODE,ue],[Node.ELEMENT_NODE,Qe],[Node.ELEMENT_NODE,J],[Node.ELEMENT_NODE,St],["li",Ce],["b",ae.bind(ae,"bold")],["i",ae.bind(ae,"italic")],["style",_e]],V=[N.AlignAttribute,I.DirectionAttribute].reduce(function(ee,ce){return ee[ce.keyName]=ce,ee},{}),O=[N.AlignStyle,E.BackgroundStyle,C.ColorStyle,I.DirectionStyle,L.FontStyle,M.SizeStyle].reduce(function(ee,ce){return ee[ce.keyName]=ce,ee},{}),U=(function(ee){z(ce,ee);function ce(ge,ve){q(this,ce);var pe=B(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,ge,ve));return pe.quill.root.addEventListener("paste",pe.onPaste.bind(pe)),pe.container=pe.quill.addContainer("ql-clipboard"),pe.container.setAttribute("contenteditable",!0),pe.container.setAttribute("tabindex",-1),pe.matchers=[],H.concat(pe.options.matchers).forEach(function(Ue){var We=o(Ue,2),Ge=We[0],Jt=We[1];!ve.matchVisual&&Jt===Qe||pe.addMatcher(Ge,Jt)}),pe}return l(ce,[{key:"addMatcher",value:function(ve,pe){this.matchers.push([ve,pe])}},{key:"convert",value:function(ve){if(typeof ve=="string")return this.container.innerHTML=ve.replace(/\>\r?\n +\</g,"><"),this.convert();var pe=this.quill.getFormat(this.quill.selection.savedRange.index);if(pe[A.default.blotName]){var Ue=this.container.innerText;return this.container.innerHTML="",new f.default().insert(Ue,F({},A.default.blotName,pe[A.default.blotName]))}var We=this.prepareMatching(),Ge=o(We,2),Jt=Ge[0],os=Ge[1],ut=Q(this.container,Jt,os);return te(ut,`
`)&&ut.ops[ut.ops.length-1].attributes==null&&(ut=ut.compose(new f.default().retain(ut.length()-1).delete(1))),G.log("convert",this.container.innerHTML,ut),this.container.innerHTML="",ut}},{key:"dangerouslyPasteHTML",value:function(ve,pe){var Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.default.sources.API;if(typeof ve=="string")this.quill.setContents(this.convert(ve),pe),this.quill.setSelection(0,y.default.sources.SILENT);else{var We=this.convert(pe);this.quill.updateContents(new f.default().retain(ve).concat(We),Ue),this.quill.setSelection(ve+We.length(),y.default.sources.SILENT)}}},{key:"onPaste",value:function(ve){var pe=this;if(!(ve.defaultPrevented||!this.quill.isEnabled())){var Ue=this.quill.getSelection(),We=new f.default().retain(Ue.index),Ge=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(y.default.sources.SILENT),setTimeout(function(){We=We.concat(pe.convert()).delete(Ue.length),pe.quill.updateContents(We,y.default.sources.USER),pe.quill.setSelection(We.length()-Ue.length,y.default.sources.SILENT),pe.quill.scrollingContainer.scrollTop=Ge,pe.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ve=this,pe=[],Ue=[];return this.matchers.forEach(function(We){var Ge=o(We,2),Jt=Ge[0],os=Ge[1];switch(Jt){case Node.TEXT_NODE:Ue.push(os);break;case Node.ELEMENT_NODE:pe.push(os);break;default:[].forEach.call(ve.container.querySelectorAll(Jt),function(ut){ut[Y]=ut[Y]||[],ut[Y].push(os)});break}}),[pe,Ue]}}]),ce})(k.default);U.DEFAULTS={matchers:[],matchVisual:!0};function K(ee,ce,ge){return(typeof ce>"u"?"undefined":a(ce))==="object"?Object.keys(ce).reduce(function(ve,pe){return K(ve,pe,ce[pe])},ee):ee.reduce(function(ve,pe){return pe.attributes&&pe.attributes[ce]?ve.push(pe):ve.insert(pe.insert,(0,h.default)({},F({},ce,ge),pe.attributes))},new f.default)}function se(ee){if(ee.nodeType!==Node.ELEMENT_NODE)return{};var ce="__ql-computed-style";return ee[ce]||(ee[ce]=window.getComputedStyle(ee))}function te(ee,ce){for(var ge="",ve=ee.ops.length-1;ve>=0&&ge.length<ce.length;--ve){var pe=ee.ops[ve];if(typeof pe.insert!="string")break;ge=pe.insert+ge}return ge.slice(-1*ce.length)===ce}function X(ee){if(ee.childNodes.length===0)return!1;var ce=se(ee);return["block","list-item"].indexOf(ce.display)>-1}function Q(ee,ce,ge){return ee.nodeType===ee.TEXT_NODE?ge.reduce(function(ve,pe){return pe(ee,ve)},new f.default):ee.nodeType===ee.ELEMENT_NODE?[].reduce.call(ee.childNodes||[],function(ve,pe){var Ue=Q(pe,ce,ge);return pe.nodeType===ee.ELEMENT_NODE&&(Ue=ce.reduce(function(We,Ge){return Ge(pe,We)},Ue),Ue=(pe[Y]||[]).reduce(function(We,Ge){return Ge(pe,We)},Ue)),ve.concat(Ue)},new f.default):new f.default}function ae(ee,ce,ge){return K(ge,ee,!0)}function J(ee,ce){var ge=g.default.Attributor.Attribute.keys(ee),ve=g.default.Attributor.Class.keys(ee),pe=g.default.Attributor.Style.keys(ee),Ue={};return ge.concat(ve).concat(pe).forEach(function(We){var Ge=g.default.query(We,g.default.Scope.ATTRIBUTE);Ge!=null&&(Ue[Ge.attrName]=Ge.value(ee),Ue[Ge.attrName])||(Ge=V[We],Ge!=null&&(Ge.attrName===We||Ge.keyName===We)&&(Ue[Ge.attrName]=Ge.value(ee)||void 0),Ge=O[We],Ge!=null&&(Ge.attrName===We||Ge.keyName===We)&&(Ge=O[We],Ue[Ge.attrName]=Ge.value(ee)||void 0))}),Object.keys(Ue).length>0&&(ce=K(ce,Ue)),ce}function ue(ee,ce){var ge=g.default.query(ee);if(ge==null)return ce;if(ge.prototype instanceof g.default.Embed){var ve={},pe=ge.value(ee);pe!=null&&(ve[ge.blotName]=pe,ce=new f.default().insert(ve,ge.formats(ee)))}else typeof ge.formats=="function"&&(ce=K(ce,ge.blotName,ge.formats(ee)));return ce}function we(ee,ce){return te(ce,`
`)||ce.insert(`
`),ce}function _e(){return new f.default}function Ce(ee,ce){var ge=g.default.query(ee);if(ge==null||ge.blotName!=="list-item"||!te(ce,`
`))return ce;for(var ve=-1,pe=ee.parentNode;!pe.classList.contains("ql-clipboard");)(g.default.query(pe)||{}).blotName==="list"&&(ve+=1),pe=pe.parentNode;return ve<=0?ce:ce.compose(new f.default().retain(ce.length()-1).retain(1,{indent:ve}))}function Le(ee,ce){return te(ce,`
`)||(X(ee)||ce.length()>0&&ee.nextSibling&&X(ee.nextSibling))&&ce.insert(`
`),ce}function Qe(ee,ce){if(X(ee)&&ee.nextElementSibling!=null&&!te(ce,`

`)){var ge=ee.offsetHeight+parseFloat(se(ee).marginTop)+parseFloat(se(ee).marginBottom);ee.nextElementSibling.offsetTop>ee.offsetTop+ge*1.5&&ce.insert(`
`)}return ce}function St(ee,ce){var ge={},ve=ee.style||{};return ve.fontStyle&&se(ee).fontStyle==="italic"&&(ge.italic=!0),ve.fontWeight&&(se(ee).fontWeight.startsWith("bold")||parseInt(se(ee).fontWeight)>=700)&&(ge.bold=!0),Object.keys(ge).length>0&&(ce=K(ce,ge)),parseFloat(ve.textIndent||0)>0&&(ce=new f.default().insert("	").concat(ce)),ce}function at(ee,ce){var ge=ee.data;if(ee.parentNode.tagName==="O:P")return ce.insert(ge.trim());if(ge.trim().length===0&&ee.parentNode.classList.contains("ql-clipboard"))return ce;if(!se(ee.parentNode).whiteSpace.startsWith("pre")){var ve=function(Ue,We){return We=We.replace(/[^\u00a0]/g,""),We.length<1&&Ue?" ":We};ge=ge.replace(/\r\n/g," ").replace(/\n/g," "),ge=ge.replace(/\s\s+/g,ve.bind(ve,!0)),(ee.previousSibling==null&&X(ee.parentNode)||ee.previousSibling!=null&&X(ee.previousSibling))&&(ge=ge.replace(/^\s+/,ve.bind(ve,!1))),(ee.nextSibling==null&&X(ee.parentNode)||ee.nextSibling!=null&&X(ee.nextSibling))&&(ge=ge.replace(/\s+$/,ve.bind(ve,!1)))}return ce.insert(ge)}n.default=U,n.matchAttributor=J,n.matchBlot=ue,n.matchNewline=Le,n.matchSpacing=Qe,n.matchText=at}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function v(y,x){for(var b=0;b<x.length;b++){var w=x[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,x,b){return x&&v(y.prototype,x),b&&v(y,b),y}})(),o=function v(y,x,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,x);if(w===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:v(k,x,b)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(b)}},l=i(6),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(){return c(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return a(y,[{key:"optimize",value:function(b){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,b),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),y})(u.default);g.blotName="bold",g.tagName=["STRONG","B"],n.default=g}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var a=(function(){function M(D,F){var q=[],B=!0,z=!1,G=void 0;try{for(var Y=D[Symbol.iterator](),H;!(B=(H=Y.next()).done)&&(q.push(H.value),!(F&&q.length===F));B=!0);}catch(V){z=!0,G=V}finally{try{!B&&Y.return&&Y.return()}finally{if(z)throw G}}return q}return function(D,F){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return M(D,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=(function(){function M(D,F){for(var q=0;q<F.length;q++){var B=F[q];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(D,B.key,B)}}return function(D,F,q){return F&&M(D.prototype,F),q&&M(D,q),D}})(),l=i(2),u=b(l),h=i(0),c=b(h),f=i(5),m=b(f),g=i(10),v=b(g),y=i(9),x=b(y);function b(M){return M&&M.__esModule?M:{default:M}}function w(M,D,F){return D in M?Object.defineProperty(M,D,{value:F,enumerable:!0,configurable:!0,writable:!0}):M[D]=F,M}function k(M,D){if(!(M instanceof D))throw new TypeError("Cannot call a class as a function")}function N(M,D){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:M}function E(M,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);M.prototype=Object.create(D&&D.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(M,D):M.__proto__=D)}var S=(0,v.default)("quill:toolbar"),A=(function(M){E(D,M);function D(F,q){k(this,D);var B=N(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,F,q));if(Array.isArray(B.options.container)){var z=document.createElement("div");I(z,B.options.container),F.container.parentNode.insertBefore(z,F.container),B.container=z}else typeof B.options.container=="string"?B.container=document.querySelector(B.options.container):B.container=B.options.container;if(!(B.container instanceof HTMLElement)){var G;return G=S.error("Container required for toolbar",B.options),N(B,G)}return B.container.classList.add("ql-toolbar"),B.controls=[],B.handlers={},Object.keys(B.options.handlers).forEach(function(Y){B.addHandler(Y,B.options.handlers[Y])}),[].forEach.call(B.container.querySelectorAll("button, select"),function(Y){B.attach(Y)}),B.quill.on(m.default.events.EDITOR_CHANGE,function(Y,H){Y===m.default.events.SELECTION_CHANGE&&B.update(H)}),B.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){var Y=B.quill.selection.getRange(),H=a(Y,1),V=H[0];B.update(V)}),B}return o(D,[{key:"addHandler",value:function(q,B){this.handlers[q]=B}},{key:"attach",value:function(q){var B=this,z=[].find.call(q.classList,function(Y){return Y.indexOf("ql-")===0});if(z){if(z=z.slice(3),q.tagName==="BUTTON"&&q.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){S.warn("ignoring attaching to disabled format",z,q);return}if(c.default.query(z)==null){S.warn("ignoring attaching to nonexistent format",z,q);return}}var G=q.tagName==="SELECT"?"change":"click";q.addEventListener(G,function(Y){var H=void 0;if(q.tagName==="SELECT"){if(q.selectedIndex<0)return;var V=q.options[q.selectedIndex];V.hasAttribute("selected")?H=!1:H=V.value||!1}else q.classList.contains("ql-active")?H=!1:H=q.value||!q.hasAttribute("value"),Y.preventDefault();B.quill.focus();var O=B.quill.selection.getRange(),U=a(O,1),K=U[0];if(B.handlers[z]!=null)B.handlers[z].call(B,H);else if(c.default.query(z).prototype instanceof c.default.Embed){if(H=prompt("Enter "+z),!H)return;B.quill.updateContents(new u.default().retain(K.index).delete(K.length).insert(w({},z,H)),m.default.sources.USER)}else B.quill.format(z,H,m.default.sources.USER);B.update(K)}),this.controls.push([z,q])}}},{key:"update",value:function(q){var B=q==null?{}:this.quill.getFormat(q);this.controls.forEach(function(z){var G=a(z,2),Y=G[0],H=G[1];if(H.tagName==="SELECT"){var V=void 0;if(q==null)V=null;else if(B[Y]==null)V=H.querySelector("option[selected]");else if(!Array.isArray(B[Y])){var O=B[Y];typeof O=="string"&&(O=O.replace(/\"/g,'\\"')),V=H.querySelector('option[value="'+O+'"]')}V==null?(H.value="",H.selectedIndex=-1):V.selected=!0}else if(q==null)H.classList.remove("ql-active");else if(H.hasAttribute("value")){var U=B[Y]===H.getAttribute("value")||B[Y]!=null&&B[Y].toString()===H.getAttribute("value")||B[Y]==null&&!H.getAttribute("value");H.classList.toggle("ql-active",U)}else H.classList.toggle("ql-active",B[Y]!=null)})}}]),D})(x.default);A.DEFAULTS={};function C(M,D,F){var q=document.createElement("button");q.setAttribute("type","button"),q.classList.add("ql-"+D),F!=null&&(q.value=F),M.appendChild(q)}function I(M,D){Array.isArray(D[0])||(D=[D]),D.forEach(function(F){var q=document.createElement("span");q.classList.add("ql-formats"),F.forEach(function(B){if(typeof B=="string")C(q,B);else{var z=Object.keys(B)[0],G=B[z];Array.isArray(G)?L(q,z,G):C(q,z,G)}}),M.appendChild(q)})}function L(M,D,F){var q=document.createElement("select");q.classList.add("ql-"+D),F.forEach(function(B){var z=document.createElement("option");B!==!1?z.setAttribute("value",B):z.setAttribute("selected","selected"),q.appendChild(z)}),M.appendChild(q)}A.DEFAULTS={container:null,handlers:{clean:function(){var D=this,F=this.quill.getSelection();if(F!=null)if(F.length==0){var q=this.quill.getFormat();Object.keys(q).forEach(function(B){c.default.query(B,c.default.Scope.INLINE)!=null&&D.quill.format(B,!1)})}else this.quill.removeFormat(F,m.default.sources.USER)},direction:function(D){var F=this.quill.getFormat().align;D==="rtl"&&F==null?this.quill.format("align","right",m.default.sources.USER):!D&&F==="right"&&this.quill.format("align",!1,m.default.sources.USER),this.quill.format("direction",D,m.default.sources.USER)},indent:function(D){var F=this.quill.getSelection(),q=this.quill.getFormat(F),B=parseInt(q.indent||0);if(D==="+1"||D==="-1"){var z=D==="+1"?1:-1;q.direction==="rtl"&&(z*=-1),this.quill.format("indent",B+z,m.default.sources.USER)}},link:function(D){D===!0&&(D=prompt("Enter link URL:")),this.quill.format("link",D,m.default.sources.USER)},list:function(D){var F=this.quill.getSelection(),q=this.quill.getFormat(F);D==="check"?q.list==="checked"||q.list==="unchecked"?this.quill.format("list",!1,m.default.sources.USER):this.quill.format("list","unchecked",m.default.sources.USER):this.quill.format("list",D,m.default.sources.USER)}}},n.default=A,n.addControls=I}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function v(y,x){for(var b=0;b<x.length;b++){var w=x[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,x,b){return x&&v(y.prototype,x),b&&v(y,b),y}})(),o=function v(y,x,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,x);if(w===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:v(k,x,b)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(b)}},l=i(28),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(x,b){c(this,y);var w=f(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,x));return w.label.innerHTML=b,w.container.classList.add("ql-color-picker"),[].slice.call(w.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(k){k.classList.add("ql-primary")}),w}return a(y,[{key:"buildItem",value:function(b){var w=o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"buildItem",this).call(this,b);return w.style.backgroundColor=b.getAttribute("value")||"",w}},{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w);var k=this.label.querySelector(".ql-color-label"),N=b&&b.getAttribute("data-value")||"";k&&(k.tagName==="line"?k.style.stroke=N:k.style.fill=N)}}]),y})(u.default);n.default=g}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function v(y,x){for(var b=0;b<x.length;b++){var w=x[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,x,b){return x&&v(y.prototype,x),b&&v(y,b),y}})(),o=function v(y,x,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,x);if(w===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:v(k,x,b)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(b)}},l=i(28),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(x,b){c(this,y);var w=f(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,x));return w.container.classList.add("ql-icon-picker"),[].forEach.call(w.container.querySelectorAll(".ql-picker-item"),function(k){k.innerHTML=b[k.getAttribute("data-value")||""]}),w.defaultItem=w.container.querySelector(".ql-selected"),w.selectItem(w.defaultItem),w}return a(y,[{key:"selectItem",value:function(b,w){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,b,w),b=b||this.defaultItem,this.label.innerHTML=b.innerHTML}}]),y})(u.default);n.default=g}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function u(h,c){for(var f=0;f<c.length;f++){var m=c[f];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(h,m.key,m)}}return function(h,c,f){return c&&u(h.prototype,c),f&&u(h,f),h}})();function o(u,h){if(!(u instanceof h))throw new TypeError("Cannot call a class as a function")}var l=(function(){function u(h,c){var f=this;o(this,u),this.quill=h,this.boundsContainer=c||document.body,this.root=h.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){f.root.style.marginTop=-1*f.quill.root.scrollTop+"px"}),this.hide()}return a(u,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(c){var f=c.left+c.width/2-this.root.offsetWidth/2,m=c.bottom+this.quill.root.scrollTop;this.root.style.left=f+"px",this.root.style.top=m+"px",this.root.classList.remove("ql-flip");var g=this.boundsContainer.getBoundingClientRect(),v=this.root.getBoundingClientRect(),y=0;if(v.right>g.right&&(y=g.right-v.right,this.root.style.left=f+y+"px"),v.left<g.left&&(y=g.left-v.left,this.root.style.left=f+y+"px"),v.bottom>g.bottom){var x=v.bottom-v.top,b=c.bottom-c.top+x;this.root.style.top=m-b+"px",this.root.classList.add("ql-flip")}return y}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),u})();n.default=l}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function L(M,D){var F=[],q=!0,B=!1,z=void 0;try{for(var G=M[Symbol.iterator](),Y;!(q=(Y=G.next()).done)&&(F.push(Y.value),!(D&&F.length===D));q=!0);}catch(H){B=!0,z=H}finally{try{!q&&G.return&&G.return()}finally{if(B)throw z}}return F}return function(M,D){if(Array.isArray(M))return M;if(Symbol.iterator in Object(M))return L(M,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),o=function L(M,D,F){M===null&&(M=Function.prototype);var q=Object.getOwnPropertyDescriptor(M,D);if(q===void 0){var B=Object.getPrototypeOf(M);return B===null?void 0:L(B,D,F)}else{if("value"in q)return q.value;var z=q.get;return z===void 0?void 0:z.call(F)}},l=(function(){function L(M,D){for(var F=0;F<D.length;F++){var q=D[F];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(M,q.key,q)}}return function(M,D,F){return D&&L(M.prototype,D),F&&L(M,F),M}})(),u=i(3),h=k(u),c=i(8),f=k(c),m=i(43),g=k(m),v=i(27),y=k(v),x=i(15),b=i(41),w=k(b);function k(L){return L&&L.__esModule?L:{default:L}}function N(L,M){if(!(L instanceof M))throw new TypeError("Cannot call a class as a function")}function E(L,M){if(!L)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M&&(typeof M=="object"||typeof M=="function")?M:L}function S(L,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof M);L.prototype=Object.create(M&&M.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(L,M):L.__proto__=M)}var A=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],C=(function(L){S(M,L);function M(D,F){N(this,M),F.modules.toolbar!=null&&F.modules.toolbar.container==null&&(F.modules.toolbar.container=A);var q=E(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,D,F));return q.quill.container.classList.add("ql-snow"),q}return l(M,[{key:"extendToolbar",value:function(F){F.container.classList.add("ql-snow"),this.buildButtons([].slice.call(F.container.querySelectorAll("button")),w.default),this.buildPickers([].slice.call(F.container.querySelectorAll("select")),w.default),this.tooltip=new I(this.quill,this.options.bounds),F.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(q,B){F.handlers.link.call(F,!B.format.link)})}}]),M})(g.default);C.DEFAULTS=(0,h.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(M){if(M){var D=this.quill.getSelection();if(D==null||D.length==0)return;var F=this.quill.getText(D);/^\S+@\S+\.\S+$/.test(F)&&F.indexOf("mailto:")!==0&&(F="mailto:"+F);var q=this.quill.theme.tooltip;q.edit("link",F)}else this.quill.format("link",!1)}}}}});var I=(function(L){S(M,L);function M(D,F){N(this,M);var q=E(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,D,F));return q.preview=q.root.querySelector("a.ql-preview"),q}return l(M,[{key:"listen",value:function(){var F=this;o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(q){F.root.classList.contains("ql-editing")?F.save():F.edit("link",F.preview.textContent),q.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(q){if(F.linkRange!=null){var B=F.linkRange;F.restoreFocus(),F.quill.formatText(B,"link",!1,f.default.sources.USER),delete F.linkRange}q.preventDefault(),F.hide()}),this.quill.on(f.default.events.SELECTION_CHANGE,function(q,B,z){if(q!=null){if(q.length===0&&z===f.default.sources.USER){var G=F.quill.scroll.descendant(y.default,q.index),Y=a(G,2),H=Y[0],V=Y[1];if(H!=null){F.linkRange=new x.Range(q.index-V,H.length());var O=y.default.formats(H.domNode);F.preview.textContent=O,F.preview.setAttribute("href",O),F.show(),F.position(F.quill.getBounds(F.linkRange));return}}else delete F.linkRange;F.hide()}})}},{key:"show",value:function(){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),M})(m.BaseTooltip);I.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=C}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(29),o=pe(a),l=i(36),u=i(38),h=i(64),c=i(65),f=pe(c),m=i(66),g=pe(m),v=i(67),y=pe(v),x=i(37),b=i(26),w=i(39),k=i(40),N=i(56),E=pe(N),S=i(68),A=pe(S),C=i(27),I=pe(C),L=i(69),M=pe(L),D=i(70),F=pe(D),q=i(71),B=pe(q),z=i(72),G=pe(z),Y=i(73),H=pe(Y),V=i(13),O=pe(V),U=i(74),K=pe(U),se=i(75),te=pe(se),X=i(57),Q=pe(X),ae=i(41),J=pe(ae),ue=i(28),we=pe(ue),_e=i(59),Ce=pe(_e),Le=i(60),Qe=pe(Le),St=i(61),at=pe(St),ee=i(108),ce=pe(ee),ge=i(62),ve=pe(ge);function pe(Ue){return Ue&&Ue.__esModule?Ue:{default:Ue}}o.default.register({"attributors/attribute/direction":u.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":x.BackgroundClass,"attributors/class/color":b.ColorClass,"attributors/class/direction":u.DirectionClass,"attributors/class/font":w.FontClass,"attributors/class/size":k.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":x.BackgroundStyle,"attributors/style/color":b.ColorStyle,"attributors/style/direction":u.DirectionStyle,"attributors/style/font":w.FontStyle,"attributors/style/size":k.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":u.DirectionClass,"formats/indent":h.IndentClass,"formats/background":x.BackgroundStyle,"formats/color":b.ColorStyle,"formats/font":w.FontClass,"formats/size":k.SizeClass,"formats/blockquote":f.default,"formats/code-block":O.default,"formats/header":g.default,"formats/list":y.default,"formats/bold":E.default,"formats/code":V.Code,"formats/italic":A.default,"formats/link":I.default,"formats/script":M.default,"formats/strike":F.default,"formats/underline":B.default,"formats/image":G.default,"formats/video":H.default,"formats/list/item":v.ListItem,"modules/formula":K.default,"modules/syntax":te.default,"modules/toolbar":Q.default,"themes/bubble":ce.default,"themes/snow":ve.default,"ui/icons":J.default,"ui/picker":we.default,"ui/icon-picker":Qe.default,"ui/color-picker":Ce.default,"ui/tooltip":at.default},!0),n.default=o.default}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var a=(function(){function y(x,b){for(var w=0;w<b.length;w++){var k=b[w];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}return function(x,b,w){return b&&y(x.prototype,b),w&&y(x,w),x}})(),o=function y(x,b,w){x===null&&(x=Function.prototype);var k=Object.getOwnPropertyDescriptor(x,b);if(k===void 0){var N=Object.getPrototypeOf(x);return N===null?void 0:y(N,b,w)}else{if("value"in k)return k.value;var E=k.get;return E===void 0?void 0:E.call(w)}},l=i(0),u=h(l);function h(y){return y&&y.__esModule?y:{default:y}}function c(y,x){if(!(y instanceof x))throw new TypeError("Cannot call a class as a function")}function f(y,x){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:y}function m(y,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(y,x):y.__proto__=x)}var g=(function(y){m(x,y);function x(){return c(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return a(x,[{key:"add",value:function(w,k){if(k==="+1"||k==="-1"){var N=this.value(w)||0;k=k==="+1"?N+1:N-1}return k===0?(this.remove(w),!0):o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"add",this).call(this,w,k)}},{key:"canAdd",value:function(w,k){return o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"canAdd",this).call(this,w,k)||o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"canAdd",this).call(this,w,parseInt(k))}},{key:"value",value:function(w){return parseInt(o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"value",this).call(this,w))||void 0}}]),x})(u.default.Attributor.Class),v=new g("indent","ql-indent",{scope:u.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=v}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(4),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function h(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function c(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var f=(function(m){c(g,m);function g(){return u(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g})(o.default);f.blotName="blockquote",f.tagName="blockquote",n.default=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function g(v,y){for(var x=0;x<y.length;x++){var b=y[x];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(v,b.key,b)}}return function(v,y,x){return y&&g(v.prototype,y),x&&g(v,x),v}})(),o=i(4),l=u(o);function u(g){return g&&g.__esModule?g:{default:g}}function h(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function c(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function f(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var m=(function(g){f(v,g);function v(){return h(this,v),c(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return a(v,null,[{key:"formats",value:function(x){return this.tagName.indexOf(x.tagName)+1}}]),v})(l.default);m.blotName="header",m.tagName=["H1","H2","H3","H4","H5","H6"],n.default=m}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var a=(function(){function N(E,S){for(var A=0;A<S.length;A++){var C=S[A];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(E,C.key,C)}}return function(E,S,A){return S&&N(E.prototype,S),A&&N(E,A),E}})(),o=function N(E,S,A){E===null&&(E=Function.prototype);var C=Object.getOwnPropertyDescriptor(E,S);if(C===void 0){var I=Object.getPrototypeOf(E);return I===null?void 0:N(I,S,A)}else{if("value"in C)return C.value;var L=C.get;return L===void 0?void 0:L.call(A)}},l=i(0),u=g(l),h=i(4),c=g(h),f=i(25),m=g(f);function g(N){return N&&N.__esModule?N:{default:N}}function v(N,E,S){return E in N?Object.defineProperty(N,E,{value:S,enumerable:!0,configurable:!0,writable:!0}):N[E]=S,N}function y(N,E){if(!(N instanceof E))throw new TypeError("Cannot call a class as a function")}function x(N,E){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:N}function b(N,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);N.prototype=Object.create(E&&E.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(N,E):N.__proto__=E)}var w=(function(N){b(E,N);function E(){return y(this,E),x(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return a(E,[{key:"format",value:function(A,C){A===k.blotName&&!C?this.replaceWith(u.default.create(this.statics.scope)):o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"format",this).call(this,A,C)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(A,C){return this.parent.isolate(this.offset(this.parent),this.length()),A===this.parent.statics.blotName?(this.parent.replaceWith(A,C),this):(this.parent.unwrap(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,A,C))}}],[{key:"formats",value:function(A){return A.tagName===this.tagName?void 0:o(E.__proto__||Object.getPrototypeOf(E),"formats",this).call(this,A)}}]),E})(c.default);w.blotName="list-item",w.tagName="LI";var k=(function(N){b(E,N),a(E,null,[{key:"create",value:function(A){var C=A==="ordered"?"OL":"UL",I=o(E.__proto__||Object.getPrototypeOf(E),"create",this).call(this,C);return(A==="checked"||A==="unchecked")&&I.setAttribute("data-checked",A==="checked"),I}},{key:"formats",value:function(A){if(A.tagName==="OL")return"ordered";if(A.tagName==="UL")return A.hasAttribute("data-checked")?A.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function E(S){y(this,E);var A=x(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,S)),C=function(L){if(L.target.parentNode===S){var M=A.statics.formats(S),D=u.default.find(L.target);M==="checked"?D.format("list","unchecked"):M==="unchecked"&&D.format("list","checked")}};return S.addEventListener("touchstart",C),S.addEventListener("mousedown",C),A}return a(E,[{key:"format",value:function(A,C){this.children.length>0&&this.children.tail.format(A,C)}},{key:"formats",value:function(){return v({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(A,C){if(A instanceof w)o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"insertBefore",this).call(this,A,C);else{var I=C==null?this.length():C.offset(this),L=this.split(I);L.parent.insertBefore(A,L)}}},{key:"optimize",value:function(A){o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"optimize",this).call(this,A);var C=this.next;C!=null&&C.prev===this&&C.statics.blotName===this.statics.blotName&&C.domNode.tagName===this.domNode.tagName&&C.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(C.moveChildren(this),C.remove())}},{key:"replace",value:function(A){if(A.statics.blotName!==this.statics.blotName){var C=u.default.create(this.statics.defaultChild);A.moveChildren(C),this.appendChild(C)}o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replace",this).call(this,A)}}]),E})(m.default);k.blotName="list",k.scope=u.default.Scope.BLOCK_BLOT,k.tagName=["OL","UL"],k.defaultChild="list-item",k.allowedChildren=[w],n.ListItem=w,n.default=k}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(56),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function h(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function c(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var f=(function(m){c(g,m);function g(){return u(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g})(o.default);f.blotName="italic",f.tagName=["EM","I"],n.default=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function v(y,x){for(var b=0;b<x.length;b++){var w=x[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(y,w.key,w)}}return function(y,x,b){return x&&v(y.prototype,x),b&&v(y,b),y}})(),o=function v(y,x,b){y===null&&(y=Function.prototype);var w=Object.getOwnPropertyDescriptor(y,x);if(w===void 0){var k=Object.getPrototypeOf(y);return k===null?void 0:v(k,x,b)}else{if("value"in w)return w.value;var N=w.get;return N===void 0?void 0:N.call(b)}},l=i(6),u=h(l);function h(v){return v&&v.__esModule?v:{default:v}}function c(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function f(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(function(v){m(y,v);function y(){return c(this,y),f(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return a(y,null,[{key:"create",value:function(b){return b==="super"?document.createElement("sup"):b==="sub"?document.createElement("sub"):o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,b)}},{key:"formats",value:function(b){if(b.tagName==="SUB")return"sub";if(b.tagName==="SUP")return"super"}}]),y})(u.default);g.blotName="script",g.tagName=["SUB","SUP"],n.default=g}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function h(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function c(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var f=(function(m){c(g,m);function g(){return u(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g})(o.default);f.blotName="strike",f.tagName="S",n.default=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),o=l(a);function l(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function h(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function c(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var f=(function(m){c(g,m);function g(){return u(this,g),h(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g})(o.default);f.blotName="underline",f.tagName="U",n.default=f}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function x(b,w){for(var k=0;k<w.length;k++){var N=w[k];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,w,k){return w&&x(b.prototype,w),k&&x(b,k),b}})(),o=function x(b,w,k){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,w);if(N===void 0){var E=Object.getPrototypeOf(b);return E===null?void 0:x(E,w,k)}else{if("value"in N)return N.value;var S=N.get;return S===void 0?void 0:S.call(k)}},l=i(0),u=c(l),h=i(27);function c(x){return x&&x.__esModule?x:{default:x}}function f(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function m(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=["alt","height","width"],y=(function(x){g(b,x);function b(){return f(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,[{key:"format",value:function(k,N){v.indexOf(k)>-1?N?this.domNode.setAttribute(k,N):this.domNode.removeAttribute(k):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,k,N)}}],[{key:"create",value:function(k){var N=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,k);return typeof k=="string"&&N.setAttribute("src",this.sanitize(k)),N}},{key:"formats",value:function(k){return v.reduce(function(N,E){return k.hasAttribute(E)&&(N[E]=k.getAttribute(E)),N},{})}},{key:"match",value:function(k){return/\.(jpe?g|gif|png)$/.test(k)||/^data:image\/.+;base64/.test(k)}},{key:"sanitize",value:function(k){return(0,h.sanitize)(k,["http","https","data"])?k:"//:0"}},{key:"value",value:function(k){return k.getAttribute("src")}}]),b})(u.default.Embed);y.blotName="image",y.tagName="IMG",n.default=y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=(function(){function x(b,w){for(var k=0;k<w.length;k++){var N=w[k];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,w,k){return w&&x(b.prototype,w),k&&x(b,k),b}})(),o=function x(b,w,k){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,w);if(N===void 0){var E=Object.getPrototypeOf(b);return E===null?void 0:x(E,w,k)}else{if("value"in N)return N.value;var S=N.get;return S===void 0?void 0:S.call(k)}},l=i(4),u=i(27),h=c(u);function c(x){return x&&x.__esModule?x:{default:x}}function f(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function m(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=["height","width"],y=(function(x){g(b,x);function b(){return f(this,b),m(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return a(b,[{key:"format",value:function(k,N){v.indexOf(k)>-1?N?this.domNode.setAttribute(k,N):this.domNode.removeAttribute(k):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,k,N)}}],[{key:"create",value:function(k){var N=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,k);return N.setAttribute("frameborder","0"),N.setAttribute("allowfullscreen",!0),N.setAttribute("src",this.sanitize(k)),N}},{key:"formats",value:function(k){return v.reduce(function(N,E){return k.hasAttribute(E)&&(N[E]=k.getAttribute(E)),N},{})}},{key:"sanitize",value:function(k){return h.default.sanitize(k)}},{key:"value",value:function(k){return k.getAttribute("src")}}]),b})(l.BlockEmbed);y.blotName="video",y.className="ql-video",y.tagName="IFRAME",n.default=y}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var a=(function(){function k(N,E){for(var S=0;S<E.length;S++){var A=E[S];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(N,A.key,A)}}return function(N,E,S){return E&&k(N.prototype,E),S&&k(N,S),N}})(),o=function k(N,E,S){N===null&&(N=Function.prototype);var A=Object.getOwnPropertyDescriptor(N,E);if(A===void 0){var C=Object.getPrototypeOf(N);return C===null?void 0:k(C,E,S)}else{if("value"in A)return A.value;var I=A.get;return I===void 0?void 0:I.call(S)}},l=i(35),u=g(l),h=i(5),c=g(h),f=i(9),m=g(f);function g(k){return k&&k.__esModule?k:{default:k}}function v(k,N){if(!(k instanceof N))throw new TypeError("Cannot call a class as a function")}function y(k,N){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:k}function x(k,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);k.prototype=Object.create(N&&N.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(k,N):k.__proto__=N)}var b=(function(k){x(N,k);function N(){return v(this,N),y(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return a(N,null,[{key:"create",value:function(S){var A=o(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this,S);return typeof S=="string"&&(window.katex.render(S,A,{throwOnError:!1,errorColor:"#f00"}),A.setAttribute("data-value",S)),A}},{key:"value",value:function(S){return S.getAttribute("data-value")}}]),N})(u.default);b.blotName="formula",b.className="ql-formula",b.tagName="SPAN";var w=(function(k){x(N,k),a(N,null,[{key:"register",value:function(){c.default.register(b,!0)}}]);function N(){v(this,N);var E=y(this,(N.__proto__||Object.getPrototypeOf(N)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return E}return N})(m.default);n.FormulaBlot=b,n.default=w}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var a=(function(){function S(A,C){for(var I=0;I<C.length;I++){var L=C[I];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(A,L.key,L)}}return function(A,C,I){return C&&S(A.prototype,C),I&&S(A,I),A}})(),o=function S(A,C,I){A===null&&(A=Function.prototype);var L=Object.getOwnPropertyDescriptor(A,C);if(L===void 0){var M=Object.getPrototypeOf(A);return M===null?void 0:S(M,C,I)}else{if("value"in L)return L.value;var D=L.get;return D===void 0?void 0:D.call(I)}},l=i(0),u=y(l),h=i(5),c=y(h),f=i(9),m=y(f),g=i(13),v=y(g);function y(S){return S&&S.__esModule?S:{default:S}}function x(S,A){if(!(S instanceof A))throw new TypeError("Cannot call a class as a function")}function b(S,A){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:S}function w(S,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);S.prototype=Object.create(A&&A.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(S,A):S.__proto__=A)}var k=(function(S){w(A,S);function A(){return x(this,A),b(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return a(A,[{key:"replaceWith",value:function(I){this.domNode.textContent=this.domNode.textContent,this.attach(),o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"replaceWith",this).call(this,I)}},{key:"highlight",value:function(I){var L=this.domNode.textContent;this.cachedText!==L&&((L.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=I(L),this.domNode.normalize(),this.attach()),this.cachedText=L)}}]),A})(v.default);k.className="ql-syntax";var N=new u.default.Attributor.Class("token","hljs",{scope:u.default.Scope.INLINE}),E=(function(S){w(A,S),a(A,null,[{key:"register",value:function(){c.default.register(N,!0),c.default.register(k,!0)}}]);function A(C,I){x(this,A);var L=b(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,C,I));if(typeof L.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var M=null;return L.quill.on(c.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(M),M=setTimeout(function(){L.highlight(),M=null},L.options.interval)}),L.highlight(),L}return a(A,[{key:"highlight",value:function(){var I=this;if(!this.quill.selection.composing){this.quill.update(c.default.sources.USER);var L=this.quill.getSelection();this.quill.scroll.descendants(k).forEach(function(M){M.highlight(I.options.highlight)}),this.quill.update(c.default.sources.SILENT),L!=null&&this.quill.setSelection(L,c.default.sources.SILENT)}}}]),A})(m.default);E.DEFAULTS={highlight:(function(){return window.hljs==null?null:function(S){var A=window.hljs.highlightAuto(S);return A.value}})(),interval:1e3},n.CodeBlock=k,n.CodeToken=N,n.default=E}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'}),(function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'}),(function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'}),(function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'}),(function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'}),(function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'}),(function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var a=function A(C,I,L){C===null&&(C=Function.prototype);var M=Object.getOwnPropertyDescriptor(C,I);if(M===void 0){var D=Object.getPrototypeOf(C);return D===null?void 0:A(D,I,L)}else{if("value"in M)return M.value;var F=M.get;return F===void 0?void 0:F.call(L)}},o=(function(){function A(C,I){for(var L=0;L<I.length;L++){var M=I[L];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(C,M.key,M)}}return function(C,I,L){return I&&A(C.prototype,I),L&&A(C,L),C}})(),l=i(3),u=x(l),h=i(8),c=x(h),f=i(43),m=x(f),g=i(15),v=i(41),y=x(v);function x(A){return A&&A.__esModule?A:{default:A}}function b(A,C){if(!(A instanceof C))throw new TypeError("Cannot call a class as a function")}function w(A,C){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:A}function k(A,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);A.prototype=Object.create(C&&C.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(A,C):A.__proto__=C)}var N=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],E=(function(A){k(C,A);function C(I,L){b(this,C),L.modules.toolbar!=null&&L.modules.toolbar.container==null&&(L.modules.toolbar.container=N);var M=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I,L));return M.quill.container.classList.add("ql-bubble"),M}return o(C,[{key:"extendToolbar",value:function(L){this.tooltip=new S(this.quill,this.options.bounds),this.tooltip.root.appendChild(L.container),this.buildButtons([].slice.call(L.container.querySelectorAll("button")),y.default),this.buildPickers([].slice.call(L.container.querySelectorAll("select")),y.default)}}]),C})(m.default);E.DEFAULTS=(0,u.default)(!0,{},m.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){C?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var S=(function(A){k(C,A);function C(I,L){b(this,C);var M=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,I,L));return M.quill.on(c.default.events.EDITOR_CHANGE,function(D,F,q,B){if(D===c.default.events.SELECTION_CHANGE)if(F!=null&&F.length>0&&B===c.default.sources.USER){M.show(),M.root.style.left="0px",M.root.style.width="",M.root.style.width=M.root.offsetWidth+"px";var z=M.quill.getLines(F.index,F.length);if(z.length===1)M.position(M.quill.getBounds(F));else{var G=z[z.length-1],Y=M.quill.getIndex(G),H=Math.min(G.length()-1,F.index+F.length-Y),V=M.quill.getBounds(new g.Range(Y,H));M.position(V)}}else document.activeElement!==M.textbox&&M.quill.hasFocus()&&M.hide()}),M}return o(C,[{key:"listen",value:function(){var L=this;a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){L.root.classList.remove("ql-editing")}),this.quill.on(c.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!L.root.classList.contains("ql-hidden")){var M=L.quill.getSelection();M!=null&&L.position(L.quill.getBounds(M))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(L){var M=a(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"position",this).call(this,L),D=this.root.querySelector(".ql-tooltip-arrow");if(D.style.marginLeft="",M===0)return M;D.style.marginLeft=-1*M-D.offsetWidth/2+"px"}}]),C})(f.BaseTooltip);S.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=S,n.default=E}),(function(t,n,i){t.exports=i(63)})]).default})})(iu)),iu.exports}var Br,$N;function ML(){if($N)return Br;$N=1;var r=Br&&Br.__extends||(function(){var c=function(f,m){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,v){g.__proto__=v}||function(g,v){for(var y in v)v.hasOwnProperty(y)&&(g[y]=v[y])},c(f,m)};return function(f,m){c(f,m);function g(){this.constructor=f}f.prototype=m===null?Object.create(m):(g.prototype=m.prototype,new g)}})(),e=Br&&Br.__assign||function(){return e=Object.assign||function(c){for(var f,m=1,g=arguments.length;m<g;m++){f=arguments[m];for(var v in f)Object.prototype.hasOwnProperty.call(f,v)&&(c[v]=f[v])}return c},e.apply(this,arguments)},t=Br&&Br.__spreadArrays||function(){for(var c=0,f=0,m=arguments.length;f<m;f++)c+=arguments[f].length;for(var g=Array(c),v=0,f=0;f<m;f++)for(var y=arguments[f],x=0,b=y.length;x<b;x++,v++)g[v]=y[x];return g},n=Br&&Br.__importDefault||function(c){return c&&c.__esModule?c:{default:c}},i=n(Gu()),a=n(Xx()),o=n(RL()),l=n(PL()),u=(function(c){r(f,c);function f(m){var g=c.call(this,m)||this;g.dirtyProps=["modules","formats","bounds","theme","children"],g.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],g.state={generation:0},g.selection=null,g.onEditorChange=function(y,x,b,w){var k,N,E,S;y==="text-change"?(N=(k=g).onEditorChangeText)===null||N===void 0||N.call(k,g.editor.root.innerHTML,x,w,g.unprivilegedEditor):y==="selection-change"&&((S=(E=g).onEditorChangeSelection)===null||S===void 0||S.call(E,x,w,g.unprivilegedEditor))};var v=g.isControlled()?m.value:m.defaultValue;return g.value=v??"",g}return f.prototype.validateProps=function(m){var g;if(i.default.Children.count(m.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(m.children)){var v=i.default.Children.only(m.children);if(((g=v)===null||g===void 0?void 0:g.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&m.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},f.prototype.shouldComponentUpdate=function(m,g){var v=this,y;if(this.validateProps(m),!this.editor||this.state.generation!==g.generation)return!0;if("value"in m){var x=this.getEditorContents(),b=(y=m.value,y??"");this.isEqualValue(b,x)||this.setEditorContents(this.editor,b)}return m.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,m.readOnly),t(this.cleanProps,this.dirtyProps).some(function(w){return!o.default(m[w],v.props[w])})},f.prototype.shouldComponentRegenerate=function(m){var g=this;return this.dirtyProps.some(function(v){return!o.default(m[v],g.props[v])})},f.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},f.prototype.componentWillUnmount=function(){this.destroyEditor()},f.prototype.componentDidUpdate=function(m,g){var v=this;if(this.editor&&this.shouldComponentRegenerate(m)){var y=this.editor.getContents(),x=this.editor.getSelection();this.regenerationSnapshot={delta:y,selection:x},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==g.generation){var b=this.regenerationSnapshot,y=b.delta,w=b.selection;delete this.regenerationSnapshot,this.instantiateEditor();var k=this.editor;k.setContents(y),h(function(){return v.setEditorSelection(k,w)})}},f.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},f.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},f.prototype.isControlled=function(){return"value"in this.props},f.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},f.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},f.prototype.createEditor=function(m,g){var v=new l.default(m,g);return g.tabIndex!=null&&this.setEditorTabIndex(v,g.tabIndex),this.hookEditor(v),v},f.prototype.hookEditor=function(m){this.unprivilegedEditor=this.makeUnprivilegedEditor(m),m.on("editor-change",this.onEditorChange)},f.prototype.unhookEditor=function(m){m.off("editor-change",this.onEditorChange)},f.prototype.getEditorContents=function(){return this.value},f.prototype.getEditorSelection=function(){return this.selection},f.prototype.isDelta=function(m){return m&&m.ops},f.prototype.isEqualValue=function(m,g){return this.isDelta(m)&&this.isDelta(g)?o.default(m.ops,g.ops):o.default(m,g)},f.prototype.setEditorContents=function(m,g){var v=this;this.value=g;var y=this.getEditorSelection();typeof g=="string"?m.setContents(m.clipboard.convert(g)):m.setContents(g),h(function(){return v.setEditorSelection(m,y)})},f.prototype.setEditorSelection=function(m,g){if(this.selection=g,g){var v=m.getLength();g.index=Math.max(0,Math.min(g.index,v-1)),g.length=Math.max(0,Math.min(g.length,v-1-g.index)),m.setSelection(g)}},f.prototype.setEditorTabIndex=function(m,g){var v,y;!((y=(v=m)===null||v===void 0?void 0:v.scroll)===null||y===void 0)&&y.domNode&&(m.scroll.domNode.tabIndex=g)},f.prototype.setEditorReadOnly=function(m,g){g?m.disable():m.enable()},f.prototype.makeUnprivilegedEditor=function(m){var g=m;return{getHTML:function(){return g.root.innerHTML},getLength:g.getLength.bind(g),getText:g.getText.bind(g),getContents:g.getContents.bind(g),getSelection:g.getSelection.bind(g),getBounds:g.getBounds.bind(g)}},f.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var m=a.default.findDOMNode(this.editingArea);if(!m)throw new Error("Cannot find element for editing area");if(m.nodeType===3)throw new Error("Editing area cannot be a text node");return m},f.prototype.renderEditingArea=function(){var m=this,g=this.props,v=g.children,y=g.preserveWhitespace,x=this.state.generation,b={key:x,ref:function(w){m.editingArea=w}};return i.default.Children.count(v)?i.default.cloneElement(i.default.Children.only(v),b):y?i.default.createElement("pre",e({},b)):i.default.createElement("div",e({},b))},f.prototype.render=function(){var m;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(m=this.props.className,m??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},f.prototype.onEditorChangeText=function(m,g,v,y){var x,b;if(this.editor){var w=this.isDelta(this.value)?y.getContents():y.getHTML();w!==this.getEditorContents()&&(this.lastDeltaChangeSet=g,this.value=w,(b=(x=this.props).onChange)===null||b===void 0||b.call(x,m,g,v,y))}},f.prototype.onEditorChangeSelection=function(m,g,v){var y,x,b,w,k,N;if(this.editor){var E=this.getEditorSelection(),S=!E&&m,A=E&&!m;o.default(m,E)||(this.selection=m,(x=(y=this.props).onChangeSelection)===null||x===void 0||x.call(y,m,g,v),S?(w=(b=this.props).onFocus)===null||w===void 0||w.call(b,m,g,v):A&&((N=(k=this.props).onBlur)===null||N===void 0||N.call(k,E,g,v)))}},f.prototype.focus=function(){this.editor&&this.editor.focus()},f.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},f.displayName="React Quill",f.Quill=l.default,f.defaultProps={theme:"snow",modules:{},readOnly:!1},f})(i.default.Component);function h(c){Promise.resolve().then(c)}return Br=u,Br}var OL=ML();const ku=Wu(OL);function ac({isOpen:r,onClose:e,title:t,children:n,size:i="md"}){R.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[r]);const a={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return r?pu.createPortal(s.jsx(zs,{children:s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black bg-opacity-50",onClick:e}),s.jsxs(W.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:`relative bg-white rounded-2xl shadow-xl w-full ${a[i]} mx-4 max-h-[90vh] overflow-hidden`,children:[t&&s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-80px)]",children:n})]})]})}),document.body):null}function LL(){const r=qs(),{user:e}=st(),{books:t,myBooks:n,loading:i,error:a,fetchBooks:o,fetchMyBooks:l,createBook:u,updateBook:h,deleteBook:c,clearError:f}=OS(),[m,g]=R.useState(!1),[v,y]=R.useState(null),[x,b]=R.useState("public"),[w,k]=R.useState([]),[N,E]=R.useState(!0),[S,A]=R.useState(null),[C,I]=R.useState(""),[L,M]=R.useState(""),{posts:D,loading:F,error:q,createPost:B,toggleLike:z,sharePost:G,refetch:Y}=BS();rh();const[H,V]=R.useState(""),[O,U]=R.useState(!1),[K,se]=R.useState(!1),[te,X]=R.useState("image"),[Q,ae]=R.useState([]),[J,ue]=R.useState(null),[we,_e]=R.useState(null),[Ce,Le]=R.useState(null),[Qe,St]=R.useState(""),[at,ee]=R.useState([]),[ce,ge]=R.useState(!1),[ve,pe]=R.useState("livres"),[Ue,We]=R.useState(!1),Ge={toolbar:[["bold","italic","underline","strike"],[{header:[1,2,3,!1]}],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]};R.useEffect(()=>{const he=()=>{const Pe=["livres","clubs","publications"],tt=window.scrollY+100;for(const xt of Pe){const jt=document.getElementById(xt);if(jt){const{offsetTop:$s,offsetHeight:Tr}=jt;if(tt>=$s&&tt<$s+Tr){pe(xt);break}}}We(window.scrollY>400)};return window.addEventListener("scroll",he),()=>window.removeEventListener("scroll",he)},[]);const Jt=he=>{const Pe=document.getElementById(he);if(Pe){const xt=Pe.offsetTop-120;window.scrollTo({top:xt,behavior:"smooth"})}};R.useEffect(()=>{os()},[x]);const os=async()=>{try{x==="public"?await o():await l()}catch(he){console.error("Erreur chargement livres:",he)}};R.useEffect(()=>{ut()},[]);const ut=async()=>{if(E(!0),A(null),!e?.token){A("Veuillez vous connecter pour voir les clubs."),E(!1);return}try{const he=await fetch("https://vakio-boky-backend.onrender.com/api/clubs",{headers:{Authorization:`Bearer ${e.token}`}});if(he.status===401||he.status===403){A("Session expire.");return}const Pe=await he.json();Pe.success?k(Pe.clubs):A(Pe.message||"Erreur lors du chargement des clubs")}catch(he){console.error(he),A("Erreur lors du chargement des clubs")}finally{E(!1)}},Ri=w.filter(he=>{const Pe=he.nom.toLowerCase().includes(C.toLowerCase())||he.description.toLowerCase().includes(C.toLowerCase()),tt=!L||he.categorie===L;return Pe&&tt}),gt=[...new Set(w.map(he=>he.categorie).filter(Boolean))],_s=async he=>{try{await u(he),g(!1),os()}catch(Pe){console.error("Erreur cration livre:",Pe)}},Ah=async he=>{try{await h(v.id,he),y(null),os()}catch(Pe){console.error("Erreur modification livre:",Pe)}},xc=async he=>{if(window.confirm("tes-vous sr de vouloir supprimer ce livre ?"))try{await c(he),os()}catch(Pe){console.error("Erreur suppression livre:",Pe)}},yc=he=>{y(he)},vc=x==="public"?t:n,Ro=async he=>{try{const tt=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${he}/join`,{method:"POST",headers:{Authorization:`Bearer ${e.token}`}})).json();tt.success?(alert("Vous avez rejoint le club !"),ut()):alert(tt.message)}catch(Pe){console.error(Pe),alert("Erreur lors de l'adhsion")}},Do=he=>he.membres_count>0,Hn=he=>{X(he),se(!0)},Po=async he=>{if(he.preventDefault(),!H.trim()&&Q.length===0){alert("Le contenu ou un mdia est requis");return}U(!0);try{let Pe="simple",tt=null;Q.length>0&&(tt=Q[0].url,Q[0].type==="image"?Pe="image":Q[0].type==="video"?Pe="video":Pe="document");const jt=await B({contenu:H,type_post:Pe,media_url:tt});jt.success?(V(""),ae([]),ge(!1),await Y()):alert(jt.error||"Erreur lors de la cration du post")}catch(Pe){console.error("Erreur cration post:",Pe),alert("Erreur lors de la cration du post")}finally{U(!1)}},Mo=async he=>{he&&he.length>0&&(ae(he),se(!1))},Vn=async he=>{he&&he.length>0&&(ee(he),se(!1))},yn=()=>{ee([])},bc=async he=>{(await z(he)).success||alert("Erreur lors du like")},jc=async he=>{const Pe=D.find(xt=>xt.id===he);if(!Pe)return;if((await G(he)).success){const xt=`Dcouvrez ce post de ${Pe.auteur_nom} sur Vakio Boky`,jt=`${window.location.origin}/post/${he}`;if(navigator.share)try{await navigator.share({title:"Vakio Boky",text:xt,url:jt})}catch{console.log("Partage annul")}else window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(xt)}&url=${encodeURIComponent(jt)}`,"_blank")}else alert("Erreur lors du partage")},wc=async he=>{if(confirm("tes-vous sr de vouloir supprimer cette publication ?"))try{const tt=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${he}`,{method:"DELETE",headers:{Authorization:`Bearer ${e?.token}`}})).json();tt.success?(await Y(),_e(null)):alert(tt.error||"Erreur lors de la suppression")}catch(Pe){console.error("Erreur suppression post:",Pe),alert("Erreur lors de la suppression")}},Nc=async he=>{if(!Qe.trim()){alert("Le contenu ne peut pas tre vide");return}try{let Pe="simple";if(at.length>0){const $s=at[0].type;$s.includes("image")?Pe="image":$s.includes("video")?Pe="video":Pe="document"}else Pe=D.find(Tr=>Tr.id===he)?.type_post||"simple";const tt={contenu:Qe,type_post:Pe,media_url:at.length>0?at[0].url:null};at.length===0&&(tt.media_url=null,tt.type_post="simple");const jt=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${he}`,{method:"PUT",headers:{Authorization:`Bearer ${e?.token}`,"Content-Type":"application/json"},body:JSON.stringify(tt)})).json();jt.success?(await Y(),Le(null),St(""),ee([])):alert(jt.error||"Erreur lors de la modification")}catch(Pe){console.error("Erreur modification post:",Pe),alert("Erreur lors de la modification")}},kc=he=>{Le(he.id),St(he.contenu),ee(he.media_url?[{url:he.media_url,type:he.type_post}]:[])},va=he=>he.media_url?s.jsxs("div",{className:"mt-4 rounded-2xl overflow-hidden border border-gray-200 bg-gray-50 shadow-sm",children:[he.type_post==="image"&&s.jsx("img",{src:he.media_url,alt:"Post media",className:"w-full max-h-96 object-cover cursor-pointer transition-transform duration-300 hover:scale-105",onClick:()=>window.open(he.media_url,"_blank")}),he.type_post==="video"&&s.jsx("video",{src:he.media_url,controls:!0,className:"w-full max-h-96 bg-black rounded-lg"}),(he.type_post==="document"||he.type_post==="fichier")&&s.jsxs("div",{className:"p-6 flex items-center space-x-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl",children:[s.jsx(dn,{className:"text-blue-600 text-2xl flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-gray-900 truncate",children:"Document joint"}),s.jsx("a",{href:he.media_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors",children:"Tlcharger le fichier"})]})]})]}):null,Ec=he=>s.jsxs("div",{className:"mb-4 space-y-4",children:[s.jsx(ku,{theme:"snow",value:Qe,onChange:St,modules:Ge,className:"bg-white rounded-xl border border-gray-200 min-h-[150px] mb-4"}),he.media_url&&s.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[s.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Mdia actuel:"}),va(he),s.jsxs("button",{onClick:yn,className:"mt-3 flex items-center gap-2 text-red-600 text-sm font-medium hover:text-red-700 transition-colors",children:[s.jsx(Zk,{size:14}),"Supprimer ce mdia"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>Hn("image"),className:"flex items-center gap-2 px-4 py-2 border-2 border-blue-200 rounded-xl text-blue-700 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 font-medium",children:[s.jsx(Fl,{size:18}),"Image"]}),s.jsxs("button",{type:"button",onClick:()=>Hn("video"),className:"flex items-center gap-2 px-4 py-2 border-2 border-purple-200 rounded-xl text-purple-700 hover:bg-purple-50 hover:border-purple-300 transition-all duration-200 font-medium",children:[s.jsx(Ur,{size:18}),"Vido"]}),s.jsxs("button",{type:"button",onClick:()=>Hn("file"),className:"flex items-center gap-2 px-4 py-2 border-2 border-green-200 rounded-xl text-green-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200 font-medium",children:[s.jsx(dn,{size:18}),"Fichier"]})]}),at.length>0&&s.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:[s.jsx("p",{className:"text-sm font-semibold text-green-900 mb-2",children:"Nouveau mdia:"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-green-800 font-medium",children:at[0].url.split("/").pop()}),s.jsx("button",{onClick:yn,className:"text-red-600 hover:text-red-700 transition-colors",children:s.jsx(ot,{size:18})})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(oe,{size:"md",onClick:()=>Nc(he.id),disabled:!Qe.trim(),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:"Enregistrer les modifications"}),s.jsx(oe,{variant:"outline",size:"md",onClick:()=>{Le(null),St(""),ee([])},children:"Annuler"})]})]}),Di=()=>{const he=[{id:"livres",label:"Livres",icon:et,color:"blue"},{id:"clubs",label:"Clubs",icon:Me,color:"green"},{id:"publications",label:"Publications",icon:mi,color:"purple"}],Pe=he.findIndex(jt=>jt.id===ve),tt=he[Pe+1],xt=he[Pe-1];return s.jsx(zs,{children:Ue&&s.jsxs(W.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-8 right-8 z-40 flex flex-col gap-3",children:[xt&&s.jsxs(W.button,{whileHover:{scale:1.05,x:-5},whileTap:{scale:.95},onClick:()=>Jt(xt.id),className:`bg-gradient-to-r from-${xt.color}-600 to-${xt.color}-700 text-white px-6 py-4 rounded-2xl shadow-2xl hover:shadow-3xl flex items-center gap-3 font-semibold group`,children:[s.jsx(Xk,{className:"group-hover:-translate-y-0.5 transition-transform"}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm opacity-90",children:"Retour "}),s.jsx("div",{children:xt.label})]})]}),tt&&s.jsxs(W.button,{whileHover:{scale:1.05,x:-5},whileTap:{scale:.95},onClick:()=>Jt(tt.id),className:`bg-gradient-to-r from-${tt.color}-600 to-${tt.color}-700 text-white px-6 py-4 rounded-2xl shadow-2xl hover:shadow-3xl flex items-center gap-3 font-semibold group`,children:[s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-sm opacity-90",children:"Continuer vers"}),s.jsx("div",{children:tt.label})]}),s.jsx(Kk,{className:"group-hover:translate-y-0.5 transition-transform"})]}),s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-white/90 backdrop-blur-lg rounded-2xl shadow-2xl border border-gray-200 p-4",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2 text-center",children:"Navigation rapide"}),s.jsx("div",{className:"flex gap-2",children:he.map(jt=>s.jsx(W.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>Jt(jt.id),className:`flex-1 px-3 py-2 rounded-xl text-xs font-semibold transition-all duration-200 ${ve===jt.id?`bg-${jt.color}-600 text-white shadow-lg`:"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:jt.label},jt.id))})]})]})})};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 pb-12",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-center mb-16",children:[s.jsx(W.h1,{initial:{scale:.9},animate:{scale:1},transition:{delay:.2},className:"text-5xl md:text-6xl font-bold bg-gradient-to-br from-gray-900 to-blue-800 bg-clip-text text-transparent mb-6",children:"Explorez l'Univers Littraire"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Dcouvrez des livres captivants, rencontrez des auteurs talentueux et plongez dans vos genres prfrs au sein de notre communaut"})]}),s.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"sticky top-20 z-30 bg-white/90 backdrop-blur-lg border-b border-gray-200 shadow-sm mb-12",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex overflow-x-auto py-4 gap-2 scrollbar-hide",children:[{id:"livres",label:" Bibliothque",icon:et},{id:"clubs",label:" Clubs Littraires",icon:Me},{id:"publications",label:" Fil d'Actualit",icon:mi}].map(he=>s.jsxs(W.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>Jt(he.id),className:`flex items-center gap-3 px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all duration-300 flex-shrink-0 ${ve===he.id?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[s.jsx(he.icon,{size:18}),he.label]},he.id))})})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"max-w-2xl mx-auto mb-16",children:s.jsxs("div",{className:"relative group",children:[s.jsx(nr,{className:"absolute left-6 top-1/2 transform -translate-y-1/2 text-gray-400 text-xl group-hover:text-blue-500 transition-colors"}),s.jsx("input",{type:"text",placeholder:"Rechercher un livre, un auteur, un genre...",className:"w-full pl-16 pr-6 py-5 text-lg border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 shadow-lg hover:shadow-xl transition-all duration-300 bg-white/80 backdrop-blur-sm"})]})}),s.jsxs(W.section,{id:"livres",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mb-20 scroll-mt-32",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center mb-2",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(et,{className:"text-white text-xl"})}),"Bibliothque"]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Dcouvrez et grez votre collection de livres"})]}),s.jsxs(oe,{onClick:()=>g(!0),className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 px-8 py-4 rounded-2xl font-semibold",children:[s.jsx(bt,{className:"mr-2"}),"Nouveau Livre"]})]}),s.jsx("div",{className:"flex space-x-1 bg-gray-100/80 rounded-2xl p-2 mb-8 max-w-md backdrop-blur-sm",children:[{id:"public",label:"Livres Publis"},{id:"mes-livres",label:"Mes Livres"}].map(he=>s.jsx("button",{className:`flex-1 px-6 py-4 rounded-xl font-semibold transition-all duration-300 ${x===he.id?"bg-white text-blue-600 shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-white/50"}`,onClick:()=>b(he.id),children:he.label},he.id))}),a&&s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl mb-6 flex justify-between items-center shadow-lg",children:[s.jsx("span",{className:"font-medium",children:a}),s.jsx("button",{onClick:f,className:"text-red-700 hover:text-red-900 p-1 rounded-lg hover:bg-red-100 transition-colors",children:s.jsx(ot,{size:20})})]}),s.jsx(zs,{children:(m||v)&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:s.jsx(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-200",children:s.jsx(IS,{book:v,onSubmit:v?Ah:_s,onCancel:()=>{g(!1),y(null)}})})})}),i?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-blue-600 border-t-transparent"}),s.jsx("span",{className:"text-lg",children:"Chargement des livres..."})]})}):vc.length===0?s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white/50 rounded-3xl border-2 border-dashed border-gray-300",children:[s.jsx(t0,{className:"mx-auto text-6xl text-gray-400 mb-4"}),s.jsx("h3",{className:"text-2xl font-semibold text-gray-600 mb-2",children:x==="public"?"Aucun livre publi":"Votre bibliothque est vide"}),s.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:x==="public"?"Soyez le premier  publier un livre dans la communaut":"Commencez par ajouter votre premier livre  votre collection"}),s.jsxs(oe,{onClick:()=>g(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[s.jsx(bt,{className:"mr-2"}),"Ajouter un livre"]})]}):s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:vc.map((he,Pe)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:Pe*.1},whileHover:{y:-5},children:s.jsx(LS,{book:he,onEdit:yc,onDelete:xc,showActions:x==="mes-livres"})},he.id))})]}),s.jsxs(W.section,{id:"clubs",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mb-20 scroll-mt-32",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center justify-center mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(Me,{className:"text-white text-xl"})}),"Clubs Littraires"]}),s.jsx("p",{className:"text-gray-600 text-lg max-w-2xl mx-auto",children:"Rejoignez des communauts passionnes et partagez vos dcouvertes littraires"})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col lg:flex-row gap-6 justify-center items-center mb-12 bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-gray-200",children:[s.jsxs("div",{className:"relative w-full lg:w-96",children:[s.jsx(nr,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg"}),s.jsx("input",{type:"text",placeholder:"Rechercher un club...",value:C,onChange:he=>I(he.target.value),className:"w-full px-12 py-4 rounded-xl border-2 border-gray-200 focus:ring-4 focus:ring-green-500/20 focus:border-green-500 transition-all duration-300 bg-white"})]}),s.jsxs("div",{className:"relative w-full lg:w-64",children:[s.jsx(ko,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg"}),s.jsxs("select",{value:L,onChange:he=>M(he.target.value),className:"w-full px-12 py-4 rounded-xl border-2 border-gray-200 focus:ring-4 focus:ring-green-500/20 focus:border-green-500 appearance-none bg-white cursor-pointer transition-all duration-300",children:[s.jsx("option",{value:"",children:"Toutes les catgories"}),gt.map(he=>s.jsx("option",{value:he,children:he},he))]})]})]}),S&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl mb-8 text-center shadow-lg",children:S}),N?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-green-600 border-t-transparent"}),s.jsx("span",{className:"text-lg",children:"Chargement des clubs..."})]})}):Ri.length===0?s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-16 text-center",children:[s.jsx(Me,{className:"mx-auto text-6xl text-gray-300 mb-6"}),s.jsx("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Aucun club trouv"}),s.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto text-lg",children:w.length===0?"Soyez le premier  crer un club littraire et  rassembler une communaut de passionns !":"Aucun club ne correspond  votre recherche. Essayez d'autres termes."}),s.jsx(oe,{onClick:()=>r("/create"),className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 px-8 py-4 rounded-2xl font-semibold",children:"Crer un club"})]}):s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:Ri.map((he,Pe)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:Pe*.1},whileHover:{y:-8,scale:1.02},className:"bg-white rounded-3xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden group border border-gray-200",children:[he.createur_id===e?.id&&s.jsx("div",{className:"absolute top-4 left-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-4 py-2 rounded-full text-sm font-semibold z-10 shadow-lg",children:" Admin"}),s.jsxs("div",{className:"relative overflow-hidden h-48",children:[s.jsx("img",{src:he.image_url?`https://vakio-boky-backend.onrender.com${he.image_url}`:"/placeholder-club.jpg",alt:he.nom,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",onError:tt=>{tt.target.src="/placeholder-club.jpg"}}),s.jsx("div",{className:"absolute top-0 right-0 bg-black/80 text-white px-3 py-2 rounded-bl-2xl text-sm font-medium",children:he.visibilite}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4",children:s.jsx("h3",{className:"text-xl font-bold text-white truncate",children:he.nom})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2 leading-relaxed",children:he.description}),s.jsxs("div",{className:"space-y-3 mb-6",children:[he.categorie&&s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(et,{className:"w-4 h-4 mr-3 text-blue-500"}),s.jsx("span",{className:"font-medium",children:he.categorie})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(Me,{className:"w-4 h-4 mr-3 text-green-500"}),s.jsxs("span",{className:"font-medium",children:[he.membres_count," membre",he.membres_count!==1?"s":""]})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(fs,{className:"w-4 h-4 mr-3 text-amber-500"}),s.jsxs("span",{className:"font-medium",children:["Cr par ",he.createur_nom||"Inconnu"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-4",children:[s.jsx("span",{children:"Actif depuis"}),s.jsx("span",{children:new Date(he.created_at).toLocaleDateString("fr-FR")})]}),s.jsx("div",{className:"flex gap-3",children:Do(he)?s.jsx(oe,{size:"lg",variant:"primary",onClick:()=>r(`/clubs/${he.id}`),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:"Accder au club"}):s.jsx(oe,{size:"lg",variant:"primary",onClick:()=>Ro(he.id),className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:"Rejoindre le club"})})]})]},he.id))})]}),s.jsxs(W.section,{id:"publications",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"mb-20 scroll-mt-32",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center justify-center mb-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(mi,{className:"text-white text-xl"})}),"Fil d'Actualit"]}),s.jsx("p",{className:"text-gray-600 text-lg max-w-2xl mx-auto",children:"Partagez vos dcouvertes, discutez avec la communaut et restez connect"})]}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8 mb-12 backdrop-blur-sm",children:s.jsxs("form",{onSubmit:Po,className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg",children:e?.nom?s.jsx("span",{className:"text-white font-bold text-xl",children:e.nom.charAt(0).toUpperCase()}):s.jsx(Qt,{className:"text-white text-xl"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:e?.nom}),s.jsx("p",{className:"text-gray-500",children:"Partagez vos impressions de lecture..."})]})]}),s.jsx(W.div,{whileHover:{scale:1.005},whileTap:{scale:.995},className:"border-2 border-dashed border-gray-300 rounded-2xl p-6 cursor-text bg-gray-50/50 hover:border-blue-400 transition-all duration-300",onClick:()=>ge(!0),children:H?s.jsx("div",{className:"text-gray-800 prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:H}}):s.jsxs("div",{className:"text-gray-400 text-center py-8",children:[s.jsx(as,{className:"mx-auto text-3xl mb-3"}),s.jsx("p",{className:"text-lg",children:"Cliquez pour commencer  crire..."}),s.jsx("p",{className:"text-sm mt-2",children:"Partagez vos citations favorites, vos critiques ou vos dcouvertes"})]})}),Q.length>0&&s.jsx(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-4 border border-green-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(dn,{className:"text-green-600 text-xl"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900",children:"Fichier prt  tre publi"}),s.jsx("p",{className:"text-green-700 text-sm",children:Q[0].url.split("/").pop()})]})]}),s.jsx("button",{onClick:()=>ae([]),className:"text-red-500 hover:text-red-700 transition-colors p-2 hover:bg-red-50 rounded-xl",children:s.jsx(ot,{size:20})})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[s.jsx("div",{className:"flex gap-2",children:[{type:"image",icon:Fl,color:"blue",label:"Image"},{type:"video",icon:Ur,color:"purple",label:"Vido"},{type:"file",icon:dn,color:"green",label:"Document"}].map(({type:he,icon:Pe,color:tt,label:xt})=>s.jsxs(W.button,{type:"button",whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:()=>Hn(he),className:`flex items-center gap-2 px-4 py-3 rounded-xl font-medium transition-all duration-200
                        text-${tt}-600 bg-${tt}-50 hover:bg-${tt}-100 border border-${tt}-200 hover:border-${tt}-300`,children:[s.jsx(Pe,{size:18}),xt]},he))}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:O||!H.trim()&&Q.length===0,className:"px-8 py-4 rounded-2xl font-semibold bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl",children:O?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Publication en cours..."]}):"Publier"})})]})]})}),s.jsx(ac,{isOpen:ce,onClose:()=>ge(!1),className:"max-w-4xl rounded-3xl overflow-hidden shadow-2xl",children:s.jsxs("div",{className:"p-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Crer une publication"}),s.jsx("button",{onClick:()=>ge(!1),className:"p-3 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsx(ku,{theme:"snow",value:H,onChange:V,modules:Ge,className:"bg-white rounded-xl border border-gray-200 min-h-[400px] mb-8"}),s.jsxs("div",{className:"flex justify-end gap-4",children:[s.jsx(oe,{variant:"outline",onClick:()=>ge(!1),size:"lg",className:"px-8 py-3 rounded-2xl",children:"Annuler"}),s.jsx(oe,{onClick:()=>ge(!1),size:"lg",className:"px-8 py-3 rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:"Enregistrer"})]})]})}),s.jsx(zs,{children:K&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>se(!1),children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-3xl p-8 w-full max-w-2xl shadow-2xl border border-gray-200",onClick:he=>he.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[te==="image"&&" Ajouter une image",te==="video"&&" Ajouter une vido",te==="file"&&" Ajouter un document"]}),s.jsx("button",{onClick:()=>se(!1),className:"p-3 hover:bg-gray-100 rounded-2xl transition-colors",children:s.jsx(ot,{size:20})})]}),s.jsx(US,{onMediasUploaded:Ce?Vn:Mo,maxFiles:1,accept:te==="image"?"image/*":te==="video"?"video/*":"application/pdf,.doc,.docx,.txt,.ppt,.pptx"})]})})}),s.jsx(zs,{children:F&&D.length===0?s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-lg border border-gray-200 p-16 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-600 border-t-transparent mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-600",children:"Chargement des publications..."})]}):D.length===0?s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-lg border border-gray-200 p-16 text-center",children:[s.jsx(mi,{className:"mx-auto text-6xl text-gray-300 mb-6"}),s.jsx("h3",{className:"text-2xl font-semibold text-gray-600 mb-4",children:"Aucune publication"}),s.jsx("p",{className:"text-gray-500 text-lg mb-8",children:"Soyez le premier  partager vos dcouvertes littraires !"}),s.jsx(oe,{onClick:()=>ge(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 px-8 py-4 rounded-2xl font-semibold",children:"Crer une publication"})]}):s.jsx("div",{className:"space-y-8",children:D.map((he,Pe)=>s.jsxs(W.article,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:Pe*.1},whileHover:{y:-2},className:"bg-white rounded-3xl shadow-lg border border-gray-200 p-8 hover:shadow-xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg",children:he.auteur_nom?s.jsx("span",{className:"text-white font-bold text-2xl",children:he.auteur_nom.charAt(0).toUpperCase()}):s.jsx(Qt,{className:"text-white text-xl"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-900 text-xl",children:he.auteur_nom||"Utilisateur"}),s.jsx("p",{className:"text-gray-500",children:new Date(he.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e?.id===he.auteur_id&&s.jsxs("div",{className:"relative",children:[s.jsxs(W.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>_e(we===he.id?null:he.id),className:"p-3 hover:bg-gray-100 rounded-2xl text-gray-500 transition-colors",children:[s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mb-1"}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mb-1"}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"})]}),s.jsx(zs,{children:we===he.id&&s.jsxs(W.div,{initial:{opacity:0,scale:.8,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-10},className:"absolute right-0 top-14 bg-white border border-gray-200 rounded-2xl shadow-xl py-2 z-10 min-w-48",children:[s.jsxs("button",{onClick:()=>{kc(he),_e(null)},className:"w-full px-6 py-4 text-left hover:bg-gray-50 flex items-center gap-3 text-sm font-medium text-gray-700 transition-colors rounded-t-2xl",children:[s.jsx(as,{size:18}),"Modifier"]}),s.jsxs("button",{onClick:()=>wc(he.id),className:"w-full px-6 py-4 text-left hover:bg-red-50 flex items-center gap-3 text-sm font-medium text-red-600 transition-colors rounded-b-2xl",children:[s.jsx(zt,{size:18}),"Supprimer"]})]})})]})]}),Ce===he.id?Ec(he):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("div",{className:"text-gray-800 leading-relaxed text-lg prose prose-lg max-w-none mb-6",dangerouslySetInnerHTML:{__html:he.contenu}}),va(he)]}),s.jsxs("div",{className:"flex items-center space-x-8 text-gray-600 text-sm mb-6 px-2",children:[s.jsxs("span",{className:"font-semibold flex items-center gap-2",children:[s.jsx($t,{className:"text-red-500"}),he.likes_count||0," j'aime"]}),s.jsxs("span",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Ul,{className:"text-blue-500"}),he.comments_count||0," commentaires"]}),s.jsxs("span",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Yg,{className:"text-green-500"}),he.shares_count||0," partages"]})]}),s.jsx("div",{className:"flex items-center justify-between border-t border-gray-200 pt-6",children:[{icon:$t,label:"J'aime",action:()=>bc(he.id),active:he.user_liked,color:"red"},{icon:Ul,label:"Commenter",action:()=>ue(he),color:"blue"},{icon:Yg,label:"Partager",action:()=>jc(he.id),color:"green"}].map(({icon:tt,label:xt,action:jt,active:$s,color:Tr})=>s.jsxs(W.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:jt,className:`flex items-center space-x-3 px-8 py-4 rounded-2xl transition-all duration-200 font-semibold flex-1 mx-2 justify-center
                                ${$s?`text-${Tr}-600 bg-${Tr}-50 border border-${Tr}-200`:"text-gray-600 hover:bg-gray-50 border border-transparent hover:border-gray-200"}`,children:[s.jsx(tt,{size:20,fill:$s?"currentColor":"none"}),s.jsx("span",{children:xt})]},xt))})]})]},he.id))})}),s.jsx(zS,{post:J,isOpen:!!J,onClose:()=>ue(null),onCommentAdded:Y}),q&&s.jsx(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-8 py-6 rounded-2xl mt-8 text-center shadow-lg",children:s.jsx("p",{className:"font-semibold text-lg",children:q})})]}),s.jsx(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.8},className:"mt-20"})]}),s.jsx(Di,{})]})}const JS=()=>{const[r,e]=R.useState(!1),[t,n]=R.useState(null),i="https://vakio-boky-backend.onrender.com/api";return{loading:r,error:t,sendOrderConfirmation:async u=>{e(!0),n(null);try{const h=await fetch(`${i}/emails/order-confirmation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),c=await h.json();if(!h.ok)throw new Error(c.error||"Erreur lors de l'envoi de l'email");return c}catch(h){throw n(h.message),console.error(" Erreur envoi email confirmation:",h),h}finally{e(!1)}},sendOrderShipped:async u=>{e(!0),n(null);try{const h=await fetch(`${i}/emails/order-shipped`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),c=await h.json();if(!h.ok)throw new Error(c.error||"Erreur lors de l'envoi de l'email");return c}catch(h){throw n(h.message),console.error(" Erreur envoi email expdition:",h),h}finally{e(!1)}},sendOrderCancelled:async u=>{e(!0),n(null);try{const h=await fetch(`${i}/emails/order-cancelled`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),c=await h.json();if(!h.ok)throw new Error(c.error||"Erreur lors de l'envoi de l'email");return c}catch(h){throw n(h.message),console.error(" Erreur envoi email annulation:",h),h}finally{e(!1)}}}},dh=()=>{const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState([]),[o,l]=R.useState(!1),[u,h]=R.useState(null);JS();const{user:c}=st(),f="https://vakio-boky-backend.onrender.com/api",m=async()=>{l(!0),h(null);try{const N=await fetch(`${f}/marketplace`),E=N.headers.get("content-type");if(!E||!E.includes("application/json")){const A=await N.text();throw new Error("Le serveur a renvoy une rponse non-JSON")}const S=await N.json();if(!N.ok)throw new Error(S.error||`Erreur ${N.status}`);if(S.success)e(S.products||[]);else throw new Error(S.error||"Erreur inconnue")}catch(N){h(N.message),console.error(" Erreur rcupration produits:",N)}finally{l(!1)}},g=async()=>{if(c?.token){l(!0),h(null);try{const N=await fetch(`${f}/marketplace/admin`,{headers:{Authorization:`Bearer ${c.token}`}}),E=N.headers.get("content-type");if(!E||!E.includes("application/json")){const A=await N.text();throw new Error("Rponse serveur non-JSON")}const S=await N.json();if(!N.ok)throw new Error(S.error||`Erreur ${N.status}`);if(S.success)n(S.products||[]);else throw new Error(S.error||"Erreur lors du chargement")}catch(N){h(N.message),console.error(" Erreur rcupration produits admin:",N)}finally{l(!1)}}},v=async N=>{if(!c?.token)throw new Error("Non authentifi");l(!0),h(null);try{const E=await fetch(`${f}/marketplace/admin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c.token}`},body:JSON.stringify(N)}),S=E.headers.get("content-type");if(!S||!S.includes("application/json")){const C=await E.text();throw new Error("Rponse serveur non-JSON")}const A=await E.json();if(!E.ok)throw new Error(A.error||`Erreur ${E.status}`);if(A.success)return n(C=>[...C,A.product]),A.product;throw new Error(A.error||"Erreur lors de l'ajout")}catch(E){throw h(E.message),console.error(" Erreur ajout produit:",E),E}finally{l(!1)}},y=async(N,E)=>{if(!c?.token)throw new Error("Non authentifi");l(!0),h(null);try{const S=await fetch(`${f}/marketplace/admin/${N}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c.token}`},body:JSON.stringify(E)}),A=S.headers.get("content-type");if(!A||!A.includes("application/json")){const I=await S.text();throw new Error("Rponse serveur non-JSON")}const C=await S.json();if(!S.ok)throw new Error(C.error||`Erreur ${S.status}`);if(C.success)return n(I=>I.map(L=>L.id===N?C.product:L)),C.product;throw new Error(C.error||"Erreur lors de la modification")}catch(S){throw h(S.message),console.error(" Erreur modification produit:",S),S}finally{l(!1)}},x=async N=>{if(!c?.token)throw new Error("Non authentifi");l(!0),h(null);try{const E=await fetch(`${f}/marketplace/admin/${N}`,{method:"DELETE",headers:{Authorization:`Bearer ${c.token}`}}),S=E.headers.get("content-type");if(!S||!S.includes("application/json")){const C=await E.text();throw new Error("Rponse serveur non-JSON")}const A=await E.json();if(!E.ok)throw new Error(A.error||`Erreur ${E.status}`);if(A.success)return n(C=>C.filter(I=>I.id!==N)),A;throw new Error(A.error||"Erreur lors de la suppression")}catch(E){throw h(E.message),console.error(" Erreur suppression produit:",E),E}finally{l(!1)}},b=async N=>{l(!0),h(null);try{const E=await fetch(`${f}/marketplace/orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c?.token}`},body:JSON.stringify(N)}),S=await E.json();if(!E.ok)throw new Error(S.error||`Erreur ${E.status}`);if(S.success)return await m(),S.order;throw new Error(S.error||"Erreur lors de la cration")}catch(E){throw h(E.message),console.error(" Erreur cration commande:",E),E}finally{l(!1)}},w=async()=>{if(c?.token){l(!0),h(null);try{const N=await fetch(`${f}/marketplace/user/orders`,{headers:{Authorization:`Bearer ${c.token}`}}),E=N.headers.get("content-type");if(!E||!E.includes("application/json")){const A=await N.text();throw new Error("Rponse serveur non-JSON")}const S=await N.json();if(!N.ok)throw new Error(S.error||`Erreur ${N.status}`);if(S.success)a(S.orders||[]);else throw new Error(S.error||"Erreur lors du chargement")}catch(N){h(N.message),console.error(" Erreur rcupration commandes:",N)}finally{l(!1)}}},k=async N=>{l(!0),h(null);try{const E=await fetch(`${f}/marketplace/payments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c?.token}`},body:JSON.stringify(N)}),S=E.headers.get("content-type");if(!S||!S.includes("application/json")){const C=await E.text();throw new Error("Rponse serveur non-JSON")}const A=await E.json();if(!E.ok)throw new Error(A.error||`Erreur ${E.status}`);if(A.success)return await w(),A;throw new Error(A.error||"Erreur lors du paiement")}catch(E){throw h(E.message),console.error(" Erreur traitement paiement:",E),E}finally{l(!1)}};return R.useEffect(()=>{m()},[]),R.useEffect(()=>{c?.token&&w()},[c?.token]),{products:r,adminProducts:t,orders:i,loading:o,error:u,fetchProducts:m,createOrder:b,fetchUserOrders:w,processPayment:k,fetchAdminProducts:g,addProduct:v,updateProduct:y,deleteProduct:x}};function IL({product:r,onOrder:e,isOwned:t=!1,onDownload:n,onRead:i}){const a=l=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(l),o=r.stock_quantity===0;return s.jsxs(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-blue-100",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-blue-100 to-green-100 overflow-hidden",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(xs,{className:"text-4xl text-blue-400"})}),o&&s.jsx("div",{className:"absolute top-3 right-3 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:"Rupture"}),s.jsx("div",{className:"absolute top-3 left-3 bg-blue-600 text-white px-2 py-1 rounded-full text-xs",children:r.category})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-bold text-lg text-blue-900 mb-2 line-clamp-2",children:r.name}),s.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:r.description}),s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-2xl font-bold text-green-600",children:a(r.price)}),s.jsx("span",{className:`text-sm ${r.stock_quantity>5?"text-green-600":r.stock_quantity>0?"text-orange-600":"text-red-600"}`,children:r.stock_quantity>0?`${r.stock_quantity} en stock`:"Rupture de stock"})]}),t&&r.file_url?s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"primary",size:"sm",onClick:()=>n(r),className:"flex-1 flex items-center justify-center gap-2",children:[s.jsx(Qu,{}),"Tlcharger"]}),s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>i(r),className:"flex-1 flex items-center justify-center gap-2",children:[s.jsx(t0,{}),"Lire"]})]}):s.jsxs(oe,{variant:o?"secondary":"primary",size:"sm",onClick:()=>e(r),disabled:o,className:"w-full flex items-center justify-center gap-2",children:[s.jsx(qr,{}),o?"Rupture":"Commander"]})]})]})}function BL({product:r,isOpen:e,onClose:t,onSubmit:n,loading:i=!1}){const[a,o]=R.useState(1),[l,u]=R.useState(""),[h,c]=R.useState(""),[f,m]=R.useState("mvola"),[g,v]=R.useState("details");if(R.useEffect(()=>{e&&(o(1),u(""),c(""),m("mvola"),v("details"))},[e]),!e||!r)return null;const y=[{id:"mvola",name:"MVola",icon:eu,color:"bg-purple-500",description:"Paiement via MVola (Telma)",testPhone:"03322222222"},{id:"orange_money",name:"Orange Money",icon:eu,color:"bg-orange-500",description:"Paiement via Orange Money",testPhone:"03411111111"},{id:"airtel_money",name:"Airtel Money",icon:eu,color:"bg-red-500",description:"Paiement via Airtel Money",testPhone:"03233333333"},{id:"stripe",name:"Carte Bancaire",icon:Pn,color:"bg-blue-500",description:"Paiement scuris par carte",testCard:"4242 4242 4242 4242"},{id:"paypal",name:"PayPal",icon:ln,color:"bg-blue-400",description:"Payer avec votre compte PayPal"}],x=y.find(E=>E.id===f),b=async E=>{if(E.preventDefault(),a<1||a>r.stock_quantity){alert(" Quantit invalide");return}if(!l.trim()){alert(" Veuillez saisir une adresse de livraison");return}if(["mvola","orange_money","airtel_money"].includes(f)&&!h.trim()){alert(" Veuillez saisir votre numro de tlphone pour le paiement mobile");return}const S={product_id:r.id,quantity:a,shipping_address:l,phone:h.trim(),payment_method:f,total_amount:r.price*a};try{await n(S)}catch(A){console.error("Order submission error:",A)}},w=(r.price*a).toFixed(2),k=()=>s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-100 to-green-100 rounded-lg flex items-center justify-center",children:r.image_url?s.jsx("img",{src:r.image_url,alt:r.name,className:"w-full h-full object-cover rounded-lg"}):s.jsx(xs,{className:"text-2xl text-blue-400"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:r.name}),s.jsx("p",{className:"text-2xl font-bold text-green-600 mb-2",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(r.price)}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Stock:"," ",s.jsx("span",{className:"font-semibold",children:r.stock_quantity})," ","units"]})]})]})}),s.jsxs("form",{onSubmit:E=>{E.preventDefault(),v("payment")},className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantit"}),s.jsx(Ve,{type:"number",min:"1",max:r.stock_quantity,value:a,onChange:E=>o(parseInt(E.target.value)||1),required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(Mn,{}),"Adresse de livraison"]}),s.jsx("textarea",{value:l,onChange:E=>u(E.target.value),placeholder:"Saisissez votre adresse complte de livraison...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",required:!0})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Sous-total:"}),s.jsxs("span",{children:[(r.price*a).toFixed(2)," "]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Livraison:"}),s.jsx("span",{className:"text-green-600",children:"Gratuite"})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-2 flex justify-between font-semibold",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{className:"text-lg text-green-600",children:[w," "]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:t,disabled:i,className:"flex-1",children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",disabled:i||r.stock_quantity===0,className:"flex-1",children:["Continuer vers le paiement",s.jsx(Pn,{className:"ml-2"})]})]})]})]}),N=()=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>v("details"),className:"text-gray-600 hover:text-gray-900 transition-colors",children:" Retour"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 flex-1 text-center",children:"Slection du paiement"}),s.jsx("div",{className:"w-6"})]}),s.jsxs("form",{onSubmit:b,className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Choisissez votre mthode de paiement"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:y.map(E=>s.jsxs(W.button,{type:"button",whileTap:{scale:.95},whileHover:{scale:1.02},onClick:()=>m(E.id),className:`
                  relative p-4 rounded-xl border-2 transition-all duration-200
                  ${f===E.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 bg-white hover:border-gray-300"}
                `,children:[s.jsxs("div",{className:"flex flex-col items-center text-center",children:[s.jsx("div",{className:`w-10 h-10 ${E.color} rounded-lg flex items-center justify-center mb-2`,children:s.jsx(E.icon,{className:"text-white text-lg"})}),s.jsx("span",{className:"font-medium text-gray-900 text-sm mb-1",children:E.name}),s.jsx("span",{className:"text-xs text-gray-600",children:E.description})]}),f===E.id&&s.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx(ms,{className:"text-white text-xs"})})]},E.id))})]}),["mvola","orange_money","airtel_money"].includes(f)&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Votre numro de tlphone ",x?.name,!1]}),s.jsx(Ve,{type:"tel",value:h,onChange:E=>c(E.target.value),placeholder:`Ex: ${x?.testPhone||"034 12 345 67"}`,required:!0})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Produit:"}),s.jsx("span",{className:"text-sm font-medium",children:r.name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Quantit:"}),s.jsx("span",{className:"text-sm font-medium",children:a})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Mthode de paiement:"}),s.jsx("span",{className:"text-sm font-medium capitalize",children:f.replace("_"," ")})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-2 flex justify-between font-semibold",children:[s.jsx("span",{children:"Total  payer:"}),s.jsxs("span",{className:"text-lg text-green-600",children:[w," "]})]})]}),!1,s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:()=>v("details"),disabled:i,className:"flex-1",children:"Retour"}),s.jsx(oe,{type:"submit",variant:"primary",disabled:i||r.stock_quantity===0,className:"flex-1",children:i?s.jsxs("span",{className:"flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2 text-white",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Traitement..."]}):s.jsxs(s.Fragment,{children:["Confirmer et payer",s.jsx(ms,{className:"ml-2"})]})})]})]})]});return s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:E=>E.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-blue-900 flex items-center gap-2",children:[s.jsx(xs,{}),g==="details"?"Passer commande":"Paiement"]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),g==="details"?k():N()]})})}function FL({isOpen:r,onClose:e,order:t,product:n,payment:i}){if(!r||!t||!n)return null;const a=h=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(h),o=h=>({mvola:"MVola",orange_money:"Orange Money",airtel_money:"Airtel Money",stripe:"Carte Bancaire",paypal:"PayPal"})[h]||h,u=i?(h=>["mvola","orange_money","airtel_money"].includes(h)?eu:Pn)(i.method):Pn;return s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),children:[s.jsxs("div",{className:"bg-green-500 text-white p-6 rounded-t-xl text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(ms,{size:32})}),s.jsx("h2",{className:"text-2xl font-bold",children:"Commande Confirme !"}),s.jsx("p",{className:"opacity-90 mt-2",children:"Votre commande a t passe avec succs"}),i?.mock&&s.jsxs("div",{className:"mt-3 inline-flex items-center gap-1 bg-white bg-opacity-20 px-3 py-1 rounded-full text-xs",children:[s.jsx(hP,{size:12}),s.jsx("span",{children:"Paiement simul"})]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[n.image_url?s.jsx("img",{src:n.image_url,alt:n.name,className:"w-16 h-16 object-cover rounded-lg"}):s.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(xs,{className:"text-blue-600",size:24})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:n.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Quantit: ",t.quantity,"  ",a(n.price)]})]})]}),i&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(u,{}),"Paiement ",i.status==="completed"?"russi":"chou"]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Mthode:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:o(i.method)})]}),i.transactionId&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Transaction:"}),s.jsx("span",{className:"text-sm font-mono text-gray-900 truncate max-w-[150px]",children:i.transactionId})]}),i.amount&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Montant:"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:a(i.amount)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Statut:"}),s.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded-full ${i.status==="completed"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:i.status==="completed"?" Russi":" chou"})]})]}),i.mock&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Ceci est une simulation. Aucun vrai paiement n'a t effectu."})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(dP,{}),"Livraison"]}),s.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:t.shipping_address})})]}),s.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Sous-total:"}),s.jsx("span",{children:a(t.total_amount)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Livraison:"}),s.jsx("span",{className:"text-green-600",children:"Gratuite"})]}),s.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t border-gray-200 pt-2",children:[s.jsx("span",{children:"Total:"}),s.jsx("span",{className:"text-green-600",children:a(t.total_amount)})]})]}),s.jsxs("div",{className:"bg-gray-100 p-3 rounded-lg text-center",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Numro de commande"}),s.jsx("p",{className:"font-mono font-bold text-gray-900",children:t.id?.toString().startsWith("CMD-")?t.id:`CMD-${t.id?.toString().padStart(6,"0")}`})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx($r,{className:"text-yellow-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Prochaine tape :"})," Vous recevrez un email de confirmation avec les dtails de suivi de votre commande."]}),i?.mock&&s.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:[s.jsx("strong",{children:"Note :"})," En production, vous recevrez une vraie confirmation de paiement."]})]})]})})]}),s.jsx("div",{className:"flex gap-3 p-6 border-t border-gray-200",children:s.jsx(oe,{variant:"primary",onClick:e,className:"flex-1",children:"Parfait, merci !"})})]})})}const gx=(r,e)=>e.some(t=>r instanceof t);let WN,GN;function zL(){return WN||(WN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UL(){return GN||(GN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xx=new WeakMap,mg=new WeakMap,uh=new WeakMap;function HL(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",a),r.removeEventListener("error",o)},a=()=>{t(aa(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",a),r.addEventListener("error",o)});return uh.set(e,r),e}function VL(r){if(xx.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",o),r.removeEventListener("abort",o)},a=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",a),r.addEventListener("error",o),r.addEventListener("abort",o)});xx.set(r,e)}let yx={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return xx.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return aa(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function ZS(r){yx=r(yx)}function qL(r){return UL().includes(r)?function(...e){return r.apply(vx(this),e),aa(this.request)}:function(...e){return aa(r.apply(vx(this),e))}}function $L(r){return typeof r=="function"?qL(r):(r instanceof IDBTransaction&&VL(r),gx(r,zL())?new Proxy(r,yx):r)}function aa(r){if(r instanceof IDBRequest)return HL(r);if(mg.has(r))return mg.get(r);const e=$L(r);return e!==r&&(mg.set(r,e),uh.set(e,r)),e}const vx=r=>uh.get(r);function WL(r,e,{blocked:t,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(r,e),l=aa(o);return n&&o.addEventListener("upgradeneeded",u=>{n(aa(o.result),u.oldVersion,u.newVersion,aa(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const GL=["get","getKey","getAll","getAllKeys","count"],YL=["put","add","delete","clear"],pg=new Map;function YN(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(pg.get(e))return pg.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=YL.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||GL.includes(t)))return;const a=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),i&&u.done]))[0]};return pg.set(e,a),a}ZS(r=>({...r,get:(e,t,n)=>YN(e,t)||r.get(e,t,n),has:(e,t)=>!!YN(e,t)||r.has(e,t)}));const KL=["continue","continuePrimaryKey","advance"],KN={},bx=new WeakMap,e_=new WeakMap,XL={get(r,e){if(!KL.includes(e))return r[e];let t=KN[e];return t||(t=KN[e]=function(...n){bx.set(this,e_.get(this)[e](...n))}),t}};async function*QL(...r){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...r)),!e)return;e=e;const t=new Proxy(e,XL);for(e_.set(t,e),uh.set(t,vx(e));e;)yield t,e=await(bx.get(t)||e.continue()),bx.delete(t)}function XN(r,e){return e===Symbol.asyncIterator&&gx(r,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&gx(r,[IDBIndex,IDBObjectStore])}ZS(r=>({...r,get(e,t,n){return XN(e,t)?QL:r.get(e,t,n)},has(e,t){return XN(e,t)||r.has(e,t)}}));const JL="VakioBokyEbooks",ZL=1,Eu="ebooks",t_=async()=>WL(JL,ZL,{upgrade(r){r.objectStoreNames.contains(Eu)||r.createObjectStore(Eu,{keyPath:"id"})}}),e5=async r=>{await(await t_()).put(Eu,r)},s_=async r=>await(await t_()).get(Eu,r),t5=()=>{const[r,e]=R.useState(!1),[t,n]=R.useState(null),[i,a]=R.useState(null);return{paymentLoading:r,paymentError:t,paymentData:i,simulatePayment:async u=>{e(!0),n(null);try{if(await new Promise(c=>setTimeout(c,1500)),Math.random()<.9){const c={success:!0,paymentId:`MOCK_PAY_${Date.now()}`,transactionId:`${u.paymentMethod?.toUpperCase()||"PAY"}_TX_${Date.now()}`,amount:u.amount,currency:u.currency||"MGA",status:"completed",provider:u.paymentMethod,mock:!0,message:"Paiement simul avec succs",timestamp:new Date().toISOString()};return a(c),c}else throw new Error("chec de la simulation de paiement (solde insuffisant)")}catch(h){const c={success:!1,error:h.message,status:"failed",mock:!0};throw n(h.message),a(c),h}finally{e(!1)}},checkPaymentStatus:async u=>new Promise(h=>{setTimeout(()=>{h({id:u,status:"completed",amount:1e3,currency:"MGA",mock:!0})},1e3)})}};function s5(){const{products:r,orders:e,loading:t,error:n,createOrder:i,fetchUserOrders:a,updateOrderPaymentStatus:o}=dh(),{user:l}=st(),{paymentLoading:u,simulatePayment:h}=t5(),{sendOrderConfirmation:c}=JS(),[f,m]=R.useState(null),[g,v]=R.useState(!1),[y,x]=R.useState(!1),[b,w]=R.useState(null),[k,N]=R.useState(!1),[E,S]=R.useState(null),A=B=>{m(B),v(!0)},C=()=>{v(!1),m(null)},I=async B=>{N(!0);try{console.log(" Cration de commande...",B);const z=await i(B);console.log(" Commande cre:",z);const G=l?.email||l?.user?.email,Y=l?.first_name||l?.user?.first_name||"Client";console.log(" Dbut du processus de paiement...");let H;try{H=await h({orderId:z.id||`CMD-${Date.now()}`,amount:f?.price*(B.quantity||1),currency:"MGA",customerName:Y,customerEmail:G,customerPhone:B.phone||this.getTestPhone(B.payment_method),paymentMethod:B.payment_method}),console.log(" Paiement simul:",H),o&&await o(z.id,{payment_status:H.status==="completed"?"paid":"failed",payment_method:B.payment_method,transaction_id:H.transactionId}),S({method:B.payment_method,status:H.status,transactionId:H.transactionId,amount:H.amount,mock:!0})}catch(V){throw console.error(" chec du paiement:",V),S({method:B.payment_method,status:"failed",error:V.message,mock:!0}),new Error(`Paiement chou: ${V.message}`)}if(G)try{console.log(" Envoi email de confirmation :",G),await c({user:{first_name:Y,email:G},order:{order_number:z.id||z.order_number||`CMD-${Date.now()}`,created_at:z.created_at||new Date().toISOString(),total_amount:f?.price*(B.quantity||1),payment_method:B.payment_method,payment_status:H.status},orderItems:[{product_name:f?.name||"Produit",quantity:B.quantity||1,price:f?.price||0}]}),console.log(" Email de confirmation envoy !")}catch(V){console.error(" Email non envoy:",V)}else console.warn(" Aucun email trouv. User object:",l);w({order:z,product:f}),x(!0),v(!1),await a()}catch(z){console.error(" Erreur lors de la commande:",z),alert(`Erreur: ${z.message}`)}finally{N(!1)}},L=()=>{x(!1),w(null),S(null)},M=async B=>{if(B.file_url)try{const z=await s_(B.id);if(z){const O=window.URL.createObjectURL(z.blob),U=document.createElement("a");U.href=O,U.download=`${B.name}.pdf`,document.body.appendChild(U),U.click(),window.URL.revokeObjectURL(O),document.body.removeChild(U);return}const Y=await(await fetch(B.file_url)).blob();await e5({id:B.id,name:B.name,blob:Y,downloadedAt:new Date().toISOString()});const H=window.URL.createObjectURL(Y),V=document.createElement("a");V.href=H,V.download=`${B.name}.pdf`,document.body.appendChild(V),V.click(),window.URL.revokeObjectURL(H),document.body.removeChild(V)}catch(z){console.error("Download failed:",z),alert("Erreur lors du tlchargement")}},D=B=>{window.location.href=`/reader?id=${B.id}`},F=B=>e.some(z=>z.product_id===B&&z.status==="confirmed"),q=[{value:r.length,label:"Produits Disponibles",icon:xs,color:"blue"},{value:e.filter(B=>B.status==="confirmed").length,label:"Commandes Confirmes",icon:Pn,color:"green"},{value:r.reduce((B,z)=>B+(z.sales_count||0),0),label:"Ventes Total",icon:ct,color:"purple"},{value:"100%",label:"Satisfaction",icon:Nt,color:"amber"}];return t&&r.length===0?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-600 border-t-transparent mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600 text-lg",children:"Chargement des produits..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 pb-12",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-center mb-16",children:[s.jsx(W.h1,{initial:{scale:.9},animate:{scale:1},transition:{delay:.2},className:"text-5xl md:text-6xl font-bold bg-gradient-to-br from-gray-900 to-blue-800 bg-clip-text text-transparent mb-6",children:"Marketplace Vakio Boky"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Dcouvrez nos produits exclusifs et soutenez l'initiative Vakio Boky. Chaque achat contribue  promouvoir la littrature malgache."}),!1]}),s.jsx(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mb-16",children:s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:q.map((B,z)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6+z*.1},whileHover:{y:-5,scale:1.02},className:"bg-white rounded-3xl p-6 shadow-lg border border-gray-200 text-center group hover:shadow-xl transition-all duration-300",children:[s.jsx("div",{className:`w-16 h-16 bg-gradient-to-br from-${B.color}-500 to-${B.color}-600 rounded-2xl flex items-center justify-center shadow-lg mx-auto mb-4 group-hover:scale-110 transition-transform duration-300`,children:s.jsx(B.icon,{className:"text-white text-2xl"})}),s.jsx("div",{className:"text-3xl font-bold text-gray-900 mb-2",children:B.value}),s.jsx("div",{className:"text-gray-600 font-semibold text-sm",children:B.label})]},B.label))})}),s.jsxs(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mb-16",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center mb-2",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(xs,{className:"text-white text-xl"})}),"Nos Produits"]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Dcouvrez notre collection exclusive de livres et produits drivs"})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[s.jsx(qr,{className:"text-green-500"}),s.jsxs("span",{children:[r.length," produits disponibles"]}),!1]})]}),n&&s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl mb-6 flex justify-between items-center shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx(ot,{className:"text-red-600"})}),s.jsx("span",{className:"font-medium",children:n})]}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),className:"border-red-200 text-red-700 hover:bg-red-100",children:"Ressayer"})]}),r.length===0?s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white/50 rounded-3xl border-2 border-dashed border-gray-300",children:[s.jsx(xs,{className:"mx-auto text-6xl text-gray-400 mb-4"}),s.jsx("h3",{className:"text-2xl font-semibold text-gray-600 mb-2",children:"Aucun produit disponible"}),s.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:"Revenez bientt pour dcouvrir nos nouvelles collections"})]}):s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:r.map((B,z)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:z*.1},whileHover:{y:-5},children:s.jsx(IL,{product:B,onOrder:A,isOwned:F(B.id),onDownload:M,onRead:D})},B.id))})]}),l&&e.length>0&&s.jsxs(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mb-16",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-10 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-900 flex items-center mb-2",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(Pn,{className:"text-white text-xl"})}),"Mes Commandes"]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Suivez l'tat de vos achats et tlchargez vos produits"})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[s.jsx(ct,{className:"text-blue-500"}),s.jsxs("span",{children:[e.length," commande",e.length>1?"s":""]})]})]}),s.jsx("div",{className:"bg-white rounded-3xl shadow-lg border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"p-6 space-y-4",children:e.map((B,z)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:z*.1},className:"flex items-center justify-between p-4 border border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors duration-200",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center",children:s.jsx(xs,{className:"text-blue-600 text-xl"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:B.product_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Quantit: ",B.quantity,"  Total: ",B.total_amount," "]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:`inline-block px-3 py-1 text-xs rounded-full font-medium ${B.status==="confirmed"?"bg-green-100 text-green-800 border border-green-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`,children:B.status==="confirmed"?" Confirme":" En attente"}),B.payment_method&&s.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border border-blue-200",children:B.payment_method==="mvola"?"MVola":B.payment_method==="orange_money"?"Orange Money":B.payment_method==="airtel_money"?"Airtel Money":B.payment_method}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(B.created_at).toLocaleDateString("fr-FR")})]})]})]}),B.status==="confirmed"&&s.jsxs(oe,{size:"sm",variant:"outline",className:"border-blue-200 text-blue-600 hover:bg-blue-50",onClick:()=>{const G=r.find(Y=>Y.id===B.product_id);G&&M(G)},children:[s.jsx(Qu,{className:"mr-2"}),"Tlcharger"]})]},B.id))})})]})]}),s.jsx(BL,{product:f,isOpen:g,onClose:C,onSubmit:I,loading:k||u}),s.jsx(FL,{isOpen:y,onClose:L,order:b?.order,product:b?.product,payment:E})]})}function r5(){const[r,e]=R.useState({postsCount:0,likesReceivedCount:0,commentsMadeCount:0,clubsJoinedCount:0,eventsRegisteredCount:0,booksPublishedCount:0,excerptsCreatedCount:0,booksReadCount:0,totalReadingTime:0,totalPagesRead:0}),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(null),{user:u,isAuthenticated:h}=st(),c=u?.token,f=u?.user?.id,m=R.useCallback(()=>!(!h||!c||!f||typeof f!="number"||f<1||typeof c!="string"||c.split(".").length!==3),[h,c,f]),g=R.useCallback(async()=>{if(!m()){a("Session invalide. Veuillez vous reconnecter."),n(!1);return}try{n(!0),a(null);const x=new AbortController,b=setTimeout(()=>x.abort(),1e4),w=await fetch("https://vakio-boky-backend.onrender.com/api/profile/statistics",{headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},signal:x.signal});if(clearTimeout(b),!w.ok)throw w.status===401?new Error("Session expire. Veuillez vous reconnecter."):w.status===404?new Error("Endpoint des statistiques non trouv."):new Error(`Erreur serveur: ${w.status} ${w.statusText}`);const k=await w.json();k.success&&k.statistics?(e(k.statistics),l(new Date)):a(k.error||"Format de rponse invalide du serveur")}catch(x){console.error(" [useProfileStatistics] Erreur fetch:",x),x.name==="AbortError"?a("La requte a pris trop de temps. Vrifiez votre connexion."):x.name==="TypeError"&&x.message.includes("fetch")?a("Impossible de se connecter au serveur. Vrifiez votre connexion internet."):a(x.message||"Erreur lors du chargement des statistiques"),e({postsCount:0,likesReceivedCount:0,commentsMadeCount:0,clubsJoinedCount:0,eventsRegisteredCount:0,booksPublishedCount:0,excerptsCreatedCount:0,booksReadCount:0,totalReadingTime:0,totalPagesRead:0})}finally{n(!1)}},[m,c,f]),v=R.useCallback(()=>({postsCount:r.postsCount||0,likesReceivedCount:r.likesReceivedCount||0,commentsMadeCount:r.commentsMadeCount||0,clubsJoinedCount:r.clubsJoinedCount||0,eventsRegisteredCount:r.eventsRegisteredCount||0,booksPublishedCount:r.booksPublishedCount||0,excerptsCreatedCount:r.excerptsCreatedCount||0,booksReadCount:r.booksReadCount||0,totalReadingTime:r.totalReadingTime||0,totalPagesRead:r.totalPagesRead||0,totalActivity:(r.postsCount||0)+(r.commentsMadeCount||0)+(r.booksPublishedCount||0),totalEngagement:(r.clubsJoinedCount||0)+(r.eventsRegisteredCount||0),hasAnyActivity:(r.postsCount||0)>0||(r.commentsMadeCount||0)>0||(r.booksPublishedCount||0)>0}),[r]),y=R.useCallback(()=>{e({postsCount:0,likesReceivedCount:0,commentsMadeCount:0,clubsJoinedCount:0,eventsRegisteredCount:0,booksPublishedCount:0,excerptsCreatedCount:0,booksReadCount:0,totalReadingTime:0,totalPagesRead:0}),a(null),n(!0),l(null)},[]);return R.useEffect(()=>{let x=!0;return(async()=>{if(x)if(m()){if(o&&new Date-o<3e4){n(!1);return}await g()}else n(!1)})(),()=>{x=!1}},[m,g]),R.useEffect(()=>{(!h||!f)&&y()},[h,f,y]),{statistics:v(),rawStatistics:r,loading:t,error:i,refetch:g,reset:y,lastFetchTime:o,hasValidAuth:m(),formattedStats:v()}}function n5({onFileSelect:r,accept:e="image/*",maxSize:t=10*1024*1024,className:n=""}){const[i,a]=R.useState(!1),[o,l]=R.useState(null),u=R.useRef(null),h=v=>{if(v.size>t){alert(`Fichier trop volumineux. Maximum: ${t/1024/1024}MB`);return}if(r(v),v.type.startsWith("image/")){const y=new FileReader;y.onload=x=>l(x.target.result),y.readAsDataURL(v)}else l(null)},c=v=>{v.preventDefault(),a(!0)},f=v=>{v.preventDefault(),a(!1)},m=v=>{v.preventDefault(),a(!1);const y=v.dataTransfer.files;y.length>0&&h(y[0])},g=()=>{u.current?.click()};return s.jsxs("div",{className:`w-full ${n}`,children:[s.jsx("input",{type:"file",ref:u,onChange:v=>v.target.files[0]&&h(v.target.files[0]),accept:e,className:"hidden"}),s.jsx(W.div,{className:`border-2 border-dashed rounded-xl p-6 text-center cursor-pointer transition-colors
          ${i?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}
          ${o?"p-2":"p-6"}`,onDragOver:c,onDragLeave:f,onDrop:m,onClick:g,whileHover:{scale:1.02},whileTap:{scale:.98},children:o?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:o,alt:"Preview",className:"w-full h-32 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),l(null),r(null),u.current.value=""},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):s.jsxs(s.Fragment,{children:[s.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s.jsxs("p",{className:"text-gray-600 mb-1",children:["Glissez-dposez votre fichier ici ou"," ",s.jsx("span",{className:"text-blue-600",children:"cliquez pour parcourir"})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["PNG, JPG, GIF, PDF, DOC jusqu' ",t/1024/1024,"MB"]})]})})]})}function i5({isOpen:r,onClose:e,profileData:t,onProfileUpdate:n}){const{user:i}=st(),[a,o]=R.useState({nom:"",telephone:"",genre_prefere:"",bio:"",accepte_newsletter:!1}),[l,u]=R.useState(null),[h,c]=R.useState(!1),[f,m]=R.useState("");R.useEffect(()=>{r&&t&&(o({nom:t.nom||"",telephone:t.telephone||"",genre_prefere:t.genre_prefere||"",bio:t.bio||"",accepte_newsletter:t.accepte_newsletter||!1}),u(null),m(""))},[r,t]);const g=(x,b)=>{o(w=>({...w,[x]:b}))},v=x=>{u(x)},y=async x=>{x.preventDefault(),c(!0),m("");try{const b=await fetch("https://vakio-boky-backend.onrender.com/api/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.token}`},body:JSON.stringify(a)}),w=await b.json();if(!b.ok)throw new Error(w.error||"Erreur lors de la mise  jour du profil");if(l){const k=new FormData;k.append("profilePicture",l);const N=await fetch("https://vakio-boky-backend.onrender.com/api/profile/picture",{method:"POST",headers:{Authorization:`Bearer ${i.token}`},body:k}),E=await N.json();if(!N.ok)throw new Error(E.error||"Erreur lors de l'upload de la photo");w.user.photo_profil=E.photoUrl}n(w.user),e()}catch(b){console.error("Erreur mise  jour profil:",b),m(b.message)}finally{c(!1)}};return s.jsx(ac,{isOpen:r,onClose:e,title:"Modifier le profil",size:"lg",children:s.jsxs("form",{onSubmit:y,className:"p-6 space-y-6",children:[f&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:f}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Photo de profil"}),s.jsx(n5,{onFileSelect:v,accept:"image/*",maxSize:5*1024*1024,className:"w-full"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Formats accepts: JPG, PNG, GIF. Taille maximale: 5MB"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Nom complet"}),s.jsx(Ve,{variant:"primary",size:"md",type:"text",placeholder:"Votre nom complet",icon:s.jsx(Qt,{className:"text-gray-400"}),value:a.nom,onChange:x=>g("nom",x.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Tlphone"}),s.jsx(Ve,{variant:"primary",size:"md",type:"tel",placeholder:"+261 XX XX XXX XX",icon:s.jsx(Ju,{className:"text-gray-400"}),value:a.telephone,onChange:x=>g("telephone",x.target.value)})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Genre littraire prfr"}),s.jsxs("select",{value:a.genre_prefere,onChange:x=>g("genre_prefere",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"Slectionnez un genre"}),s.jsx("option",{value:"Roman",children:"Roman"}),s.jsx("option",{value:"Posie",children:"Posie"}),s.jsx("option",{value:"Thtre",children:"Thtre"}),s.jsx("option",{value:"Essai",children:"Essai"}),s.jsx("option",{value:"Biographie",children:"Biographie"}),s.jsx("option",{value:"Science-fiction",children:"Science-fiction"}),s.jsx("option",{value:"Fantasy",children:"Fantasy"}),s.jsx("option",{value:"Policier",children:"Policier"}),s.jsx("option",{value:"Historique",children:"Historique"}),s.jsx("option",{value:"Jeunesse",children:"Jeunesse"}),s.jsx("option",{value:"Autre",children:"Autre"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700 block",children:"Biographie"}),s.jsx("textarea",{value:a.bio,onChange:x=>g("bio",x.target.value),placeholder:"Parlez-nous de vous et de votre passion pour la lecture...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",id:"newsletter",checked:a.accepte_newsletter,onChange:x=>g("accepte_newsletter",x.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"newsletter",className:"text-sm text-gray-700",children:"J'accepte de recevoir la newsletter et les actualits de Vakio Boky"})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[s.jsx(oe,{variant:"outline",type:"button",onClick:e,disabled:h,children:"Annuler"}),s.jsx(oe,{variant:"primary",type:"submit",disabled:h,className:"flex items-center gap-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Enregistrement..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Er,{className:"text-sm"}),"Enregistrer"]})})]})]})})}const a5=r=>!r||r==="null"||r==="NULL"||r.trim()===""?null:r.startsWith("http")?r:r.startsWith("/uploads/")?r.includes("//uploads/")?`/uploads/profiles/${r.split("/").pop()}`:r:`/uploads/profiles/${r}`,QN=r=>a5(r);function o5(){const{user:r,isAuthenticated:e}=st(),{statistics:t,loading:n,error:i}=r5(),[a,o]=R.useState(null),[l,u]=R.useState(!0),[h,c]=R.useState(null),[f,m]=R.useState(!1);R.useEffect(()=>{(async()=>{if(!e||!r?.token){u(!1),c("Non authentifi");return}try{u(!0),c(null);const w=await fetch("https://vakio-boky-backend.onrender.com/api/profile",{headers:{Authorization:`Bearer ${r.token}`,"Content-Type":"application/json"}});if(!w.ok)throw new Error(`Erreur HTTP: ${w.status}`);const k=await w.json();if(k.success&&k.user){const N={...k.user,photo_profil:QN(k.user.photo_profil)};o(N)}else c(k.error||"Erreur lors du chargement du profil")}catch(w){console.error("Erreur chargement profil:",w),c(w.message||"Impossible de se connecter au serveur")}finally{u(!1)}})()},[e,r]);const g=b=>{const w={...b,photo_profil:QN(b.photo_profil)};o(w)},v=()=>{m(!0)},y=b=>{if(!b)return"N/A";try{const w=new Date(b);return isNaN(w.getTime())?"N/A":w.getFullYear()}catch{return"N/A"}},x=[{icon:s.jsx(et,{className:"text-blue-600"}),title:"Posts publis",value:t?.postsCount||0,color:"bg-blue-50"},{icon:s.jsx($t,{className:"text-red-600"}),title:"Likes reus",value:t?.likesReceivedCount||0,color:"bg-red-50"},{icon:s.jsx(Ul,{className:"text-green-600"}),title:"Commentaires",value:t?.commentsMadeCount||0,color:"bg-green-50"},{icon:s.jsx(Me,{className:"text-purple-600"}),title:"Clubs rejoints",value:t?.clubsJoinedCount||0,color:"bg-purple-50"},{icon:s.jsx(Je,{className:"text-orange-600"}),title:"vnements",value:t?.eventsRegisteredCount||0,color:"bg-orange-50"},{icon:s.jsx(fs,{className:"text-yellow-600"}),title:"Livres publis",value:t?.booksPublishedCount||0,color:"bg-yellow-50"},{icon:s.jsx(ct,{className:"text-indigo-600"}),title:"Extraits crs",value:t?.excerptsCreatedCount||0,color:"bg-indigo-50"},{icon:s.jsx(et,{className:"text-teal-600"}),title:"Livres lus",value:t?.booksReadCount||0,color:"bg-teal-50"},{icon:s.jsx(ct,{className:"text-cyan-600"}),title:"Temps de lecture (min)",value:t?.totalReadingTime||0,color:"bg-cyan-50"},{icon:s.jsx(et,{className:"text-emerald-600"}),title:"Pages lues",value:t?.totalPagesRead||0,color:"bg-emerald-50"}];return l||n?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Qk,{className:"animate-spin text-4xl text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement de votre profil..."})]})}):e?h||i?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Erreur de chargement"}),s.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:h||i}),s.jsxs("div",{className:"space-x-4",children:[s.jsx(oe,{variant:"primary",onClick:()=>window.location.reload(),children:"Ressayer"}),s.jsx(oe,{variant:"outline",onClick:()=>window.location.href="/",children:"Retour  l'accueil"})]})]})}):a?s.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 px-4 py-8",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-32"}),s.jsxs("div",{className:"px-6 sm:px-8 pb-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-end -mt-16 mb-6",children:["// Profile.jsx - SECTION DE L'IMAGE SEULEMENT (remplace juste cette partie)",s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"w-32 h-32 bg-white rounded-full border-4 border-white shadow-lg flex items-center justify-center overflow-hidden",children:[s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-100 to-purple-100",children:s.jsx("span",{className:"text-4xl font-bold text-blue-600",children:a?.nom?.charAt(0)?.toUpperCase()||"U"})}),a?.photo_profil&&a.photo_profil!=="null"&&a.photo_profil!=="undefined"&&s.jsx("img",{src:`https://vakio-boky-backend.onrender.com${a.photo_profil}`,alt:`Photo de ${a?.nom||"profil"}`,className:"w-full h-full object-cover absolute inset-0",onError:b=>{console.log(" Image non trouve:",b.target.src),b.target.style.display="none"}})]}),s.jsx("button",{onClick:v,className:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700 transition-colors",children:s.jsx(YD,{className:"text-sm"})})]}),s.jsxs("div",{className:"md:ml-6 mt-4 md:mt-0 text-center md:text-left",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a?.nom||"Utilisateur"}),s.jsxs("p",{className:"text-gray-600 mb-2",children:["Membre depuis ",y(a?.created_at)]}),a?.bio&&s.jsx("p",{className:"text-gray-700 max-w-md",children:a.bio})]}),s.jsx("div",{className:"md:ml-auto mt-4 md:mt-0",children:s.jsxs(oe,{variant:"outline",className:"flex items-center gap-2",onClick:v,children:[s.jsx(as,{className:"text-sm"}),"Modifier le profil"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx($r,{className:"text-blue-600 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Email"}),s.jsx("p",{className:"font-medium truncate",children:a?.email||"Non renseign"})]})]}),a?.telephone&&s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx(Ju,{className:"text-green-600 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Tlphone"}),s.jsx("p",{className:"font-medium truncate",children:a.telephone})]})]}),a?.genre_prefere&&s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx(et,{className:"text-purple-600 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Genre prfr"}),s.jsx("p",{className:"font-medium truncate",children:a.genre_prefere})]})]}),a?.role&&a.role!=="user"&&s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx(Qt,{className:"text-orange-600 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500 truncate",children:"Rle"}),s.jsx("p",{className:"font-medium truncate capitalize",children:a.role})]})]})]}),a?.accepte_newsletter!==void 0&&s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-100",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${a.accepte_newsletter?"bg-green-500":"bg-gray-300"}`}),s.jsx("span",{className:"text-sm text-gray-700",children:a.accepte_newsletter?" Abonn  la newsletter":" Non abonn  la newsletter"})]})})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sm:p-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(ct,{className:"text-2xl text-blue-600"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Vos statistiques"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 sm:gap-6",children:x.map((b,w)=>s.jsxs("div",{className:`${b.color} p-4 sm:p-6 rounded-xl border border-gray-100 hover:shadow-md transition-shadow`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[s.jsx("div",{className:"text-xl sm:text-2xl",children:b.icon}),s.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:b.value.toLocaleString()})]}),s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:b.title})]},w))}),t&&s.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Activit totale"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((t.postsCount||0)+(t.commentsMadeCount||0)+(t.booksPublishedCount||0)).toLocaleString()})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Engagement"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((t.clubsJoinedCount||0)+(t.eventsRegisteredCount||0)).toLocaleString()})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Lecture"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.booksReadCount||0," livres"]})]})]}),s.jsx("div",{className:"mt-8 p-6 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl border border-yellow-200",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(fs,{className:"text-yellow-600 text-2xl flex-shrink-0 mt-1"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-900 mb-1",children:"Flicitations pour votre engagement !"}),s.jsx("p",{className:"text-gray-700 text-sm",children:"Vous avez contribu activement  la communaut Vakio Boky. Continuez  partager votre passion pour la littrature !"})]})]})})]}),a&&s.jsx(i5,{isOpen:f,onClose:()=>m(!1),profileData:a,onProfileUpdate:g})]}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Qt,{className:"text-6xl text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Profil non disponible"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Impossible de charger les donnes de votre profil."}),s.jsx(oe,{variant:"primary",onClick:()=>window.location.reload(),children:"Ressayer"})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Qt,{className:"text-6xl text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Veuillez vous connecter pour accder  votre profil."}),s.jsx(oe,{variant:"primary",onClick:()=>window.location.href="/login",children:"Se connecter"})]})})}function l5(){const r=st(),e=r.user?.user,t=r.user?.token,{posts:n,loading:i,error:a,createPost:o,toggleLike:l,sharePost:u,refetch:h}=BS();rh();const[c,f]=R.useState(""),[m,g]=R.useState(!1),[v,y]=R.useState(!1),[x,b]=R.useState("image"),[w,k]=R.useState([]),[N,E]=R.useState(null),[S,A]=R.useState(null),[C,I]=R.useState(null),[L,M]=R.useState(""),[D,F]=R.useState([]),[q,B]=R.useState(!1),z={toolbar:[["bold","italic","underline","strike"],[{header:[1,2,3,!1]}],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]},G=J=>{b(J),y(!0)},Y=async J=>{if(J.preventDefault(),!c.trim()&&w.length===0){alert("Le contenu ou un mdia est requis");return}g(!0);try{let ue="simple",we=null;w.length>0&&(we=w[0].url,w[0].type==="image"?ue="image":w[0].type==="video"?ue="video":ue="document");const Ce=await o({contenu:c,type_post:ue,media_url:we});Ce.success?(f(""),k([]),B(!1),await h()):alert(Ce.error||"Erreur lors de la cration du post")}catch(ue){console.error("Erreur cration post:",ue),alert("Erreur lors de la cration du post")}finally{g(!1)}},H=async J=>{console.log(" Mdias reus:",J),J&&J.length>0&&(k(J),y(!1))},V=async J=>{J&&J.length>0&&(F(J),y(!1))},O=()=>{F([])},U=async J=>{(await l(J)).success||alert("Erreur lors du like")},K=async J=>{const ue=n.find(_e=>_e.id===J);if(!ue)return;if((await u(J)).success){const _e=`Dcouvrez ce post de ${ue.auteur_nom} sur Vakio Boky`,Ce=`${window.location.origin}/post/${J}`;if(navigator.share)try{await navigator.share({title:"Vakio Boky",text:_e,url:Ce})}catch{console.log("Partage annul")}else window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(_e)}&url=${encodeURIComponent(Ce)}`,"_blank")}else alert("Erreur lors du partage")},se=async J=>{if(confirm("tes-vous sr de vouloir supprimer cette publication ?"))try{const we=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${J}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).json();we.success?(await h(),A(null)):alert(we.error||"Erreur lors de la suppression")}catch(ue){console.error("Erreur suppression post:",ue),alert("Erreur lors de la suppression")}},te=async J=>{if(!L.trim()){alert("Le contenu ne peut pas tre vide");return}try{let ue="simple";if(D.length>0){const Le=D[0].type;Le.includes("image")?ue="image":Le.includes("video")?ue="video":ue="document"}else ue=n.find(Qe=>Qe.id===J)?.type_post||"simple";const we={contenu:L,type_post:ue,media_url:D.length>0?D[0].url:null};D.length===0&&(we.media_url=null,we.type_post="simple");const Ce=await(await fetch(`https://vakio-boky-backend.onrender.com/api/posts/${J}`,{method:"PUT",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(we)})).json();Ce.success?(await h(),I(null),M(""),F([])):alert(Ce.error||"Erreur lors de la modification")}catch(ue){console.error("Erreur modification post:",ue),alert("Erreur lors de la modification")}},X=J=>{I(J.id),M(J.contenu),F(J.media_url?[{url:J.media_url,type:J.type_post}]:[])},Q=J=>J.media_url?s.jsxs("div",{className:"mt-4 rounded-xl overflow-hidden border border-gray-200 bg-gray-50 shadow-sm",children:[J.type_post==="image"&&s.jsx("img",{src:J.media_url,alt:"Post media",className:"w-full max-h-96 object-cover cursor-pointer transition-transform hover:scale-105",onClick:()=>window.open(J.media_url,"_blank")}),J.type_post==="video"&&s.jsx("video",{src:J.media_url,controls:!0,className:"w-full max-h-96 bg-black rounded-lg"}),(J.type_post==="document"||J.type_post==="fichier")&&s.jsxs("div",{className:"p-4 flex items-center space-x-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg",children:[s.jsx(dn,{className:"text-blue-600 text-2xl flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-gray-900 truncate",children:"Document joint"}),s.jsx("a",{href:J.media_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm font-medium transition-colors",children:"Tlcharger le fichier"})]})]})]}):null,ae=J=>s.jsxs("div",{className:"mb-4 space-y-4",children:[s.jsx(ku,{theme:"snow",value:L,onChange:M,modules:z,className:"bg-white rounded-lg border border-gray-200 min-h-[150px] mb-4"}),J.media_url&&s.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[s.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Mdia actuel:"}),Q(J),s.jsxs("button",{onClick:O,className:"mt-3 flex items-center gap-2 text-red-600 text-sm font-medium hover:text-red-700 transition-colors",children:[s.jsx(Zk,{size:14}),"Supprimer ce mdia"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>G("image"),className:"flex items-center gap-2 px-4 py-2 border-2 border-blue-200 rounded-xl text-blue-700 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 font-medium",children:[s.jsx(Fl,{size:18}),"Image"]}),s.jsxs("button",{type:"button",onClick:()=>G("video"),className:"flex items-center gap-2 px-4 py-2 border-2 border-purple-200 rounded-xl text-purple-700 hover:bg-purple-50 hover:border-purple-300 transition-all duration-200 font-medium",children:[s.jsx(Ur,{size:18}),"Vido"]}),s.jsxs("button",{type:"button",onClick:()=>G("file"),className:"flex items-center gap-2 px-4 py-2 border-2 border-green-200 rounded-xl text-green-700 hover:bg-green-50 hover:border-green-300 transition-all duration-200 font-medium",children:[s.jsx(dn,{size:18}),"Fichier"]})]}),D.length>0&&s.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:[s.jsx("p",{className:"text-sm font-semibold text-green-900 mb-2",children:"Nouveau mdia:"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-green-800 font-medium",children:D[0].url.split("/").pop()}),s.jsx("button",{onClick:O,className:"text-red-600 hover:text-red-700 transition-colors",children:s.jsx(ot,{size:18})})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(oe,{size:"md",onClick:()=>te(J.id),disabled:!L.trim(),className:"flex-1",children:"Enregistrer les modifications"}),s.jsx(oe,{variant:"outline",size:"md",onClick:()=>{I(null),M(""),F([])},children:"Annuler"})]})]});return i&&n.length===0?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 font-medium",children:"Chargement des publications..."})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 py-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:s.jsxs(W.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"inline-flex items-center gap-3 bg-white/80 backdrop-blur-sm rounded-2xl px-6 py-4 shadow-lg border border-gray-100",children:[s.jsx(et,{className:"text-2xl text-blue-600"}),s.jsxs("div",{children:[s.jsx("h1",{className:"font-bold text-xl text-gray-900",children:"Fil d'Actualit"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Partagez vos dcouvertes littraires"})]})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 mb-8 backdrop-blur-sm",children:s.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:e?.nom?s.jsx("span",{className:"text-white font-bold text-lg",children:e.nom.charAt(0).toUpperCase()}):s.jsx(Qt,{className:"text-white",size:20})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:e?.nom}),s.jsx("p",{className:"text-sm text-gray-500",children:"Quoi de neuf dans vos lectures ?"})]})]}),s.jsx(W.div,{whileHover:{scale:1.005},whileTap:{scale:.995},className:"border-2 border-dashed border-gray-200 rounded-xl p-4 cursor-text bg-gray-50/50 hover:border-blue-300 transition-all duration-200",onClick:()=>B(!0),children:c?s.jsx("div",{className:"text-gray-800 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:c}}):s.jsxs("div",{className:"text-gray-400 text-center py-4",children:[s.jsx(et,{className:"mx-auto text-2xl mb-2"}),s.jsx("p",{children:"Partagez vos impressions de lecture, citations favorites ou recommandations..."})]})}),w.length>0&&s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(dn,{className:"text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900 text-sm",children:"Fichier prt  tre publi"}),s.jsx("p",{className:"text-green-700 text-sm",children:w[0].url.split("/").pop()})]})]}),s.jsx("button",{onClick:()=>k([]),className:"text-red-500 hover:text-red-700 transition-colors p-1",children:s.jsx(ot,{size:18})})]})})]}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[s.jsxs("div",{className:"flex gap-1",children:[s.jsxs(W.button,{type:"button",whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>G("image"),className:"p-3 text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group",title:"Ajouter une image",children:[s.jsx(Fl,{size:20}),s.jsx("span",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Image"})]}),s.jsxs(W.button,{type:"button",whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>G("video"),className:"p-3 text-purple-600 hover:bg-purple-50 rounded-xl transition-all duration-200 group",title:"Ajouter une vido",children:[s.jsx(Ur,{size:20}),s.jsx("span",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Vido"})]}),s.jsxs(W.button,{type:"button",whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>G("file"),className:"p-3 text-green-600 hover:bg-green-50 rounded-xl transition-all duration-200 group",title:"Ajouter un document",children:[s.jsx(dn,{size:20}),s.jsx("span",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"Document"})]})]}),s.jsx(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx(oe,{variant:"primary",size:"lg",type:"submit",disabled:m||!c.trim()&&w.length===0,className:"px-8 font-semibold",children:m?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Publication..."]}):"Publier"})})]})]})}),s.jsx(ac,{isOpen:q,onClose:()=>B(!1),className:"max-w-4xl",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Crer une publication"}),s.jsx("button",{onClick:()=>B(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsx(ku,{theme:"snow",value:c,onChange:f,modules:z,className:"bg-white rounded-lg border border-gray-200 min-h-[300px] mb-6"}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx(oe,{variant:"outline",onClick:()=>B(!1),size:"lg",children:"Annuler"}),s.jsx(oe,{onClick:()=>B(!1),size:"lg",children:"Enregistrer"})]})]})}),s.jsx(zs,{children:v&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",onClick:()=>y(!1),children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl p-6 w-full max-w-2xl shadow-2xl border border-gray-100",onClick:J=>J.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[x==="image"&&" Ajouter une image",x==="video"&&" Ajouter une vido",x==="file"&&" Ajouter un document"]}),s.jsx("button",{onClick:()=>y(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:s.jsx(ot,{size:20})})]}),s.jsx(US,{onMediasUploaded:C?V:H,maxFiles:1,accept:x==="image"?"image/*":x==="video"?"video/*":"application/pdf,.doc,.docx,.txt,.ppt,.pptx"})]})})}),s.jsx(zs,{children:n.length===0?s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-12 text-center",children:[s.jsx(et,{className:"mx-auto text-4xl text-gray-300 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Aucune publication"}),s.jsx("p",{className:"text-gray-500",children:"Soyez le premier  partager vos dcouvertes littraires !"})]}):s.jsx("div",{className:"space-y-6",children:n.map((J,ue)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ue*.1},className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 hover:shadow-xl transition-all duration-300",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:J.auteur_nom?s.jsx("span",{className:"text-white font-bold text-xl",children:J.auteur_nom.charAt(0).toUpperCase()}):s.jsx(Qt,{className:"text-white",size:20})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:J.auteur_nom||"Utilisateur"}),s.jsx("p",{className:"text-gray-500 text-sm",children:new Date(J.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e?.id===J.auteur_id&&s.jsxs("div",{className:"relative",children:[s.jsxs(W.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>A(S===J.id?null:J.id),className:"p-2 hover:bg-gray-100 rounded-xl text-gray-500 transition-colors",children:[s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mb-1"}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full mb-1"}),s.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"})]}),s.jsx(zs,{children:S===J.id&&s.jsx(W.div,{initial:{opacity:0,scale:.8,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.8,y:-10},className:"absolute right-0 top-12 bg-white border border-gray-200 rounded-xl shadow-lg py-2 z-10 min-w-48",children:e?.id===J.auteur_id?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{X(J),A(null)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3 text-sm font-medium text-gray-700",children:[s.jsx(as,{size:16}),"Modifier"]}),s.jsxs("button",{onClick:()=>se(J.id),className:"w-full px-4 py-3 text-left hover:bg-red-50 flex items-center gap-3 text-sm font-medium text-red-600",children:[s.jsx(zt,{size:16}),"Supprimer"]})]}):s.jsx(FS,{contentId:J.id,contentType:"post",reportedUserId:J.auteur_id,reportedUserName:J.auteur_nom,contentPreview:J.contenu.replace(/<[^>]*>/g,"").substring(0,100),variant:"text",className:"w-full px-4 py-3 text-left hover:bg-red-50 flex items-center gap-3 text-sm font-medium text-red-600",onReportSubmitted:()=>A(null)})})})]})]}),C===J.id?ae(J):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"text-gray-800 leading-relaxed text-lg prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:J.contenu}}),Q(J)]}),s.jsxs("div",{className:"flex items-center space-x-8 text-gray-600 text-sm mb-4 px-2",children:[s.jsxs("span",{className:"font-medium",children:[J.likes_count||0," j'aime"]}),s.jsxs("span",{className:"font-medium",children:[J.comments_count||0," commentaires"]}),s.jsxs("span",{className:"font-medium",children:[J.shares_count||0," partages"]})]}),s.jsxs("div",{className:"flex items-center justify-between border-t border-gray-100 pt-4",children:[s.jsxs(W.button,{whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>U(J.id),className:`flex items-center space-x-3 px-6 py-3 rounded-xl transition-all duration-200 font-medium ${J.user_liked?"text-red-600 bg-red-50 border border-red-200":"text-gray-600 hover:bg-gray-50 border border-transparent hover:border-gray-200"}`,children:[s.jsx($t,{size:20,fill:J.user_liked?"currentColor":"none"}),s.jsx("span",{children:"J'aime"})]}),s.jsxs(W.button,{whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>E(J),className:"flex items-center space-x-3 px-6 py-3 rounded-xl text-gray-600 hover:bg-gray-50 border border-transparent hover:border-gray-200 transition-all duration-200 font-medium",children:[s.jsx(Ul,{size:20}),s.jsx("span",{children:"Commenter"})]}),s.jsxs(W.button,{whileHover:{scale:1.05,y:-1},whileTap:{scale:.95},onClick:()=>K(J.id),className:"flex items-center space-x-3 px-6 py-3 rounded-xl text-gray-600 hover:bg-gray-50 border border-transparent hover:border-gray-200 transition-all duration-200 font-medium",children:[s.jsx(Yg,{size:20}),s.jsx("span",{children:"Partager"})]})]})]})]},J.id))})}),s.jsx(zS,{post:N,isOpen:!!N,onClose:()=>E(null),onCommentAdded:h}),a&&s.jsx(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl mt-6 text-center shadow-lg",children:s.jsx("p",{className:"font-medium",children:a})})]})})}const c5=()=>{const{books:r,myBooks:e,loading:t,error:n,success:i,fetchBooks:a,fetchMyBooks:o,createBook:l,updateBook:u,deleteBook:h,clearError:c,clearSuccess:f}=OS(),[m,g]=R.useState(!1),[v,y]=R.useState(null),[x,b]=R.useState("public"),[w,k]=R.useState(""),[N,E]=R.useState("all");R.useEffect(()=>{S()},[x]);const S=async()=>{try{x==="public"?await a():await o()}catch(q){console.error("Erreur chargement livres:",q)}},A=async q=>{try{await l(q),g(!1),S()}catch(B){console.error("Erreur cration livre:",B)}},C=async q=>{try{await u(v.id,q),y(null),S()}catch(B){console.error("Erreur modification livre:",B)}},I=async q=>{if(window.confirm("tes-vous sr de vouloir supprimer ce livre ?"))try{await h(q),S()}catch(B){console.error("Erreur suppression livre:",B)}},L=q=>{y(q)},M=x==="public"?r:e,D=M.filter(q=>{const B=q.titre?.toLowerCase().includes(w.toLowerCase())||q.description?.toLowerCase().includes(w.toLowerCase())||q.genre?.toLowerCase().includes(w.toLowerCase())||q.auteur_nom?.toLowerCase().includes(w.toLowerCase()),z=N==="all"||q.statut===N;return B&&z}),F={total:M.length,published:M.filter(q=>q.statut==="publi").length,draft:M.filter(q=>q.statut==="brouillon").length,archived:M.filter(q=>q.statut==="archiv").length};return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[i&&s.jsx("div",{className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:i}),s.jsx("button",{onClick:f,className:"text-green-700 hover:text-green-900",children:""})]})}),n&&s.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:n}),s.jsx("button",{onClick:c,className:"text-red-700 hover:text-red-900",children:""})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(et,{className:"text-blue-600"}),"Gestion des Livres"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:x==="public"?"Dcouvrez les livres publis par nos auteurs":"Grez votre bibliothque personnelle"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:S,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:[s.jsx(Wr,{className:t?"animate-spin":""}),"Actualiser"]}),x==="mes-livres"&&s.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[s.jsx(bt,{}),"Nouveau Livre"]})]})]})}),x==="mes-livres"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.total})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-green-600",children:"Publis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.published})]}),s.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"Brouillons"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.draft})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Archivs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.archived})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"flex space-x-8 px-6",children:[s.jsxs("button",{className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${x==="public"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>b("public"),children:[s.jsx(et,{className:"w-4 h-4"}),"Livres Publis",s.jsx("span",{className:"ml-1 py-0.5 px-2 rounded-full text-xs bg-gray-100 text-gray-600",children:r.length})]}),s.jsxs("button",{className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${x==="mes-livres"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>b("mes-livres"),children:[s.jsx(et,{className:"w-4 h-4"}),"Mes Livres",s.jsx("span",{className:"ml-1 py-0.5 px-2 rounded-full text-xs bg-gray-100 text-gray-600",children:e.length})]})]})}),s.jsxs("div",{className:"p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher un livre...",value:w,onChange:q=>k(q.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"})]}),x==="mes-livres"&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ko,{className:"text-gray-400 mt-2"}),s.jsxs("select",{value:N,onChange:q=>E(q.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"publi",children:"Publi"}),s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"archiv",children:"Archiv"})]})]})]}),s.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:[D.length," livre(s) trouv(s) sur ",M.length]})]})]}),(m||v)&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:s.jsx(IS,{book:v,onSubmit:v?C:A,onCancel:()=>{g(!1),y(null)}})})}),t?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"text-lg text-gray-600",children:"Chargement des livres..."})}):D.length===0?s.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:[s.jsx(et,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg mb-4",children:w||N!=="all"?"Aucun livre ne correspond  votre recherche":x==="public"?"Aucun livre publi trouv":"Vous n'avez pas encore cr de livres"}),x==="mes-livres"&&!w&&N==="all"&&s.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:"Crer votre premier livre"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(q=>s.jsx(LS,{book:q,onEdit:L,onDelete:I,showActions:x==="mes-livres"},q.id))})]})};function d5(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState({}),[u,h]=R.useState(""),[c,f]=R.useState(""),m=qs(),g=Yr(),{user:v,logout:y}=st(),x=async()=>{if(n(!0),a(null),!v?.token){m("/login",{state:{from:g.pathname,message:"Veuillez vous connecter."},replace:!0});return}try{const A=await fetch("https://vakio-boky-backend.onrender.com/api/clubs",{headers:{Authorization:`Bearer ${v.token}`}});if(A.status===401||A.status===403){y(),m("/login",{state:{from:g.pathname,message:"Session expire."},replace:!0});return}const C=await A.json();C.success?e(C.clubs):a(C.message||"Erreur lors du chargement des clubs")}catch(A){console.error(A),a("Erreur lors du chargement des clubs")}finally{n(!1)}};R.useEffect(()=>{x()},[]);const b=r.filter(A=>{const C=A.nom.toLowerCase().includes(u.toLowerCase())||A.description.toLowerCase().includes(u.toLowerCase()),I=!c||A.categorie===c;return C&&I}),w=[...new Set(r.map(A=>A.categorie).filter(Boolean))],k=async A=>{if(confirm("Voulez-vous vraiment supprimer ce club ? Cette action est irrversible."))try{const I=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${A}`,{method:"DELETE",headers:{Authorization:`Bearer ${v.token}`}})).json();I.success?(x(),alert("Club supprim avec succs")):alert(I.message)}catch(C){console.error(C),alert("Erreur lors de la suppression")}},N=async A=>{try{const I=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${A}/join`,{method:"POST",headers:{Authorization:`Bearer ${v.token}`}})).json();I.success?(alert("Vous avez rejoint le club !"),x()):alert(I.message)}catch(C){console.error(C),alert("Erreur lors de l'adhsion")}},E=async A=>{try{const I=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${A}/leave`,{method:"POST",headers:{Authorization:`Bearer ${v.token}`}})).json();I.success?(alert("Vous avez quitt le club"),x()):alert(I.message)}catch(C){console.error(C),alert("Erreur lors de la dsinscription")}},S=A=>A.membres_count>0;return t?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100",children:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"text-blue-800 text-lg",children:"Chargement des clubs..."})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[s.jsxs(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[s.jsx(W.h1,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"text-3xl md:text-5xl font-bold text-blue-900 mb-4",children:"Communaut des Clubs Littraires"}),s.jsx("p",{className:"text-blue-600 text-lg mb-8 max-w-2xl mx-auto",children:"Dcouvrez, rejoignez et animez des clubs de lecture passionnants. Partagez vos dcouvertes, organisez des vnements et rencontrez d'autres passionns."}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-center items-center mb-8",children:[s.jsxs("div",{className:"relative w-full md:w-96",children:[s.jsx("input",{type:"text",placeholder:"Rechercher un club...",value:u,onChange:A=>h(A.target.value),className:"w-full px-4 py-3 pl-12 rounded-2xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),s.jsx("svg",{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),s.jsxs("select",{value:c,onChange:A=>f(A.target.value),className:"w-full md:w-48 px-4 py-3 rounded-2xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"Toutes les catgories"}),w.map(A=>s.jsx("option",{value:A,children:A},A))]}),s.jsxs(oe,{variant:"primary",size:"lg",onClick:()=>m("/create"),className:"whitespace-nowrap",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Crer un club"]})]})]}),i&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded-lg mb-4 text-center",children:i}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.length}),s.jsx("div",{className:"text-gray-600",children:"Clubs actifs"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.reduce((A,C)=>A+C.membres_count,0)}),s.jsx("div",{className:"text-gray-600",children:"Membres total"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.filter(A=>A.createur_id===v.id).length}),s.jsx("div",{className:"text-gray-600",children:"Mes clubs"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-md p-6 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.filter(A=>A.membres_count>0).length}),s.jsx("div",{className:"text-gray-600",children:"Clubs rejoints"})]})]}),s.jsx(zs,{children:b.length===0?s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl shadow-xl border border-blue-200 p-12 text-center",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucun club trouv"}),s.jsx("p",{className:"text-gray-600 mb-6",children:r.length===0?"Soyez le premier  crer un club littraire !":"Aucun club ne correspond  votre recherche."}),s.jsx(oe,{onClick:()=>m("/create"),children:"Crer le premier club"})]}):s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map((A,C)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.1},className:"bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 relative flex flex-col group",children:[A.createur_id===v.id&&s.jsx("div",{className:"absolute top-4 left-4 bg-purple-600 text-white px-3 py-1 rounded-full text-xs font-semibold z-10",children:"Admin"}),s.jsxs("div",{className:"relative overflow-hidden rounded-t-2xl",children:[s.jsx("img",{src:A.image_url?`https://vakio-boky-backend.onrender.com${A.image_url}`:"/placeholder-club.jpg",alt:A.nom,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300",onError:I=>{I.target.src="/placeholder-club.jpg"}}),s.jsx("div",{className:"absolute top-0 right-0 bg-black bg-opacity-70 text-white px-3 py-1 rounded-bl-lg text-sm",children:A.visibilite})]}),s.jsxs("div",{className:"p-6 flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 flex-1",children:A.nom}),(A.createur_id===v.id||S(A))&&s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>l({...o,[A.id]:!o[A.id]}),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),s.jsx(zs,{children:o[A.id]&&s.jsxs(W.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute right-0 top-10 bg-white shadow-xl rounded-lg p-2 min-w-48 z-20 border border-gray-200",children:[A.createur_id===v.id&&s.jsxs(s.Fragment,{children:[s.jsxs(tr,{to:`/clubs/${A.id}/edit`,className:"flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md text-gray-700",onClick:()=>l({}),children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier le club"]}),s.jsxs(tr,{to:`/clubs/${A.id}/events`,className:"flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md text-gray-700",onClick:()=>l({}),children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Grer les vnements"]}),s.jsxs(tr,{to:`/clubs/${A.id}/members`,className:"flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md text-gray-700",onClick:()=>l({}),children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),"Grer les membres"]}),s.jsx("hr",{className:"my-1"}),s.jsxs("button",{onClick:()=>{k(A.id),l({})},className:"flex items-center w-full px-3 py-2 text-sm hover:bg-red-50 rounded-md text-red-600",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Supprimer le club"]})]}),S(A)&&A.createur_id!==v.id&&s.jsxs("button",{onClick:()=>{E(A.id),l({})},className:"flex items-center w-full px-3 py-2 text-sm hover:bg-red-50 rounded-md text-red-600",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Quitter le club"]})]})})]})]}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:A.description}),s.jsxs("div",{className:"space-y-2 mb-4",children:[A.categorie&&s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),A.categorie]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),A.ville&&A.pays?`${A.ville}, ${A.pays}`:"En ligne"]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),A.membres_count," membre",A.membres_count!==1?"s":""]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[s.jsxs("span",{children:["Cr par ",A.createur_nom||"Inconnu"]}),s.jsx("span",{children:new Date(A.created_at).toLocaleDateString("fr-FR")})]})]}),s.jsx("div",{className:"p-6 pt-0",children:s.jsx("div",{className:"flex gap-3",children:S(A)?s.jsxs(s.Fragment,{children:[s.jsxs(oe,{size:"sm",variant:"primary",onClick:()=>m(`/clubs/${A.id}`),className:"flex-1",children:[s.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Accder"]}),s.jsx(tr,{to:`/clubs/${A.id}/events`,className:"flex items-center justify-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}):s.jsxs(oe,{size:"sm",variant:"primary",onClick:()=>N(A.id),className:"flex-1",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),"Rejoindre"]})})})]},A.id))})})]})})}function u5(){return s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow",children:s.jsx("div",{className:"h-48 bg-gray-200 relative",children:s.jsx("p",{children:"Vakio Boky Initiative..."})})})}const h5=()=>{const[r,e]=R.useState([]),[t,n]=R.useState(!1),[i,a]=R.useState(null),o="https://vakio-boky-backend.onrender.com/api",l=async()=>{n(!0),a(null);try{const f=await fetch(`${o}/campaigns`);if(!f.ok)throw new Error(`Erreur ${f.status}`);const m=await f.json();if(m.success)e(m.campaigns||[]);else throw new Error(m.error||"Erreur inconnue")}catch(f){a(f.message),console.error(" Erreur rcupration campagnes:",f)}finally{n(!1)}},u=async f=>{n(!0),a(null);try{const m=localStorage.getItem("vakio_token"),g=await fetch(`${o}/campaigns`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify(f)});if(!g.ok)throw new Error(`Erreur ${g.status}`);const v=await g.json();if(v.success)return await l(),v.campaign;throw new Error(v.error||"Erreur lors de la cration")}catch(m){throw a(m.message),console.error(" Erreur cration campagne:",m),m}finally{n(!1)}},h=async(f,m)=>{n(!0),a(null);try{const g=localStorage.getItem("vakio_token"),v=await fetch(`${o}/campaigns/${f}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(m)});if(!v.ok)throw new Error(`Erreur ${v.status}`);const y=await v.json();if(y.success)return await l(),y.campaign;throw new Error(y.error||"Erreur lors de la modification")}catch(g){throw a(g.message),console.error(" Erreur modification campagne:",g),g}finally{n(!1)}},c=async f=>{n(!0),a(null);try{const m=localStorage.getItem("vakio_token"),g=await fetch(`${o}/campaigns/${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${m}`}});if(!g.ok)throw new Error(`Erreur ${g.status}`);const v=await g.json();if(v.success)return await l(),v;throw new Error(v.error||"Erreur lors de la suppression")}catch(m){throw a(m.message),console.error(" Erreur suppression campagne:",m),m}finally{n(!1)}};return R.useEffect(()=>{l()},[]),{campaigns:r,loading:t,error:i,fetchCampaigns:l,createCampaign:u,updateCampaign:h,deleteCampaign:c}};function f5({campaign:r,onDonate:e}){const t=Math.min(r.current_amount/r.target_amount*100,100),n=r.end_date?Math.ceil((new Date(r.end_date)-new Date)/(1e3*60*60*24)):null,i=a=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(a);return s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 hover:shadow-xl transition-shadow",children:[s.jsxs("div",{className:"h-48 bg-gray-200 relative",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-100 to-green-100 flex items-center justify-center",children:s.jsx($t,{className:"text-4xl text-blue-600"})}),n!==null&&n>0&&s.jsx("div",{className:"absolute top-3 right-3 bg-white px-3 py-1 rounded-full shadow-sm",children:s.jsxs("span",{className:"text-sm font-semibold text-blue-600 flex items-center gap-1",children:[s.jsx(Je,{size:14}),n," jour",n>1?"s":""]})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2 line-clamp-2",children:r.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:r.description}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[s.jsxs("span",{children:["Collect: ",i(r.current_amount)]}),s.jsxs("span",{children:["Objectif: ",i(r.target_amount)]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${t}%`}})}),s.jsxs("div",{className:"text-right text-xs text-gray-500 mt-1",children:[t.toFixed(1),"% atteint"]})]}),s.jsxs(oe,{variant:"primary",onClick:()=>e(r),className:"w-full flex items-center justify-center gap-2",children:[s.jsx($t,{}),"Faire un don"]})]})]})}const m5=()=>{const[r,e]=R.useState([]),[t,n]=R.useState(!1),[i,a]=R.useState(null),{user:o}=st(),l="https://vakio-boky-backend.onrender.com/api",u=async c=>{if(!o?.token){a("Vous devez tre connect pour effectuer un don"),console.error(" Token manquant pour createDonation");return}n(!0),a(null);try{const f=await fetch(`${l}/donations`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.token}`},body:JSON.stringify(c)}),m=await f.json();if(!f.ok)throw new Error(m.error||`Erreur ${f.status}`);if(m.success)return m.donation;throw new Error(m.error||"Erreur traitement don")}catch(f){throw a(f.message),console.error(" Erreur cration don:",f),f}finally{n(!1)}},h=async()=>{if(!o?.token){console.error(" Token manquant pour fetchUserDonations"),a("Vous devez tre connect");return}n(!0),a(null);try{const c=await fetch(`${l}/donations/user`,{headers:{Authorization:`Bearer ${o.token}`}}),f=await c.json();if(!c.ok)throw new Error(f.error||`Erreur ${c.status}`);if(f.success)e(f.donations||[]);else throw new Error(f.error||"Erreur chargement dons")}catch(c){a(c.message),console.error(" Erreur rcupration dons:",c)}finally{n(!1)}};return R.useEffect(()=>{o&&h()},[o]),{donations:r,loading:t,error:i,createDonation:u,fetchUserDonations:h}};function p5({campaign:r,isOpen:e,onClose:t,onSuccess:n}){const{createDonation:i,loading:a}=m5(),[o,l]=R.useState({amount:"",message:"",anonymous:!1}),u=[5,10,25,50,100],h=async f=>{f.preventDefault();try{const m={campaign_id:r.id,amount:parseFloat(o.amount),message:o.message,anonymous:o.anonymous};await i(m),n(),l({amount:"",message:"",anonymous:!1})}catch(m){console.error(" Erreur don:",m)}},c=f=>{l(m=>({...m,amount:f.toString()}))};return e?s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-md w-full",onClick:f=>f.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx($t,{className:"text-red-500"}),'Soutenir "',r.title,'"']}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("form",{onSubmit:h,className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Choisissez un montant"}),s.jsx("div",{className:"grid grid-cols-3 gap-2",children:u.map(f=>s.jsxs("button",{type:"button",onClick:()=>c(f),className:`p-3 border rounded-lg text-center transition-colors ${o.amount===f.toString()?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-blue-300"}`,children:[f," "]},f))})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ou montant personnalis"}),s.jsx(Ve,{type:"number",step:"0.01",min:"1",value:o.amount,onChange:f=>l(m=>({...m,amount:f.target.value})),placeholder:"Montant en ",required:!0})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message d'encouragement (optionnel)"}),s.jsx("textarea",{value:o.message,onChange:f=>l(m=>({...m,message:f.target.value})),placeholder:"Laissez un message de soutien...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3"})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:o.anonymous,onChange:f=>l(m=>({...m,anonymous:f.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Faire un don anonyme"})]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:t,disabled:a,className:"flex-1",children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",loading:a,disabled:a||!o.amount,className:"flex-1 flex items-center justify-center gap-2",children:[s.jsx(tP,{}),"Faire un don"]})]})]})]})}):null}function g5(){const{campaigns:r,loading:e,error:t,fetchCampaigns:n}=h5(),[i,a]=R.useState(null),[o,l]=R.useState(!1),[u,h]=R.useState("all"),c=v=>{a(v),l(!0)},f=()=>{l(!1),a(null),n()},m=r.reduce((v,y)=>v+(y.amount_raised||0),0);r.reduce((v,y)=>v+(y.donor_count||0),0),r.filter(v=>v.status==="active").length;const g=[{id:"all",label:"Toutes les campagnes"},{id:"active",label:"En cours"},{id:"ending",label:"Bientt termines"},{id:"successful",label:"Russies"}];return e&&r.length===0?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-600 border-t-transparent mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600 text-lg",children:"Chargement des campagnes..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 pb-12",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-center mb-16",children:[s.jsx(W.h1,{initial:{scale:.9},animate:{scale:1},transition:{delay:.2},className:"text-5xl md:text-6xl font-bold bg-gradient-to-br from-gray-900 to-red-800 bg-clip-text text-transparent mb-6",children:"Collecte de Fonds Vakio Boky"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Soutenez nos initiatives et contribuez  promouvoir la littrature malgache. Chaque don fait la diffrence pour notre culture !"})]}),s.jsx(W.section,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"mb-12",children:s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-gray-200",children:s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center mb-2",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-red-500 to-pink-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx($t,{className:"text-white text-lg"})}),"Campagnes de Collecte"]}),s.jsx("p",{className:"text-gray-600",children:"Dcouvrez et soutenez nos projets pour la littrature malgache"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-xl text-gray-600",children:[s.jsx(ko,{size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Filtrer :"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(v=>s.jsx("button",{onClick:()=>h(v.id),className:`px-4 py-2 rounded-xl text-sm font-semibold transition-all duration-300 ${u===v.id?"bg-gradient-to-r from-red-500 to-pink-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:v.label},v.id))})]})]})})}),t&&s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-2xl mb-6 flex justify-between items-center shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx(ot,{className:"text-red-600"})}),s.jsx("span",{className:"font-medium",children:t})]}),s.jsx(oe,{variant:"outline",size:"sm",onClick:n,className:"border-red-200 text-red-700 hover:bg-red-100",children:"Ressayer"})]}),s.jsx(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"mb-16",children:r.length===0?s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16 bg-white/50 rounded-3xl border-2 border-dashed border-gray-300",children:[s.jsx($t,{className:"mx-auto text-6xl text-gray-400 mb-4"}),s.jsx("h3",{className:"text-2xl font-semibold text-gray-600 mb-2",children:"Aucune campagne active"}),s.jsx("p",{className:"text-gray-500 mb-6 max-w-md mx-auto",children:"Revenez bientt pour dcouvrir nos prochaines initiatives de collecte"}),s.jsxs("div",{className:"flex gap-3 justify-center",children:[s.jsx(oe,{variant:"outline",className:"border-gray-300 text-gray-600 hover:bg-gray-50",children:"tre notifi"}),s.jsx(oe,{className:"bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700",children:"Proposer un projet"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[r.length," campagne",r.length>1?"s":"","  soutenir"]}),s.jsx("p",{className:"text-gray-600",children:"Faites partie du mouvement pour la littrature malgache"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[s.jsx(ct,{className:"text-green-500"}),s.jsxs("span",{children:["",m.toLocaleString()," collects au total"]})]})]}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map((v,y)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1+y*.1},whileHover:{y:-5},children:s.jsx(f5,{campaign:v,onDonate:c})},v.id))})]})})]}),s.jsx(p5,{campaign:i,isOpen:o,onClose:()=>l(!1),onSuccess:f})]})}const hh=()=>{const[r,e]=R.useState([]),[t,n]=R.useState(!1),[i,a]=R.useState(null),o=async(N,E={})=>{const S=localStorage.getItem("vakio_token"),A={headers:{"Content-Type":"application/json",...S&&{Authorization:`Bearer ${S}`},...E.headers}},C=await fetch(N,{...A,...E});if(!C.ok)throw new Error(`Erreur ${C.status}: ${C.statusText}`);return C.json()},l=async()=>{n(!0),a(null);try{const N=await o("https://vakio-boky-backend.onrender.com/api/events");if(N.success)e(N.events||[]);else throw new Error(N.error||"Erreur lors du chargement des vnements")}catch(N){console.error(" Erreur fetchEvents:",N),a(N.message)}finally{n(!1)}},u=async()=>{n(!0),a(null);try{const N=await o("https://vakio-boky-backend.onrender.com/api/events/admin/events");if(N.success)e(N.events||[]);else throw new Error(N.error||"Erreur lors du chargement des vnements admin")}catch(N){console.error(" Erreur fetchAdminEvents:",N),a(N.message)}finally{n(!1)}};return{events:r,loading:t,error:i,fetchEvents:l,fetchEventById:async N=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/${N}`);if(E.success)return{success:!0,event:E.event};throw new Error(E.error||"vnement non trouv")}catch(E){return console.error(" Erreur fetchEventById:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},registerToEvent:async N=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/${N}/register`,{method:"POST"});if(E.success)return{success:!0,registration:E.registration,message:E.message};throw new Error(E.error||"Erreur lors de l'inscription")}catch(E){return console.error(" Erreur registerToEvent:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},fetchAdminEvents:u,createEvent:async N=>{n(!0),a(null);try{const E=await o("https://vakio-boky-backend.onrender.com/api/events",{method:"POST",body:JSON.stringify(N)});if(E.success)return await u(),{success:!0,event:E.event};throw new Error(E.error||"Erreur lors de la cration")}catch(E){return console.error(" Erreur createEvent:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},updateEvent:async(N,E)=>{n(!0),a(null);try{const S=await o(`https://vakio-boky-backend.onrender.com/api/events/${N}`,{method:"PUT",body:JSON.stringify(E)});if(S.success)return await u(),{success:!0,event:S.event};throw new Error(S.error||"Erreur lors de la modification")}catch(S){return console.error(" Erreur updateEvent:",S),a(S.message),{success:!1,error:S.message}}finally{n(!1)}},deleteEvent:async N=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/${N}`,{method:"DELETE"});if(E.success)return await u(),{success:!0,message:E.message};throw new Error(E.error||"Erreur lors de la suppression")}catch(E){return console.error(" Erreur deleteEvent:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},approveEvent:async N=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/admin/${N}/approve`,{method:"PUT"});if(E.success)return await u(),{success:!0,event:E.event};throw new Error(E.error||"Erreur lors de l'approbation")}catch(E){return console.error(" Erreur approveEvent:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},rejectEvent:async(N,E)=>{n(!0),a(null);try{const S=await o(`https://vakio-boky-backend.onrender.com/api/events/admin/${N}/reject`,{method:"PUT",body:JSON.stringify({reason:E})});if(S.success)return await u(),{success:!0,event:S.event};throw new Error(S.error||"Erreur lors du rejet")}catch(S){return console.error(" Erreur rejectEvent:",S),a(S.message),{success:!1,error:S.message}}finally{n(!1)}},featureEvent:async(N,E)=>{n(!0),a(null);try{const S=await o(`https://vakio-boky-backend.onrender.com/api/events/admin/${N}/feature`,{method:"PUT",body:JSON.stringify({featured:E})});if(S.success)return await u(),{success:!0,event:S.event};throw new Error(S.error||"Erreur lors de la mise  jour")}catch(S){return console.error(" Erreur featureEvent:",S),a(S.message),{success:!1,error:S.message}}finally{n(!1)}},fetchEventAnalytics:async(N="30d")=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/admin/analytics?range=${N}`);if(E.success)return{success:!0,analytics:E.analytics};throw new Error(E.error||"Erreur lors du chargement des statistiques")}catch(E){return console.error(" Erreur fetchEventAnalytics:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},fetchEventRegistrations:async N=>{n(!0),a(null);try{const E=await o(`https://vakio-boky-backend.onrender.com/api/events/${N}/registrations`);if(E.success)return{success:!0,registrations:E.registrations};throw new Error(E.error||"Erreur lors du chargement des inscriptions")}catch(E){return console.error(" Erreur fetchEventRegistrations:",E),a(E.message),{success:!1,error:E.message}}finally{n(!1)}},clearError:()=>{a(null)}}};function JN({event:r,onRegister:e,user:t}){const n=new Date(r.event_date),a=n<new Date,o=t&&r.registrations?.some(h=>h.user_id===t.id),l=h=>new Intl.DateTimeFormat("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(h),u=()=>{if(!r.max_participants)return"Illimit";const h=r.max_participants-(r.registered_count||0);return`${h} place${h>1?"s":""}`};return s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`\r
        bg-white \r
        rounded-xl \r
        shadow-md \r
        hover:shadow-lg \r
        transition-all \r
        border border-gray-200 \r
        overflow-hidden\r
      `,children:[s.jsxs("div",{className:"relative h-52 bg-gray-100",children:[r.image_url?s.jsx("img",{src:r.image_url,alt:r.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-purple-100 to-pink-100",children:s.jsx(Je,{className:"text-4xl text-purple-500"})}),s.jsx("div",{className:"absolute top-3 left-3 bg-white/85 px-3 py-1 rounded-lg shadow-sm backdrop-blur",children:s.jsxs("span",{className:"text-sm font-medium text-purple-700 flex items-center gap-1",children:[s.jsx(Je,{size:14}),l(n)]})}),r.price>0&&s.jsx("div",{className:"absolute top-3 right-3 bg-white/85 px-3 py-1 rounded-lg shadow-sm backdrop-blur",children:s.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[r.price," "]})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2 line-clamp-2",children:r.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:r.description}),s.jsxs("div",{className:"space-y-2 mb-5",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx(Mn,{className:"text-red-500"}),s.jsx("span",{children:r.location})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx(Me,{className:"text-blue-500"}),s.jsxs("span",{children:[r.registered_count||0," participant",r.registered_count!==1?"s":"",r.max_participants&&`  ${u()}`]})]})]}),t?a?s.jsx(oe,{variant:"secondary",disabled:!0,className:"w-full",children:"vnement termin"}):o?s.jsx(oe,{variant:"success",disabled:!0,className:"w-full",children:" Dj inscrit"}):s.jsx(oe,{variant:"primary",onClick:()=>e(r),disabled:r.max_participants&&(r.registered_count||0)>=r.max_participants,className:"w-full",children:r.max_participants&&(r.registered_count||0)>=r.max_participants?"Complet":"S'inscrire"}):s.jsx(oe,{variant:"secondary",disabled:!0,className:"w-full",children:"Connectez-vous pour vous inscrire"})]})]})}function r_({isOpen:r,onClose:e,onSuccess:t}){const{createEvent:n,loading:i}=hh(),[a,o]=R.useState({title:"",description:"",event_date:"",event_time:"",location:"",max_participants:"",price:"",image_url:""}),l=async h=>{h.preventDefault();try{const c={...a,event_date:`${a.event_date}T${a.event_time}:00`,max_participants:a.max_participants?parseInt(a.max_participants):null,price:a.price?parseFloat(a.price):0};await n(c),t(),o({title:"",description:"",event_date:"",event_time:"",location:"",max_participants:"",price:"",image_url:""})}catch(c){console.error(" Erreur cration vnement:",c)}},u=(h,c)=>{o(f=>({...f,[h]:c}))};return r?s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(bt,{}),"Nouvel vnement"]}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("form",{onSubmit:l,className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre de l'vnement *"}),s.jsx(Ve,{type:"text",value:a.title,onChange:h=>u("title",h.target.value),placeholder:"Ex: Rencontre avec l'auteur malgache",required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{value:a.description,onChange:h=>u("description",h.target.value),placeholder:"Dcrivez l'vnement en dtail...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),s.jsx(Ve,{type:"date",value:a.event_date,onChange:h=>u("event_date",h.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Heure *"}),s.jsx(Ve,{type:"time",value:a.event_time,onChange:h=>u("event_time",h.target.value),required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lieu *"}),s.jsx(Ve,{type:"text",value:a.location,onChange:h=>u("location",h.target.value),placeholder:"Adresse complte ou lieu de l'vnement",icon:s.jsx(Mn,{className:"text-gray-400"}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Participants maximum"}),s.jsx(Ve,{type:"number",min:"1",value:a.max_participants,onChange:h=>u("max_participants",h.target.value),placeholder:"Illimit si vide",icon:s.jsx(Me,{className:"text-gray-400"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix ()"}),s.jsx(Ve,{type:"number",step:"0.01",min:"0",value:a.price,onChange:h=>u("price",h.target.value),placeholder:"Gratuit si 0",icon:s.jsx(Je,{className:"text-gray-400"})})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image (optionnel)"}),s.jsx(Ve,{type:"url",value:a.image_url,onChange:h=>u("image_url",h.target.value),placeholder:"https://example.com/event-image.jpg"})]}),a.image_url&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aperu de l'image"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[s.jsx("img",{src:a.image_url,alt:"Aperu vnement",className:"max-h-32 mx-auto rounded-lg",onError:h=>{h.target.style.display="none"}}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"L'image s'affichera ici si l'URL est valide"})]})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end pt-6 mt-6 border-t border-gray-200",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:e,disabled:i,children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",loading:i,disabled:i,children:[s.jsx(bt,{className:"mr-2"}),"Crer l'vnement"]})]})]})]})}):null}function x5({event:r,isOpen:e,onClose:t,onConfirm:n}){if(!e||!r)return null;const i=new Date(r.event_date),a=l=>new Intl.DateTimeFormat("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(l),o=()=>{if(!r.max_participants)return"Illimit";const l=r.max_participants-(r.registered_count||0);return`${l} place${l>1?"s":""}`};return s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-md w-full",onClick:l=>l.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Je,{className:"text-purple-500"}),"Confirmation d'inscription"]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r.title}),s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[s.jsx(Je,{className:"text-purple-500 flex-shrink-0"}),s.jsx("span",{children:a(i)})]}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[s.jsx(Mn,{className:"text-red-500 flex-shrink-0"}),s.jsx("span",{children:r.location})]}),r.price>0&&s.jsx("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:s.jsxs("span",{children:["Prix: ",r.price," "]})}),s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[s.jsx(Me,{className:"text-blue-500 flex-shrink-0"}),s.jsxs("span",{children:[r.registered_count||0," inscrit",r.registered_count!==1?"s":"",r.max_participants&&`  ${o()} disponible${o()!=="1"?"s":""}`]})]})]}),s.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["tes-vous sr de vouloir vous inscrire  cet vnement ?",r.price>0&&s.jsxs("span",{className:"font-semibold text-green-600 block mt-1",children:["Montant  payer: ",r.price," "]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:t,className:"flex-1",children:"Annuler"}),s.jsx(oe,{type:"button",variant:"primary",onClick:n,className:"flex-1",children:"Confirmer l'inscription"})]})]})]})})}function y5(){const{events:r,loading:e,error:t,fetchEvents:n,registerForEvent:i}=hh(),{user:a,isAdmin:o}=st(),[l,u]=R.useState(null),[h,c]=R.useState(!1),[f,m]=R.useState(!1),g=async k=>{u(k),m(!0)},v=async()=>{if(l)try{await i(l.id),m(!1),u(null)}catch(k){console.error("Erreur inscription:",k)}},y=()=>{c(!1),n()},x=new Date,b=r.filter(k=>new Date(k.event_date)>=x),w=r.filter(k=>new Date(k.event_date)<x);return e&&r.length===0?s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-purple-900",children:"Chargement des vnements..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 pt-20",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[s.jsx(Je,{className:"text-4xl text-purple-600"}),s.jsx("h1",{className:"text-4xl font-bold text-gray-900 font-mono",children:"vnements Vakio Boky"})]}),s.jsx("p",{className:"text-lg text-gray-700 max-w-2xl mx-auto",children:"Dcouvrez nos vnements littraires, rencontres d'auteurs et ateliers d'criture. Rejoignez notre communaut passionne !"})]}),o&&s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"flex justify-end mb-6",children:s.jsxs(oe,{variant:"primary",onClick:()=>c(!0),className:"flex items-center gap-2",children:[s.jsx(bt,{}),"Nouvel vnement"]})}),t&&s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 text-center",children:[" ",t,s.jsx(oe,{variant:"primary",size:"sm",onClick:n,className:"ml-4",children:"Ressayer"})]}),s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mb-12",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 font-mono flex items-center gap-2 mb-6",children:[s.jsx(Je,{className:"text-green-500"}),"vnements  venir (",b.length,")"]}),b.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Je,{className:"text-6xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Aucun vnement  venir pour le moment"}),o&&s.jsxs(oe,{variant:"primary",onClick:()=>c(!0),className:"flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier vnement"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(k=>s.jsx(JN,{event:k,onRegister:g,user:a},k.id))})]}),w.length>0&&s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 font-mono flex items-center gap-2 mb-6",children:[s.jsx(Me,{className:"text-gray-500"}),"vnements passs (",w.length,")"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 opacity-75",children:w.map(k=>s.jsx(JN,{event:k,onRegister:g,user:a},k.id))})]})]}),s.jsx(r_,{isOpen:h,onClose:()=>c(!1),onSuccess:y}),s.jsx(x5,{event:l,isOpen:f,onClose:()=>m(!1),onConfirm:v})]})}var fh,Fe,n_,i_,yo,Xi,ZN,a_,o_,Su={},l_=[],v5=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function gi(r,e){for(var t in e)r[t]=e[t];return r}function c_(r){var e=r.parentNode;e&&e.removeChild(r)}function re(r,e,t){var n,i,a,o={};for(a in e)a=="key"?n=e[a]:a=="ref"?i=e[a]:o[a]=e[a];if(arguments.length>2&&(o.children=arguments.length>3?fh.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(a in r.defaultProps)o[a]===void 0&&(o[a]=r.defaultProps[a]);return au(r,o,n,i,null)}function au(r,e,t,n,i){var a={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++n_};return i==null&&Fe.vnode!=null&&Fe.vnode(a),a}function Vs(){return{current:null}}function kt(r){return r.children}function b5(r,e,t,n,i){var a;for(a in t)a==="children"||a==="key"||a in e||_u(r,a,null,t[a],n);for(a in e)i&&typeof e[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||t[a]===e[a]||_u(r,a,e[a],t[a],n)}function e2(r,e,t){e[0]==="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||v5.test(e)?t:t+"px"}function _u(r,e,t,n,i){var a;e:if(e==="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||e2(r.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||e2(r.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")a=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in r?e.toLowerCase().slice(2):e.slice(2),r.l||(r.l={}),r.l[e+a]=t,t?n||r.addEventListener(e,a?s2:t2,a):r.removeEventListener(e,a?s2:t2,a);else if(e!=="dangerouslySetInnerHTML"){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?r.removeAttribute(e):r.setAttribute(e,t))}}function t2(r){yo=!0;try{return this.l[r.type+!1](Fe.event?Fe.event(r):r)}finally{yo=!1}}function s2(r){yo=!0;try{return this.l[r.type+!0](Fe.event?Fe.event(r):r)}finally{yo=!1}}function ur(r,e){this.props=r,this.context=e}function Yl(r,e){if(e==null)return r.__?Yl(r.__,r.__.__k.indexOf(r)+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?Yl(r):null}function d_(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return d_(r)}}function j5(r){yo?setTimeout(r):a_(r)}function jx(r){(!r.__d&&(r.__d=!0)&&Xi.push(r)&&!Au.__r++||ZN!==Fe.debounceRendering)&&((ZN=Fe.debounceRendering)||j5)(Au)}function Au(){var r,e,t,n,i,a,o,l;for(Xi.sort(function(u,h){return u.__v.__b-h.__v.__b});r=Xi.shift();)r.__d&&(e=Xi.length,n=void 0,i=void 0,o=(a=(t=r).__v).__e,(l=t.__P)&&(n=[],(i=gi({},a)).__v=a.__v+1,q0(l,a,i,t.__n,l.ownerSVGElement!==void 0,a.__h!=null?[o]:null,n,o??Yl(a),a.__h),p_(n,a),a.__e!=o&&d_(a)),Xi.length>e&&Xi.sort(function(u,h){return u.__v.__b-h.__v.__b}));Au.__r=0}function u_(r,e,t,n,i,a,o,l,u,h){var c,f,m,g,v,y,x,b=n&&n.__k||l_,w=b.length;for(t.__k=[],c=0;c<e.length;c++)if((g=t.__k[c]=(g=e[c])==null||typeof g=="boolean"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?au(null,g,null,null,g):Array.isArray(g)?au(kt,{children:g},null,null,null):g.__b>0?au(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)!=null){if(g.__=t,g.__b=t.__b+1,(m=b[c])===null||m&&g.key==m.key&&g.type===m.type)b[c]=void 0;else for(f=0;f<w;f++){if((m=b[f])&&g.key==m.key&&g.type===m.type){b[f]=void 0;break}m=null}q0(r,g,m=m||Su,i,a,o,l,u,h),v=g.__e,(f=g.ref)&&m.ref!=f&&(x||(x=[]),m.ref&&x.push(m.ref,null,g),x.push(f,g.__c||v,g)),v!=null?(y==null&&(y=v),typeof g.type=="function"&&g.__k===m.__k?g.__d=u=h_(g,u,r):u=f_(r,g,m,b,v,u),typeof t.type=="function"&&(t.__d=u)):u&&m.__e==u&&u.parentNode!=r&&(u=Yl(m))}for(t.__e=y,c=w;c--;)b[c]!=null&&(typeof t.type=="function"&&b[c].__e!=null&&b[c].__e==t.__d&&(t.__d=m_(n).nextSibling),x_(b[c],b[c]));if(x)for(c=0;c<x.length;c++)g_(x[c],x[++c],x[++c])}function h_(r,e,t){for(var n,i=r.__k,a=0;i&&a<i.length;a++)(n=i[a])&&(n.__=r,e=typeof n.type=="function"?h_(n,e,t):f_(t,n,n,i,n.__e,e));return e}function Cu(r,e){return e=e||[],r==null||typeof r=="boolean"||(Array.isArray(r)?r.some(function(t){Cu(t,e)}):e.push(r)),e}function f_(r,e,t,n,i,a){var o,l,u;if(e.__d!==void 0)o=e.__d,e.__d=void 0;else if(t==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==r)r.appendChild(i),o=null;else{for(l=a,u=0;(l=l.nextSibling)&&u<n.length;u+=1)if(l==i)break e;r.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function m_(r){var e,t,n;if(r.type==null||typeof r.type=="string")return r.__e;if(r.__k){for(e=r.__k.length-1;e>=0;e--)if((t=r.__k[e])&&(n=m_(t)))return n}return null}function q0(r,e,t,n,i,a,o,l,u){var h,c,f,m,g,v,y,x,b,w,k,N,E,S,A,C=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(u=t.__h,l=e.__e=t.__e,e.__h=null,a=[l]),(h=Fe.__b)&&h(e);try{e:if(typeof C=="function"){if(x=e.props,b=(h=C.contextType)&&n[h.__c],w=h?b?b.props.value:h.__:n,t.__c?y=(c=e.__c=t.__c).__=c.__E:("prototype"in C&&C.prototype.render?e.__c=c=new C(x,w):(e.__c=c=new ur(x,w),c.constructor=C,c.render=N5),b&&b.sub(c),c.props=x,c.state||(c.state={}),c.context=w,c.__n=n,f=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),C.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=gi({},c.__s)),gi(c.__s,C.getDerivedStateFromProps(x,c.__s))),m=c.props,g=c.state,c.__v=e,f)C.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(C.getDerivedStateFromProps==null&&x!==m&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(x,w),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(x,c.__s,w)===!1||e.__v===t.__v){for(e.__v!==t.__v&&(c.props=x,c.state=c.__s,c.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(I){I&&(I.__=e)}),k=0;k<c._sb.length;k++)c.__h.push(c._sb[k]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(x,c.__s,w),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(m,g,v)})}if(c.context=w,c.props=x,c.__P=r,N=Fe.__r,E=0,"prototype"in C&&C.prototype.render){for(c.state=c.__s,c.__d=!1,N&&N(e),h=c.render(c.props,c.state,c.context),S=0;S<c._sb.length;S++)c.__h.push(c._sb[S]);c._sb=[]}else do c.__d=!1,N&&N(e),h=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++E<25);c.state=c.__s,c.getChildContext!=null&&(n=gi(gi({},n),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(v=c.getSnapshotBeforeUpdate(m,g)),A=h!=null&&h.type===kt&&h.key==null?h.props.children:h,u_(r,Array.isArray(A)?A:[A],e,t,n,i,a,o,l,u),c.base=e.__e,e.__h=null,c.__h.length&&o.push(c),y&&(c.__E=c.__=null),c.__e=!1}else a==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=w5(t.__e,e,t,n,i,a,o,u);(h=Fe.diffed)&&h(e)}catch(I){e.__v=null,(u||a!=null)&&(e.__e=l,e.__h=!!u,a[a.indexOf(l)]=null),Fe.__e(I,e,t)}}function p_(r,e){Fe.__c&&Fe.__c(e,r),r.some(function(t){try{r=t.__h,t.__h=[],r.some(function(n){n.call(t)})}catch(n){Fe.__e(n,t.__v)}})}function w5(r,e,t,n,i,a,o,l){var u,h,c,f=t.props,m=e.props,g=e.type,v=0;if(g==="svg"&&(i=!0),a!=null){for(;v<a.length;v++)if((u=a[v])&&"setAttribute"in u==!!g&&(g?u.localName===g:u.nodeType===3)){r=u,a[v]=null;break}}if(r==null){if(g===null)return document.createTextNode(m);r=i?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,m.is&&m),a=null,l=!1}if(g===null)f===m||l&&r.data===m||(r.data=m);else{if(a=a&&fh.call(r.childNodes),h=(f=t.props||Su).dangerouslySetInnerHTML,c=m.dangerouslySetInnerHTML,!l){if(a!=null)for(f={},v=0;v<r.attributes.length;v++)f[r.attributes[v].name]=r.attributes[v].value;(c||h)&&(c&&(h&&c.__html==h.__html||c.__html===r.innerHTML)||(r.innerHTML=c&&c.__html||""))}if(b5(r,m,f,i,l),c)e.__k=[];else if(v=e.props.children,u_(r,Array.isArray(v)?v:[v],e,t,n,i&&g!=="foreignObject",a,o,a?a[0]:t.__k&&Yl(t,0),l),a!=null)for(v=a.length;v--;)a[v]!=null&&c_(a[v]);l||("value"in m&&(v=m.value)!==void 0&&(v!==r.value||g==="progress"&&!v||g==="option"&&v!==f.value)&&_u(r,"value",v,f.value,!1),"checked"in m&&(v=m.checked)!==void 0&&v!==r.checked&&_u(r,"checked",v,f.checked,!1))}return r}function g_(r,e,t){try{typeof r=="function"?r(e):r.current=e}catch(n){Fe.__e(n,t)}}function x_(r,e,t){var n,i;if(Fe.unmount&&Fe.unmount(r),(n=r.ref)&&(n.current&&n.current!==r.__e||g_(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(a){Fe.__e(a,e)}n.base=n.__P=null,r.__c=void 0}if(n=r.__k)for(i=0;i<n.length;i++)n[i]&&x_(n[i],e,t||typeof r.type!="function");t||r.__e==null||c_(r.__e),r.__=r.__e=r.__d=void 0}function N5(r,e,t){return this.constructor(r,t)}function Kl(r,e,t){var n,i,a;Fe.__&&Fe.__(r,e),i=(n=!1)?null:e.__k,a=[],q0(e,r=e.__k=re(kt,null,[r]),i||Su,Su,e.ownerSVGElement!==void 0,i?null:e.firstChild?fh.call(e.childNodes):null,a,i?i.__e:e.firstChild,n),p_(a,r)}function k5(r,e){var t={__c:e="__cC"+o_++,__:r,Consumer:function(n,i){return n.children(i)},Provider:function(n){var i,a;return this.getChildContext||(i=[],(a={})[e]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(function(l){l.__e=!0,jx(l)})},this.sub=function(o){i.push(o);var l=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),l&&l.call(o)}}),n.children}};return t.Provider.__=t.Consumer.contextType=t}fh=l_.slice,Fe={__e:function(r,e,t,n){for(var i,a,o;e=e.__;)if((i=e.__c)&&!i.__)try{if((a=i.constructor)&&a.getDerivedStateFromError!=null&&(i.setState(a.getDerivedStateFromError(r)),o=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(r,n||{}),o=i.__d),o)return i.__E=i}catch(l){r=l}throw r}},n_=0,i_=function(r){return r!=null&&r.constructor===void 0},yo=!1,ur.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=gi({},this.state),typeof r=="function"&&(r=r(gi({},t),this.props)),r&&gi(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),jx(this))},ur.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),jx(this))},ur.prototype.render=kt,Xi=[],a_=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Au.__r=0,o_=0;var on,gg,r2,y_=[],xg=[],n2=Fe.__b,i2=Fe.__r,a2=Fe.diffed,o2=Fe.__c,l2=Fe.unmount;function E5(){for(var r;r=y_.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(ou),r.__H.__h.forEach(wx),r.__H.__h=[]}catch(e){r.__H.__h=[],Fe.__e(e,r.__v)}}Fe.__b=function(r){on=null,n2&&n2(r)},Fe.__r=function(r){i2&&i2(r);var e=(on=r.__c).__H;e&&(gg===on?(e.__h=[],on.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=xg,t.__N=t.i=void 0})):(e.__h.forEach(ou),e.__h.forEach(wx),e.__h=[])),gg=on},Fe.diffed=function(r){a2&&a2(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(y_.push(e)!==1&&r2===Fe.requestAnimationFrame||((r2=Fe.requestAnimationFrame)||S5)(E5)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==xg&&(t.__=t.__V),t.i=void 0,t.__V=xg})),gg=on=null},Fe.__c=function(r,e){e.some(function(t){try{t.__h.forEach(ou),t.__h=t.__h.filter(function(n){return!n.__||wx(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Fe.__e(n,t.__v)}}),o2&&o2(r,e)},Fe.unmount=function(r){l2&&l2(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{ou(n)}catch(i){e=i}}),t.__H=void 0,e&&Fe.__e(e,t.__v))};var c2=typeof requestAnimationFrame=="function";function S5(r){var e,t=function(){clearTimeout(n),c2&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,100);c2&&(e=requestAnimationFrame(t))}function ou(r){var e=on,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),on=e}function wx(r){var e=on;r.__c=r.__(),on=e}function _5(r,e){for(var t in e)r[t]=e[t];return r}function d2(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function u2(r){this.props=r}(u2.prototype=new ur).isPureReactComponent=!0,u2.prototype.shouldComponentUpdate=function(r,e){return d2(this.props,r)||d2(this.state,e)};var h2=Fe.__b;Fe.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),h2&&h2(r)};var A5=Fe.__e;Fe.__e=function(r,e,t,n){if(r.then){for(var i,a=e;a=a.__;)if((i=a.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(r,e)}A5(r,e,t,n)};var f2=Fe.unmount;function v_(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=_5({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return v_(n,e,t)})),r}function b_(r,e,t){return r&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return b_(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.insertBefore(r.__e,r.__d),r.__c.__e=!0,r.__c.__P=t)),r}function yg(){this.__u=0,this.t=null,this.__b=null}function j_(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function Bd(){this.u=null,this.o=null}Fe.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&r.__h===!0&&(r.type=null),f2&&f2(r)},(yg.prototype=new ur).__c=function(r,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var i=j_(n.__v),a=!1,o=function(){a||(a=!0,t.__R=null,i?i(l):l())};t.__R=o;var l=function(){if(!--n.__u){if(n.state.__a){var h=n.state.__a;n.__v.__k[0]=b_(h,h.__c.__P,h.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}},u=e.__h===!0;n.__u++||u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(o,o)},yg.prototype.componentWillUnmount=function(){this.t=[]},yg.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=v_(this.__b,t,n.__O=n.__P)}this.__b=null}var i=e.__a&&re(kt,null,r.fallback);return i&&(i.__h=null),[re(kt,null,e.__a?null:r.children),i]};var m2=function(r,e,t){if(++t[1]===t[0]&&r.o.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.o.size))for(t=r.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.u=t=t[2]}};function C5(r){return this.getChildContext=function(){return r.context},r.children}function T5(r){var e=this,t=r.i;e.componentWillUnmount=function(){Kl(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),r.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,i){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),Kl(re(C5,{context:e.context},r.__v),e.l)):e.l&&e.componentWillUnmount()}function R5(r,e){var t=re(T5,{__v:r,i:e});return t.containerInfo=e,t}(Bd.prototype=new ur).__a=function(r){var e=this,t=j_(e.__v),n=e.o.get(r);return n[0]++,function(i){var a=function(){e.props.revealOrder?(n.push(i),m2(e,r,n)):i()};t?t(a):a()}},Bd.prototype.render=function(r){this.u=null,this.o=new Map;var e=Cu(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return r.children},Bd.prototype.componentDidUpdate=Bd.prototype.componentDidMount=function(){var r=this;this.o.forEach(function(e,t){m2(r,t,e)})};var D5=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,P5=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,M5=typeof document<"u",O5=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(r)};ur.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(ur.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var p2=Fe.event;function L5(){}function I5(){return this.cancelBubble}function B5(){return this.defaultPrevented}Fe.event=function(r){return p2&&(r=p2(r)),r.persist=L5,r.isPropagationStopped=I5,r.isDefaultPrevented=B5,r.nativeEvent=r};var g2={configurable:!0,get:function(){return this.class}},x2=Fe.vnode;Fe.vnode=function(r){var e=r.type,t=r.props,n=t;if(typeof e=="string"){var i=e.indexOf("-")===-1;for(var a in n={},t){var o=t[a];M5&&a==="children"&&e==="noscript"||a==="value"&&"defaultValue"in t&&o==null||(a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&o===!0?o="":/ondoubleclick/i.test(a)?a="ondblclick":/^onchange(textarea|input)/i.test(a+e)&&!O5(t.type)?a="oninput":/^onfocus$/i.test(a)?a="onfocusin":/^onblur$/i.test(a)?a="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(a)?a=a.toLowerCase():i&&P5.test(a)?a=a.replace(/[A-Z0-9]/g,"-$&").toLowerCase():o===null&&(o=void 0),/^oninput$/i.test(a)&&(a=a.toLowerCase(),n[a]&&(a="oninputCapture")),n[a]=o)}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=Cu(t.children).forEach(function(l){l.props.selected=n.value.indexOf(l.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=Cu(t.children).forEach(function(l){l.props.selected=n.multiple?n.defaultValue.indexOf(l.props.value)!=-1:n.defaultValue==l.props.value})),r.props=n,t.class!=t.className&&(g2.enumerable="className"in t,t.className!=null&&(n.class=t.className),Object.defineProperty(n,"className",g2))}r.$$typeof=D5,x2&&x2(r)};var y2=Fe.__r;Fe.__r=function(r){y2&&y2(r),r.__c};const w_=[],Nx=new Map;function $0(r){w_.push(r),Nx.forEach(e=>{k_(e,r)})}function F5(r){r.isConnected&&r.getRootNode&&N_(r.getRootNode())}function N_(r){let e=Nx.get(r);if(!e||!e.isConnected){if(e=r.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");const t=U5();t&&(e.nonce=t);const n=r===document?document.head:r,i=r===document?n.querySelector("script,link[rel=stylesheet],link[as=style],style"):n.firstChild;n.insertBefore(e,i)}Nx.set(r,e),z5(e)}}function z5(r){for(const e of w_)k_(r,e)}function k_(r,e){const{sheet:t}=r,n=t.cssRules.length;e.split("}").forEach((i,a)=>{i=i.trim(),i&&t.insertRule(i+"}",n+a)})}let vg;function U5(){return vg===void 0&&(vg=H5()),vg}function H5(){const r=document.querySelector('meta[name="csp-nonce"]');if(r&&r.hasAttribute("content"))return r.getAttribute("content");const e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&N_(document);var V5=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';$0(V5);class W0{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(e="",t){let{pauseDepths:n}=this;e in n&&(t?delete n[e]:(n[e]-=1,n[e]<=0&&delete n[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function G0(r){r.parentNode&&r.parentNode.removeChild(r)}function Ds(r,e){if(r.closest)return r.closest(e);if(!document.documentElement.contains(r))return null;do{if(q5(r,e))return r;r=r.parentElement||r.parentNode}while(r!==null&&r.nodeType===1);return null}function q5(r,e){return(r.matches||r.matchesSelector||r.msMatchesSelector).call(r,e)}function $5(r,e){let t=r instanceof HTMLElement?[r]:r,n=[];for(let i=0;i<t.length;i+=1){let a=t[i].querySelectorAll(e);for(let o=0;o<a.length;o+=1)n.push(a[o])}return n}const W5=/(top|left|right|bottom|width|height)$/i;function Pl(r,e){for(let t in e)E_(r,t,e[t])}function E_(r,e,t){t==null?r.style[e]="":typeof t=="number"&&W5.test(e)?r.style[e]=`${t}px`:r.style[e]=t}function S_(r){var e,t;return(t=(e=r.composedPath)===null||e===void 0?void 0:e.call(r)[0])!==null&&t!==void 0?t:r.target}let v2=0;function mh(){return v2+=1,"fc-dom-"+v2}function ph(r){r.preventDefault()}function G5(r,e){return t=>{let n=Ds(t.target,r);n&&e.call(n,t,n)}}function __(r,e,t,n){let i=G5(t,n);return r.addEventListener(e,i),()=>{r.removeEventListener(e,i)}}function Y5(r,e,t,n){let i;return __(r,"mouseover",e,(a,o)=>{if(o!==i){i=o,t(a,o);let l=u=>{i=null,n(u,o),o.removeEventListener("mouseleave",l)};o.addEventListener("mouseleave",l)}})}const b2=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function K5(r,e){let t=n=>{e(n),b2.forEach(i=>{r.removeEventListener(i,t)})};b2.forEach(n=>{r.addEventListener(n,t)})}function A_(r){return Object.assign({onClick:r},C_(r))}function C_(r){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(r(e),e.preventDefault())}}}let j2=0;function ma(){return j2+=1,String(j2)}function Y0(){document.body.classList.add("fc-not-allowed")}function K0(){document.body.classList.remove("fc-not-allowed")}function X5(r){r.style.userSelect="none",r.style.webkitUserSelect="none",r.addEventListener("selectstart",ph)}function Q5(r){r.style.userSelect="",r.style.webkitUserSelect="",r.removeEventListener("selectstart",ph)}function J5(r){r.addEventListener("contextmenu",ph)}function Z5(r){r.removeEventListener("contextmenu",ph)}function eI(r){let e=[],t=[],n,i;for(typeof r=="string"?t=r.split(/\s*,\s*/):typeof r=="function"?t=[r]:Array.isArray(r)&&(t=r),n=0;n<t.length;n+=1)i=t[n],typeof i=="string"?e.push(i.charAt(0)==="-"?{field:i.substring(1),order:-1}:{field:i,order:1}):typeof i=="function"&&e.push({func:i});return e}function tI(r,e,t){let n,i;for(n=0;n<t.length;n+=1)if(i=sI(r,e,t[n]),i)return i;return 0}function sI(r,e,t){return t.func?t.func(r,e):rI(r[t.field],e[t.field])*(t.order||1)}function rI(r,e){return!r&&!e?0:e==null?-1:r==null?1:typeof r=="string"||typeof e=="string"?String(r).localeCompare(String(e)):r-e}function ao(r,e){let t=String(r);return"000".substr(0,e-t.length)+t}function Ml(r,e,t){return typeof r=="function"?r(...e):typeof r=="string"?e.reduce((n,i,a)=>n.replace("$"+a,i||""),r):t}function nI(r,e){return r-e}function lu(r){return r%1===0}function iI(r){let e=r.querySelector(".fc-scrollgrid-shrink-frame"),t=r.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!t)throw new Error("needs fc-scrollgrid-shrink-cushion className");return r.getBoundingClientRect().width-e.getBoundingClientRect().width+t.getBoundingClientRect().width}const w2=["years","months","days","milliseconds"],aI=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function rt(r,e){return typeof r=="string"?oI(r):typeof r=="object"&&r?N2(r):typeof r=="number"?N2({[e||"milliseconds"]:r}):null}function oI(r){let e=aI.exec(r);if(e){let t=e[1]?-1:1;return{years:0,months:0,days:t*(e[2]?parseInt(e[2],10):0),milliseconds:t*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function N2(r){let e={years:r.years||r.year||0,months:r.months||r.month||0,days:r.days||r.day||0,milliseconds:(r.hours||r.hour||0)*60*60*1e3+(r.minutes||r.minute||0)*60*1e3+(r.seconds||r.second||0)*1e3+(r.milliseconds||r.millisecond||r.ms||0)},t=r.weeks||r.week;return t&&(e.days+=t*7,e.specifiedWeeks=!0),e}function lI(r,e){return r.years===e.years&&r.months===e.months&&r.days===e.days&&r.milliseconds===e.milliseconds}function kx(r,e){return{years:r.years+e.years,months:r.months+e.months,days:r.days+e.days,milliseconds:r.milliseconds+e.milliseconds}}function cI(r,e){return{years:r.years-e.years,months:r.months-e.months,days:r.days-e.days,milliseconds:r.milliseconds-e.milliseconds}}function dI(r,e){return{years:r.years*e,months:r.months*e,days:r.days*e,milliseconds:r.milliseconds*e}}function uI(r){return oo(r)/365}function hI(r){return oo(r)/30}function oo(r){return Vr(r)/864e5}function Vr(r){return r.years*(365*864e5)+r.months*(30*864e5)+r.days*864e5+r.milliseconds}function X0(r,e){let t=null;for(let n=0;n<w2.length;n+=1){let i=w2[n];if(e[i]){let a=r[i]/e[i];if(!lu(a)||t!==null&&t!==a)return null;t=a}else if(r[i])return null}return t}function Ex(r){let e=r.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return r.days?r.specifiedWeeks&&r.days%7===0?{unit:"week",value:r.days/7}:{unit:"day",value:r.days}:r.months?{unit:"month",value:r.months}:r.years?{unit:"year",value:r.years}:{unit:"millisecond",value:0}}function ki(r,e,t){if(r===e)return!0;let n=r.length,i;if(n!==e.length)return!1;for(i=0;i<n;i+=1)if(!(t?t(r[i],e[i]):r[i]===e[i]))return!1;return!0}const fI=["sun","mon","tue","wed","thu","fri","sat"];function k2(r,e){let t=xi(r);return t[2]+=e*7,rr(t)}function ys(r,e){let t=xi(r);return t[2]+=e,rr(t)}function Ei(r,e){let t=xi(r);return t[6]+=e,rr(t)}function mI(r,e){return pa(r,e)/7}function pa(r,e){return(e.valueOf()-r.valueOf())/(1e3*60*60*24)}function pI(r,e){return(e.valueOf()-r.valueOf())/(1e3*60*60)}function gI(r,e){return(e.valueOf()-r.valueOf())/(1e3*60)}function xI(r,e){return(e.valueOf()-r.valueOf())/1e3}function yI(r,e){let t=Et(r),n=Et(e);return{years:0,months:0,days:Math.round(pa(t,n)),milliseconds:e.valueOf()-n.valueOf()-(r.valueOf()-t.valueOf())}}function vI(r,e){let t=Tu(r,e);return t!==null&&t%7===0?t/7:null}function Tu(r,e){return yi(r)===yi(e)?Math.round(pa(r,e)):null}function Et(r){return rr([r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()])}function bI(r){return rr([r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours()])}function jI(r){return rr([r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes()])}function wI(r){return rr([r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds()])}function NI(r,e,t){let n=r.getUTCFullYear(),i=bg(r,n,e,t);if(i<1)return bg(r,n-1,e,t);let a=bg(r,n+1,e,t);return a>=1?Math.min(i,a):i}function bg(r,e,t,n){let i=rr([e,0,1+kI(e,t,n)]),a=Et(r),o=Math.round(pa(i,a));return Math.floor(o/7)+1}function kI(r,e,t){let n=7+e-t;return-((7+rr([r,0,n]).getUTCDay()-e)%7)+n-1}function E2(r){return[r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()]}function S2(r){return new Date(r[0],r[1]||0,r[2]==null?1:r[2],r[3]||0,r[4]||0,r[5]||0)}function xi(r){return[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()]}function rr(r){return r.length===1&&(r=r.concat([0])),new Date(Date.UTC(...r))}function T_(r){return!isNaN(r.valueOf())}function yi(r){return r.getUTCHours()*1e3*60*60+r.getUTCMinutes()*1e3*60+r.getUTCSeconds()*1e3+r.getUTCMilliseconds()}function R_(r,e,t=!1){let n=r.toISOString();return n=n.replace(".000",""),t&&(n=n.replace("T00:00:00Z","")),n.length>10&&(e==null?n=n.replace("Z",""):e!==0&&(n=n.replace("Z",J0(e,!0)))),n}function Q0(r){return r.toISOString().replace(/T.*$/,"")}function EI(r){return r.toISOString().match(/^\d{4}-\d{2}/)[0]}function SI(r){return ao(r.getUTCHours(),2)+":"+ao(r.getUTCMinutes(),2)+":"+ao(r.getUTCSeconds(),2)}function J0(r,e=!1){let t=r<0?"-":"+",n=Math.abs(r),i=Math.floor(n/60),a=Math.round(n%60);return e?`${t+ao(i,2)}:${ao(a,2)}`:`GMT${t}${i}${a?`:${ao(a,2)}`:""}`}function ze(r,e,t){let n,i;return function(...a){if(!n)i=r.apply(this,a);else if(!ki(n,a)){let o=r.apply(this,a);(!e||!e(o,i))&&(i=o)}return n=a,i}}function cu(r,e,t){let n,i;return a=>(n?Gr(n,a)||(i=r.call(this,a)):i=r.call(this,a),n=a,i)}const jg={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Ru={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},Fd=/\s*([ap])\.?m\.?/i,_I=/,/g,AI=/\s+/g,CI=/\u200e/g,TI=/UTC|GMT/;class RI{constructor(e){let t={},n={},i=9;for(let a in e)a in jg?(n[a]=e[a],jg[a]<9&&(i=Math.min(jg[a],i))):(t[a]=e[a],a in Ru&&(i=Math.min(Ru[a],i)));this.standardDateProps=t,this.extendedSettings=n,this.smallestUnitNum=i,this.buildFormattingFunc=ze(_2)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,n,i){let{standardDateProps:a,extendedSettings:o}=this,l=II(e.marker,t.marker,n.calendarSystem);if(!l)return this.format(e,n);let u=l;u>1&&(a.year==="numeric"||a.year==="2-digit")&&(a.month==="numeric"||a.month==="2-digit")&&(a.day==="numeric"||a.day==="2-digit")&&(u=1);let h=this.format(e,n),c=this.format(t,n);if(h===c)return h;let f=BI(a,u),m=_2(f,o,n),g=m(e),v=m(t),y=FI(h,g,c,v),x=o.separator||i||n.defaultSeparator||"";return y?y.before+g+x+v+y.after:h+x+c}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function _2(r,e,t){let n=Object.keys(r).length;return n===1&&r.timeZoneName==="short"?i=>J0(i.timeZoneOffset):n===0&&e.week?i=>LI(t.computeWeekNumber(i.marker),t.weekText,t.weekTextLong,t.locale,e.week):DI(r,e,t)}function DI(r,e,t){r=Object.assign({},r),e=Object.assign({},e),PI(r,e),r.timeZone="UTC";let n=new Intl.DateTimeFormat(t.locale.codes,r),i;if(e.omitZeroMinute){let a=Object.assign({},r);delete a.minute,i=new Intl.DateTimeFormat(t.locale.codes,a)}return a=>{let{marker:o}=a,l;i&&!o.getUTCMinutes()?l=i:l=n;let u=l.format(o);return MI(u,a,r,e,t)}}function PI(r,e){r.timeZoneName&&(r.hour||(r.hour="2-digit"),r.minute||(r.minute="2-digit")),r.timeZoneName==="long"&&(r.timeZoneName="short"),e.omitZeroMinute&&(r.second||r.millisecond)&&delete e.omitZeroMinute}function MI(r,e,t,n,i){return r=r.replace(CI,""),t.timeZoneName==="short"&&(r=OI(r,i.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":J0(e.timeZoneOffset))),n.omitCommas&&(r=r.replace(_I,"").trim()),n.omitZeroMinute&&(r=r.replace(":00","")),n.meridiem===!1?r=r.replace(Fd,"").trim():n.meridiem==="narrow"?r=r.replace(Fd,(a,o)=>o.toLocaleLowerCase()):n.meridiem==="short"?r=r.replace(Fd,(a,o)=>`${o.toLocaleLowerCase()}m`):n.meridiem==="lowercase"&&(r=r.replace(Fd,a=>a.toLocaleLowerCase())),r=r.replace(AI," "),r=r.trim(),r}function OI(r,e){let t=!1;return r=r.replace(TI,()=>(t=!0,e)),t||(r+=` ${e}`),r}function LI(r,e,t,n,i){let a=[];return i==="long"?a.push(t):(i==="short"||i==="narrow")&&a.push(e),(i==="long"||i==="short")&&a.push(" "),a.push(n.simpleNumberFormat.format(r)),n.options.direction==="rtl"&&a.reverse(),a.join("")}function II(r,e,t){return t.getMarkerYear(r)!==t.getMarkerYear(e)?5:t.getMarkerMonth(r)!==t.getMarkerMonth(e)?4:t.getMarkerDay(r)!==t.getMarkerDay(e)?2:yi(r)!==yi(e)?1:0}function BI(r,e){let t={};for(let n in r)(!(n in Ru)||Ru[n]<=e)&&(t[n]=r[n]);return t}function FI(r,e,t,n){let i=0;for(;i<r.length;){let a=r.indexOf(e,i);if(a===-1)break;let o=r.substr(0,a);i=a+e.length;let l=r.substr(i),u=0;for(;u<t.length;){let h=t.indexOf(n,u);if(h===-1)break;let c=t.substr(0,h);u=h+n.length;let f=t.substr(u);if(o===c&&l===f)return{before:o,after:l}}}return null}function A2(r,e){let t=e.markerToArray(r.marker);return{marker:r.marker,timeZoneOffset:r.timeZoneOffset,array:t,year:t[0],month:t[1],day:t[2],hour:t[3],minute:t[4],second:t[5],millisecond:t[6]}}function Du(r,e,t,n){let i=A2(r,t.calendarSystem),a=e?A2(e,t.calendarSystem):null;return{date:i,start:i,end:a,timeZone:t.timeZone,localeCodes:t.locale.codes,defaultSeparator:n||t.defaultSeparator}}class zI{constructor(e){this.cmdStr=e}format(e,t,n){return t.cmdFormatter(this.cmdStr,Du(e,null,t,n))}formatRange(e,t,n,i){return n.cmdFormatter(this.cmdStr,Du(e,t,n,i))}}class UI{constructor(e){this.func=e}format(e,t,n){return this.func(Du(e,null,t,n))}formatRange(e,t,n,i){return this.func(Du(e,t,n,i))}}function Ft(r){return typeof r=="object"&&r?new RI(r):typeof r=="string"?new zI(r):typeof r=="function"?new UI(r):null}const C2={navLinkDayClick:me,navLinkWeekClick:me,duration:rt,bootstrapFontAwesome:me,buttonIcons:me,customButtons:me,defaultAllDayEventDuration:rt,defaultTimedEventDuration:rt,nextDayThreshold:rt,scrollTime:rt,scrollTimeReset:Boolean,slotMinTime:rt,slotMaxTime:rt,dayPopoverFormat:Ft,slotDuration:rt,snapDuration:rt,headerToolbar:me,footerToolbar:me,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:Ft,dayHeaderClassNames:me,dayHeaderContent:me,dayHeaderDidMount:me,dayHeaderWillUnmount:me,dayCellClassNames:me,dayCellContent:me,dayCellDidMount:me,dayCellWillUnmount:me,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:me,weekNumbers:Boolean,weekNumberClassNames:me,weekNumberContent:me,weekNumberDidMount:me,weekNumberWillUnmount:me,editable:Boolean,viewClassNames:me,viewDidMount:me,viewWillUnmount:me,nowIndicator:Boolean,nowIndicatorSnap:me,nowIndicatorClassNames:me,nowIndicatorContent:me,nowIndicatorDidMount:me,nowIndicatorWillUnmount:me,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:me,locale:me,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:me,eventOrder:eI,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:me,contentHeight:me,direction:String,weekNumberFormat:Ft,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:me,initialDate:me,now:me,eventDataTransform:me,stickyHeaderDates:me,stickyFooterScrollbar:me,viewHeight:me,defaultAllDay:Boolean,eventSourceFailure:me,eventSourceSuccess:me,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:me,eventConstraint:me,eventAllow:me,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:me,eventContent:me,eventDidMount:me,eventWillUnmount:me,selectConstraint:me,selectOverlap:me,selectAllow:me,droppable:Boolean,unselectCancel:String,slotLabelFormat:me,slotLaneClassNames:me,slotLaneContent:me,slotLaneDidMount:me,slotLaneWillUnmount:me,slotLabelClassNames:me,slotLabelContent:me,slotLabelDidMount:me,slotLabelWillUnmount:me,dayMaxEvents:me,dayMaxEventRows:me,dayMinWidth:Number,slotLabelInterval:rt,allDayText:String,allDayClassNames:me,allDayContent:me,allDayDidMount:me,allDayWillUnmount:me,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:Ft,rerenderDelay:Number,moreLinkText:me,moreLinkHint:me,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:me,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:rt,hiddenDays:me,fixedWeekCount:Boolean,validRange:me,visibleRange:me,titleFormat:me,eventInteractive:Boolean,noEventsText:String,viewHint:me,navLinkHint:me,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:me,moreLinkClassNames:me,moreLinkContent:me,moreLinkDidMount:me,moreLinkWillUnmount:me,monthStartFormat:Ft,handleCustomRendering:me,customRenderingMetaMap:me,customRenderingReplaces:Boolean},Ol={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:"  ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},T2={datesSet:me,eventsSet:me,eventAdd:me,eventChange:me,eventRemove:me,windowResize:me,eventClick:me,eventMouseEnter:me,eventMouseLeave:me,select:me,unselect:me,loading:me,_unmount:me,_beforeprint:me,_afterprint:me,_noEventDrop:me,_noEventResize:me,_resize:me,_scrollRequest:me},R2={buttonText:me,buttonHints:me,views:me,plugins:me,initialEvents:me,events:me,eventSources:me},Yi={headerToolbar:Ki,footerToolbar:Ki,buttonText:Ki,buttonHints:Ki,buttonIcons:Ki,dateIncrement:Ki,plugins:zd,events:zd,eventSources:zd,resources:zd};function Ki(r,e){return typeof r=="object"&&typeof e=="object"&&r&&e?Gr(r,e):r===e}function zd(r,e){return Array.isArray(r)&&Array.isArray(e)?ki(r,e):r===e}const HI={type:String,component:me,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:me,usesMinMaxTime:Boolean,classNames:me,content:me,didMount:me,willUnmount:me};function wg(r){return ey(r,Yi)}function Z0(r,e){let t={},n={};for(let i in e)i in r&&(t[i]=e[i](r[i]));for(let i in r)i in e||(n[i]=r[i]);return{refined:t,extra:n}}function me(r){return r}const{hasOwnProperty:Pu}=Object.prototype;function ey(r,e){let t={};if(e){for(let n in e)if(e[n]===Ki){let i=[];for(let a=r.length-1;a>=0;a-=1){let o=r[a][n];if(typeof o=="object"&&o)i.unshift(o);else if(o!==void 0){t[n]=o;break}}i.length&&(t[n]=ey(i))}}for(let n=r.length-1;n>=0;n-=1){let i=r[n];for(let a in i)a in t||(t[a]=i[a])}return t}function ca(r,e){let t={};for(let n in r)e(r[n],n)&&(t[n]=r[n]);return t}function In(r,e){let t={};for(let n in r)t[n]=e(r[n],n);return t}function D_(r){let e={};for(let t of r)e[t]=!0;return e}function ty(r){let e=[];for(let t in r)e.push(r[t]);return e}function Gr(r,e){if(r===e)return!0;for(let t in r)if(Pu.call(r,t)&&!(t in e))return!1;for(let t in e)if(Pu.call(e,t)&&r[t]!==e[t])return!1;return!0}const VI=/^on[A-Z]/;function qI(r,e){const t=$I(r,e);for(let n of t)if(!VI.test(n))return!1;return!0}function $I(r,e){let t=[];for(let n in r)Pu.call(r,n)&&(n in e||t.push(n));for(let n in e)Pu.call(e,n)&&r[n]!==e[n]&&t.push(n);return t}function Ng(r,e,t={}){if(r===e)return!0;for(let n in e)if(!(n in r&&WI(r[n],e[n],t[n])))return!1;for(let n in r)if(!(n in e))return!1;return!0}function WI(r,e,t){return r===e||t===!0?!0:t?t(r,e):!1}function GI(r,e=0,t,n=1){let i=[];t==null&&(t=Object.keys(r).length);for(let a=e;a<t;a+=n){let o=r[a];o!==void 0&&i.push(o)}return i}let P_={};function YI(r,e){P_[r]=e}function KI(r){return new P_[r]}class XI{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return rr(e)}markerToArray(e){return xi(e)}}YI("gregory",XI);const QI=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function JI(r){let e=QI.exec(r);if(e){let t=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(T_(t)){let n=null;return e[13]&&(n=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:t,isTimeUnspecified:!e[6],timeZoneOffset:n}}}return null}class ZI{constructor(e){let t=this.timeZone=e.timeZone,n=t!=="local"&&t!=="UTC";e.namedTimeZoneImpl&&n&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=!!(!n||this.namedTimeZoneImpl),this.calendarSystem=KI(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return t===null?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):rr(E2(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let t=null;return typeof e=="number"?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=rr(e)),t===null||!T_(t)?null:{marker:t,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let t=JI(e);if(t===null)return null;let{marker:n}=t,i=null;return t.timeZoneOffset!==null&&(this.canComputeOffset?n=this.timestampToMarker(n.valueOf()-t.timeZoneOffset*60*1e3):i=t.timeZoneOffset),{marker:n,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:i}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t.years,n[1]+=t.months,n[2]+=t.days,n[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(n)}subtract(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]-=t.years,n[1]-=t.months,n[2]-=t.days,n[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(n)}addYears(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t,this.calendarSystem.arrayToMarker(n)}addMonths(e,t){let n=this.calendarSystem.markerToArray(e);return n[1]+=t,this.calendarSystem.arrayToMarker(n)}diffWholeYears(e,t){let{calendarSystem:n}=this;return yi(e)===yi(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)&&n.getMarkerMonth(e)===n.getMarkerMonth(t)?n.getMarkerYear(t)-n.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:n}=this;return yi(e)===yi(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)?n.getMarkerMonth(t)-n.getMarkerMonth(e)+(n.getMarkerYear(t)-n.getMarkerYear(e))*12:null}greatestWholeUnit(e,t){let n=this.diffWholeYears(e,t);return n!==null?{unit:"year",value:n}:(n=this.diffWholeMonths(e,t),n!==null?{unit:"month",value:n}:(n=vI(e,t),n!==null?{unit:"week",value:n}:(n=Tu(e,t),n!==null?{unit:"day",value:n}:(n=pI(e,t),lu(n)?{unit:"hour",value:n}:(n=gI(e,t),lu(n)?{unit:"minute",value:n}:(n=xI(e,t),lu(n)?{unit:"second",value:n}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,n){let i;return n.years&&(i=this.diffWholeYears(e,t),i!==null)?i/uI(n):n.months&&(i=this.diffWholeMonths(e,t),i!==null)?i/hI(n):n.days&&(i=Tu(e,t),i!==null)?i/oo(n):(t.valueOf()-e.valueOf())/Vr(n)}startOf(e,t){return t==="year"?this.startOfYear(e):t==="month"?this.startOfMonth(e):t==="week"?this.startOfWeek(e):t==="day"?Et(e):t==="hour"?bI(e):t==="minute"?jI(e):t==="second"?wI(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):NI(e,this.weekDow,this.weekDoy)}format(e,t,n={}){return t.format({marker:e,timeZoneOffset:n.forcedTzo!=null?n.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,n,i={}){return i.isEndExclusive&&(t=Ei(t,-1)),n.formatRange({marker:e,timeZoneOffset:i.forcedStartTzo!=null?i.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:i.forcedEndTzo!=null?i.forcedEndTzo:this.offsetForMarker(t)},this,i.defaultSeparator)}formatIso(e,t={}){let n=null;return t.omitTimeZoneOffset||(t.forcedTzo!=null?n=t.forcedTzo:n=this.offsetForMarker(e)),R_(e,n,t.omitTime)}timestampToMarker(e){return this.timeZone==="local"?rr(E2(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):rr(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-S2(xi(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(xi(e)):null}toDate(e,t){return this.timeZone==="local"?S2(xi(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(xi(e))*1e3*60):new Date(e.valueOf()-(t||0))}}class oc{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,n;if(typeof e=="object"&&e){t=Object.assign({},this.iconClasses);for(n in e)t[n]=this.applyIconOverridePrefix(e[n]);this.iconClasses=t}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&e.indexOf(t)!==0&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let n;return t&&this.rtlIconClasses?n=this.rtlIconClasses[e]||this.iconClasses[e]:n=this.iconClasses[e],n?`${this.baseIconClass} ${n}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}}oc.prototype.classes={};oc.prototype.iconClasses={};oc.prototype.baseIconClass="";oc.prototype.iconOverridePrefix="";function Mu(r){r();let e=Fe.debounceRendering,t=[];function n(i){t.push(i)}for(Fe.debounceRendering=n,Kl(re(eB,{}),document.createElement("div"));t.length;)t.shift()();Fe.debounceRendering=e}class eB extends ur{render(){return re("div",{})}componentDidMount(){this.setState({})}}function M_(r){let e=k5(r),t=e.Provider;return e.Provider=function(){let n=!this.getChildContext,i=t.apply(this,arguments);if(n){let a=[];this.shouldComponentUpdate=o=>{this.props.value!==o.value&&a.forEach(l=>{l.context=o.value,l.forceUpdate()})},this.sub=o=>{a.push(o);let l=o.componentWillUnmount;o.componentWillUnmount=()=>{a.splice(a.indexOf(o),1),l&&l.call(o)}}}return i},e}class tB{constructor(e,t,n,i){this.execFunc=e,this.emitter=t,this.scrollTime=n,this.scrollTimeReset=i,this.handleScrollRequest=a=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},a),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const zn=M_({});function sB(r,e,t,n,i,a,o,l,u,h,c,f,m,g){return{dateEnv:i,nowManager:a,options:t,pluginHooks:l,emitter:c,dispatch:u,getCurrentData:h,calendarApi:f,viewSpec:r,viewApi:e,dateProfileGenerator:n,theme:o,isRtl:t.direction==="rtl",addResizeHandler(v){c.on("_resize",v)},removeResizeHandler(v){c.off("_resize",v)},createScrollResponder(v){return new tB(v,c,rt(t.scrollTime),t.scrollTimeReset)},registerInteractiveComponent:m,unregisterInteractiveComponent:g}}class ga extends ur{shouldComponentUpdate(e,t){return!Ng(this.props,e,this.propEquality)||!Ng(this.state,t,this.stateEquality)}safeSetState(e){Ng(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}ga.addPropsEquality=rB;ga.addStateEquality=nB;ga.contextType=zn;ga.prototype.propEquality={};ga.prototype.stateEquality={};class mt extends ga{}mt.contextType=zn;function rB(r){let e=Object.create(this.prototype.propEquality);Object.assign(e,r),this.prototype.propEquality=e}function nB(r){let e=Object.create(this.prototype.stateEquality);Object.assign(e,r),this.prototype.stateEquality=e}function pn(r,e){typeof r=="function"?r(e):r&&(r.current=e)}class sy extends mt{constructor(){super(...arguments),this.id=ma(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:t}=this.context,{generatorName:n}=this.props;(!t.customRenderingReplaces||!Sx(n,t))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&pn(this.props.elRef,e)}}render(){const{props:e,context:t}=this,{options:n}=t,{customGenerator:i,defaultGenerator:a,renderProps:o}=e,l=O_(e,[],this.handleEl);let u=!1,h,c=[],f;if(i!=null){const m=typeof i=="function"?i(o,re):i;if(m===!0)u=!0;else{const g=m&&typeof m=="object";g&&"html"in m?l.dangerouslySetInnerHTML={__html:m.html}:g&&"domNodes"in m?c=Array.prototype.slice.call(m.domNodes):(g?i_(m):typeof m!="function")?h=m:f=m}}else u=!Sx(e.generatorName,n);return u&&a&&(h=a(o)),this.queuedDomNodes=c,this.currentGeneratorMeta=f,re(e.elTag,l,h)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;const{props:n,context:i}=this,{handleCustomRendering:a,customRenderingMetaMap:o}=i.options;if(a){const l=(t=this.currentGeneratorMeta)!==null&&t!==void 0?t:o?.[n.generatorName];l&&a(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:l},n),{elClasses:(n.elClasses||[]).filter(iB)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:t}=this,n=this.base;if(!ki(e,t)){t.forEach(G0);for(let i of e)n.appendChild(i);this.currentDomNodes=e}}}sy.addPropsEquality({elClasses:ki,elStyle:Gr,elAttrs:qI,renderProps:Gr});function Sx(r,e){var t;return!!(e.handleCustomRendering&&r&&(!((t=e.customRenderingMetaMap)===null||t===void 0)&&t[r]))}function O_(r,e,t){const n=Object.assign(Object.assign({},r.elAttrs),{ref:t});return(r.elClasses||e)&&(n.className=(r.elClasses||[]).concat(e||[]).concat(n.className||[]).filter(Boolean).join(" ")),r.elStyle&&(n.style=r.elStyle),n}function iB(r){return!!r}const L_=M_(0);class fr extends ur{constructor(){super(...arguments),this.InnerContent=aB.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(pn(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,t=oB(e.classNameGenerator,e.renderProps);if(e.children){const n=O_(e,t,this.handleEl),i=e.children(this.InnerContent,e.renderProps,n);return e.elTag?re(e.elTag,n,i):i}else return re(sy,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?(t=(e=this.props).didMount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;(t=(e=this.props).willUnmount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}fr.contextType=L_;function aB(r,e){const t=r.props;return re(sy,Object.assign({renderProps:t.renderProps,generatorName:t.generatorName,customGenerator:t.customGenerator,defaultGenerator:t.defaultGenerator,renderId:r.context},e))}function oB(r,e){const t=typeof r=="function"?r(e):r||[];return typeof t=="string"?[t]:t}class Ou extends mt{render(){let{props:e,context:t}=this,{options:n}=t,i={view:t.viewApi};return re(fr,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...I_(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,classNameGenerator:n.viewClassNames,generatorName:void 0,didMount:n.viewDidMount,willUnmount:n.viewWillUnmount},()=>e.children)}}function I_(r){return[`fc-${r.type}-view`,"fc-view"]}function lB(r,e){let t=null,n=null;return r.start&&(t=e.createMarker(r.start)),r.end&&(n=e.createMarker(r.end)),!t&&!n||t&&n&&n<t?null:{start:t,end:n}}function D2(r,e){let t=[],{start:n}=e,i,a;for(r.sort(cB),i=0;i<r.length;i+=1)a=r[i],a.start>n&&t.push({start:n,end:a.start}),a.end>n&&(n=a.end);return n<e.end&&t.push({start:n,end:e.end}),t}function cB(r,e){return r.start.valueOf()-e.start.valueOf()}function da(r,e){let{start:t,end:n}=r,i=null;return e.start!==null&&(t===null?t=e.start:t=new Date(Math.max(t.valueOf(),e.start.valueOf()))),e.end!=null&&(n===null?n=e.end:n=new Date(Math.min(n.valueOf(),e.end.valueOf()))),(t===null||n===null||t<n)&&(i={start:t,end:n}),i}function dB(r,e){return(r.start===null?null:r.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(r.end===null?null:r.end.valueOf())===(e.end===null?null:e.end.valueOf())}function ry(r,e){return(r.end===null||e.start===null||r.end>e.start)&&(r.start===null||e.end===null||r.start<e.end)}function gh(r,e){return(r.start===null||e.start!==null&&e.start>=r.start)&&(r.end===null||e.end!==null&&e.end<=r.end)}function Dn(r,e){return(r.start===null||e>=r.start)&&(r.end===null||e<r.end)}function uB(r,e){return e.start!=null&&r<e.start?e.start:e.end!=null&&r>=e.end?new Date(e.end.valueOf()-1):r}function B_(r){let e=Math.floor(pa(r.start,r.end))||1,t=Et(r.start),n=ys(t,e);return{start:t,end:n}}function F_(r,e=rt(0)){let t=null,n=null;if(r.end){n=Et(r.end);let i=r.end.valueOf()-n.valueOf();i&&i>=Vr(e)&&(n=ys(n,1))}return r.start&&(t=Et(r.start),n&&n<=t&&(n=ys(t,1))),{start:t,end:n}}function to(r,e,t,n){return n==="year"?rt(t.diffWholeYears(r,e),"year"):n==="month"?rt(t.diffWholeMonths(r,e),"month"):yI(r,e)}class z_{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,n){let{dateEnv:i}=this.props,a=i.subtract(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(a,-1,n)}buildNext(e,t,n){let{dateEnv:i}=this.props,a=i.add(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(a,1,n)}build(e,t,n=!0){let{props:i}=this,a,o,l,u,h,c;return a=this.buildValidRange(),a=this.trimHiddenDays(a),n&&(e=uB(e,a)),o=this.buildCurrentRangeInfo(e,t),l=/^(year|month|week|day)$/.test(o.unit),u=this.buildRenderRange(this.trimHiddenDays(o.range),o.unit,l),u=this.trimHiddenDays(u),h=u,i.showNonCurrentDates||(h=da(h,o.range)),h=this.adjustActiveRange(h),h=da(h,a),c=ry(o.range,a),Dn(u,e)||(e=u.start),{currentDate:e,validRange:a,currentRange:o.range,currentRangeUnit:o.unit,isRangeAllDay:l,activeRange:h,renderRange:u,slotMinTime:i.slotMinTime,slotMaxTime:i.slotMaxTime,isValid:c,dateIncrement:this.buildDateIncrement(o.duration)}}buildValidRange(){let e=this.props.validRangeInput,t=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let{props:n}=this,i=null,a=null,o=null,l;return n.duration?(i=n.duration,a=n.durationUnit,o=this.buildRangeFromDuration(e,t,i,a)):(l=this.props.dayCount)?(a="day",o=this.buildRangeFromDayCount(e,t,l)):(o=this.buildCustomVisibleRange(e))?a=n.dateEnv.greatestWholeUnit(o.start,o.end).unit:(i=this.getFallbackDuration(),a=Ex(i).unit,o=this.buildRangeFromDuration(e,t,i,a)),{duration:i,unit:a,range:o}}getFallbackDuration(){return rt({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:n,slotMinTime:i,slotMaxTime:a}=this.props,{start:o,end:l}=e;return n&&(oo(i)<0&&(o=Et(o),o=t.add(o,i)),oo(a)>1&&(l=Et(l),l=ys(l,-1),l=t.add(l,a))),{start:o,end:l}}buildRangeFromDuration(e,t,n,i){let{dateEnv:a,dateAlignment:o}=this.props,l,u,h;if(!o){let{dateIncrement:f}=this.props;f&&Vr(f)<Vr(n)?o=Ex(f).unit:o=i}oo(n)<=1&&this.isHiddenDay(l)&&(l=this.skipHiddenDays(l,t),l=Et(l));function c(){l=a.startOf(e,o),u=a.add(l,n),h={start:l,end:u}}return c(),this.trimHiddenDays(h)||(e=this.skipHiddenDays(e,t),c()),h}buildRangeFromDayCount(e,t,n){let{dateEnv:i,dateAlignment:a}=this.props,o=0,l=e,u;a&&(l=i.startOf(l,a)),l=Et(l),l=this.skipHiddenDays(l,t),u=l;do u=ys(u,1),this.isHiddenDay(u)||(o+=1);while(o<n);return{start:l,end:u}}buildCustomVisibleRange(e){let{props:t}=this,n=t.visibleRangeInput,i=typeof n=="function"?n.call(t.calendarApi,t.dateEnv.toDate(e)):n,a=this.refineRange(i);return a&&(a.start==null||a.end==null)?null:a}buildRenderRange(e,t,n){return e}buildDateIncrement(e){let{dateIncrement:t}=this.props,n;return t||((n=this.props.dateAlignment)?rt(1,n):e||rt({days:1}))}refineRange(e){if(e){let t=lB(e,this.props.dateEnv);return t&&(t=F_(t)),t}return null}initHiddenDays(){let e=this.props.hiddenDays||[],t=[],n=0,i;for(this.props.weekends===!1&&e.push(0,6),i=0;i<7;i+=1)(t[i]=e.indexOf(i)!==-1)||(n+=1);if(!n)throw new Error("invalid hiddenDays");this.isHiddenDayHash=t}trimHiddenDays(e){let{start:t,end:n}=e;return t&&(t=this.skipHiddenDays(t)),n&&(n=this.skipHiddenDays(n,-1,!0)),t==null||n==null||t<n?{start:t,end:n}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,t=1,n=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(n?t:0)+7)%7];)e=ys(e,t);return e}}function ny(r,e,t,n){return{instanceId:ma(),defId:r,range:e,forcedStartTzo:t??null,forcedEndTzo:n??null}}function hB(r,e,t,n){for(let i=0;i<n.length;i+=1){let a=n[i].parse(r,t);if(a){let{allDay:o}=r;return o==null&&(o=e,o==null&&(o=a.allDayGuess,o==null&&(o=!1))),{allDay:o,duration:a.duration,typeData:a.typeData,typeId:i}}}return null}function ua(r,e,t){let{dateEnv:n,pluginHooks:i,options:a}=t,{defs:o,instances:l}=r;l=ca(l,u=>!o[u.defId].recurringDef);for(let u in o){let h=o[u];if(h.recurringDef){let{duration:c}=h.recurringDef;c||(c=h.allDay?a.defaultAllDayEventDuration:a.defaultTimedEventDuration);let f=fB(h,c,e,n,i.recurringTypes);for(let m of f){let g=ny(u,{start:m,end:n.add(m,c)});l[g.instanceId]=g}}}return{defs:o,instances:l}}function fB(r,e,t,n,i){let o=i[r.recurringDef.typeId].expand(r.recurringDef.typeData,{start:n.subtract(t.start,e),end:t.end},n);return r.allDay&&(o=o.map(Et)),o}const du={id:String,groupId:String,title:String,url:String,interactive:Boolean},U_={start:me,end:me,date:me,allDay:Boolean},mB=Object.assign(Object.assign(Object.assign({},du),U_),{extendedProps:me});function H_(r,e,t,n,i=iy(t),a,o){let{refined:l,extra:u}=V_(r,t,i),h=gB(e,t),c=hB(l,h,t.dateEnv,t.pluginHooks.recurringTypes);if(c){let m=_x(l,u,e?e.sourceId:"",c.allDay,!!c.duration,t,a);return m.recurringDef={typeId:c.typeId,typeData:c.typeData,duration:c.duration},{def:m,instance:null}}let f=pB(l,h,t,n);if(f){let m=_x(l,u,e?e.sourceId:"",f.allDay,f.hasEnd,t,a),g=ny(m.defId,f.range,f.forcedStartTzo,f.forcedEndTzo);return o&&m.publicId&&o[m.publicId]&&(g.instanceId=o[m.publicId]),{def:m,instance:g}}return null}function V_(r,e,t=iy(e)){return Z0(r,t)}function iy(r){return Object.assign(Object.assign(Object.assign({},Lu),mB),r.pluginHooks.eventRefiners)}function _x(r,e,t,n,i,a,o){let l={title:r.title||"",groupId:r.groupId||"",publicId:r.id||"",url:r.url||"",recurringDef:null,defId:(o&&r.id?o[r.id]:"")||ma(),sourceId:t,allDay:n,hasEnd:i,interactive:r.interactive,ui:Iu(r,a),extendedProps:Object.assign(Object.assign({},r.extendedProps||{}),e)};for(let u of a.pluginHooks.eventDefMemberAdders)Object.assign(l,u(r));return Object.freeze(l.ui.classNames),Object.freeze(l.extendedProps),l}function pB(r,e,t,n){let{allDay:i}=r,a,o=null,l=!1,u,h=null,c=r.start!=null?r.start:r.date;if(a=t.dateEnv.createMarkerMeta(c),a)o=a.marker;else if(!n)return null;return r.end!=null&&(u=t.dateEnv.createMarkerMeta(r.end)),i==null&&(e!=null?i=e:i=(!a||a.isTimeUnspecified)&&(!u||u.isTimeUnspecified)),i&&o&&(o=Et(o)),u&&(h=u.marker,i&&(h=Et(h)),o&&h<=o&&(h=null)),h?l=!0:n||(l=t.options.forceEventDuration||!1,h=t.dateEnv.add(o,i?t.options.defaultAllDayEventDuration:t.options.defaultTimedEventDuration)),{allDay:i,hasEnd:l,range:{start:o,end:h},forcedStartTzo:a?a.forcedTzo:null,forcedEndTzo:u?u.forcedTzo:null}}function gB(r,e){let t=null;return r&&(t=r.defaultAllDay),t==null&&(t=e.options.defaultAllDay),t}function Xl(r,e,t,n,i,a){let o=hr(),l=iy(t);for(let u of r){let h=H_(u,e,t,n,l,i,a);h&&Ax(h,o)}return o}function Ax(r,e=hr()){return e.defs[r.def.defId]=r.def,r.instance&&(e.instances[r.instance.instanceId]=r.instance),e}function ay(r,e){let t=r.instances[e];if(t){let n=r.defs[t.defId],i=xh(r,a=>xB(n,a));return i.defs[n.defId]=n,i.instances[t.instanceId]=t,i}return hr()}function xB(r,e){return!!(r.groupId&&r.groupId===e.groupId)}function hr(){return{defs:{},instances:{}}}function oy(r,e){return{defs:Object.assign(Object.assign({},r.defs),e.defs),instances:Object.assign(Object.assign({},r.instances),e.instances)}}function xh(r,e){let t=ca(r.defs,e),n=ca(r.instances,i=>t[i.defId]);return{defs:t,instances:n}}function yB(r,e){let{defs:t,instances:n}=r,i={},a={};for(let o in t)e.defs[o]||(i[o]=t[o]);for(let o in n)!e.instances[o]&&i[n[o].defId]&&(a[o]=n[o]);return{defs:i,instances:a}}function vB(r,e){return Array.isArray(r)?Xl(r,null,e,!0):typeof r=="object"&&r?Xl([r],null,e,!0):r!=null?String(r):null}function P2(r){return Array.isArray(r)?r:typeof r=="string"?r.split(/\s+/):[]}const Lu={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:me,overlap:me,allow:me,className:P2,classNames:P2,color:String,backgroundColor:String,borderColor:String,textColor:String},bB={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function Iu(r,e){let t=vB(r.constraint,e);return{display:r.display||null,startEditable:r.startEditable!=null?r.startEditable:r.editable,durationEditable:r.durationEditable!=null?r.durationEditable:r.editable,constraints:t!=null?[t]:[],overlap:r.overlap!=null?r.overlap:null,allows:r.allow!=null?[r.allow]:[],backgroundColor:r.backgroundColor||r.color||"",borderColor:r.borderColor||r.color||"",textColor:r.textColor||"",classNames:(r.className||[]).concat(r.classNames||[])}}function q_(r){return r.reduce(jB,bB)}function jB(r,e){return{display:e.display!=null?e.display:r.display,startEditable:e.startEditable!=null?e.startEditable:r.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:r.durationEditable,constraints:r.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:r.overlap,allows:r.allows.concat(e.allows),backgroundColor:e.backgroundColor||r.backgroundColor,borderColor:e.borderColor||r.borderColor,textColor:e.textColor||r.textColor,classNames:r.classNames.concat(e.classNames)}}const wB={id:String,defaultAllDay:Boolean,url:String,format:String,events:me,eventDataTransform:me,success:me,failure:me};function $_(r,e,t=W_(e)){let n;if(typeof r=="string"?n={url:r}:typeof r=="function"||Array.isArray(r)?n={events:r}:typeof r=="object"&&r&&(n=r),n){let{refined:i,extra:a}=Z0(n,t),o=NB(i,e);if(o)return{_raw:r,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:i.defaultAllDay,eventDataTransform:i.eventDataTransform,success:i.success,failure:i.failure,publicId:i.id||"",sourceId:ma(),sourceDefId:o.sourceDefId,meta:o.meta,ui:Iu(i,e),extendedProps:a}}return null}function W_(r){return Object.assign(Object.assign(Object.assign({},Lu),wB),r.pluginHooks.eventSourceRefiners)}function NB(r,e){let t=e.pluginHooks.eventSourceDefs;for(let n=t.length-1;n>=0;n-=1){let a=t[n].parseMeta(r);if(a)return{sourceDefId:n,meta:a}}return null}function kB(r,e,t,n,i){switch(e.type){case"RECEIVE_EVENTS":return EB(r,t[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,i);case"RESET_RAW_EVENTS":return SB(r,t[e.sourceId],e.rawEvents,n.activeRange,i);case"ADD_EVENTS":return _B(r,e.eventStore,n?n.activeRange:null,i);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return oy(r,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return n?ua(r,n.activeRange,i):r;case"REMOVE_EVENTS":return yB(r,e.eventStore);case"REMOVE_EVENT_SOURCE":return Y_(r,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return xh(r,a=>!a.sourceId);case"REMOVE_ALL_EVENTS":return hr();default:return r}}function EB(r,e,t,n,i,a){if(e&&t===e.latestFetchId){let o=Xl(G_(i,e,a),e,a);return n&&(o=ua(o,n,a)),oy(Y_(r,e.sourceId),o)}return r}function SB(r,e,t,n,i){const{defIdMap:a,instanceIdMap:o}=CB(r);let l=Xl(G_(t,e,i),e,i,!1,a,o);return ua(l,n,i)}function G_(r,e,t){let n=t.options.eventDataTransform,i=e?e.eventDataTransform:null;return i&&(r=M2(r,i)),n&&(r=M2(r,n)),r}function M2(r,e){let t;if(!e)t=r;else{t=[];for(let n of r){let i=e(n);i?t.push(i):i==null&&t.push(n)}}return t}function _B(r,e,t,n){return t&&(e=ua(e,t,n)),oy(r,e)}function O2(r,e,t){let{defs:n}=r,i=In(r.instances,a=>n[a.defId].allDay?a:Object.assign(Object.assign({},a),{range:{start:t.createMarker(e.toDate(a.range.start,a.forcedStartTzo)),end:t.createMarker(e.toDate(a.range.end,a.forcedEndTzo))},forcedStartTzo:t.canComputeOffset?null:a.forcedStartTzo,forcedEndTzo:t.canComputeOffset?null:a.forcedEndTzo}));return{defs:n,instances:i}}function Y_(r,e){return xh(r,t=>t.sourceId!==e)}function AB(r,e){return{defs:r.defs,instances:ca(r.instances,t=>!e[t.instanceId])}}function CB(r){const{defs:e,instances:t}=r,n={},i={};for(let a in e){const o=e[a],{publicId:l}=o;l&&(n[l]=a)}for(let a in t){const o=t[a],l=e[o.defId],{publicId:u}=l;u&&(i[u]=a)}return{defIdMap:n,instanceIdMap:i}}class yh{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){TB(this.handlers,e,t)}off(e,t){RB(this.handlers,e,t)}trigger(e,...t){let n=this.handlers[e]||[],i=this.options&&this.options[e],a=[].concat(i||[],n);for(let o of a)o.apply(this.thisContext,t)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}function TB(r,e,t){(r[e]||(r[e]=[])).push(t)}function RB(r,e,t){t?r[e]&&(r[e]=r[e].filter(n=>n!==t)):delete r[e]}const DB={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function PB(r,e){return Xl(MB(r),null,e)}function MB(r){let e;return r===!0?e=[{}]:Array.isArray(r)?e=r.filter(t=>t.daysOfWeek):typeof r=="object"&&r?e=[r]:e=[],e=e.map(t=>Object.assign(Object.assign({},DB),t)),e}function K_(r,e,t){t.emitter.trigger("select",Object.assign(Object.assign({},ly(r,t)),{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view}))}function OB(r,e){e.emitter.trigger("unselect",{jsEvent:r?r.origEvent:null,view:e.viewApi||e.calendarApi.view})}function ly(r,e){let t={};for(let n of e.pluginHooks.dateSpanTransforms)Object.assign(t,n(r,e));return Object.assign(t,KB(r,e.dateEnv)),t}function L2(r,e,t){let{dateEnv:n,options:i}=t,a=e;return r?(a=Et(a),a=n.add(a,i.defaultAllDayEventDuration)):a=n.add(a,i.defaultTimedEventDuration),a}function cy(r,e,t,n){let i=Bu(r.defs,e),a=hr();for(let o in r.defs){let l=r.defs[o];a.defs[o]=LB(l,i[o],t,n)}for(let o in r.instances){let l=r.instances[o],u=a.defs[l.defId];a.instances[o]=IB(l,u,i[l.defId],t,n)}return a}function LB(r,e,t,n){let i=t.standardProps||{};i.hasEnd==null&&e.durationEditable&&(t.startDelta||t.endDelta)&&(i.hasEnd=!0);let a=Object.assign(Object.assign(Object.assign({},r),i),{ui:Object.assign(Object.assign({},r.ui),i.ui)});t.extendedProps&&(a.extendedProps=Object.assign(Object.assign({},a.extendedProps),t.extendedProps));for(let o of n.pluginHooks.eventDefMutationAppliers)o(a,t,n);return!a.hasEnd&&n.options.forceEventDuration&&(a.hasEnd=!0),a}function IB(r,e,t,n,i){let{dateEnv:a}=i,o=n.standardProps&&n.standardProps.allDay===!0,l=n.standardProps&&n.standardProps.hasEnd===!1,u=Object.assign({},r);return o&&(u.range=B_(u.range)),n.datesDelta&&t.startEditable&&(u.range={start:a.add(u.range.start,n.datesDelta),end:a.add(u.range.end,n.datesDelta)}),n.startDelta&&t.durationEditable&&(u.range={start:a.add(u.range.start,n.startDelta),end:u.range.end}),n.endDelta&&t.durationEditable&&(u.range={start:u.range.start,end:a.add(u.range.end,n.endDelta)}),l&&(u.range={start:u.range.start,end:L2(e.allDay,u.range.start,i)}),e.allDay&&(u.range={start:Et(u.range.start),end:Et(u.range.end)}),u.range.end<u.range.start&&(u.range.end=L2(e.allDay,u.range.start,i)),u}class qa{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Mt{constructor(e,t,n){this._context=e,this._def=t,this._instance=n||null}setProp(e,t){if(e in U_)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")t=du[e](t),this.mutate({standardProps:{publicId:t}});else if(e in du)t=du[e](t),this.mutate({standardProps:{[e]:t}});else if(e in Lu){let n=Lu[e](t);e==="color"?n={backgroundColor:t,borderColor:t}:e==="editable"?n={startEditable:t,durationEditable:t}:n={[e]:t},this.mutate({standardProps:{ui:n}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e,t={}){let{dateEnv:n}=this._context,i=n.createMarker(e);if(i&&this._instance){let a=this._instance.range,o=to(a.start,i,n,t.granularity);t.maintainDuration?this.mutate({datesDelta:o}):this.mutate({startDelta:o})}}setEnd(e,t={}){let{dateEnv:n}=this._context,i;if(!(e!=null&&(i=n.createMarker(e),!i))&&this._instance)if(i){let a=to(this._instance.range.end,i,n,t.granularity);this.mutate({endDelta:a})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t,n={}){let{dateEnv:i}=this._context,a={allDay:n.allDay},o=i.createMarker(e),l;if(o&&!(t!=null&&(l=i.createMarker(t),!l))&&this._instance){let u=this._instance.range;n.allDay===!0&&(u=B_(u));let h=to(u.start,o,i,n.granularity);if(l){let c=to(u.end,l,i,n.granularity);lI(h,c)?this.mutate({datesDelta:h,standardProps:a}):this.mutate({startDelta:h,endDelta:c,standardProps:a})}else a.hasEnd=!1,this.mutate({datesDelta:h,standardProps:a})}}moveStart(e){let t=rt(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=rt(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=rt(e);t&&this.mutate({datesDelta:t})}setAllDay(e,t={}){let n={allDay:e},{maintainDuration:i}=t;i==null&&(i=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(n.hasEnd=i),this.mutate({standardProps:n})}formatRange(e){let{dateEnv:t}=this._context,n=this._instance,i=Ft(e);return this._def.hasEnd?t.formatRange(n.range.start,n.range.end,i,{forcedStartTzo:n.forcedStartTzo,forcedEndTzo:n.forcedEndTzo}):t.format(n.range.start,i,{forcedTzo:n.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let n=this._def,i=this._context,{eventStore:a}=i.getCurrentData(),o=ay(a,t.instanceId);o=cy(o,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,i);let u=new Mt(i,n,t);this._def=o.defs[n.defId],this._instance=o.instances[t.instanceId],i.dispatch({type:"MERGE_EVENTS",eventStore:o}),i.emitter.trigger("eventChange",{oldEvent:u,event:this,relatedEvents:oa(o,i,t),revert(){i.dispatch({type:"RESET_EVENTS",eventStore:a})}})}}remove(){let e=this._context,t=X_(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new qa(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let t=this._def,{ui:n}=t,{startStr:i,endStr:a}=this,o={allDay:t.allDay};return t.title&&(o.title=t.title),i&&(o.start=i),a&&(o.end=a),t.publicId&&(o.id=t.publicId),t.groupId&&(o.groupId=t.groupId),t.url&&(o.url=t.url),n.display&&n.display!=="auto"&&(o.display=n.display),e.collapseColor&&n.backgroundColor&&n.backgroundColor===n.borderColor?o.color=n.backgroundColor:(n.backgroundColor&&(o.backgroundColor=n.backgroundColor),n.borderColor&&(o.borderColor=n.borderColor)),n.textColor&&(o.textColor=n.textColor),n.classNames.length&&(o.classNames=n.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(o,t.extendedProps):o.extendedProps=t.extendedProps),o}toJSON(){return this.toPlainObject()}}function X_(r){let e=r._def,t=r._instance;return{defs:{[e.defId]:e},instances:t?{[t.instanceId]:t}:{}}}function oa(r,e,t){let{defs:n,instances:i}=r,a=[],o=t?t.instanceId:"";for(let l in i){let u=i[l],h=n[u.defId];u.instanceId!==o&&a.push(new Mt(e,h,u))}return a}function I2(r,e,t,n){let i={},a={},o={},l=[],u=[],h=Bu(r.defs,e);for(let c in r.defs){let f=r.defs[c];h[f.defId].display==="inverse-background"&&(f.groupId?(i[f.groupId]=[],o[f.groupId]||(o[f.groupId]=f)):a[c]=[])}for(let c in r.instances){let f=r.instances[c],m=r.defs[f.defId],g=h[m.defId],v=f.range,y=!m.allDay&&n?F_(v,n):v,x=da(y,t);x&&(g.display==="inverse-background"?m.groupId?i[m.groupId].push(x):a[f.defId].push(x):g.display!=="none"&&(g.display==="background"?l:u).push({def:m,ui:g,instance:f,range:x,isStart:y.start&&y.start.valueOf()===x.start.valueOf(),isEnd:y.end&&y.end.valueOf()===x.end.valueOf()}))}for(let c in i){let f=i[c],m=D2(f,t);for(let g of m){let v=o[c],y=h[v.defId];l.push({def:v,ui:y,instance:null,range:g,isStart:!1,isEnd:!1})}}for(let c in a){let f=a[c],m=D2(f,t);for(let g of m)l.push({def:r.defs[c],ui:h[c],instance:null,range:g,isStart:!1,isEnd:!1})}return{bg:l,fg:u}}function BB(r){return r.ui.display==="background"||r.ui.display==="inverse-background"}function B2(r,e){r.fcSeg=e}function vo(r){return r.fcSeg||r.parentNode.fcSeg||null}function Bu(r,e){return In(r,t=>Q_(t,e))}function Q_(r,e){let t=[];return e[""]&&t.push(e[""]),e[r.defId]&&t.push(e[r.defId]),t.push(r.ui),q_(t)}function J_(r,e){let t=r.map(FB);return t.sort((n,i)=>tI(n,i,e)),t.map(n=>n._seg)}function FB(r){let{eventRange:e}=r,t=e.def,n=e.instance?e.instance.range:e.range,i=n.start?n.start.valueOf():0,a=n.end?n.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},t.extendedProps),t),{id:t.publicId,start:i,end:a,duration:a-i,allDay:Number(t.allDay),_seg:r})}function zB(r,e){let{pluginHooks:t}=e,n=t.isDraggableTransformers,{def:i,ui:a}=r.eventRange,o=a.startEditable;for(let l of n)o=l(o,i,a,e);return o}function UB(r,e){return r.isStart&&r.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function HB(r,e){return r.isEnd&&r.eventRange.ui.durationEditable}function Z_(r,e,t,n,i,a,o){let{dateEnv:l,options:u}=t,{displayEventTime:h,displayEventEnd:c}=u,f=r.eventRange.def,m=r.eventRange.instance;h==null&&(h=n!==!1),c==null&&(c=i!==!1);let g=m.range.start,v=m.range.end,y=r.start||r.eventRange.range.start,x=r.end||r.eventRange.range.end,b=Et(g).valueOf()===Et(y).valueOf(),w=Et(Ei(v,-1)).valueOf()===Et(Ei(x,-1)).valueOf();return h&&!f.allDay&&(b||w)?(y=b?g:y,x=w?v:x,c&&f.hasEnd?l.formatRange(y,x,e,{forcedStartTzo:m.forcedStartTzo,forcedEndTzo:m.forcedEndTzo}):l.format(y,e,{forcedTzo:m.forcedStartTzo})):""}function bi(r,e,t){let n=r.eventRange.range;return{isPast:n.end<=(t||e.start),isFuture:n.start>=(t||e.end),isToday:e&&Dn(e,n.start)}}function VB(r){let e=["fc-event"];return r.isMirror&&e.push("fc-event-mirror"),r.isDraggable&&e.push("fc-event-draggable"),(r.isStartResizable||r.isEndResizable)&&e.push("fc-event-resizable"),r.isDragging&&e.push("fc-event-dragging"),r.isResizing&&e.push("fc-event-resizing"),r.isSelected&&e.push("fc-event-selected"),r.isStart&&e.push("fc-event-start"),r.isEnd&&e.push("fc-event-end"),r.isPast&&e.push("fc-event-past"),r.isToday&&e.push("fc-event-today"),r.isFuture&&e.push("fc-event-future"),e}function eA(r){return r.instance?r.instance.instanceId:`${r.def.defId}:${r.range.start.toISOString()}`}function tA(r,e){let{def:t,instance:n}=r.eventRange,{url:i}=t;if(i)return{href:i};let{emitter:a,options:o}=e,{eventInteractive:l}=o;return l==null&&(l=t.interactive,l==null&&(l=!!a.hasHandlers("eventClick"))),l?C_(u=>{a.trigger("eventClick",{el:u.target,event:new Mt(e,t,n),jsEvent:u,view:e.viewApi})}):{}}const qB={start:me,end:me,allDay:Boolean};function $B(r,e,t){let n=WB(r,e),{range:i}=n;if(!i.start)return null;if(!i.end){if(t==null)return null;i.end=e.add(i.start,t)}return n}function WB(r,e){let{refined:t,extra:n}=Z0(r,qB),i=t.start?e.createMarkerMeta(t.start):null,a=t.end?e.createMarkerMeta(t.end):null,{allDay:o}=t;return o==null&&(o=i&&i.isTimeUnspecified&&(!a||a.isTimeUnspecified)),Object.assign({range:{start:i?i.marker:null,end:a?a.marker:null},allDay:o},n)}function GB(r,e){return dB(r.range,e.range)&&r.allDay===e.allDay&&YB(r,e)}function YB(r,e){for(let t in e)if(t!=="range"&&t!=="allDay"&&r[t]!==e[t])return!1;for(let t in r)if(!(t in e))return!1;return!0}function KB(r,e){return Object.assign(Object.assign({},rA(r.range,e,r.allDay)),{allDay:r.allDay})}function sA(r,e,t){return Object.assign(Object.assign({},rA(r,e,t)),{timeZone:e.timeZone})}function rA(r,e,t){return{start:e.toDate(r.start),end:e.toDate(r.end),startStr:e.formatIso(r.start,{omitTime:t}),endStr:e.formatIso(r.end,{omitTime:t})}}function XB(r,e,t){let n=V_({editable:!1},t),i=_x(n.refined,n.extra,"",r.allDay,!0,t);return{def:i,ui:Q_(i,e),instance:ny(i.defId,r.range),range:r.range,isStart:!0,isEnd:!0}}function QB(r,e,t){let n=!1,i=function(l){n||(n=!0,e(l))},a=function(l){n||(n=!0,t(l))},o=r(i,a);o&&typeof o.then=="function"&&o.then(i,a)}class F2 extends Error{constructor(e,t){super(e),this.response=t}}function JB(r,e,t){r=r.toUpperCase();const n={method:r};return r==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(t):(n.body=new URLSearchParams(t),n.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,n).then(i=>{if(i.ok)return i.json().then(a=>[a,i],()=>{throw new F2("Failure parsing JSON",i)});throw new F2("Request failed",i)})}let kg;function nA(){return kg==null&&(kg=ZB()),kg}function ZB(){if(typeof document>"u")return!0;let r=document.createElement("div");r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.innerHTML="<table><tr><td><div></div></td></tr></table>",r.querySelector("table").style.height="100px",r.querySelector("div").style.height="100%",document.body.appendChild(r);let t=r.querySelector("div").offsetHeight>0;return document.body.removeChild(r),t}class eF extends mt{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{Mu(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{Mu(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:n}=this.state,i=n||t.height==="auto"||t.contentHeight==="auto",a=!i&&t.height!=null?t.height:"",o=["fc",n?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return nA()||o.push("fc-liquid-hack"),e.children(o,a,i,n)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class Co{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function tF(r,e){return{component:r,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function dy(r){return{[r.component.uid]:r}}const Cx={};class To extends ur{constructor(e,t){super(e,t),this.handleRefresh=()=>{let n=this.computeTiming();n.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(n.state),this.clearTimeout(),this.setTimeout(n.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:t}=this,n=t.nowManager.getDateMarker(),{nowIndicatorSnap:i}=t.options;i==="auto"&&(i=/year|month|week|day/.test(e.unit)||(e.unitValue||1)===1);let a,o;return i?(a=t.dateEnv.startOf(n,e.unit),o=t.dateEnv.add(a,rt(1,e.unit)).valueOf()-n.valueOf()):(a=n,o=1e3*60),o=Math.min(1e3*60*60*24,o),{state:{nowDate:a,todayRange:sF(a)},waitMs:o}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{const t=this.computeTiming();this.setState(t.state,()=>{this.setTimeout(t.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}To.contextType=zn;function sF(r){let e=Et(r),t=ys(e,1);return{start:e,end:t}}class rF{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:n}=this;n.currentCalendarOptionsRefiners[e]?n.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e,...t){this.currentDataManager.emitter.trigger(e,...t)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:n}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:n.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let n=this.getCurrentData(),i;t=t||"day",i=n.viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),i?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:i.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:t,toolbarConfig:n}=this.getCurrentData(),i=[].concat(n.header?n.header.viewsWithButtons:[],n.footer?n.footer.viewsWithButtons:[]),a,o;for(let l in t)i.push(l);for(a=0;a<i.length;a+=1)if(o=t[i[a]],o&&o.singleUnit===e)return o;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),n=rt(e);n&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,n)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:n}=this.getCurrentData();return n.format(n.createMarker(e),Ft(t))}formatRange(e,t,n){let{dateEnv:i}=this.getCurrentData();return i.formatRange(i.createMarker(e),i.createMarker(t),Ft(n),n)}formatIso(e,t){let{dateEnv:n}=this.getCurrentData();return n.formatIso(n.createMarker(e),{omitTime:t})}select(e,t){let n;t==null?e.start!=null?n=e:n={start:e,end:null}:n={start:e,end:t};let i=this.getCurrentData(),a=$B(n,i.dateEnv,rt({days:1}));a&&(this.dispatch({type:"SELECT_DATES",selection:a}),K_(a,null,i))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),OB(e,t))}addEvent(e,t){if(e instanceof Mt){let o=e._def,l=e._instance;return this.getCurrentData().eventStore.defs[o.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:Ax({def:o,instance:l})}),this.triggerEventAdd(e)),e}let n=this.getCurrentData(),i;if(t instanceof qa)i=t.internalEventSource;else if(typeof t=="boolean")t&&([i]=ty(n.eventSources));else if(t!=null){let o=this.getEventSourceById(t);if(!o)return console.warn(`Could not find an event source with ID "${t}"`),null;i=o.internalEventSource}let a=H_(e,i,n,!1);if(a){let o=new Mt(n,a.def,a.def.recurringDef?null:a.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:Ax(a)}),this.triggerEventAdd(o),o}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:X_(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:n,instances:i}=t.eventStore;e=String(e);for(let a in n){let o=n[a];if(o.publicId===e){if(o.recurringDef)return new Mt(t,o,null);for(let l in i){let u=i[l];if(u.defId===o.defId)return new Mt(t,o,u)}}}return null}getEvents(){let e=this.getCurrentData();return oa(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,n=[];for(let i in t)n.push(new qa(e,t[i]));return n}getEventSourceById(e){let t=this.getCurrentData(),n=t.eventSources;e=String(e);for(let i in n)if(n[i].publicId===e)return new qa(t,n[i]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof qa)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let n=$_(e,t);return n?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[n]}),new qa(t,n)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=rt(e);t&&this.trigger("_scrollRequest",{time:t})}}function nF(r,e){return r.left>=e.left&&r.left<e.right&&r.top>=e.top&&r.top<e.bottom}function iA(r,e){let t={left:Math.max(r.left,e.left),right:Math.min(r.right,e.right),top:Math.max(r.top,e.top),bottom:Math.min(r.bottom,e.bottom)};return t.left<t.right&&t.top<t.bottom?t:!1}function iF(r,e){return{left:Math.min(Math.max(r.left,e.left),e.right),top:Math.min(Math.max(r.top,e.top),e.bottom)}}function aF(r){return{left:(r.left+r.right)/2,top:(r.top+r.bottom)/2}}function oF(r,e){return{left:r.left-e.left,top:r.top-e.top}}const Eg=hr();class lF{constructor(){this.getKeysForEventDefs=ze(this._getKeysForEventDefs),this.splitDateSelection=ze(this._splitDateSpan),this.splitEventStore=ze(this._splitEventStore),this.splitIndividualUi=ze(this._splitIndividualUi),this.splitEventDrag=ze(this._splitInteraction),this.splitEventResize=ze(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let t=this.getKeyInfo(e),n=this.getKeysForEventDefs(e.eventStore),i=this.splitDateSelection(e.dateSelection),a=this.splitIndividualUi(e.eventUiBases,n),o=this.splitEventStore(e.eventStore,n),l=this.splitEventDrag(e.eventDrag),u=this.splitEventResize(e.eventResize),h={};this.eventUiBuilders=In(t,(c,f)=>this.eventUiBuilders[f]||ze(cF));for(let c in t){let f=t[c],m=o[c]||Eg,g=this.eventUiBuilders[c];h[c]={businessHours:f.businessHours||e.businessHours,dateSelection:i[c]||null,eventStore:m,eventUiBases:g(e.eventUiBases[""],f.ui,a[c]),eventSelection:m.instances[e.eventSelection]?e.eventSelection:"",eventDrag:l[c]||null,eventResize:u[c]||null}}return h}_splitDateSpan(e){let t={};if(e){let n=this.getKeysForDateSpan(e);for(let i of n)t[i]=e}return t}_getKeysForEventDefs(e){return In(e.defs,t=>this.getKeysForEventDef(t))}_splitEventStore(e,t){let{defs:n,instances:i}=e,a={};for(let o in n)for(let l of t[o])a[l]||(a[l]=hr()),a[l].defs[o]=n[o];for(let o in i){let l=i[o];for(let u of t[l.defId])a[u]&&(a[u].instances[o]=l)}return a}_splitIndividualUi(e,t){let n={};for(let i in e)if(i)for(let a of t[i])n[a]||(n[a]={}),n[a][i]=e[i];return n}_splitInteraction(e){let t={};if(e){let n=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),i=this._getKeysForEventDefs(e.mutatedEvents),a=this._splitEventStore(e.mutatedEvents,i),o=l=>{t[l]||(t[l]={affectedEvents:n[l]||Eg,mutatedEvents:a[l]||Eg,isEvent:e.isEvent})};for(let l in n)o(l);for(let l in a)o(l)}return t}}function cF(r,e,t){let n=[];r&&n.push(r),e&&n.push(e);let i={"":q_(n)};return t&&Object.assign(i,t),i}function aA(r,e,t,n){return{dow:r.getUTCDay(),isDisabled:!!(n&&(!n.activeRange||!Dn(n.activeRange,r))),isOther:!!(n&&!Dn(n.currentRange,r)),isToday:!!(e&&Dn(e,r)),isPast:!!(e&&r<e.start),isFuture:!!(e&&r>=e.end)}}function uy(r,e){let t=["fc-day",`fc-day-${fI[r.dow]}`];return r.isDisabled?t.push("fc-day-disabled"):(r.isToday&&(t.push("fc-day-today"),t.push(e.getClass("today"))),r.isPast&&t.push("fc-day-past"),r.isFuture&&t.push("fc-day-future"),r.isOther&&t.push("fc-day-other")),t}const dF=Ft({year:"numeric",month:"long",day:"numeric"}),uF=Ft({week:"long"});function Fu(r,e,t="day",n=!0){const{dateEnv:i,options:a,calendarApi:o}=r;let l=i.format(e,t==="week"?uF:dF);if(a.navLinks){let u=i.toDate(e);const h=c=>{let f=t==="day"?a.navLinkDayClick:t==="week"?a.navLinkWeekClick:null;typeof f=="function"?f.call(o,i.toDate(e),c):(typeof f=="string"&&(t=f),o.zoomTo(e,t))};return Object.assign({title:Ml(a.navLinkHint,[l,u],l),"data-navlink":""},n?A_(h):{onClick:h})}return{"aria-label":l}}let Sg=null;function hF(){return Sg===null&&(Sg=fF()),Sg}function fF(){let r=document.createElement("div");Pl(r,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),r.innerHTML="<div></div>",document.body.appendChild(r);let t=r.firstChild.getBoundingClientRect().left>r.getBoundingClientRect().left;return G0(r),t}let _g;function mF(){return _g||(_g=pF()),_g}function pF(){let r=document.createElement("div");r.style.overflow="scroll",r.style.position="absolute",r.style.top="-9999px",r.style.left="-9999px",document.body.appendChild(r);let e=oA(r);return document.body.removeChild(r),e}function oA(r){return{x:r.offsetHeight-r.clientHeight,y:r.offsetWidth-r.clientWidth}}function gF(r,e=!1){let t=window.getComputedStyle(r),n=parseInt(t.borderLeftWidth,10)||0,i=parseInt(t.borderRightWidth,10)||0,a=parseInt(t.borderTopWidth,10)||0,o=parseInt(t.borderBottomWidth,10)||0,l=oA(r),u=l.y-n-i,h=l.x-a-o,c={borderLeft:n,borderRight:i,borderTop:a,borderBottom:o,scrollbarBottom:h,scrollbarLeft:0,scrollbarRight:0};return hF()&&t.direction==="rtl"?c.scrollbarLeft=u:c.scrollbarRight=u,e&&(c.paddingLeft=parseInt(t.paddingLeft,10)||0,c.paddingRight=parseInt(t.paddingRight,10)||0,c.paddingTop=parseInt(t.paddingTop,10)||0,c.paddingBottom=parseInt(t.paddingBottom,10)||0),c}function xF(r,e=!1,t){let n=hy(r),i=gF(r,e),a={left:n.left+i.borderLeft+i.scrollbarLeft,right:n.right-i.borderRight-i.scrollbarRight,top:n.top+i.borderTop,bottom:n.bottom-i.borderBottom-i.scrollbarBottom};return e&&(a.left+=i.paddingLeft,a.right-=i.paddingRight,a.top+=i.paddingTop,a.bottom-=i.paddingBottom),a}function hy(r){let e=r.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function yF(r){let e=lA(r),t=r.getBoundingClientRect();for(let n of e){let i=iA(t,n.getBoundingClientRect());if(i)t=i;else return null}return t}function lA(r){let e=[];for(;r instanceof HTMLElement;){let t=window.getComputedStyle(r);if(t.position==="fixed")break;/(auto|scroll)/.test(t.overflow+t.overflowY+t.overflowX)&&e.push(r),r=r.parentNode}return e}class bo{constructor(e,t,n,i){this.els=t;let a=this.originClientRect=e.getBoundingClientRect();n&&this.buildElHorizontals(a.left),i&&this.buildElVerticals(a.top)}buildElHorizontals(e){let t=[],n=[];for(let i of this.els){let a=i.getBoundingClientRect();t.push(a.left-e),n.push(a.right-e)}this.lefts=t,this.rights=n}buildElVerticals(e){let t=[],n=[];for(let i of this.els){let a=i.getBoundingClientRect();t.push(a.top-e),n.push(a.bottom-e)}this.tops=t,this.bottoms=n}leftToIndex(e){let{lefts:t,rights:n}=this,i=t.length,a;for(a=0;a<i;a+=1)if(e>=t[a]&&e<n[a])return a}topToIndex(e){let{tops:t,bottoms:n}=this,i=t.length,a;for(a=0;a<i;a+=1)if(e>=t[a]&&e<n[a])return a}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return Ud(this.tops||[],e.tops||[])&&Ud(this.bottoms||[],e.bottoms||[])&&Ud(this.lefts||[],e.lefts||[])&&Ud(this.rights||[],e.rights||[])}}function Ud(r,e){const t=r.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(Math.round(r[n])!==Math.round(e[n]))return!1;return!0}class fy{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class vF extends fy{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class bF extends fy{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class xn extends mt{constructor(){super(...arguments),this.uid=ma()}prepareHits(){}queryHit(e,t,n,i){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!Ds(e,".fc-event-mirror")}isValidDateDownEl(e){return!Ds(e,".fc-event:not(.fc-bg-event)")&&!Ds(e,".fc-more-link")&&!Ds(e,"a[data-navlink]")&&!Ds(e,".fc-popover")}}class cA{constructor(e=t=>t.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let n of e)this.insertEntry(n,t);return t}insertEntry(e,t){let n=this.findInsertion(e);this.isInsertionValid(n,e)?this.insertEntryAt(e,n):this.handleInvalidInsertion(n,e,t)}isInsertionValid(e,t){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,n){if(this.allowReslicing&&e.touchingEntry){const i=Object.assign(Object.assign({},t),{span:my(t.span,e.touchingEntry.span)});n.push(i),this.splitEntry(t,e.touchingEntry,n)}else n.push(t)}splitEntry(e,t,n){let i=e.span,a=t.span;i.start<a.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:i.start,end:a.start}},n),i.end>a.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:a.end,end:i.end}},n)}insertEntryAt(e,t){let{entriesByLevel:n,levelCoords:i}=this;t.lateral===-1?(Ag(i,t.level,t.levelCoord),Ag(n,t.level,[e])):Ag(n[t.level],t.lateral,e),this.stackCnts[la(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:n,strictOrder:i,stackCnts:a}=this,o=t.length,l=0,u=-1,h=-1,c=null,f=0;for(let v=0;v<o;v+=1){const y=t[v];if(!i&&y>=l+this.getEntryThickness(e))break;let x=n[v],b,w=Rx(x,e.span.start,Tx),k=w[0]+w[1];for(;(b=x[k])&&b.span.start<e.span.end;){let N=y+this.getEntryThickness(b);N>l&&(l=N,c=b,u=v,h=k),N===l&&(f=Math.max(f,a[la(b)]+1)),k+=1}}let m=0;if(c)for(m=u+1;m<o&&t[m]<l;)m+=1;let g=-1;return m<o&&t[m]===l&&(g=Rx(n[m],e.span.end,Tx)[0]),{touchingLevel:u,touchingLateral:h,touchingEntry:c,stackCnt:f,levelCoord:l,level:m,lateral:g}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,n=e.length,i=[];for(let a=0;a<n;a+=1){let o=e[a],l=t[a];for(let u of o)i.push(Object.assign(Object.assign({},u),{thickness:this.getEntryThickness(u),levelCoord:l}))}return i}}function Tx(r){return r.span.end}function la(r){return r.index+":"+r.span.start}function jF(r){let e=[];for(let t of r){let n=[],i={span:t.span,entries:[t]};for(let a of e)my(a.span,i.span)?i={entries:a.entries.concat(i.entries),span:wF(a.span,i.span)}:n.push(a);n.push(i),e=n}return e}function wF(r,e){return{start:Math.min(r.start,e.start),end:Math.max(r.end,e.end)}}function my(r,e){let t=Math.max(r.start,e.start),n=Math.min(r.end,e.end);return t<n?{start:t,end:n}:null}function Ag(r,e,t){r.splice(e,0,t)}function Rx(r,e,t){let n=0,i=r.length;if(!i||e<t(r[n]))return[0,0];if(e>t(r[i-1]))return[i,0];for(;n<i;){let a=Math.floor(n+(i-n)/2),o=t(r[a]);if(e<o)i=a;else if(e>o)n=a+1;else return[a,1]}return[n,0]}class NF{constructor(e,t){this.emitter=new yh}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const py={};function kF(r,e){return!r||e>10?Ft({weekday:"short"}):e>1?Ft({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):Ft({weekday:"long"})}const dA="fc-col-header-cell";function uA(r){return r.text}class EF extends mt{render(){let{dateEnv:e,options:t,theme:n,viewApi:i}=this.context,{props:a}=this,{date:o,dateProfile:l}=a,u=aA(o,a.todayRange,null,l),h=[dA].concat(uy(u,n)),c=e.format(o,a.dayHeaderFormat),f=!u.isDisabled&&a.colCnt>1?Fu(this.context,o):{},m=e.toDate(o);e.namedTimeZoneImpl&&(m=Ei(m,36e5));let g=Object.assign(Object.assign(Object.assign({date:m,view:i},a.extraRenderProps),{text:c}),u);return re(fr,{elTag:"th",elClasses:h,elAttrs:Object.assign({role:"columnheader",colSpan:a.colSpan,"data-date":u.isDisabled?void 0:Q0(o)},a.extraDataAttrs),renderProps:g,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:uA,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},v=>re("div",{className:"fc-scrollgrid-sync-inner"},!u.isDisabled&&re(v,{elTag:"a",elAttrs:f,elClasses:["fc-col-header-cell-cushion",a.isSticky&&"fc-sticky"]})))}}const SF=Ft({weekday:"long"});class _F extends mt{render(){let{props:e}=this,{dateEnv:t,theme:n,viewApi:i,options:a}=this.context,o=ys(new Date(2592e5),e.dow),l={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},u=t.format(o,e.dayHeaderFormat),h=Object.assign(Object.assign(Object.assign(Object.assign({date:o},l),{view:i}),e.extraRenderProps),{text:u});return re(fr,{elTag:"th",elClasses:[dA,...uy(l,n),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:h,generatorName:"dayHeaderContent",customGenerator:a.dayHeaderContent,defaultGenerator:uA,classNameGenerator:a.dayHeaderClassNames,didMount:a.dayHeaderDidMount,willUnmount:a.dayHeaderWillUnmount},c=>re("div",{className:"fc-scrollgrid-sync-inner"},re(c,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(o,SF)}})))}}class hA extends mt{constructor(){super(...arguments),this.createDayHeaderFormatter=ze(AF)}render(){let{context:e}=this,{dates:t,dateProfile:n,datesRepDistinctDays:i,renderIntro:a}=this.props,o=this.createDayHeaderFormatter(e.options.dayHeaderFormat,i,t.length);return re(To,{unit:"day"},(l,u)=>re("tr",{role:"row"},a&&a("day"),t.map(h=>i?re(EF,{key:h.toISOString(),date:h,dateProfile:n,todayRange:u,colCnt:t.length,dayHeaderFormat:o}):re(_F,{key:h.getUTCDay(),dow:h.getUTCDay(),dayHeaderFormat:o}))))}}function AF(r,e,t){return r||kF(e,t)}class fA{constructor(e,t){let n=e.start,{end:i}=e,a=[],o=[],l=-1;for(;n<i;)t.isHiddenDay(n)?a.push(l+.5):(l+=1,a.push(l),o.push(n)),n=ys(n,1);this.dates=o,this.indices=a,this.cnt=o.length}sliceRange(e){let t=this.getDateDayIndex(e.start),n=this.getDateDayIndex(ys(e.end,-1)),i=Math.max(0,t),a=Math.min(this.cnt-1,n);return i=Math.ceil(i),a=Math.floor(a),i<=a?{firstIndex:i,lastIndex:a,isStart:t===i,isEnd:n===a}:null}getDateDayIndex(e){let{indices:t}=this,n=Math.floor(pa(this.dates[0],e));return n<0?t[0]-1:n>=t.length?t[t.length-1]+1:t[n]}}class mA{constructor(e,t){let{dates:n}=e,i,a,o;if(t){for(a=n[0].getUTCDay(),i=1;i<n.length&&n[i].getUTCDay()!==a;i+=1);o=Math.ceil(n.length/i)}else o=1,i=n.length;this.rowCnt=o,this.colCnt=i,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let n=[];for(let i=0;i<this.colCnt;i+=1)n.push(this.buildCell(t,i));e.push(n)}return e}buildCell(e,t){let n=this.daySeries.dates[e*this.colCnt+t];return{key:n.toISOString(),date:n}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,n=this.daySeries.sliceRange(e),i=[];if(n){let{firstIndex:a,lastIndex:o}=n,l=a;for(;l<=o;){let u=Math.floor(l/t),h=Math.min((u+1)*t,o+1);i.push({row:u,firstCol:l%t,lastCol:(h-1)%t,isStart:n.isStart&&l===a,isEnd:n.isEnd&&h-1===o}),l=h}}return i}}class pA{constructor(){this.sliceBusinessHours=ze(this._sliceBusinessHours),this.sliceDateSelection=ze(this._sliceDateSpan),this.sliceEventStore=ze(this._sliceEventStore),this.sliceEventDrag=ze(this._sliceInteraction),this.sliceEventResize=ze(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,n,i,...a){let{eventUiBases:o}=e,l=this.sliceEventStore(e.eventStore,o,t,n,...a);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,n,o,i,...a),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,n,i,...a),fgEventSegs:l.fg,bgEventSegs:l.bg,eventDrag:this.sliceEventDrag(e.eventDrag,o,t,n,...a),eventResize:this.sliceEventResize(e.eventResize,o,t,n,...a),eventSelection:e.eventSelection}}sliceNowDate(e,t,n,i,...a){return this._sliceDateSpan({range:{start:e,end:Ei(e,1)},allDay:!1},t,n,{},i,...a)}_sliceBusinessHours(e,t,n,i,...a){return e?this._sliceEventStore(ua(e,Hd(t,!!n),i),{},t,n,...a).bg:[]}_sliceEventStore(e,t,n,i,...a){if(e){let o=I2(e,t,Hd(n,!!i),i);return{bg:this.sliceEventRanges(o.bg,a),fg:this.sliceEventRanges(o.fg,a)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,n,i,...a){if(!e)return null;let o=I2(e.mutatedEvents,t,Hd(n,!!i),i);return{segs:this.sliceEventRanges(o.fg,a),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,n,i,a,...o){if(!e)return[];let l=Hd(t,!!n),u=da(e.range,l);if(u){e=Object.assign(Object.assign({},e),{range:u});let h=XB(e,i,a),c=this.sliceRange(e.range,...o);for(let f of c)f.eventRange=h;return c}return[]}sliceEventRanges(e,t){let n=[];for(let i of e)n.push(...this.sliceEventRange(i,t));return n}sliceEventRange(e,t){let n=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(n={start:n.start,end:ys(n.start,1)});let i=this.sliceRange(n,...t);for(let a of i)a.eventRange=e,a.isStart=e.isStart&&a.isStart,a.isEnd=e.isEnd&&a.isEnd;return i}}function Hd(r,e){let t=r.activeRange;return e?t:{start:Ei(t.start,r.slotMinTime.milliseconds),end:Ei(t.end,r.slotMaxTime.milliseconds-864e5)}}function gA(r,e,t){let{instances:n}=r.mutatedEvents;for(let i in n)if(!gh(e.validRange,n[i].range))return!1;return xA({eventDrag:r},t)}function CF(r,e,t){return gh(e.validRange,r.range)?xA({dateSelection:r},t):!1}function xA(r,e){let t=e.getCurrentData(),n=Object.assign({businessHours:t.businessHours,dateSelection:"",eventStore:t.eventStore,eventUiBases:t.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},r);return(e.pluginHooks.isPropsValid||TF)(n,e)}function TF(r,e,t={},n){return!(r.eventDrag&&!RF(r,e,t,n)||r.dateSelection&&!DF(r,e,t,n))}function RF(r,e,t,n){let i=e.getCurrentData(),a=r.eventDrag,o=a.mutatedEvents,l=o.defs,u=o.instances,h=Bu(l,a.isEvent?r.eventUiBases:{"":i.selectionConfig});n&&(h=In(h,n));let c=AB(r.eventStore,a.affectedEvents.instances),f=c.defs,m=c.instances,g=Bu(f,r.eventUiBases);for(let v in u){let y=u[v],x=y.range,b=h[y.defId],w=l[y.defId];if(!yA(b.constraints,x,c,r.businessHours,e))return!1;let{eventOverlap:k}=e.options,N=typeof k=="function"?k:null;for(let S in m){let A=m[S];if(ry(x,A.range)&&(g[A.defId].overlap===!1&&a.isEvent||b.overlap===!1||N&&!N(new Mt(e,f[A.defId],A),new Mt(e,w,y))))return!1}let E=i.eventStore;for(let S of b.allows){let A=Object.assign(Object.assign({},t),{range:y.range,allDay:w.allDay}),C=E.defs[w.defId],I=E.instances[v],L;if(C?L=new Mt(e,C,I):L=new Mt(e,w),!S(ly(A,e),L))return!1}}return!0}function DF(r,e,t,n){let i=r.eventStore,a=i.defs,o=i.instances,l=r.dateSelection,u=l.range,{selectionConfig:h}=e.getCurrentData();if(n&&(h=n(h)),!yA(h.constraints,u,i,r.businessHours,e))return!1;let{selectOverlap:c}=e.options,f=typeof c=="function"?c:null;for(let m in o){let g=o[m];if(ry(u,g.range)&&(h.overlap===!1||f&&!f(new Mt(e,a[g.defId],g),null)))return!1}for(let m of h.allows){let g=Object.assign(Object.assign({},t),l);if(!m(ly(g,e),null))return!1}return!0}function yA(r,e,t,n,i){for(let a of r)if(!MF(PF(a,e,t,n,i),e))return!1;return!0}function PF(r,e,t,n,i){return r==="businessHours"?Cg(ua(n,e,i)):typeof r=="string"?Cg(xh(t,a=>a.groupId===r)):typeof r=="object"&&r?Cg(ua(r,e,i)):[]}function Cg(r){let{instances:e}=r,t=[];for(let n in e)t.push(e[n].range);return t}function MF(r,e){for(let t of r)if(gh(t,e))return!0;return!1}const Vd=/^(visible|hidden)$/;class OF extends mt{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,pn(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:n}=e,i=t&&n,a=["fc-scroller"];return t&&(n?a.push("fc-scroller-liquid-absolute"):a.push("fc-scroller-liquid")),re("div",{ref:this.handleEl,className:a.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:i&&-(e.overcomeLeft||0)||"",right:i&&-(e.overcomeRight||0)||"",bottom:i&&-(e.overcomeBottom||0)||"",marginLeft:!i&&-(e.overcomeLeft||0)||"",marginRight:!i&&-(e.overcomeRight||0)||"",marginBottom:!i&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(Vd.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:n}=e;for(let i=0;i<n.length;i+=1)if(n[i].getBoundingClientRect().width>t)return!0;return!1}needsYScrolling(){if(Vd.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:n}=e;for(let i=0;i<n.length;i+=1)if(n[i].getBoundingClientRect().height>t)return!0;return!1}getXScrollbarWidth(){return Vd.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return Vd.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class Rn{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(t,n)=>{let{depths:i,currentMap:a}=this,o=!1,l=!1;t!==null?(o=n in a,a[n]=t,i[n]=(i[n]||0)+1,l=!0):(i[n]-=1,i[n]||(delete a[n],delete this.callbackMap[n],o=!0)),this.masterCallback&&(o&&this.masterCallback(null,String(n)),l&&this.masterCallback(t,String(n)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=n=>{this.handleValue(n,String(e))}),t}collect(e,t,n){return GI(this.currentMap,e,t,n)}getAll(){return ty(this.currentMap)}}function LF(r){let e=$5(r,".fc-scrollgrid-shrink"),t=0;for(let n of e)t=Math.max(t,iI(n));return Math.ceil(t)}function vA(r,e){return r.liquid&&e.liquid}function IF(r,e){return e.maxHeight!=null||vA(r,e)}function BF(r,e,t,n){let{expandRows:i}=t;return typeof e.content=="function"?e.content(t):re("table",{role:"presentation",className:[e.tableClassName,r.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:t.tableMinWidth,width:t.clientWidth,height:i?t.clientHeight:""}},t.tableColGroupNode,re(n?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(t):e.rowContent))}function FF(r,e){return ki(r,e,Gr)}function zF(r,e){let t=[];for(let n of r){let i=n.span||1;for(let a=0;a<i;a+=1)t.push(re("col",{style:{width:n.width==="shrink"?UF(e):n.width||"",minWidth:n.minWidth||""}}))}return re("colgroup",{},...t)}function UF(r){return r??4}function HF(r){for(let e of r)if(e.width==="shrink")return!0;return!1}function VF(r,e){let t=["fc-scrollgrid",e.theme.getClass("table")];return r&&t.push("fc-scrollgrid-liquid"),t}function qF(r,e){let t=["fc-scrollgrid-section",`fc-scrollgrid-section-${r.type}`,r.className];return e&&r.liquid&&r.maxHeight==null&&t.push("fc-scrollgrid-section-liquid"),r.isSticky&&t.push("fc-scrollgrid-section-sticky"),t}function Dx(r){return re("div",{className:"fc-scrollgrid-sticky-shim",style:{width:r.clientWidth,minWidth:r.tableMinWidth}})}function zu(r){let{stickyHeaderDates:e}=r;return(e==null||e==="auto")&&(e=r.height==="auto"||r.viewHeight==="auto"),e}function bA(r){let{stickyFooterScrollbar:e}=r;return(e==null||e==="auto")&&(e=r.height==="auto"||r.viewHeight==="auto"),e}class gy extends mt{constructor(){super(...arguments),this.processCols=ze(e=>e,FF),this.renderMicroColGroup=ze(zF),this.scrollerRefs=new Rn,this.scrollerElRefs=new Rn(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:n}=this,i=e.sections||[],a=this.processCols(e.cols),o=this.renderMicroColGroup(a,t.shrinkWidth),l=VF(e.liquid,n);e.collapsibleWidth&&l.push("fc-scrollgrid-collapsible");let u=i.length,h=0,c,f=[],m=[],g=[];for(;h<u&&(c=i[h]).type==="header";)f.push(this.renderSection(c,o,!0)),h+=1;for(;h<u&&(c=i[h]).type==="body";)m.push(this.renderSection(c,o,!1)),h+=1;for(;h<u&&(c=i[h]).type==="footer";)g.push(this.renderSection(c,o,!0)),h+=1;let v=!nA();const y={role:"rowgroup"};return re("table",{role:"grid",className:l.join(" "),style:{height:e.height}},!!(!v&&f.length)&&re("thead",y,...f),!!(!v&&m.length)&&re("tbody",y,...m),!!(!v&&g.length)&&re("tfoot",y,...g),v&&re("tbody",y,...f,...m,...g))}renderSection(e,t,n){return"outerContent"in e?re(kt,{key:e.key},e.outerContent):re("tr",{key:e.key,role:"presentation",className:qF(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,n))}renderChunkTd(e,t,n,i){if("outerContent"in n)return n.outerContent;let{props:a}=this,{forceYScrollbars:o,scrollerClientWidths:l,scrollerClientHeights:u}=this.state,h=IF(a,e),c=vA(a,e),f=a.liquid?o?"scroll":h?"auto":"hidden":"visible",m=e.key,g=BF(e,n,{tableColGroupNode:t,tableMinWidth:"",clientWidth:!a.collapsibleWidth&&l[m]!==void 0?l[m]:null,clientHeight:u[m]!==void 0?u[m]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},i);return re(i?"th":"td",{ref:n.elRef,role:"presentation"},re("div",{className:`fc-scroller-harness${c?" fc-scroller-harness-liquid":""}`},re(OF,{ref:this.scrollerRefs.createRef(m),elRef:this.scrollerElRefs.createRef(m),overflowY:f,overflowX:a.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:c,liquidIsAbsolute:!0},g)))}_handleScrollerEl(e,t){let n=$F(this.props.sections,t);n&&pn(n.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return HF(this.props.cols)?LF(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=mF(),{scrollerRefs:t,scrollerElRefs:n}=this,i=!1,a={},o={};for(let l in t.currentMap){let u=t.currentMap[l];if(u&&u.needsYScrolling()){i=!0;break}}for(let l of this.props.sections){let u=l.key,h=n.currentMap[u];if(h){let c=h.parentNode;a[u]=Math.floor(c.getBoundingClientRect().width-(i?e.y:0)),o[u]=Math.floor(c.getBoundingClientRect().height)}}return{forceYScrollbars:i,scrollerClientWidths:a,scrollerClientHeights:o}}}gy.addStateEquality({scrollerClientWidths:Gr,scrollerClientHeights:Gr});function $F(r,e){for(let t of r)if(t.key===e)return t;return null}class xy extends mt{constructor(){super(...arguments),this.buildPublicEvent=ze((e,t,n)=>new Mt(e,t,n)),this.handleEl=e=>{this.el=e,pn(this.props.elRef,e),e&&B2(e,this.props.seg)}}render(){const{props:e,context:t}=this,{options:n}=t,{seg:i}=e,{eventRange:a}=i,{ui:o}=a,l={event:this.buildPublicEvent(t,a.def,a.instance),view:t.viewApi,timeText:e.timeText,textColor:o.textColor,backgroundColor:o.backgroundColor,borderColor:o.borderColor,isDraggable:!e.disableDragging&&zB(i,t),isStartResizable:!e.disableResizing&&UB(i,t),isEndResizable:!e.disableResizing&&HB(i),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!i.isStart,isEnd:!!i.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return re(fr,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...VB(l),...i.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:l,generatorName:"eventContent",customGenerator:n.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:n.eventClassNames,didMount:n.eventDidMount,willUnmount:n.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&B2(this.el,this.props.seg)}}class yy extends mt{render(){let{props:e,context:t}=this,{options:n}=t,{seg:i}=e,{ui:a}=i.eventRange,o=n.eventTimeFormat||e.defaultTimeFormat,l=Z_(i,o,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return re(xy,Object.assign({},e,{elTag:"a",elStyle:{borderColor:a.borderColor,backgroundColor:a.backgroundColor},elAttrs:tA(i,t),defaultGenerator:WF,timeText:l}),(u,h)=>re(kt,null,re(u,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:h.textColor}}),!!h.isStartResizable&&re("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!h.isEndResizable&&re("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}yy.addPropsEquality({seg:Gr});function WF(r){return re("div",{className:"fc-event-main-frame"},r.timeText&&re("div",{className:"fc-event-time"},r.timeText),re("div",{className:"fc-event-title-container"},re("div",{className:"fc-event-title fc-sticky"},r.event.title||re(kt,null,""))))}const vy=r=>re(zn.Consumer,null,e=>{let{options:t}=e,n={isAxis:r.isAxis,date:e.dateEnv.toDate(r.date),view:e.viewApi};return re(fr,{elRef:r.elRef,elTag:r.elTag||"div",elAttrs:r.elAttrs,elClasses:r.elClasses,elStyle:r.elStyle,renderProps:n,generatorName:"nowIndicatorContent",customGenerator:t.nowIndicatorContent,classNameGenerator:t.nowIndicatorClassNames,didMount:t.nowIndicatorDidMount,willUnmount:t.nowIndicatorWillUnmount},r.children)}),GF=Ft({day:"numeric"});class by extends mt{constructor(){super(...arguments),this.refineRenderProps=cu(YF)}render(){let{props:e,context:t}=this,{options:n}=t,i=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:n.monthStartFormat});return re(fr,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),i.isDisabled?{}:{"data-date":Q0(e.date)}),elClasses:[...uy(i,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,generatorName:"dayCellContent",customGenerator:n.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:i.isDisabled?void 0:n.dayCellClassNames,didMount:n.dayCellDidMount,willUnmount:n.dayCellWillUnmount},e.children)}}function jy(r){return!!(r.dayCellContent||Sx("dayCellContent",r))}function YF(r){let{date:e,dateEnv:t,dateProfile:n,isMonthStart:i}=r,a=aA(e,r.todayRange,null,n),o=r.showDayNumber?t.format(e,i?r.monthStartFormat:GF):"";return Object.assign(Object.assign(Object.assign({date:t.toDate(e),view:r.viewApi},a),{isMonthStart:i,dayNumberText:o}),r.extraRenderProps)}class jA extends mt{render(){let{props:e}=this,{seg:t}=e;return re(xy,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:KF,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function KF(r){let{title:e}=r.event;return e&&re("div",{className:"fc-event-title"},r.event.title)}function wA(r){return re("div",{className:`fc-${r}`})}const NA=r=>re(zn.Consumer,null,e=>{let{dateEnv:t,options:n}=e,{date:i}=r,a=n.weekNumberFormat||r.defaultFormat,o=t.computeWeekNumber(i),l=t.format(i,a),u={num:o,text:l,date:i};return re(fr,{elRef:r.elRef,elTag:r.elTag,elAttrs:r.elAttrs,elClasses:r.elClasses,elStyle:r.elStyle,renderProps:u,generatorName:"weekNumberContent",customGenerator:n.weekNumberContent,defaultGenerator:XF,classNameGenerator:n.weekNumberClassNames,didMount:n.weekNumberDidMount,willUnmount:n.weekNumberWillUnmount},r.children)});function XF(r){return r.text}const Tg=10;class QF extends mt{constructor(){super(...arguments),this.state={titleId:mh()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&pn(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const t=S_(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:n,state:i}=this,a=["fc-popover",e.getClass("popover")].concat(n.extraClassNames||[]);return R5(re("div",Object.assign({},n.extraAttrs,{id:n.id,className:a.join(" "),"aria-labelledby":i.titleId,ref:this.handleRootEl}),re("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},re("span",{className:"fc-popover-title",id:i.titleId},n.title),re("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),re("div",{className:"fc-popover-body "+e.getClass("popoverContent")},n.children)),n.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:n}=this.props,{rootEl:i}=this,a=yF(t);if(a){let o=i.getBoundingClientRect(),l=n?Ds(t,".fc-scrollgrid").getBoundingClientRect().top:a.top,u=e?a.right-o.width:a.left;l=Math.max(l,Tg),u=Math.min(u,document.documentElement.clientWidth-Tg-o.width),u=Math.max(u,Tg);let h=i.offsetParent.getBoundingClientRect();Pl(i,{top:l-h.top,left:u-h.left})}}}class JF extends xn{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:n}=this,{startDate:i,todayRange:a,dateProfile:o}=n,l=t.format(i,e.dayPopoverFormat);return re(by,{elRef:this.handleRootEl,date:i,dateProfile:o,todayRange:a},(u,h,c)=>re(QF,{elRef:c.ref,id:n.id,title:l,extraClassNames:["fc-more-popover"].concat(c.className||[]),extraAttrs:c,parentEl:n.parentEl,alignmentEl:n.alignmentEl,alignGridTop:n.alignGridTop,onClose:n.onClose},jy(e)&&re(u,{elTag:"div",elClasses:["fc-more-popover-misc"]}),n.children))}queryHit(e,t,n,i){let{rootEl:a,props:o}=this;return e>=0&&e<n&&t>=0&&t<i?{dateProfile:o.dateProfile,dateSpan:Object.assign({allDay:!o.forceTimed,range:{start:o.startDate,end:o.endDate}},o.extraDateSpan),dayEl:a,rect:{left:0,top:0,right:n,bottom:i},layer:1}:null}}class kA extends mt{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:mh()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&pn(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:n}=this,{moreLinkClick:i}=n.options,a=z2(t).start;function o(l){let{def:u,instance:h,range:c}=l.eventRange;return{event:new Mt(n,u,h),start:n.dateEnv.toDate(c.start),end:n.dateEnv.toDate(c.end),isStart:l.isStart,isEnd:l.isEnd}}typeof i=="function"&&(i=i({date:a,allDay:!!t.allDayDate,allSegs:t.allSegs.map(o),hiddenSegs:t.hiddenSegs.map(o),jsEvent:e,view:n.viewApi})),!i||i==="popover"?this.setState({isPopoverOpen:!0}):typeof i=="string"&&n.calendarApi.zoomTo(a,i)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return re(zn.Consumer,null,n=>{let{viewApi:i,options:a,calendarApi:o}=n,{moreLinkText:l}=a,{moreCnt:u}=e,h=z2(e),c=typeof l=="function"?l.call(o,u):`+${u} ${l}`,f=Ml(a.moreLinkHint,[u],c),m={num:u,shortText:`+${u}`,text:c,view:i};return re(kt,null,!!e.moreCnt&&re(fr,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),A_(this.handleClick)),{title:f,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:m,generatorName:"moreLinkContent",customGenerator:a.moreLinkContent,defaultGenerator:e.defaultGenerator||ZF,classNameGenerator:a.moreLinkClassNames,didMount:a.moreLinkDidMount,willUnmount:a.moreLinkWillUnmount},e.children),t.isPopoverOpen&&re(JF,{id:t.popoverId,startDate:h.start,endDate:h.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=Ds(this.linkEl,".fc-view-harness"))}}function ZF(r){return r.text}function z2(r){if(r.allDayDate)return{start:r.allDayDate,end:ys(r.allDayDate,1)};let{hiddenSegs:e}=r;return{start:EA(e),end:t8(e)}}function EA(r){return r.reduce(e8).eventRange.range.start}function e8(r,e){return r.eventRange.range.start<e.eventRange.range.start?r:e}function t8(r){return r.reduce(s8).eventRange.range.end}function s8(r,e){return r.eventRange.range.end>e.eventRange.range.end?r:e}class r8{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),this.currentValue!==void 0&&e(this.currentValue)}}class n8 extends r8{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:t}=this;let n=!1;e.isActive?(t.set(e.id,e),n=!0):t.has(e.id)&&(t.delete(e.id),n=!0),n&&this.set(t)}}const i8=[],SA={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},_A=Object.assign(Object.assign({},SA),{buttonHints:{prev:"Previous $0",next:"Next $0",today(r,e){return e==="day"?"Today":`This ${r}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(r){return`Show ${r} more event${r===1?"":"s"}`}});function a8(r){let e=r.length>0?r[0].code:"en",t=i8.concat(r),n={en:_A};for(let i of t)n[i.code]=i;return{map:n,defaultCode:e}}function AA(r,e){return typeof r=="object"&&!Array.isArray(r)?CA(r.code,[r.code],r):o8(r,e)}function o8(r,e){let t=[].concat(r||[]),n=l8(t,e)||_A;return CA(r,t,n)}function l8(r,e){for(let t=0;t<r.length;t+=1){let n=r[t].toLocaleLowerCase().split("-");for(let i=n.length;i>0;i-=1){let a=n.slice(0,i).join("-");if(e[a])return e[a]}}return null}function CA(r,e,t){let n=ey([SA,t],["buttonText"]);delete n.code;let{week:i}=n;return delete n.week,{codeArg:r,codes:e,week:i,simpleNumberFormat:new Intl.NumberFormat(r),options:n}}function Un(r){return{id:ma(),name:r.name,premiumReleaseDate:r.premiumReleaseDate?new Date(r.premiumReleaseDate):void 0,deps:r.deps||[],reducers:r.reducers||[],isLoadingFuncs:r.isLoadingFuncs||[],contextInit:[].concat(r.contextInit||[]),eventRefiners:r.eventRefiners||{},eventDefMemberAdders:r.eventDefMemberAdders||[],eventSourceRefiners:r.eventSourceRefiners||{},isDraggableTransformers:r.isDraggableTransformers||[],eventDragMutationMassagers:r.eventDragMutationMassagers||[],eventDefMutationAppliers:r.eventDefMutationAppliers||[],dateSelectionTransformers:r.dateSelectionTransformers||[],datePointTransforms:r.datePointTransforms||[],dateSpanTransforms:r.dateSpanTransforms||[],views:r.views||{},viewPropsTransformers:r.viewPropsTransformers||[],isPropsValid:r.isPropsValid||null,externalDefTransforms:r.externalDefTransforms||[],viewContainerAppends:r.viewContainerAppends||[],eventDropTransformers:r.eventDropTransformers||[],componentInteractions:r.componentInteractions||[],calendarInteractions:r.calendarInteractions||[],themeClasses:r.themeClasses||{},eventSourceDefs:r.eventSourceDefs||[],cmdFormatter:r.cmdFormatter,recurringTypes:r.recurringTypes||[],namedTimeZonedImpl:r.namedTimeZonedImpl,initialView:r.initialView||"",elementDraggingImpl:r.elementDraggingImpl,optionChangeHandlers:r.optionChangeHandlers||{},scrollGridImpl:r.scrollGridImpl||null,listenerRefiners:r.listenerRefiners||{},optionRefiners:r.optionRefiners||{},propSetHandlers:r.propSetHandlers||{}}}function c8(r,e){let t={},n={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function i(a){for(let o of a){const l=o.name,u=t[l];u===void 0?(t[l]=o.id,i(o.deps),n=u8(n,o)):u!==o.id&&console.warn(`Duplicate plugin '${l}'`)}}return r&&i(r),i(e),n}function d8(){let r=[],e=[],t;return(n,i)=>((!t||!ki(n,r)||!ki(i,e))&&(t=c8(n,i)),r=n,e=i,t)}function u8(r,e){return{premiumReleaseDate:h8(r.premiumReleaseDate,e.premiumReleaseDate),reducers:r.reducers.concat(e.reducers),isLoadingFuncs:r.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:r.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},r.eventRefiners),e.eventRefiners),eventDefMemberAdders:r.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},r.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:r.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:r.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:r.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:r.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:r.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:r.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},r.views),e.views),viewPropsTransformers:r.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||r.isPropsValid,externalDefTransforms:r.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:r.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:r.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:r.calendarInteractions.concat(e.calendarInteractions),componentInteractions:r.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},r.themeClasses),e.themeClasses),eventSourceDefs:r.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||r.cmdFormatter,recurringTypes:r.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||r.namedTimeZonedImpl,initialView:r.initialView||e.initialView,elementDraggingImpl:r.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},r.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||r.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},r.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},r.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},r.propSetHandlers),e.propSetHandlers)}}function h8(r,e){return r===void 0?e:e===void 0?r:new Date(Math.max(r.valueOf(),e.valueOf()))}class Ti extends oc{}Ti.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};Ti.prototype.baseIconClass="fc-icon";Ti.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};Ti.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};Ti.prototype.iconOverrideOption="buttonIcons";Ti.prototype.iconOverrideCustomButtonOption="icon";Ti.prototype.iconOverridePrefix="fc-icon-";function f8(r,e){let t={},n;for(n in r)Px(n,t,r,e);for(n in e)Px(n,t,r,e);return t}function Px(r,e,t,n){if(e[r])return e[r];let i=m8(r,e,t,n);return i&&(e[r]=i),i}function m8(r,e,t,n){let i=t[r],a=n[r],o=c=>i&&i[c]!==null?i[c]:a&&a[c]!==null?a[c]:null,l=o("component"),u=o("superType"),h=null;if(u){if(u===r)throw new Error("Can't have a custom view type that references itself");h=Px(u,e,t,n)}return!l&&h&&(l=h.component),l?{type:r,component:l,defaults:Object.assign(Object.assign({},h?h.defaults:{}),i?i.rawOptions:{}),overrides:Object.assign(Object.assign({},h?h.overrides:{}),a?a.rawOptions:{})}:null}function U2(r){return In(r,p8)}function p8(r){let e=typeof r=="function"?{component:r}:r,{component:t}=e;return e.content?t=H2(e):t&&!(t.prototype instanceof mt)&&(t=H2(Object.assign(Object.assign({},e),{content:t}))),{superType:e.type,component:t,rawOptions:e}}function H2(r){return e=>re(zn.Consumer,null,t=>re(fr,{elTag:"div",elClasses:I_(t.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:t.options.nextDayThreshold}),generatorName:void 0,customGenerator:r.content,classNameGenerator:r.classNames,didMount:r.didMount,willUnmount:r.willUnmount}))}function g8(r,e,t,n){let i=U2(r),a=U2(e.views),o=f8(i,a);return In(o,l=>x8(l,a,e,t,n))}function x8(r,e,t,n,i){let a=r.overrides.duration||r.defaults.duration||n.duration||t.duration,o=null,l="",u="",h={};if(a&&(o=y8(a),o)){let m=Ex(o);l=m.unit,m.value===1&&(u=l,h=e[l]?e[l].rawOptions:{})}let c=m=>{let g=m.buttonText||{},v=r.defaults.buttonTextKey;return v!=null&&g[v]!=null?g[v]:g[r.type]!=null?g[r.type]:g[u]!=null?g[u]:null},f=m=>{let g=m.buttonHints||{},v=r.defaults.buttonTextKey;return v!=null&&g[v]!=null?g[v]:g[r.type]!=null?g[r.type]:g[u]!=null?g[u]:null};return{type:r.type,component:r.component,duration:o,durationUnit:l,singleUnit:u,optionDefaults:r.defaults,optionOverrides:Object.assign(Object.assign({},h),r.overrides),buttonTextOverride:c(n)||c(t)||r.overrides.buttonText,buttonTextDefault:c(i)||r.defaults.buttonText||c(Ol)||r.type,buttonTitleOverride:f(n)||f(t)||r.overrides.buttonHint,buttonTitleDefault:f(i)||r.defaults.buttonHint||f(Ol)}}let V2={};function y8(r){let e=JSON.stringify(r),t=V2[e];return t===void 0&&(t=rt(r),V2[e]=t),t}function v8(r,e){switch(e.type){case"CHANGE_VIEW_TYPE":r=e.viewType}return r}function b8(r,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return r}}function j8(r,e,t){let n=r.initialDate;return n!=null?e.createMarker(n):t.getDateMarker()}function w8(r,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},r),{[e.optionName]:e.rawOptionValue});default:return r}}function N8(r,e,t,n){let i;switch(e.type){case"CHANGE_VIEW_TYPE":return n.build(e.dateMarker||t);case"CHANGE_DATE":return n.build(e.dateMarker);case"PREV":if(i=n.buildPrev(r,t),i.isValid)return i;break;case"NEXT":if(i=n.buildNext(r,t),i.isValid)return i;break}return r}function k8(r,e,t){let n=e?e.activeRange:null;return RA({},R8(r,t),n,t)}function E8(r,e,t,n){let i=t?t.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return RA(r,e.sources,i,n);case"REMOVE_EVENT_SOURCE":return _8(r,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return t?DA(r,i,n):r;case"FETCH_EVENT_SOURCES":return wy(r,e.sourceIds?D_(e.sourceIds):PA(r,n),i,e.isRefetch||!1,n);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return T8(r,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return r}}function S8(r,e,t){let n=e?e.activeRange:null;return wy(r,PA(r,t),n,!0,t)}function TA(r){for(let e in r)if(r[e].isFetching)return!0;return!1}function RA(r,e,t,n){let i={};for(let a of e)i[a.sourceId]=a;return t&&(i=DA(i,t,n)),Object.assign(Object.assign({},r),i)}function _8(r,e){return ca(r,t=>t.sourceId!==e)}function DA(r,e,t){return wy(r,ca(r,n=>A8(n,e,t)),e,!1,t)}function A8(r,e,t){return MA(r,t)?!t.options.lazyFetching||!r.fetchRange||r.isFetching||e.start<r.fetchRange.start||e.end>r.fetchRange.end:!r.latestFetchId}function wy(r,e,t,n,i){let a={};for(let o in r){let l=r[o];e[o]?a[o]=C8(l,t,n,i):a[o]=l}return a}function C8(r,e,t,n){let{options:i,calendarApi:a}=n,o=n.pluginHooks.eventSourceDefs[r.sourceDefId],l=ma();return o.fetch({eventSource:r,range:e,isRefetch:t,context:n},u=>{let{rawEvents:h}=u;i.eventSourceSuccess&&(h=i.eventSourceSuccess.call(a,h,u.response)||h),r.success&&(h=r.success.call(a,h,u.response)||h),n.dispatch({type:"RECEIVE_EVENTS",sourceId:r.sourceId,fetchId:l,fetchRange:e,rawEvents:h})},u=>{let h=!1;i.eventSourceFailure&&(i.eventSourceFailure.call(a,u),h=!0),r.failure&&(r.failure(u),h=!0),h||console.warn(u.message,u),n.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:r.sourceId,fetchId:l,fetchRange:e,error:u})}),Object.assign(Object.assign({},r),{isFetching:!0,latestFetchId:l})}function T8(r,e,t,n){let i=r[e];return i&&t===i.latestFetchId?Object.assign(Object.assign({},r),{[e]:Object.assign(Object.assign({},i),{isFetching:!1,fetchRange:n})}):r}function PA(r,e){return ca(r,t=>MA(t,e))}function R8(r,e){let t=W_(e),n=[].concat(r.eventSources||[]),i=[];r.initialEvents&&n.unshift(r.initialEvents),r.events&&n.unshift(r.events);for(let a of n){let o=$_(a,e,t);o&&i.push(o)}return i}function MA(r,e){return!e.pluginHooks.eventSourceDefs[r.sourceDefId].ignoreRange}function D8(r,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return r}}function P8(r,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return r}}function M8(r,e){let t;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return r}}function O8(r,e){let t;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return r}}function L8(r,e,t,n,i){let a=r.headerToolbar?q2(r.headerToolbar,r,e,t,n,i):null,o=r.footerToolbar?q2(r.footerToolbar,r,e,t,n,i):null;return{header:a,footer:o}}function q2(r,e,t,n,i,a){let o={},l=[],u=!1;for(let h in r){let c=r[h],f=I8(c,e,t,n,i,a);o[h]=f.widgets,l.push(...f.viewsWithButtons),u=u||f.hasTitle}return{sectionWidgets:o,viewsWithButtons:l,hasTitle:u}}function I8(r,e,t,n,i,a){let o=e.direction==="rtl",l=e.customButtons||{},u=t.buttonText||{},h=e.buttonText||{},c=t.buttonHints||{},f=e.buttonHints||{},m=r?r.split(" "):[],g=[],v=!1;return{widgets:m.map(x=>x.split(",").map(b=>{if(b==="title")return v=!0,{buttonName:b};let w,k,N,E,S,A;if(w=l[b])N=C=>{w.click&&w.click.call(C.target,C,C.target)},(E=n.getCustomButtonIconClass(w))||(E=n.getIconClass(b,o))||(S=w.text),A=w.hint||w.text;else if(k=i[b]){g.push(b),N=()=>{a.changeView(b)},(S=k.buttonTextOverride)||(E=n.getIconClass(b,o))||(S=k.buttonTextDefault);let C=k.buttonTextOverride||k.buttonTextDefault;A=Ml(k.buttonTitleOverride||k.buttonTitleDefault||e.viewHint,[C,b],C)}else if(a[b])if(N=()=>{a[b]()},(S=u[b])||(E=n.getIconClass(b,o))||(S=h[b]),b==="prevYear"||b==="nextYear"){let C=b==="prevYear"?"prev":"next";A=Ml(c[C]||f[C],[h.year||"year","year"],h[b])}else A=C=>Ml(c[b]||f[b],[h[C]||C,C],h[b]);return{buttonName:b,buttonClick:N,buttonIcon:E,buttonText:S,buttonHint:A}})),viewsWithButtons:g,hasTitle:v}}class B8{constructor(e,t,n){this.type=e,this.getCurrentData=t,this.dateEnv=n}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}let F8={ignoreRange:!0,parseMeta(r){return Array.isArray(r.events)?r.events:null},fetch(r,e){e({rawEvents:r.eventSource.meta})}};const z8=Un({name:"array-event-source",eventSourceDefs:[F8]});let U8={parseMeta(r){return typeof r.events=="function"?r.events:null},fetch(r,e,t){const{dateEnv:n}=r.context,i=r.eventSource.meta;QB(i.bind(null,sA(r.range,n)),a=>e({rawEvents:a}),t)}};const H8=Un({name:"func-event-source",eventSourceDefs:[U8]}),V8={method:String,extraParams:me,startParam:String,endParam:String,timeZoneParam:String};let q8={parseMeta(r){return r.url&&(r.format==="json"||!r.format)?{url:r.url,format:"json",method:(r.method||"GET").toUpperCase(),extraParams:r.extraParams,startParam:r.startParam,endParam:r.endParam,timeZoneParam:r.timeZoneParam}:null},fetch(r,e,t){const{meta:n}=r.eventSource,i=W8(n,r.range,r.context);JB(n.method,n.url,i).then(([a,o])=>{e({rawEvents:a,response:o})},t)}};const $8=Un({name:"json-event-source",eventSourceRefiners:V8,eventSourceDefs:[q8]});function W8(r,e,t){let{dateEnv:n,options:i}=t,a,o,l,u,h={};return a=r.startParam,a==null&&(a=i.startParam),o=r.endParam,o==null&&(o=i.endParam),l=r.timeZoneParam,l==null&&(l=i.timeZoneParam),typeof r.extraParams=="function"?u=r.extraParams():u=r.extraParams||{},Object.assign(h,u),h[a]=n.formatIso(e.start),h[o]=n.formatIso(e.end),n.timeZone!=="local"&&(h[l]=n.timeZone),h}const G8={daysOfWeek:me,startTime:rt,endTime:rt,duration:rt,startRecur:me,endRecur:me};let Y8={parse(r,e){if(r.daysOfWeek||r.startTime||r.endTime||r.startRecur||r.endRecur){let t={daysOfWeek:r.daysOfWeek||null,startTime:r.startTime||null,endTime:r.endTime||null,startRecur:r.startRecur?e.createMarker(r.startRecur):null,endRecur:r.endRecur?e.createMarker(r.endRecur):null,dateEnv:e},n;return r.duration&&(n=r.duration),!n&&r.startTime&&r.endTime&&(n=cI(r.endTime,r.startTime)),{allDayGuess:!r.startTime&&!r.endTime,duration:n,typeData:t}}return null},expand(r,e,t){let n=da(e,{start:r.startRecur,end:r.endRecur});return n?X8(r.daysOfWeek,r.startTime,r.dateEnv,t,n):[]}};const K8=Un({name:"simple-recurring-event",recurringTypes:[Y8],eventRefiners:G8});function X8(r,e,t,n,i){let a=r?D_(r):null,o=Et(i.start),l=i.end,u=[];for(e&&(e.milliseconds<0?l=ys(l,1):e.milliseconds>=1e3*60*60*24&&(o=ys(o,-1)));o<l;){let h;(!a||a[o.getUTCDay()])&&(e?h=n.add(o,e):h=o,u.push(n.createMarker(t.toDate(h)))),o=ys(o,1)}return u}const Q8=Un({name:"change-handler",optionChangeHandlers:{events(r,e){$2([r],e)},eventSources:$2}});function $2(r,e){let t=ty(e.getCurrentData().eventSources);if(t.length===1&&r.length===1&&Array.isArray(t[0]._raw)&&Array.isArray(r[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:t[0].sourceId,rawEvents:r[0]});return}let n=[];for(let i of r){let a=!1;for(let o=0;o<t.length;o+=1)if(t[o]._raw===i){t.splice(o,1),a=!0;break}a||n.push(i)}for(let i of t)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:i.sourceId});for(let i of n)e.calendarApi.addEventSource(i)}function J8(r,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},sA(r.activeRange,e.dateEnv)),{view:e.viewApi}))}function Z8(r,e){let{emitter:t}=e;t.hasHandlers("eventsSet")&&t.trigger("eventsSet",oa(r,e))}const ez=[z8,H8,$8,K8,Q8,Un({name:"misc",isLoadingFuncs:[r=>TA(r.eventSources)],propSetHandlers:{dateProfile:J8,eventStore:Z8}})];class tz{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new W0(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t=[],n;for(;n=e.shift();)this.runTask(n),t.push(n);this.drained(t)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function sz(r,e,t){let n;return/^(year|month)$/.test(r.currentRangeUnit)?n=r.currentRange:n=r.activeRange,t.formatRange(n.start,n.end,Ft(e.titleFormat||rz(r)),{isEndExclusive:r.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function rz(r){let{currentRangeUnit:e}=r;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let t=Tu(r.currentRange.start,r.currentRange.end);return t!==null&&t>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}class W2{constructor(){this.resetListeners=new Set}handleInput(e,t){const n=this.dateEnv;if(e!==n&&(typeof t=="function"?this.nowFn=t:n||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,n))for(const i of this.resetListeners.values())i()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class nz{constructor(e){this.computeCurrentViewData=ze(this._computeCurrentViewData),this.organizeRawLocales=ze(a8),this.buildLocale=ze(AA),this.buildPluginHooks=d8(),this.buildDateEnv=ze(iz),this.buildTheme=ze(az),this.parseToolbars=ze(L8),this.buildViewSpecs=ze(g8),this.buildDateProfileGenerator=cu(oz),this.buildViewApi=ze(lz),this.buildViewUiProps=cu(uz),this.buildEventUiBySource=ze(cz,Gr),this.buildEventUiBases=ze(dz),this.parseContextBusinessHours=cu(hz),this.buildTitle=ze(sz),this.nowManager=new W2,this.emitter=new yh,this.actionRunner=new tz(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=m=>{this.actionRunner.request(m)},this.props=e,this.actionRunner.pause(),this.nowManager=new W2;let t={},n=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),i=n.calendarOptions.initialView||n.pluginHooks.initialView,a=this.computeCurrentViewData(i,n,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(a.options);let o={nowManager:this.nowManager,dateEnv:n.dateEnv,options:n.calendarOptions,pluginHooks:n.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},l=j8(n.calendarOptions,n.dateEnv,this.nowManager),u=a.dateProfileGenerator.build(l);Dn(u.activeRange,l)||(l=u.currentRange.start);for(let m of n.pluginHooks.contextInit)m(o);let h=k8(n.calendarOptions,u,o),c={dynamicOptionOverrides:t,currentViewType:i,currentDate:l,dateProfile:u,businessHours:this.parseContextBusinessHours(o),eventSources:h,eventUiBases:{},eventStore:hr(),renderableEventStore:hr(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(o).selectionConfig},f=Object.assign(Object.assign({},o),c);for(let m of n.pluginHooks.reducers)Object.assign(c,m(null,null,f));Rg(c,o)&&this.emitter.trigger("loading",!0),this.state=c,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:n}=this;t===void 0?n.optionOverrides=e:(n.optionOverrides=Object.assign(Object.assign({},n.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(t===void 0||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:n,emitter:i}=this,a=w8(n.dynamicOptionOverrides,e),o=this.computeOptionsData(t.optionOverrides,a,t.calendarApi),l=v8(n.currentViewType,e),u=this.computeCurrentViewData(l,o,t.optionOverrides,a);t.calendarApi.currentDataManager=this,i.setThisContext(t.calendarApi),i.setOptions(u.options);let h={nowManager:this.nowManager,dateEnv:o.dateEnv,options:o.calendarOptions,pluginHooks:o.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:i,getCurrentData:this.getCurrentData},{currentDate:c,dateProfile:f}=n;this.data&&this.data.dateProfileGenerator!==u.dateProfileGenerator&&(f=u.dateProfileGenerator.build(c)),c=b8(c,e),f=N8(f,e,c,u.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Dn(f.currentRange,c))&&(c=f.currentRange.start);let m=E8(n.eventSources,e,f,h),g=kB(n.eventStore,e,m,f,h),y=TA(m)&&!u.options.progressiveEventRendering&&n.renderableEventStore||g,{eventUiSingleBase:x,selectionConfig:b}=this.buildViewUiProps(h),w=this.buildEventUiBySource(m),k=this.buildEventUiBases(y.defs,x,w),N={dynamicOptionOverrides:a,currentViewType:l,currentDate:c,dateProfile:f,eventSources:m,eventStore:g,renderableEventStore:y,selectionConfig:b,eventUiBases:k,businessHours:this.parseContextBusinessHours(h),dateSelection:D8(n.dateSelection,e),eventSelection:P8(n.eventSelection,e),eventDrag:M8(n.eventDrag,e),eventResize:O8(n.eventResize,e)},E=Object.assign(Object.assign({},h),N);for(let C of o.pluginHooks.reducers)Object.assign(N,C(n,e,E));let S=Rg(n,h),A=Rg(N,h);!S&&A?i.trigger("loading",!0):S&&!A&&i.trigger("loading",!1),this.state=N,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,n=this.data,i=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),a=this.computeCurrentViewData(t.currentViewType,i,e.optionOverrides,t.dynamicOptionOverrides),o=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,a.options,i.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},i),a),t),l=i.pluginHooks.optionChangeHandlers,u=n&&n.calendarOptions,h=i.calendarOptions;if(u&&u!==h){u.timeZone!==h.timeZone&&(t.eventSources=o.eventSources=S8(o.eventSources,t.dateProfile,o),t.eventStore=o.eventStore=O2(o.eventStore,n.dateEnv,o.dateEnv),t.renderableEventStore=o.renderableEventStore=O2(o.renderableEventStore,n.dateEnv,o.dateEnv));for(let c in l)(this.optionsForHandling.indexOf(c)!==-1||u[c]!==h[c])&&l[c](h[c],o)}this.optionsForHandling=[],e.onData&&e.onData(o)}computeOptionsData(e,t,n){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:i,pluginHooks:a,localeDefaults:o,availableLocaleData:l,extra:u}=this.processRawCalendarOptions(e,t);G2(u);let h=this.buildDateEnv(i.timeZone,i.locale,i.weekNumberCalculation,i.firstDay,i.weekText,a,l,i.defaultRangeSeparator),c=this.buildViewSpecs(a.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,o),f=this.buildTheme(i,a),m=this.parseToolbars(i,this.stableOptionOverrides,f,c,n);return this.stableCalendarOptionsData={calendarOptions:i,pluginHooks:a,dateEnv:h,viewSpecs:c,theme:f,toolbarConfig:m,localeDefaults:o,availableRawLocales:l.map}}processRawCalendarOptions(e,t){let{locales:n,locale:i}=wg([Ol,e,t]),a=this.organizeRawLocales(n),o=a.map,l=this.buildLocale(i||a.defaultCode,o).options,u=this.buildPluginHooks(e.plugins||[],ez),h=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},C2),T2),R2),u.listenerRefiners),u.optionRefiners),c={},f=wg([Ol,l,e,t]),m={},g=this.currentCalendarOptionsInput,v=this.currentCalendarOptionsRefined,y=!1;for(let x in f)this.optionsForRefining.indexOf(x)===-1&&(f[x]===g[x]||Yi[x]&&x in g&&Yi[x](g[x],f[x]))?m[x]=v[x]:h[x]?(m[x]=h[x](f[x]),y=!0):c[x]=g[x];return y&&(this.currentCalendarOptionsInput=f,this.currentCalendarOptionsRefined=m,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:u,availableLocaleData:a,localeDefaults:l,extra:c}}_computeCurrentViewData(e,t,n,i){let a=t.viewSpecs[e];if(!a)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:o,extra:l}=this.processRawViewOptions(a,t.pluginHooks,t.localeDefaults,n,i);G2(l),this.nowManager.handleInput(t.dateEnv,o.now);let u=this.buildDateProfileGenerator({dateProfileGeneratorClass:a.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:a.duration,durationUnit:a.durationUnit,usesMinMaxTime:a.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:o.slotMinTime,slotMaxTime:o.slotMaxTime,showNonCurrentDates:o.showNonCurrentDates,dayCount:o.dayCount,dateAlignment:o.dateAlignment,dateIncrement:o.dateIncrement,hiddenDays:o.hiddenDays,weekends:o.weekends,validRangeInput:o.validRange,visibleRangeInput:o.visibleRange,fixedWeekCount:o.fixedWeekCount}),h=this.buildViewApi(e,this.getCurrentData,t.dateEnv);return{viewSpec:a,options:o,dateProfileGenerator:u,viewApi:h}}processRawViewOptions(e,t,n,i,a){let o=wg([Ol,e.optionDefaults,n,i,e.optionOverrides,a]),l=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},C2),T2),R2),HI),t.listenerRefiners),t.optionRefiners),u={},h=this.currentViewOptionsInput,c=this.currentViewOptionsRefined,f=!1,m={};for(let g in o)o[g]===h[g]||Yi[g]&&Yi[g](o[g],h[g])?u[g]=c[g]:(o[g]===this.currentCalendarOptionsInput[g]||Yi[g]&&Yi[g](o[g],this.currentCalendarOptionsInput[g])?g in this.currentCalendarOptionsRefined&&(u[g]=this.currentCalendarOptionsRefined[g]):l[g]?u[g]=l[g](o[g]):m[g]=o[g],f=!0);return f&&(this.currentViewOptionsInput=o,this.currentViewOptionsRefined=u),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:m}}}function iz(r,e,t,n,i,a,o,l){let u=AA(e||o.defaultCode,o.map);return new ZI({calendarSystem:"gregory",timeZone:r,namedTimeZoneImpl:a.namedTimeZonedImpl,locale:u,weekNumberCalculation:t,firstDay:n,weekText:i,cmdFormatter:a.cmdFormatter,defaultSeparator:l})}function az(r,e){let t=e.themeClasses[r.themeSystem]||Ti;return new t(r)}function oz(r){let e=r.dateProfileGeneratorClass||z_;return new e(r)}function lz(r,e,t){return new B8(r,e,t)}function cz(r){return In(r,e=>e.ui)}function dz(r,e,t){let n={"":e};for(let i in r){let a=r[i];a.sourceId&&t[a.sourceId]&&(n[i]=t[a.sourceId])}return n}function uz(r){let{options:e}=r;return{eventUiSingleBase:Iu({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},r),selectionConfig:Iu({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},r)}}function Rg(r,e){for(let t of e.pluginHooks.isLoadingFuncs)if(t(r))return!0;return!1}function hz(r){return PB(r.options.businessHours,r)}function G2(r,e){for(let t in r)console.warn(`Unknown option '${t}'`)}class fz extends mt{render(){let e=this.props.widgetGroups.map(t=>this.renderWidgetGroup(t));return re("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:t}=this,{theme:n}=this.context,i=[],a=!0;for(let o of e){let{buttonName:l,buttonClick:u,buttonText:h,buttonIcon:c,buttonHint:f}=o;if(l==="title")a=!1,i.push(re("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let m=l===t.activeButton,g=!t.isTodayEnabled&&l==="today"||!t.isPrevEnabled&&l==="prev"||!t.isNextEnabled&&l==="next",v=[`fc-${l}-button`,n.getClass("button")];m&&v.push(n.getClass("buttonActive")),i.push(re("button",{type:"button",title:typeof f=="function"?f(t.navUnit):f,disabled:g,"aria-pressed":m,className:v.join(" "),onClick:u},h||(c?re("span",{className:c,role:"img"}):"")))}}if(i.length>1){let o=a&&n.getClass("buttonGroup")||"";return re("div",{className:o},...i)}return i[0]}}class Y2 extends mt{render(){let{model:e,extraClassName:t}=this.props,n=!1,i,a,o=e.sectionWidgets,l=o.center;return o.left?(n=!0,i=o.left):i=o.start,o.right?(n=!0,a=o.right):a=o.end,re("div",{className:[t||"","fc-toolbar",n?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",i||[]),this.renderSection("center",l||[]),this.renderSection("end",a||[]))}renderSection(e,t){let{props:n}=this;return re(fz,{key:e,widgetGroups:t,title:n.title,navUnit:n.navUnit,activeButton:n.activeButton,isTodayEnabled:n.isTodayEnabled,isPrevEnabled:n.isPrevEnabled,isNextEnabled:n.isNextEnabled,titleId:n.titleId})}}class mz extends mt{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,pn(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:n}=e,i=["fc-view-harness",n||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],a="",o="";return n?t.availableWidth!==null?a=t.availableWidth/n:o=`${1/n*100}%`:a=e.height||"",re("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:i.join(" "),style:{height:a,paddingBottom:o}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class pz extends Co{constructor(e){super(e),this.handleSegClick=(t,n)=>{let{component:i}=this,{context:a}=i,o=vo(n);if(o&&i.isValidSegDownEl(t.target)){let l=Ds(t.target,".fc-event-forced-url"),u=l?l.querySelector("a[href]").href:"";a.emitter.trigger("eventClick",{el:n,event:new Mt(i.context,o.eventRange.def,o.eventRange.instance),jsEvent:t,view:a.viewApi}),u&&!t.defaultPrevented&&(window.location.href=u)}},this.destroy=__(e.el,"click",".fc-event",this.handleSegClick)}}class gz extends Co{constructor(e){super(e),this.handleEventElRemove=t=>{t===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(t,n)=>{vo(n)&&(this.currentSegEl=n,this.triggerEvent("eventMouseEnter",t,n))},this.handleSegLeave=(t,n)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",t,n))},this.removeHoverListeners=Y5(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,n){let{component:i}=this,{context:a}=i,o=vo(n);(!t||i.isValidSegDownEl(t.target))&&a.emitter.trigger(e,{el:n,event:new Mt(a,o.eventRange.def,o.eventRange.instance),jsEvent:t,view:a.viewApi})}}class xz extends ga{constructor(){super(...arguments),this.buildViewContext=ze(sB),this.buildViewPropTransformers=ze(vz),this.buildToolbarProps=ze(yz),this.headerRef=Vs(),this.footerRef=Vs(),this.interactionsStore={},this.state={viewLabelId:mh()},this.registerInteractiveComponent=(e,t)=>{let n=tF(e,t),o=[pz,gz].concat(this.props.pluginHooks.componentInteractions).map(l=>new l(n));this.interactionsStore[e.uid]=o,Cx[e.uid]=n},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let n of t)n.destroy();delete this.interactionsStore[e.uid]}delete Cx[e.uid]},this.resizeRunner=new W0(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:t,options:n}=e,i=!1,a="",o;e.isHeightAuto||e.forPrint?a="":n.height!=null?i=!0:n.contentHeight!=null?a=n.contentHeight:o=Math.max(n.aspectRatio,.5);let l=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),u=t.header&&t.header.hasTitle?this.state.viewLabelId:void 0;return re(zn.Provider,{value:l},re(To,{unit:"day"},h=>{let c=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,h,e.viewTitle);return re(kt,null,t.header&&re(Y2,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:t.header,titleId:u},c)),re(mz,{liquid:i,height:a,aspectRatio:o,labeledById:u},this.renderView(e),this.buildAppendContent()),t.footer&&re(Y2,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:t.footer,titleId:""},c)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(n=>new n(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let n in t)t[n](e[n],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:n}=t.pluginHooks;for(let i in n)t[i]!==e[i]&&n[i](t[i],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,t=e.pluginHooks.viewContainerAppends.map(n=>n(e));return re(kt,{},...t)}renderView(e){let{pluginHooks:t}=e,{viewSpec:n}=e,i={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},a=this.buildViewPropTransformers(t.viewPropsTransformers);for(let l of a)Object.assign(i,l.transform(i,e));let o=n.component;return re(o,Object.assign({},i))}}function yz(r,e,t,n,i,a){let o=t.build(i,void 0,!1),l=t.buildPrev(e,n,!1),u=t.buildNext(e,n,!1);return{title:a,activeButton:r.type,navUnit:r.singleUnit,isTodayEnabled:o.isValid&&!Dn(e.currentRange,i),isPrevEnabled:l.isValid,isNextEnabled:u.isValid}}function vz(r){return r.map(e=>new e)}class bz extends rF{constructor(e,t={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=n=>{switch(n.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=n=>{this.currentData=n,this.renderRunner.request(n.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:n}=this;Mu(()=>{Kl(re(eF,{options:n.calendarOptions,theme:n.theme,emitter:n.emitter},(i,a,o,l)=>(this.setClassNames(i),this.setHeight(a),re(L_.Provider,{value:this.customContentRenderId},re(xz,Object.assign({isHeightAuto:o,forPrint:l},n))))),this.el)})}else this.isRendered&&(this.isRendered=!1,Kl(null,this.el),this.setClassNames([]),this.setHeight(""))},F5(e),this.el=e,this.renderRunner=new W0(this.handleRenderRequest),new nz({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){Mu(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!ki(e,this.currentClassNames)){let{classList:t}=this.el;for(let n of this.currentClassNames)t.remove(n);for(let n of e)t.add(n);this.currentClassNames=e}}setHeight(e){E_(this.el,"height",e)}}const jz=parseInt(String(_r.version).split(".")[0]),wz=jz<18;class OA extends R.Component{constructor(){super(...arguments),this.elRef=R.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const t of this.state.customRenderingMap.values())e.push(_r.createElement(Nz,{key:t.id,customRendering:t}));return _r.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new n8;this.handleCustomRendering=e.handle.bind(e),this.calendar=new bz(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{pu.flushSync(()=>{})});let t;e.subscribe(n=>{const i=Date.now(),a=!t;(wz||a||this.isUpdating||this.isUnmounting||i-t<100?LA:pu.flushSync)(()=>{this.setState({customRenderingMap:n},()=>{t=i,a?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}OA.act=LA;class Nz extends R.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:t}=e,n=typeof t=="function"?t(e.renderProps):t;return pu.createPortal(n,e.containerEl)}}function LA(r){r()}class kz extends xn{constructor(){super(...arguments),this.headerElRef=Vs()}renderSimpleLayout(e,t){let{props:n,context:i}=this,a=[],o=zu(i.options);return e&&a.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),a.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),re(Ou,{elClasses:["fc-daygrid"],viewSpec:i.viewSpec},re(gy,{liquid:!n.isHeightAuto&&!n.forPrint,collapsibleWidth:n.forPrint,cols:[],sections:a}))}renderHScrollLayout(e,t,n,i){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{props:o,context:l}=this,u=!o.forPrint&&zu(l.options),h=!o.forPrint&&bA(l.options),c=[];return e&&c.push({type:"header",key:"header",isSticky:u,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),c.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),h&&c.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:Dx}]}),re(Ou,{elClasses:["fc-daygrid"],viewSpec:l.viewSpec},re(a,{liquid:!o.isHeightAuto&&!o.forPrint,forPrint:o.forPrint,collapsibleWidth:o.forPrint,colGroups:[{cols:[{span:n,minWidth:i}]}],sections:c}))}}function uu(r,e){let t=[];for(let n=0;n<e;n+=1)t[n]=[];for(let n of r)t[n.row].push(n);return t}function qd(r,e){let t=[];for(let n=0;n<e;n+=1)t[n]=[];for(let n of r)t[n.firstCol].push(n);return t}function K2(r,e){let t=[];if(r){for(let n=0;n<e;n+=1)t[n]={affectedInstances:r.affectedInstances,isEvent:r.isEvent,segs:[]};for(let n of r.segs)t[n.row].segs.push(n)}else for(let n=0;n<e;n+=1)t[n]=null;return t}const IA=Ft({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function BA(r){let{display:e}=r.eventRange.ui;return e==="list-item"||e==="auto"&&!r.eventRange.def.allDay&&r.firstCol===r.lastCol&&r.isStart&&r.isEnd}class FA extends mt{render(){let{props:e}=this;return re(yy,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:IA,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class zA extends mt{render(){let{props:e,context:t}=this,{options:n}=t,{seg:i}=e,a=n.eventTimeFormat||IA,o=Z_(i,a,t,!0,e.defaultDisplayEventEnd);return re(xy,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:tA(e.seg,t),defaultGenerator:Ez,timeText:o,isResizing:!1,isDateSelecting:!1}))}}function Ez(r){return re(kt,null,re("div",{className:"fc-daygrid-event-dot",style:{borderColor:r.borderColor||r.backgroundColor}}),r.timeText&&re("div",{className:"fc-event-time"},r.timeText),re("div",{className:"fc-event-title"},r.event.title||re(kt,null,"")))}class Sz extends mt{constructor(){super(...arguments),this.compileSegs=ze(_z)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:n}=this.compileSegs(e.singlePlacements);return re(kA,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:n,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let i=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return re(kt,null,t.map(a=>{let o=a.eventRange.instance.instanceId;return re("div",{className:"fc-daygrid-event-harness",key:o,style:{visibility:i[o]?"hidden":""}},BA(a)?re(zA,Object.assign({seg:a,isDragging:!1,isSelected:o===e.eventSelection,defaultDisplayEventEnd:!1},bi(a,e.todayRange))):re(FA,Object.assign({seg:a,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:o===e.eventSelection,defaultDisplayEventEnd:!1},bi(a,e.todayRange))))}))}})}}function _z(r){let e=[],t=[];for(let n of r)e.push(n.seg),n.isVisible||t.push(n.seg);return{allSegs:e,invisibleSegs:t}}const Az=Ft({week:"narrow"});class Cz extends xn{constructor(){super(...arguments),this.rootElRef=Vs(),this.state={dayNumberId:mh()},this.handleRootEl=e=>{pn(this.rootElRef,e),pn(this.props.elRef,e)}}render(){let{context:e,props:t,state:n,rootElRef:i}=this,{options:a,dateEnv:o}=e,{date:l,dateProfile:u}=t;const h=t.showDayNumber&&Rz(l,u.currentRange,o);return re(by,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":n.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:Tz,date:l,dateProfile:u,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:h,extraRenderProps:t.extraRenderProps},(c,f)=>re("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&re(NA,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:Fu(e,l,"week"),date:l,defaultFormat:Az}),!f.isDisabled&&(t.showDayNumber||jy(a)||t.forceDayTop)?re("div",{className:"fc-daygrid-day-top"},re(c,{elTag:"a",elClasses:["fc-daygrid-day-number",h&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},Fu(e,l)),{id:n.dayNumberId})})):t.showDayNumber?re("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},re("a",{className:"fc-daygrid-day-number"},"")):void 0,re("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,re("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},re(Sz,{allDayDate:l,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:i,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),re("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function Tz(r){return r.dayNumberText||re(kt,null,"")}function Rz(r,e,t){const{start:n,end:i}=e,a=Ei(i,-1),o=t.getYear(n),l=t.getMonth(n),u=t.getYear(a),h=t.getMonth(a);return!(o===u&&l===h)&&(r.valueOf()===n.valueOf()||t.getDay(r)===1&&r.valueOf()<i.valueOf())}function UA(r){return r.eventRange.instance.instanceId+":"+r.firstCol}function HA(r){return UA(r)+":"+r.lastCol}function Dz(r,e,t,n,i,a,o){let l=new Oz(b=>{let w=r[b.index].eventRange.instance.instanceId+":"+b.span.start+":"+(b.span.end-1);return i[w]||1});l.allowReslicing=!0,l.strictOrder=n,e===!0||t===!0?(l.maxCoord=a,l.hiddenConsumes=!0):typeof e=="number"?l.maxStackCnt=e:typeof t=="number"&&(l.maxStackCnt=t,l.hiddenConsumes=!0);let u=[],h=[];for(let b=0;b<r.length;b+=1){let w=r[b],k=HA(w);i[k]!=null?u.push({index:b,span:{start:w.firstCol,end:w.lastCol+1}}):h.push(w)}let c=l.addSegs(u),f=l.toRects(),{singleColPlacements:m,multiColPlacements:g,leftoverMargins:v}=Pz(f,r,o),y=[],x=[];for(let b of h){g[b.firstCol].push({seg:b,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let w=b.firstCol;w<=b.lastCol;w+=1)m[w].push({seg:lo(b,w,w+1,o),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let b=0;b<o.length;b+=1)y.push(0);for(let b of c){let w=r[b.index],k=b.span;g[k.start].push({seg:lo(w,k.start,k.end,o),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let N=k.start;N<k.end;N+=1)y[N]+=1,m[N].push({seg:lo(w,N,N+1,o),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let b=0;b<o.length;b+=1)x.push(v[b]);return{singleColPlacements:m,multiColPlacements:g,moreCnts:y,moreMarginTops:x}}function Pz(r,e,t){let n=Mz(r,t.length),i=[],a=[],o=[];for(let l=0;l<t.length;l+=1){let u=n[l],h=[],c=0,f=0;for(let g of u){let v=e[g.index];h.push({seg:lo(v,l,l+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:g.levelCoord,marginTop:g.levelCoord-c}),c=g.levelCoord+g.thickness}let m=[];c=0,f=0;for(let g of u){let v=e[g.index],y=g.span.end-g.span.start>1,x=g.span.start===l;f+=g.levelCoord-c,c=g.levelCoord+g.thickness,y?(f+=g.thickness,x&&m.push({seg:lo(v,g.span.start,g.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:g.levelCoord,marginTop:0})):x&&(m.push({seg:lo(v,g.span.start,g.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:g.levelCoord,marginTop:f}),f=0)}i.push(h),a.push(m),o.push(f)}return{singleColPlacements:i,multiColPlacements:a,leftoverMargins:o}}function Mz(r,e){let t=[];for(let n=0;n<e;n+=1)t.push([]);for(let n of r)for(let i=n.span.start;i<n.span.end;i+=1)t[i].push(n);return t}function lo(r,e,t,n){if(r.firstCol===e&&r.lastCol===t-1)return r;let i=r.eventRange,a=i.range,o=da(a,{start:n[e].date,end:ys(n[t-1].date,1)});return Object.assign(Object.assign({},r),{firstCol:e,lastCol:t-1,eventRange:{def:i.def,ui:Object.assign(Object.assign({},i.ui),{durationEditable:!1}),instance:i.instance,range:o},isStart:r.isStart&&o.start.valueOf()===a.start.valueOf(),isEnd:r.isEnd&&o.end.valueOf()===a.end.valueOf()})}class Oz extends cA{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:n}=this,i=a=>!this.forceHidden[la(a)];for(let a=0;a<n.length;a+=1)n[a]=n[a].filter(i);return t}handleInvalidInsertion(e,t,n){const{entriesByLevel:i,forceHidden:a}=this,{touchingEntry:o,touchingLevel:l,touchingLateral:u}=e;if(this.hiddenConsumes&&o){const h=la(o);if(!a[h])if(this.allowReslicing){const c=Object.assign(Object.assign({},o),{span:my(o.span,t.span)}),f=la(c);a[f]=!0,i[l][u]=c,n.push(c),this.splitEntry(o,t,n)}else a[h]=!0,n.push(o)}super.handleInvalidInsertion(e,t,n)}}class VA extends xn{constructor(){super(...arguments),this.cellElRefs=new Rn,this.frameElRefs=new Rn,this.fgElRefs=new Rn,this.segHarnessRefs=new Rn,this.rootElRef=Vs(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:n}=this,{options:i}=n,a=e.cells.length,o=qd(e.businessHourSegs,a),l=qd(e.bgEventSegs,a),u=qd(this.getHighlightSegs(),a),h=qd(this.getMirrorSegs(),a),{singleColPlacements:c,multiColPlacements:f,moreCnts:m,moreMarginTops:g}=Dz(J_(e.fgEventSegs,i.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,i.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),v=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return re("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((y,x)=>{let b=this.renderFgSegs(x,e.forPrint?c[x]:f[x],e.todayRange,v),w=this.renderFgSegs(x,Lz(h[x],f),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return re(Cz,{key:y.key,elRef:this.cellElRefs.createRef(y.key),innerElRef:this.frameElRefs.createRef(y.key),dateProfile:e.dateProfile,date:y.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&x===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:y.extraRenderProps,extraDataAttrs:y.extraDataAttrs,extraClassNames:y.extraClassNames,extraDateSpan:y.extraDateSpan,moreCnt:m[x],moreMarginTop:g[x],singlePlacements:c[x],fgContentElRef:this.fgElRefs.createRef(y.key),fgContent:re(kt,null,re(kt,null,b),re(kt,null,w)),bgContent:re(kt,null,this.renderFillSegs(u[x],"highlight"),this.renderFillSegs(o[x],"non-business"),this.renderFillSegs(l[x],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let n=this.props;this.updateSizing(!Gr(e,n))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,n,i,a,o,l){let{context:u}=this,{eventSelection:h}=this.props,{framePositions:c}=this.state,f=this.props.cells.length===1,m=a||o||l,g=[];if(c)for(let v of t){let{seg:y}=v,{instanceId:x}=y.eventRange.instance,b=v.isVisible&&!i[x],w=v.isAbsolute,k="",N="";w&&(u.isRtl?(N=0,k=c.lefts[y.lastCol]-c.lefts[y.firstCol]):(k=0,N=c.rights[y.firstCol]-c.rights[y.lastCol])),g.push(re("div",{className:"fc-daygrid-event-harness"+(w?" fc-daygrid-event-harness-abs":""),key:UA(y),ref:m?null:this.segHarnessRefs.createRef(HA(y)),style:{visibility:b?"":"hidden",marginTop:w?"":v.marginTop,top:w?v.absoluteTop:"",left:k,right:N}},BA(y)?re(zA,Object.assign({seg:y,isDragging:a,isSelected:x===h,defaultDisplayEventEnd:f},bi(y,n))):re(FA,Object.assign({seg:y,isDragging:a,isResizing:o,isDateSelecting:l,isSelected:x===h,defaultDisplayEventEnd:f},bi(y,n)))))}return g}renderFillSegs(e,t){let{isRtl:n}=this.context,{todayRange:i}=this.props,{framePositions:a}=this.state,o=[];if(a)for(let l of e){let u=n?{right:0,left:a.lefts[l.lastCol]-a.lefts[l.firstCol]}:{left:0,right:a.rights[l.firstCol]-a.rights[l.lastCol]};o.push(re("div",{key:eA(l.eventRange),className:"fc-daygrid-bg-harness",style:u},t==="bg-event"?re(jA,Object.assign({seg:l},bi(l,i))):wA(t)))}return re(kt,{},...o)}updateSizing(e){let{props:t,state:n,frameElRefs:i}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let u=t.cells.map(h=>i.currentMap[h.key]);if(u.length){let h=this.rootElRef.current,c=new bo(h,u,!0,!1);(!n.framePositions||!n.framePositions.similarTo(c))&&this.setState({framePositions:new bo(h,u,!0,!1)})}}const a=this.state.segHeights,o=this.querySegHeights(),l=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},a),o),maxContentHeight:l?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let n in e){let i=Math.round(e[n].getBoundingClientRect().height);t[n]=Math.max(t[n]||0,i)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],n=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-n.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}VA.addStateEquality({segHeights:Gr});function Lz(r,e){if(!r.length)return[];let t=Iz(e);return r.map(n=>({seg:n,isVisible:!0,isAbsolute:!0,absoluteTop:t[n.eventRange.instance.instanceId],marginTop:0}))}function Iz(r){let e={};for(let t of r)for(let n of t)e[n.seg.eventRange.instance.instanceId]=n.absoluteTop;return e}class Bz extends xn{constructor(){super(...arguments),this.splitBusinessHourSegs=ze(uu),this.splitBgEventSegs=ze(Fz),this.splitFgEventSegs=ze(uu),this.splitDateSelectionSegs=ze(uu),this.splitEventDrag=ze(K2),this.splitEventResize=ze(K2),this.rowRefs=new Rn}render(){let{props:e,context:t}=this,n=e.cells.length,i=this.splitBusinessHourSegs(e.businessHourSegs,n),a=this.splitBgEventSegs(e.bgEventSegs,n),o=this.splitFgEventSegs(e.fgEventSegs,n),l=this.splitDateSelectionSegs(e.dateSelectionSegs,n),u=this.splitEventDrag(e.eventDrag,n),h=this.splitEventResize(e.eventResize,n),c=n>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return re(To,{unit:"day"},(f,m)=>re(kt,null,e.cells.map((g,v)=>re(VA,{ref:this.rowRefs.createRef(v),key:g.length?g[0].date.toISOString():v,showDayNumbers:n>1,showWeekNumbers:e.showWeekNumbers,todayRange:m,dateProfile:e.dateProfile,cells:g,renderIntro:e.renderRowIntro,businessHourSegs:i[v],eventSelection:e.eventSelection,bgEventSegs:a[v],fgEventSegs:o[v],dateSelectionSegs:l[v],eventDrag:u[v],eventResize:h[v],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:c,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new bo(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new bo(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:n,rowPositions:i}=this,a=n.leftToIndex(e),o=i.topToIndex(t);if(o!=null&&a!=null){let l=this.props.cells[o][a];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(o,a),allDay:!0},l.extraDateSpan),dayEl:this.getCellEl(o,a),rect:{left:n.lefts[a],right:n.rights[a],top:i.tops[o],bottom:i.bottoms[o]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let n=this.props.cells[e][t].date,i=ys(n,1);return{start:n,end:i}}}function Fz(r,e){return uu(r.filter(zz),e)}function zz(r){return r.eventRange.def.allDay}class Uz extends xn{constructor(){super(...arguments),this.elRef=Vs(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:n,expandRows:i}=e,a=n===!0||t===!0;a&&!i&&(a=!1,t=null,n=null);let o=["fc-daygrid-body",a?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",i?"":"fc-daygrid-body-natural"];return re("div",{ref:this.elRef,className:o.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},re("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:i?e.clientHeight:""}},e.colGroupNode,re("tbody",{role:"presentation"},re(Bz,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:n,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=Hz(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),n=t.closest(".fc-scroller"),i=e.getBoundingClientRect().top-t.getBoundingClientRect().top;n.scrollTop=i?i+1:0}this.needsScrollReset=!1}}}function Hz(r,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=r.querySelector(`[data-date="${EI(e.currentDate)}-01"]`)),t||(t=r.querySelector(`[data-date="${Q0(e.currentDate)}"]`)),t}class Vz extends pA{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class qA extends xn{constructor(){super(...arguments),this.slicer=new Vz,this.tableRef=Vs()}render(){let{props:e,context:t}=this;return re(Uz,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class qz extends kz{constructor(){super(...arguments),this.buildDayTableModel=ze($z),this.headerRef=Vs(),this.tableRef=Vs()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:n}=this,i=this.buildDayTableModel(n.dateProfile,t),a=e.dayHeaders&&re(hA,{ref:this.headerRef,dateProfile:n.dateProfile,dates:i.headerDates,datesRepDistinctDays:i.rowCnt===1}),o=l=>re(qA,{ref:this.tableRef,dateProfile:n.dateProfile,dayTableModel:i,businessHours:n.businessHours,dateSelection:n.dateSelection,eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:n.eventSelection,eventDrag:n.eventDrag,eventResize:n.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:l.tableColGroupNode,tableMinWidth:l.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!n.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:l.clientWidth,clientHeight:l.clientHeight,forPrint:n.forPrint});return e.dayMinWidth?this.renderHScrollLayout(a,o,i.colCnt,e.dayMinWidth):this.renderSimpleLayout(a,o)}}function $z(r,e){let t=new fA(r.renderRange,e);return new mA(t,/year|month|week/.test(r.currentRangeUnit))}class Wz extends z_{buildRenderRange(e,t,n){let i=super.buildRenderRange(e,t,n),{props:a}=this;return Gz({currentRange:i,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:a.fixedWeekCount,dateEnv:a.dateEnv})}}function Gz(r){let{dateEnv:e,currentRange:t}=r,{start:n,end:i}=t,a;if(r.snapToWeek&&(n=e.startOfWeek(n),a=e.startOfWeek(i),a.valueOf()!==i.valueOf()&&(i=k2(a,1))),r.fixedWeekCount){let o=e.startOfWeek(e.startOfMonth(ys(t.end,-1))),l=Math.ceil(mI(o,i));i=k2(i,6-l)}return{start:n,end:i}}var Yz=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';$0(Yz);var Kz=Un({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:qz,dateProfileGeneratorClass:Wz},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});class Xz extends lF{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?BB(e)?["timed","allDay"]:["allDay"]:["timed"]}}const Qz=Ft({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function $A(r){let e=["fc-timegrid-slot","fc-timegrid-slot-label",r.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return re(zn.Consumer,null,t=>{if(!r.isLabeled)return re("td",{className:e.join(" "),"data-time":r.isoTimeStr});let{dateEnv:n,options:i,viewApi:a}=t,o=i.slotLabelFormat==null?Qz:Array.isArray(i.slotLabelFormat)?Ft(i.slotLabelFormat[0]):Ft(i.slotLabelFormat),l={level:0,time:r.time,date:n.toDate(r.date),view:a,text:n.format(r.date,o)};return re(fr,{elTag:"td",elClasses:e,elAttrs:{"data-time":r.isoTimeStr},renderProps:l,generatorName:"slotLabelContent",customGenerator:i.slotLabelContent,defaultGenerator:Jz,classNameGenerator:i.slotLabelClassNames,didMount:i.slotLabelDidMount,willUnmount:i.slotLabelWillUnmount},u=>re("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},re(u,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function Jz(r){return r.text}class Zz extends mt{render(){return this.props.slatMetas.map(e=>re("tr",{key:e.key},re($A,Object.assign({},e))))}}const e9=Ft({week:"short"}),t9=5;class s9 extends xn{constructor(){super(...arguments),this.allDaySplitter=new Xz,this.headerElRef=Vs(),this.rootElRef=Vs(),this.scrollerElRef=Vs(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:n}=this.context,{dateProfile:i}=this.props,a=i.renderRange,l=pa(a.start,a.end)===1?Fu(this.context,a.start,"week"):{};return n.weekNumbers&&e==="day"?re(NA,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:a.start,defaultFormat:e9},u=>re("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},re(u,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:l}))):re("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},re("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:n}=this.context,i={text:t.allDayText,view:n};return re(fr,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:i,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:r9,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},a=>re("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",e==null?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},re(a,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,n){let{context:i,props:a}=this,o=[],l=zu(i.options);return e&&o.push({type:"header",key:"header",isSticky:l,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(o.push({type:"body",key:"all-day",chunk:{content:t}}),o.push({type:"body",key:"all-day-divider",outerContent:re("tr",{role:"presentation",className:"fc-scrollgrid-section"},re("td",{className:"fc-timegrid-divider "+i.theme.getClass("tableCellShaded")}))})),o.push({type:"body",key:"body",liquid:!0,expandRows:!!i.options.expandRows,chunk:{scrollerElRef:this.scrollerElRef,content:n}}),re(Ou,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:i.viewSpec},re(gy,{liquid:!a.isHeightAuto&&!a.forPrint,collapsibleWidth:a.forPrint,cols:[{width:"shrink"}],sections:o}))}renderHScrollLayout(e,t,n,i,a,o,l){let u=this.context.pluginHooks.scrollGridImpl;if(!u)throw new Error("No ScrollGrid implementation");let{context:h,props:c}=this,f=!c.forPrint&&zu(h.options),m=!c.forPrint&&bA(h.options),g=[];e&&g.push({type:"header",key:"header",isSticky:f,syncRowHeights:!0,chunks:[{key:"axis",rowContent:y=>re("tr",{role:"presentation"},this.renderHeadAxis("day",y.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(g.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:y=>re("tr",{role:"presentation"},this.renderTableRowAxis(y.rowSyncHeights[0]))},{key:"cols",content:t}]}),g.push({key:"all-day-divider",type:"body",outerContent:re("tr",{role:"presentation",className:"fc-scrollgrid-section"},re("td",{colSpan:2,className:"fc-timegrid-divider "+h.theme.getClass("tableCellShaded")}))}));let v=h.options.nowIndicator;return g.push({type:"body",key:"body",liquid:!0,expandRows:!!h.options.expandRows,chunks:[{key:"axis",content:y=>re("div",{className:"fc-timegrid-axis-chunk"},re("table",{"aria-hidden":!0,style:{height:y.expandRows?y.clientHeight:""}},y.tableColGroupNode,re("tbody",null,re(Zz,{slatMetas:o}))),re("div",{className:"fc-timegrid-now-indicator-container"},re(To,{unit:v?"minute":"day"},x=>{let b=v&&l&&l.safeComputeTop(x);return typeof b=="number"?re(vy,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:b},isAxis:!0,date:x}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:n}]}),m&&g.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:Dx},{key:"cols",content:Dx}]}),re(Ou,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:h.viewSpec},re(u,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:i,minWidth:a}]}],sections:g}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return(e===!0||t===!0)&&(e=void 0,t=t9),{dayMaxEvents:e,dayMaxEventRows:t}}}function r9(r){return r.text}class n9{constructor(e,t,n){this.positions=e,this.dateProfile=t,this.slotDuration=n}safeComputeTop(e){let{dateProfile:t}=this;if(Dn(t.currentRange,e)){let n=Et(e),i=e.valueOf()-n.valueOf();if(i>=Vr(t.slotMinTime)&&i<Vr(t.slotMaxTime))return this.computeTimeTop(rt(i))}return null}computeDateTop(e,t){return t||(t=Et(e)),this.computeTimeTop(rt(e.valueOf()-t.valueOf()))}computeTimeTop(e){let{positions:t,dateProfile:n}=this,i=t.els.length,a=(e.milliseconds-Vr(n.slotMinTime))/Vr(this.slotDuration),o,l;return a=Math.max(0,a),a=Math.min(i,a),o=Math.floor(a),o=Math.min(o,i-1),l=a-o,t.tops[o]+t.getHeight(o)*l}}class i9 extends mt{render(){let{props:e,context:t}=this,{options:n}=t,{slatElRefs:i}=e;return re("tbody",null,e.slatMetas.map((a,o)=>{let l={time:a.time,date:t.dateEnv.toDate(a.date),view:t.viewApi};return re("tr",{key:a.key,ref:i.createRef(a.key)},e.axis&&re($A,Object.assign({},a)),re(fr,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!a.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":a.isoTimeStr},renderProps:l,generatorName:"slotLaneContent",customGenerator:n.slotLaneContent,classNameGenerator:n.slotLaneClassNames,didMount:n.slotLaneDidMount,willUnmount:n.slotLaneWillUnmount}))}))}}class a9 extends mt{constructor(){super(...arguments),this.rootElRef=Vs(),this.slatElRefs=new Rn}render(){let{props:e,context:t}=this;return re("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},re("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,re(i9,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;t.onCoords&&t.clientWidth!==null&&this.rootElRef.current.offsetHeight&&t.onCoords(new n9(new bo(this.rootElRef.current,o9(this.slatElRefs.currentMap,t.slatMetas),!1,!0),this.props.dateProfile,e.options.slotDuration))}}function o9(r,e){return e.map(t=>r[t.key])}function gl(r,e){let t=[],n;for(n=0;n<e;n+=1)t.push([]);if(r)for(n=0;n<r.length;n+=1)t[r[n].col].push(r[n]);return t}function X2(r,e){let t=[];if(r){for(let n=0;n<e;n+=1)t[n]={affectedInstances:r.affectedInstances,isEvent:r.isEvent,segs:[]};for(let n of r.segs)t[n.col].segs.push(n)}else for(let n=0;n<e;n+=1)t[n]=null;return t}class l9 extends mt{render(){let{props:e}=this;return re(kA,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>GA(e.hiddenSegs,e),defaultGenerator:c9,forceTimed:!0},t=>re(t,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function c9(r){return r.shortText}function d9(r,e,t){let n=new cA;e!=null&&(n.strictOrder=e),t!=null&&(n.maxStackCnt=t);let i=n.addSegs(r),a=jF(i),o=u9(n);return o=p9(o,1),{segRects:g9(o),hiddenGroups:a}}function u9(r){const{entriesByLevel:e}=r,t=Ny((n,i)=>n+":"+i,(n,i)=>{let a=m9(r,n,i),o=Q2(a,t),l=e[n][i];return[Object.assign(Object.assign({},l),{nextLevelNodes:o[0]}),l.thickness+o[1]]});return Q2(e.length?{level:0,lateralStart:0,lateralEnd:e[0].length}:null,t)[0]}function Q2(r,e){if(!r)return[[],0];let{level:t,lateralStart:n,lateralEnd:i}=r,a=n,o=[];for(;a<i;)o.push(e(t,a)),a+=1;return o.sort(h9),[o.map(f9),o[0][1]]}function h9(r,e){return e[1]-r[1]}function f9(r){return r[0]}function m9(r,e,t){let{levelCoords:n,entriesByLevel:i}=r,a=i[e][t],o=n[e]+a.thickness,l=n.length,u=e;for(;u<l&&n[u]<o;u+=1);for(;u<l;u+=1){let h=i[u],c,f=Rx(h,a.span.start,Tx),m=f[0]+f[1],g=m;for(;(c=h[g])&&c.span.start<a.span.end;)g+=1;if(m<g)return{level:u,lateralStart:m,lateralEnd:g}}return null}function p9(r,e){const t=Ny((n,i,a)=>la(n),(n,i,a)=>{let{nextLevelNodes:o,thickness:l}=n,u=l+a,h=l/u,c,f=[];if(!o.length)c=e;else for(let g of o)if(c===void 0){let v=t(g,i,u);c=v[0],f.push(v[1])}else{let v=t(g,c,0);f.push(v[1])}let m=(c-i)*h;return[c-m,Object.assign(Object.assign({},n),{thickness:m,nextLevelNodes:f})]});return r.map(n=>t(n,0,0)[1])}function g9(r){let e=[];const t=Ny((i,a,o)=>la(i),(i,a,o)=>{let l=Object.assign(Object.assign({},i),{levelCoord:a,stackDepth:o,stackForward:0});return e.push(l),l.stackForward=n(i.nextLevelNodes,a+i.thickness,o+1)+1});function n(i,a,o){let l=0;for(let u of i)l=Math.max(t(u,a,o),l);return l}return n(r,0,0),e}function Ny(r,e){const t={};return(...n)=>{let i=r(...n);return i in t?t[i]:t[i]=e(...n)}}function J2(r,e,t=null,n=0){let i=[];if(t)for(let a=0;a<r.length;a+=1){let o=r[a],l=t.computeDateTop(o.start,e),u=Math.max(l+(n||0),t.computeDateTop(o.end,e));i.push({start:Math.round(l),end:Math.round(u)})}return i}function x9(r,e,t,n){let i=[],a=[];for(let h=0;h<r.length;h+=1){let c=e[h];c?i.push({index:h,thickness:1,span:c}):a.push(r[h])}let{segRects:o,hiddenGroups:l}=d9(i,t,n),u=[];for(let h of o)u.push({seg:r[h.index],rect:h});for(let h of a)u.push({seg:h,rect:null});return{segPlacements:u,hiddenGroups:l}}const y9=Ft({hour:"numeric",minute:"2-digit",meridiem:!1});class WA extends mt{render(){return re(yy,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:y9}))}}class v9 extends mt{constructor(){super(...arguments),this.sortEventSegs=ze(J_)}render(){let{props:e,context:t}=this,{options:n}=t,i=n.selectMirror,a=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||i&&e.dateSelectionSegs||[],o=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},l=this.sortEventSegs(e.fgEventSegs,n.eventOrder);return re(by,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},u=>re("div",{className:"fc-timegrid-col-frame"},re("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),re("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(l,o,!1,!1,!1)),re("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(a,{},!!e.eventDrag,!!e.eventResize,!!i,"mirror")),re("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),jy(n)&&re(u,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,n,i,a,o){let{props:l}=this;return l.forPrint?GA(e,l):this.renderPositionedFgSegs(e,t,n,i,a,o)}renderPositionedFgSegs(e,t,n,i,a,o){let{eventMaxStack:l,eventShortHeight:u,eventOrderStrict:h,eventMinHeight:c}=this.context.options,{date:f,slatCoords:m,eventSelection:g,todayRange:v,nowDate:y}=this.props,x=n||i||a,b=J2(e,f,m,c),{segPlacements:w,hiddenGroups:k}=x9(e,b,h,l);return re(kt,null,this.renderHiddenGroups(k,e),w.map(N=>{let{seg:E,rect:S}=N,A=E.eventRange.instance.instanceId,C=x||!!(!t[A]&&S),I=Dg(S&&S.span),L=!x&&S?this.computeSegHStyle(S):{left:0,right:0},M=!!S&&S.stackForward>0,D=!!S&&S.span.end-S.span.start<u;return re("div",{className:"fc-timegrid-event-harness"+(M?" fc-timegrid-event-harness-inset":""),key:o||A,style:Object.assign(Object.assign({visibility:C?"":"hidden"},I),L)},re(WA,Object.assign({seg:E,isDragging:n,isResizing:i,isDateSelecting:a,isSelected:A===g,isShort:D},bi(E,v,y))))}))}renderHiddenGroups(e,t){let{extraDateSpan:n,dateProfile:i,todayRange:a,nowDate:o,eventSelection:l,eventDrag:u,eventResize:h}=this.props;return re(kt,null,e.map(c=>{let f=Dg(c.span),m=b9(c.entries,t);return re(l9,{key:R_(EA(m)),hiddenSegs:m,top:f.top,bottom:f.bottom,extraDateSpan:n,dateProfile:i,todayRange:a,nowDate:o,eventSelection:l,eventDrag:u,eventResize:h})}))}renderFillSegs(e,t){let{props:n,context:i}=this,o=J2(e,n.date,n.slatCoords,i.options.eventMinHeight).map((l,u)=>{let h=e[u];return re("div",{key:eA(h.eventRange),className:"fc-timegrid-bg-harness",style:Dg(l)},t==="bg-event"?re(jA,Object.assign({seg:h},bi(h,n.todayRange,n.nowDate))):wA(t))});return re(kt,null,o)}renderNowIndicator(e){let{slatCoords:t,date:n}=this.props;return t?e.map((i,a)=>re(vy,{key:a,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(i.start,n)},isAxis:!1,date:n})):null}computeSegHStyle(e){let{isRtl:t,options:n}=this.context,i=n.slotEventOverlap,a=e.levelCoord,o=e.levelCoord+e.thickness,l,u;i&&(o=Math.min(1,a+(o-a)*2)),t?(l=1-o,u=a):(l=a,u=1-o);let h={zIndex:e.stackDepth+1,left:l*100+"%",right:u*100+"%"};return i&&!e.stackForward&&(h[t?"marginLeft":"marginRight"]=20),h}}function GA(r,{todayRange:e,nowDate:t,eventSelection:n,eventDrag:i,eventResize:a}){let o=(i?i.affectedInstances:null)||(a?a.affectedInstances:null)||{};return re(kt,null,r.map(l=>{let u=l.eventRange.instance.instanceId;return re("div",{key:u,style:{visibility:o[u]?"hidden":""}},re(WA,Object.assign({seg:l,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:u===n,isShort:!1},bi(l,e,t))))}))}function Dg(r){return r?{top:r.start,bottom:-r.end}:{top:"",bottom:""}}function b9(r,e){return r.map(t=>e[t.index])}class j9 extends mt{constructor(){super(...arguments),this.splitFgEventSegs=ze(gl),this.splitBgEventSegs=ze(gl),this.splitBusinessHourSegs=ze(gl),this.splitNowIndicatorSegs=ze(gl),this.splitDateSelectionSegs=ze(gl),this.splitEventDrag=ze(X2),this.splitEventResize=ze(X2),this.rootElRef=Vs(),this.cellElRefs=new Rn}render(){let{props:e,context:t}=this,n=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),i=e.cells.length,a=this.splitFgEventSegs(e.fgEventSegs,i),o=this.splitBgEventSegs(e.bgEventSegs,i),l=this.splitBusinessHourSegs(e.businessHourSegs,i),u=this.splitNowIndicatorSegs(e.nowIndicatorSegs,i),h=this.splitDateSelectionSegs(e.dateSelectionSegs,i),c=this.splitEventDrag(e.eventDrag,i),f=this.splitEventResize(e.eventResize,i);return re("div",{className:"fc-timegrid-cols",ref:this.rootElRef},re("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,re("tbody",{role:"presentation"},re("tr",{role:"row"},e.axis&&re("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},re("div",{className:"fc-timegrid-col-frame"},re("div",{className:"fc-timegrid-now-indicator-container"},typeof n=="number"&&re(vy,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:n},isAxis:!0,date:e.nowDate})))),e.cells.map((m,g)=>re(v9,{key:m.key,elRef:this.cellElRefs.createRef(m.key),dateProfile:e.dateProfile,date:m.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:m.extraRenderProps,extraDataAttrs:m.extraDataAttrs,extraClassNames:m.extraClassNames,extraDateSpan:m.extraDateSpan,fgEventSegs:a[g],bgEventSegs:o[g],businessHourSegs:l[g],nowIndicatorSegs:u[g],dateSelectionSegs:h[g],eventDrag:c[g],eventResize:f[g],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;e.onColCoords&&e.clientWidth!==null&&e.onColCoords(new bo(this.rootElRef.current,w9(this.cellElRefs.currentMap,e.cells),!0,!1))}}function w9(r,e){return e.map(t=>r[t.key])}class N9 extends xn{constructor(){super(...arguments),this.processSlotOptions=ze(k9),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:n}=this.state;if(t&&n){if(e.time){let i=n.computeTimeTop(e.time);i=Math.ceil(i),i&&(i+=1),t(i)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return re("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},re(a9,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),re(j9,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:n,options:i}=this.context,{colCoords:a}=this,{dateProfile:o}=this.props,{slatCoords:l}=this.state,{snapDuration:u,snapsPerSlot:h}=this.processSlotOptions(this.props.slotDuration,i.snapDuration),c=a.leftToIndex(e),f=l.positions.topToIndex(t);if(c!=null&&f!=null){let m=this.props.cells[c],g=l.positions.tops[f],v=l.positions.getHeight(f),y=(t-g)/v,x=Math.floor(y*h),b=f*h+x,w=this.props.cells[c].date,k=kx(o.slotMinTime,dI(u,b)),N=n.add(w,k),E=n.add(N,u);return{dateProfile:o,dateSpan:Object.assign({range:{start:N,end:E},allDay:!1},m.extraDateSpan),dayEl:a.els[c],rect:{left:a.lefts[c],right:a.rights[c],top:g,bottom:g+v},layer:0}}return null}}function k9(r,e){let t=e||r,n=X0(r,t);return n===null&&(t=r,n=1),{snapDuration:t,snapsPerSlot:n}}class E9 extends pA{sliceRange(e,t){let n=[];for(let i=0;i<t.length;i+=1){let a=da(e,t[i]);a&&n.push({start:a.start,end:a.end,isStart:a.start.valueOf()===e.start.valueOf(),isEnd:a.end.valueOf()===e.end.valueOf(),col:i})}return n}}class S9 extends xn{constructor(){super(...arguments),this.buildDayRanges=ze(_9),this.slicer=new E9,this.timeColsRef=Vs()}render(){let{props:e,context:t}=this,{dateProfile:n,dayTableModel:i}=e,{nowIndicator:a,nextDayThreshold:o}=t.options,l=this.buildDayRanges(i,n,t.dateEnv);return re(To,{unit:a?"minute":"day"},(u,h)=>re(N9,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,n,null,t,l),{forPrint:e.forPrint,axis:e.axis,dateProfile:n,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:i.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:u,nowIndicatorSegs:a&&this.slicer.sliceNowDate(u,n,o,t,l),todayRange:h,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function _9(r,e,t){let n=[];for(let i of r.headerDates)n.push({start:t.add(i,e.slotMinTime),end:t.add(i,e.slotMaxTime)});return n}const Z2=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function A9(r,e,t,n,i){let a=new Date(0),o=r,l=rt(0),u=t||C9(n),h=[];for(;Vr(o)<Vr(e);){let c=i.add(a,o),f=X0(l,u)!==null;h.push({date:c,time:o,key:c.toISOString(),isoTimeStr:SI(c),isLabeled:f}),o=kx(o,n),l=kx(l,n)}return h}function C9(r){let e,t,n;for(e=Z2.length-1;e>=0;e-=1)if(t=rt(Z2[e]),n=X0(t,r),n!==null&&n>1)return t;return r}class T9 extends s9{constructor(){super(...arguments),this.buildTimeColsModel=ze(R9),this.buildSlatMetas=ze(A9)}render(){let{options:e,dateEnv:t,dateProfileGenerator:n}=this.context,{props:i}=this,{dateProfile:a}=i,o=this.buildTimeColsModel(a,n),l=this.allDaySplitter.splitProps(i),u=this.buildSlatMetas(a.slotMinTime,a.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:h}=e,c=!h,f=h,m=e.dayHeaders&&re(hA,{dates:o.headerDates,dateProfile:a,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),g=e.allDaySlot!==!1&&(y=>re(qA,Object.assign({},l.allDay,{dateProfile:a,dayTableModel:o,nextDayThreshold:e.nextDayThreshold,tableMinWidth:y.tableMinWidth,colGroupNode:y.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:y.clientWidth,clientHeight:y.clientHeight,forPrint:i.forPrint},this.getAllDayMaxEventProps()))),v=y=>re(S9,Object.assign({},l.timed,{dayTableModel:o,dateProfile:a,axis:c,slotDuration:e.slotDuration,slatMetas:u,forPrint:i.forPrint,tableColGroupNode:y.tableColGroupNode,tableMinWidth:y.tableMinWidth,clientWidth:y.clientWidth,clientHeight:y.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:y.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return f?this.renderHScrollLayout(m,g,v,o.colCnt,h,u,this.state.slatCoords):this.renderSimpleLayout(m,g,v)}}function R9(r,e){let t=new fA(r.renderRange,e);return new mA(t,!1)}var D9='.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}';$0(D9);const P9={allDaySlot:Boolean};var M9=Un({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:P9,views:{timeGrid:{component:T9,usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});py.touchMouseIgnoreWait=500;let Mx=0,Uu=0,Ox=!1;class YA{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&O9(t)&&this.tryStart(t)){let n=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",n),this.initScrollWatch(n),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let n=this.createEventFromMouse(t);this.recordCoords(n),this.emitter.trigger("pointermove",n)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let n=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",n),this.initScrollWatch(n);let i=t.target;this.shouldIgnoreMove||i.addEventListener("touchmove",this.handleTouchMove),i.addEventListener("touchend",this.handleTouchEnd),i.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let n=this.createEventFromTouch(t);this.recordCoords(n),this.emitter.trigger("pointermove",n)},this.handleTouchEnd=t=>{if(this.isDragging){let n=t.target;n.removeEventListener("touchmove",this.handleTouchMove),n.removeEventListener("touchend",this.handleTouchEnd),n.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,L9()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let n=window.scrollX-this.prevScrollX+this.prevPageX,i=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:n,pageY:i,deltaX:n-this.origPageX,deltaY:i-this.origPageY})}},this.containerEl=e,this.emitter=new yh,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),I9()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),B9()}tryStart(e){let t=this.querySubjectEl(e),n=e.target;return t&&(!this.handleSelector||Ds(n,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){Ox=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?Ds(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return Mx||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(Ox=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let n=0,i=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,i=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:i}}createEventFromTouch(e,t){let n=e.touches,i,a,o=0,l=0;return n&&n.length?(i=n[0].pageX,a=n[0].pageY):(i=e.pageX,a=e.pageY),t?(this.origPageX=i,this.origPageY=a):(o=i-this.origPageX,l=a-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:i,pageY:a,deltaX:o,deltaY:l}}}function O9(r){return r.button===0&&!r.ctrlKey}function L9(){Mx+=1,setTimeout(()=>{Mx-=1},py.touchMouseIgnoreWait)}function I9(){Uu+=1,Uu===1&&window.addEventListener("touchmove",KA,{passive:!1})}function B9(){Uu-=1,Uu||window.removeEventListener("touchmove",KA,{passive:!1})}function KA(r){Ox&&r.preventDefault()}class F9{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=n-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let n=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)}doRevertAnimation(e,t){let n=this.mirrorEl,i=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",Pl(n,{left:i.left,top:i.top}),K5(n,()=>{n.style.transition="",e()})}cleanup(){this.mirrorEl&&(G0(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Pl(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Pl(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class XA extends fy{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class QA extends XA{constructor(e,t){super(new vF(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return xF(this.scrollController.el)}}class z9 extends XA{constructor(e){super(new bF,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const ek=typeof performance=="function"?performance.now:Date.now;class U9{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=ek();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,n){this.isEnabled&&(this.scrollCaches=this.buildCaches(n),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let n=e-window.scrollX,i=t-window.scrollY,a=this.pointerScreenY===null?0:i-this.pointerScreenY,o=this.pointerScreenX===null?0:n-this.pointerScreenX;a<0?this.everMovedUp=!0:a>0&&(this.everMovedDown=!0),o<0?this.everMovedLeft=!0:o>0&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=i,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(ek()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:n}=e,{edgeThreshold:i}=this,a=i-e.distance,o=a*a/(i*i)*this.maxVelocity*t,l=1;switch(e.name){case"left":l=-1;case"right":n.setScrollLeft(n.getScrollLeft()+o*l);break;case"top":l=-1;case"bottom":n.setScrollTop(n.getScrollTop()+o*l);break}}computeBestEdge(e,t){let{edgeThreshold:n}=this,i=null,a=this.scrollCaches||[];for(let o of a){let l=o.clientRect,u=e-l.left,h=l.right-e,c=t-l.top,f=l.bottom-t;u>=0&&h>=0&&c>=0&&f>=0&&(c<=n&&this.everMovedUp&&o.canScrollUp()&&(!i||i.distance>c)&&(i={scrollCache:o,name:"top",distance:c}),f<=n&&this.everMovedDown&&o.canScrollDown()&&(!i||i.distance>f)&&(i={scrollCache:o,name:"bottom",distance:f}),u<=n&&this.everMovedLeft&&o.canScrollLeft()&&(!i||i.distance>u)&&(i={scrollCache:o,name:"left",distance:u}),h<=n&&this.everMovedRight&&o.canScrollRight()&&(!i||i.distance>h)&&(i={scrollCache:o,name:"right",distance:h}))}return i}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new z9(!1):new QA(t,!1))}queryScrollEls(e){let t=[];for(let n of this.scrollQuery)typeof n=="object"?t.push(n):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(n)));return t}}class lc extends NF{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=i=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,X5(document.body),J5(document.body),i.isTouch||i.origEvent.preventDefault(),this.emitter.trigger("pointerdown",i),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(i.subjectEl,i.pageX,i.pageY),this.startDelay(i),this.minDistance||this.handleDistanceSurpassed(i)))},this.onPointerMove=i=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",i),!this.isDistanceSurpassed){let a=this.minDistance,o,{deltaX:l,deltaY:u}=i;o=l*l+u*u,o>=a*a&&this.handleDistanceSurpassed(i)}this.isDragging&&(i.origEvent.type!=="scroll"&&(this.mirror.handleMove(i.pageX,i.pageY),this.autoScroller.handleMove(i.pageX,i.pageY)),this.emitter.trigger("dragmove",i))}},this.onPointerUp=i=>{this.isInteracting&&(this.isInteracting=!1,Q5(document.body),Z5(document.body),this.emitter.trigger("pointerup",i),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(i)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let n=this.pointer=new YA(e);n.emitter.on("pointerdown",this.onPointerDown),n.emitter.on("pointermove",this.onPointerMove),n.emitter.on("pointerup",this.onPointerUp),t&&(n.selector=t),this.mirror=new F9,this.autoScroller=new U9}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class H9{constructor(e){this.el=e,this.origRect=hy(e),this.scrollCaches=lA(e).map(t=>new QA(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let n={left:e,top:t};for(let i of this.scrollCaches)if(!V9(i.getEventTarget())&&!nF(n,i.clientRect))return!1;return!0}}function V9(r){let e=r.tagName;return e==="HTML"||e==="BODY"}class vh{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=n=>{let{dragging:i}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(n),this.initialHit||!this.requireInitial?(i.setIgnoreMove(!1),this.emitter.trigger("pointerdown",n)):i.setIgnoreMove(!0)},this.handleDragStart=n=>{this.emitter.trigger("dragstart",n),this.handleMove(n,!0)},this.handleDragMove=n=>{this.emitter.trigger("dragmove",n),this.handleMove(n)},this.handlePointerUp=n=>{this.releaseHits(),this.emitter.trigger("pointerup",n)},this.handleDragEnd=n=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,n),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",n)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new yh}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},n=t,i=e.subjectEl,a;i instanceof HTMLElement&&(a=hy(i),n=iF(n,a));let o=this.initialHit=this.queryHitForOffset(n.left,n.top);if(o){if(this.useSubjectCenter&&a){let l=iA(a,o.rect);l&&(n=aF(l))}this.coordAdjust=oF(n,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!bh(this.movingHit,n))&&(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))}prepareHits(){this.offsetTrackers=In(this.droppableStore,e=>(e.component.prepareHits(),new H9(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:n,offsetTrackers:i}=this,a=null;for(let o in n){let l=n[o].component,u=i[o];if(u&&u.isWithinClipping(e,t)){let h=u.computeLeft(),c=u.computeTop(),f=e-h,m=t-c,{origRect:g}=u,v=g.right-g.left,y=g.bottom-g.top;if(f>=0&&f<v&&m>=0&&m<y){let x=l.queryHit(f,m,v,y);x&&gh(x.dateProfile.activeRange,x.dateSpan.range)&&(this.disablePointCheck||u.el.contains(u.el.getRootNode().elementFromPoint(f+h-window.scrollX,m+c-window.scrollY)))&&(!a||x.layer>a.layer)&&(x.componentId=o,x.context=l.context,x.rect.left+=h,x.rect.right+=h,x.rect.top+=c,x.rect.bottom+=c,a=x)}}}return a}}function bh(r,e){return!r&&!e?!0:!!r!=!!e?!1:GB(r.dateSpan,e.dateSpan)}function JA(r,e){let t={};for(let n of e.pluginHooks.datePointTransforms)Object.assign(t,n(r,e));return Object.assign(t,q9(r,e.dateEnv)),t}function q9(r,e){return{date:e.toDate(r.range.start),dateStr:e.formatIso(r.range.start,{omitTime:r.allDay}),allDay:r.allDay}}class $9 extends Co{constructor(e){super(e),this.handlePointerDown=n=>{let{dragging:i}=this,a=n.origEvent.target;i.setIgnoreMove(!this.component.isValidDateDownEl(a))},this.handleDragEnd=n=>{let{component:i}=this,{pointer:a}=this.dragging;if(!a.wasTouchScroll){let{initialHit:o,finalHit:l}=this.hitDragging;if(o&&l&&bh(o,l)){let{context:u}=i,h=Object.assign(Object.assign({},JA(o.dateSpan,u)),{dayEl:o.dayEl,jsEvent:n.origEvent,view:u.viewApi||u.calendarApi.view});u.emitter.trigger("dateClick",h)}}},this.dragging=new lc(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new vh(this.dragging,dy(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class W9 extends Co{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=o=>{let{component:l,dragging:u}=this,{options:h}=l.context,c=h.selectable&&l.isValidDateDownEl(o.origEvent.target);u.setIgnoreMove(!c),u.delay=o.isTouch?G9(l):null},this.handleDragStart=o=>{this.component.context.calendarApi.unselect(o)},this.handleHitUpdate=(o,l)=>{let{context:u}=this.component,h=null,c=!1;if(o){let f=this.hitDragging.initialHit;o.componentId===f.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(f,o)||(h=Y9(f,o,u.pluginHooks.dateSelectionTransformers)),(!h||!CF(h,o.dateProfile,u))&&(c=!0,h=null)}h?u.dispatch({type:"SELECT_DATES",selection:h}):l||u.dispatch({type:"UNSELECT_DATES"}),c?Y0():K0(),l||(this.dragSelection=h)},this.handlePointerUp=o=>{this.dragSelection&&(K_(this.dragSelection,o,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:n}=t.context,i=this.dragging=new lc(e.el);i.touchScrollAllowed=!1,i.minDistance=n.selectMinDistance||0,i.autoScroller.isEnabled=n.dragScroll;let a=this.hitDragging=new vh(this.dragging,dy(e));a.emitter.on("pointerdown",this.handlePointerDown),a.emitter.on("dragstart",this.handleDragStart),a.emitter.on("hitupdate",this.handleHitUpdate),a.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function G9(r){let{options:e}=r.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function Y9(r,e,t){let n=r.dateSpan,i=e.dateSpan,a=[n.range.start,n.range.end,i.range.start,i.range.end];a.sort(nI);let o={};for(let l of t){let u=l(r,e);if(u===!1)return null;u&&Object.assign(o,u)}return o.range={start:a[0],end:a[3]},o.allDay=n.allDay,o}class cc extends Co{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=o=>{let l=o.origEvent.target,{component:u,dragging:h}=this,{mirror:c}=h,{options:f}=u.context,m=u.context;this.subjectEl=o.subjectEl;let g=this.subjectSeg=vo(o.subjectEl),y=(this.eventRange=g.eventRange).instance.instanceId;this.relevantEvents=ay(m.getCurrentData().eventStore,y),h.minDistance=o.isTouch?0:f.eventDragMinDistance,h.delay=o.isTouch&&y!==u.props.eventSelection?X9(u):null,f.fixedMirrorParent?c.parentNode=f.fixedMirrorParent:c.parentNode=Ds(l,".fc"),c.revertDuration=f.dragRevertDuration;let x=u.isValidSegDownEl(l)&&!Ds(l,".fc-event-resizer");h.setIgnoreMove(!x),this.isDragging=x&&o.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=o=>{let l=this.component.context,u=this.eventRange,h=u.instance.instanceId;o.isTouch?h!==this.component.props.eventSelection&&l.dispatch({type:"SELECT_EVENT",eventInstanceId:h}):l.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(l.calendarApi.unselect(o),l.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Mt(l,u.def,u.instance),jsEvent:o.origEvent,view:l.viewApi}))},this.handleHitUpdate=(o,l)=>{if(!this.isDragging)return;let u=this.relevantEvents,h=this.hitDragging.initialHit,c=this.component.context,f=null,m=null,g=null,v=!1,y={affectedEvents:u,mutatedEvents:hr(),isEvent:!0};if(o){f=o.context;let x=f.options;c===f||x.editable&&x.droppable?(m=K9(h,o,this.eventRange.instance.range.start,f.getCurrentData().pluginHooks.eventDragMutationMassagers),m&&(g=cy(u,f.getCurrentData().eventUiBases,m,f),y.mutatedEvents=g,gA(y,o.dateProfile,f)||(v=!0,m=null,g=null,y.mutatedEvents=hr()))):f=null}this.displayDrag(f,y),v?Y0():K0(),l||(c===f&&bh(h,o)&&(m=null),this.dragging.setMirrorNeedsRevert(!m),this.dragging.setMirrorIsVisible(!o||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=f,this.validMutation=m,this.mutatedRelevantEvents=g)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=o=>{if(this.isDragging){let l=this.component.context,u=l.viewApi,{receivingContext:h,validMutation:c}=this,f=this.eventRange.def,m=this.eventRange.instance,g=new Mt(l,f,m),v=this.relevantEvents,y=this.mutatedRelevantEvents,{finalHit:x}=this.hitDragging;if(this.clearDrag(),l.emitter.trigger("eventDragStop",{el:this.subjectEl,event:g,jsEvent:o.origEvent,view:u}),c){if(h===l){let b=new Mt(l,y.defs[f.defId],m?y.instances[m.instanceId]:null);l.dispatch({type:"MERGE_EVENTS",eventStore:y});let w={oldEvent:g,event:b,relatedEvents:oa(y,l,m),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:v})}},k={};for(let N of l.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(k,N(c,l));l.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},w),k),{el:o.subjectEl,delta:c.datesDelta,jsEvent:o.origEvent,view:u})),l.emitter.trigger("eventChange",w)}else if(h){let b={event:g,relatedEvents:oa(v,l,m),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:v})}};l.emitter.trigger("eventLeave",Object.assign(Object.assign({},b),{draggedEl:o.subjectEl,view:u})),l.dispatch({type:"REMOVE_EVENTS",eventStore:v}),l.emitter.trigger("eventRemove",b);let w=y.defs[f.defId],k=y.instances[m.instanceId],N=new Mt(h,w,k);h.dispatch({type:"MERGE_EVENTS",eventStore:y});let E={event:N,relatedEvents:oa(y,h,k),revert(){h.dispatch({type:"REMOVE_EVENTS",eventStore:y})}};h.emitter.trigger("eventAdd",E),o.isTouch&&h.dispatch({type:"SELECT_EVENT",eventInstanceId:m.instanceId}),h.emitter.trigger("drop",Object.assign(Object.assign({},JA(x.dateSpan,h)),{draggedEl:o.subjectEl,jsEvent:o.origEvent,view:x.context.viewApi})),h.emitter.trigger("eventReceive",Object.assign(Object.assign({},E),{draggedEl:o.subjectEl,view:x.context.viewApi}))}}else l.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:n}=t.context,i=this.dragging=new lc(e.el);i.pointer.selector=cc.SELECTOR,i.touchScrollAllowed=!1,i.autoScroller.isEnabled=n.dragScroll;let a=this.hitDragging=new vh(this.dragging,Cx);a.useSubjectCenter=e.useEventCenter,a.emitter.on("pointerdown",this.handlePointerDown),a.emitter.on("dragstart",this.handleDragStart),a.emitter.on("hitupdate",this.handleHitUpdate),a.emitter.on("pointerup",this.handlePointerUp),a.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let n=this.component.context,i=this.receivingContext;i&&i!==e&&(i===n?i.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:hr(),isEvent:!0}}):i.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}cc.SELECTOR=".fc-event-draggable, .fc-event-resizable";function K9(r,e,t,n){let i=r.dateSpan,a=e.dateSpan,o=i.range.start,l=a.range.start,u={};i.allDay!==a.allDay&&(u.allDay=a.allDay,u.hasEnd=e.context.options.allDayMaintainDuration,a.allDay?o=Et(t):o=t);let h=to(o,l,r.context.dateEnv,r.componentId===e.componentId?r.largeUnit:null);h.milliseconds&&(u.allDay=!1);let c={datesDelta:h,standardProps:u};for(let f of n)f(c,r,e);return c}function X9(r){let{options:e}=r.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}class Q9 extends Co{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=a=>{let{component:o}=this,l=this.querySegEl(a),u=vo(l),h=this.eventRange=u.eventRange;this.dragging.minDistance=o.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(a.origEvent.target)||a.isTouch&&this.component.props.eventSelection!==h.instance.instanceId)},this.handleDragStart=a=>{let{context:o}=this.component,l=this.eventRange;this.relevantEvents=ay(o.getCurrentData().eventStore,this.eventRange.instance.instanceId);let u=this.querySegEl(a);this.draggingSegEl=u,this.draggingSeg=vo(u),o.calendarApi.unselect(),o.emitter.trigger("eventResizeStart",{el:u,event:new Mt(o,l.def,l.instance),jsEvent:a.origEvent,view:o.viewApi})},this.handleHitUpdate=(a,o,l)=>{let{context:u}=this.component,h=this.relevantEvents,c=this.hitDragging.initialHit,f=this.eventRange.instance,m=null,g=null,v=!1,y={affectedEvents:h,mutatedEvents:hr(),isEvent:!0};a&&(a.componentId===c.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(c,a)||(m=J9(c,a,l.subjectEl.classList.contains("fc-event-resizer-start"),f.range))),m&&(g=cy(h,u.getCurrentData().eventUiBases,m,u),y.mutatedEvents=g,gA(y,a.dateProfile,u)||(v=!0,m=null,g=null,y.mutatedEvents=null)),g?u.dispatch({type:"SET_EVENT_RESIZE",state:y}):u.dispatch({type:"UNSET_EVENT_RESIZE"}),v?Y0():K0(),o||(m&&bh(c,a)&&(m=null),this.validMutation=m,this.mutatedRelevantEvents=g)},this.handleDragEnd=a=>{let{context:o}=this.component,l=this.eventRange.def,u=this.eventRange.instance,h=new Mt(o,l,u),c=this.relevantEvents,f=this.mutatedRelevantEvents;if(o.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:h,jsEvent:a.origEvent,view:o.viewApi}),this.validMutation){let m=new Mt(o,f.defs[l.defId],u?f.instances[u.instanceId]:null);o.dispatch({type:"MERGE_EVENTS",eventStore:f});let g={oldEvent:h,event:m,relatedEvents:oa(f,o,u),revert(){o.dispatch({type:"MERGE_EVENTS",eventStore:c})}};o.emitter.trigger("eventResize",Object.assign(Object.assign({},g),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||rt(0),endDelta:this.validMutation.endDelta||rt(0),jsEvent:a.origEvent,view:o.viewApi})),o.emitter.trigger("eventChange",g)}else o.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,n=this.dragging=new lc(e.el);n.pointer.selector=".fc-event-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.context.options.dragScroll;let i=this.hitDragging=new vh(this.dragging,dy(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return Ds(e.subjectEl,".fc-event")}}function J9(r,e,t,n){let i=r.context.dateEnv,a=r.dateSpan.range.start,o=e.dateSpan.range.start,l=to(a,o,i,r.largeUnit);if(t){if(i.add(n.start,l)<n.end)return{startDelta:l}}else if(i.add(n.end,l)>n.start)return{endDelta:l};return null}class Z9{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=n=>{n.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=n=>{let i=this.context.options.unselectCancel,a=S_(n.origEvent);this.matchesCancel=!!Ds(a,i),this.matchesEvent=!!Ds(a,cc.SELECTOR)},this.onDocumentPointerUp=n=>{let{context:i}=this,{documentPointer:a}=this,o=i.getCurrentData();if(!a.wasTouchScroll){if(o.dateSelection&&!this.isRecentPointerDateSelect){let l=i.options.unselectAuto;l&&(!l||!this.matchesCancel)&&i.calendarApi.unselect(n)}o.eventSelection&&!this.matchesEvent&&i.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new YA(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const e7={fixedMirrorParent:me},t7={dateClick:me,eventDragStart:me,eventDragStop:me,eventDrop:me,eventResizeStart:me,eventResizeStop:me,eventResize:me,drop:me,eventReceive:me,eventLeave:me};py.dataAttrPrefix="";var s7=Un({name:"@fullcalendar/interaction",componentInteractions:[$9,W9,cc,Q9],calendarInteractions:[Z9],elementDraggingImpl:lc,optionRefiners:e7,listenerRefiners:t7}),r7={code:"fr",week:{dow:1,doy:4},buttonText:{prev:"Prcdent",next:"Suivant",today:"Aujourd'hui",year:"Anne",month:"Mois",week:"Semaine",day:"Jour",list:"Planning"},weekText:"Sem.",weekTextLong:"Semaine",allDayText:"Toute la journe",moreLinkText:"en plus",noEventsText:"Aucun vnement  afficher"};const n7=()=>{const r=R.useRef(null),{events:e,loading:t,error:n,fetchEvents:i,registerForEvent:a}=hh(),{user:o}=st(),[l,u]=R.useState(null),[h,c]=R.useState(!1),f=e.map(y=>({id:y.id,title:y.title,start:y.event_date,end:y.event_date,extendedProps:{description:y.description,location:y.location,max_participants:y.max_participants,registered_count:y.registered_count||0,price:y.price,image_url:y.image_url},backgroundColor:m(y.type),borderColor:m(y.type),textColor:"#ffffff"}));function m(y){switch(y){case"conference":return"#3b82f6";case"workshop":return"#10b981";case"webinar":return"#8b5cf6";case"club_meeting":return"#f59e0b";case"festival":return"#ef4444";default:return"#6b7280"}}const g=y=>{const x=y.event;u({id:x.id,title:x.title,start:x.start,end:x.end,...x.extendedProps}),c(!0)},v=async y=>{try{await a(y),c(!1),i()}catch(x){console.error("Error registering for event:",x)}};return R.useEffect(()=>{i()},[]),t?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):n?s.jsxs("div",{className:"text-center py-8",children:[s.jsxs("p",{className:"text-red-600 mb-4",children:["Erreur lors du chargement du calendrier: ",n]}),s.jsx(oe,{onClick:i,children:"Ressayer"})]}):s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Je,{className:"text-blue-600"}),"Calendrier des vnements"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Consultez les vnements littraires  venir"})]})}),s.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded"}),s.jsx("span",{children:"Confrence"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),s.jsx("span",{children:"Atelier"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 bg-purple-500 rounded"}),s.jsx("span",{children:"Webinaire"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 bg-amber-500 rounded"}),s.jsx("span",{children:"Club"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),s.jsx("span",{children:"Festival"})]})]}),s.jsx("div",{className:"calendar-container",children:s.jsx(OA,{ref:r,plugins:[Kz,M9,s7],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"dayGridMonth",locale:r7,events:f,eventClick:g,height:"auto",aspectRatio:1.8,eventDisplay:"block",dayMaxEvents:3,moreLinkClick:"popover",eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!1}})}),h&&l&&s.jsx(ac,{isOpen:h,onClose:()=>c(!1),size:"lg",children:s.jsxs("div",{className:"p-6",children:[s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:l.title}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(Je,{}),s.jsx("span",{children:new Date(l.start).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),l.location&&s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(Mn,{}),s.jsx("span",{children:l.location})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(Me,{}),s.jsxs("span",{children:[l.registered_count||0," / ",l.max_participants||""," participants"]})]}),l.description&&s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),s.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:l.description})]}),s.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[s.jsx(oe,{variant:"secondary",onClick:()=>c(!1),className:"flex-1",children:"Fermer"}),o&&s.jsx(oe,{onClick:()=>v(l.id),className:"flex-1",disabled:l.registered_count>=l.max_participants&&l.max_participants>0,children:l.registered_count>=l.max_participants&&l.max_participants>0?"Complet":"S'inscrire"})]})]})]})})]})},i7=()=>{const{user:r}=st(),[e,t]=R.useState(!1),[n,i]=R.useState(!1),[a,o]=R.useState(!1),[l,u]=R.useState(!1),[h,c]=R.useState([{id:1,name:"Alice Dupont",role:"host",isMuted:!1,isCameraOn:!0},{id:2,name:"Jean Martin",role:"participant",isMuted:!0,isCameraOn:!1},{id:3,name:"Marie Claire",role:"participant",isMuted:!1,isCameraOn:!0}]),[f,m]=R.useState([{id:1,user:"Alice Dupont",message:"Bienvenue  tous !",timestamp:new Date},{id:2,user:"Jean Martin",message:"Merci pour cette session !",timestamp:new Date}]),[g,v]=R.useState("");R.useRef(null),R.useRef(null),R.useRef(null);const y=()=>{t(!0),console.log("Starting live session...")},x=()=>{t(!1),u(!1),console.log("Stopping live session...")},b=()=>i(!n),w=()=>o(!a),k=()=>u(!l),N=()=>{g.trim()&&(m([...f,{id:f.length+1,user:r?.name||r?.nom||"Vous",message:g,timestamp:new Date}]),v(""))},E=S=>{S.key==="Enter"&&N()};return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[s.jsx(Ur,{})," Session Live Interactive"]}),s.jsx("p",{className:"mt-1 opacity-90",children:e?"Session en cours":"Session inactive - Interface de dmonstration"})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Me,{className:"text-green-300"})," ",s.jsxs("span",{className:"font-semibold",children:[h.length," participants"]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 p-6",children:[s.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-video",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ur,{className:"text-4xl mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"Votre camra"}),s.jsx("p",{className:"text-xs opacity-70 mt-1",children:a?"Camra teinte":"Camra active"})]})}),s.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:["Vous ",n&&"(muet)"]})]}),s.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-video",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ur,{className:"text-4xl mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:l?"Partage d'cran":"Participant principal"}),s.jsx("p",{className:"text-xs opacity-70 mt-1",children:e?"Session active":"En attente de session"})]})}),s.jsx("div",{className:"absolute bottom-4 left-4 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:l?"Partage d'cran":"Participant principal"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center justify-center gap-4",children:[s.jsx(oe,{onClick:b,variant:n?"danger":"secondary",size:"lg",className:"rounded-full w-12 h-12 p-0",children:n?s.jsx(Hj,{}):s.jsx(nP,{})}),s.jsx(oe,{onClick:w,variant:a?"danger":"secondary",size:"lg",className:"rounded-full w-12 h-12 p-0",children:a?s.jsx($j,{}):s.jsx(Ur,{})}),s.jsx(oe,{onClick:k,variant:l?"primary":"secondary",size:"lg",className:"rounded-full w-12 h-12 p-0",children:s.jsx(iP,{})}),s.jsx("div",{className:"w-px h-8 bg-gray-300"}),e?s.jsxs(oe,{onClick:x,variant:"danger",size:"lg",className:"flex items-center gap-2 px-6",children:[s.jsx(cP,{})," Arrter la session"]}):s.jsxs(oe,{onClick:y,variant:"success",size:"lg",className:"flex items-center gap-2 px-6",children:[s.jsx(Gg,{})," Dmarrer la session"]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(Me,{})," Participants (",h.length,")"]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:h.map(S=>s.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:S.name.charAt(0)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:S.name}),s.jsxs("div",{className:"flex items-center gap-2",children:[S.isMuted&&s.jsx(Hj,{className:"text-red-500 text-xs"})," ",!S.isCameraOn&&s.jsx($j,{className:"text-red-500 text-xs"}),s.jsx("span",{className:"text-xs text-gray-500 capitalize",children:S.role})]})]})]},S.id))})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex flex-col h-80",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[s.jsx(mn,{})," Chat"]}),s.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 mb-3",children:f.map(S=>s.jsxs("div",{className:"text-sm",children:[s.jsxs("span",{className:"font-medium text-blue-600",children:[S.user,":"]}),s.jsx("span",{className:"text-gray-700 ml-1",children:S.message})]},S.id))}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"text",value:g,onChange:S=>v(S.target.value),onKeyPress:E,placeholder:"Tapez votre message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),s.jsx(oe,{onClick:N,size:"sm",disabled:!g.trim(),children:"Envoyer"})]})]})]})]}),s.jsx("div",{className:"bg-blue-50 border-t border-blue-200 p-4",children:s.jsx("div",{className:"text-center text-blue-700 text-sm",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Interface de dmonstration :"})," Cette interface est statique en attendant l'intgration des vritables sessions live."]})})})]})},a7=()=>{const[r,e]=R.useState("calendar"),t=[{id:"calendar",label:"Calendrier des vnements",icon:Je,description:"Explorez tous les vnements littraires  venir",color:"blue"},{id:"live",label:"Sessions Live",icon:Ur,description:"Participez aux discussions en direct avec les auteurs",color:"purple"}];return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30 pt-20 pb-12",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:"text-center mb-16",children:[s.jsx(W.h1,{initial:{scale:.9},animate:{scale:1},transition:{delay:.2},className:"text-5xl md:text-6xl font-bold bg-gradient-to-br from-gray-900 to-blue-800 bg-clip-text text-transparent mb-6",children:"vnements & Sessions"}),s.jsx(W.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed",children:"Dcouvrez les vnements littraires et participez aux sessions interactives avec notre communaut de passionns"})]}),s.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"sticky top-20 z-30 bg-white/90 backdrop-blur-lg border-b border-gray-200 shadow-sm mb-12",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex overflow-x-auto py-4 gap-2 scrollbar-hide",children:t.map(n=>s.jsxs(W.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e(n.id),className:`flex items-center gap-3 px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all duration-300 flex-shrink-0 ${r===n.id?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[s.jsx(n.icon,{size:18}),n.label]},n.id))})})}),s.jsx(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"mb-12"}),s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:s.jsxs(zs,{mode:"wait",children:[r==="calendar"&&s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:s.jsxs("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(Je,{className:"text-white text-lg"})}),"Calendrier des vnements"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Parcourez et planifiez votre participation aux vnements"})]})}),s.jsx(n7,{})]})},"calendar"),r==="live"&&s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:s.jsxs("div",{className:"bg-white rounded-3xl shadow-xl border border-gray-200 p-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center shadow-lg mr-4",children:s.jsx(Ur,{className:"text-white text-lg"})}),"Sessions Live"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Rejoignez les discussions en direct avec auteurs et lecteurs"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-300 font-semibold",children:[s.jsx(ko,{size:16}),"Filtrer"]}),s.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 font-semibold",children:[s.jsx(bt,{size:16}),"Nouvelle Session"]})]})]}),s.jsx(i7,{})]})},"live")]})}),s.jsx(W.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2},className:"mt-16"})]})})};function o7({children:r}){const{user:e,isAuthenticated:t,isAdmin:n}=st(),i=Yr();return!t||!e?.token?s.jsx(Dj,{to:"/login",state:{from:i.pathname,message:"Vous devez tre connect pour accder  l'administration"},replace:!0}):n?r:s.jsx(Dj,{to:"/",state:{message:"Accs refus. Vous n'avez pas les permissions d'administrateur."},replace:!0})}function l7({isCollapsed:r,onToggleCollapse:e}){const t=Yr(),n=[{path:"/admin",label:"Tableau de Bord",icon:s.jsx(n0,{className:"w-5 h-5"}),description:"Vue d'ensemble"},{path:"/admin/marketplace",label:"Marketplace",icon:s.jsx(qr,{className:"w-5 h-5"}),description:"Produits & Catalogue"},{path:"/admin/orders",label:"Commandes",icon:s.jsx(xs,{className:"w-5 h-5"}),description:"Ventes & Commandes"},{path:"/admin/campaigns",label:"Campagnes",icon:s.jsx($t,{className:"w-5 h-5"}),description:"Financement participatif"},{path:"/admin/events",label:"vnements",icon:s.jsx(Je,{className:"w-5 h-5"}),description:"Calendrier & Sessions"},{path:"/admin/users",label:"Utilisateurs",icon:s.jsx(Me,{className:"w-5 h-5"}),description:"Gestion des comptes"},{path:"/admin/books",label:"Bibliothque",icon:s.jsx(et,{className:"w-5 h-5"}),description:"Livres & Publications"},{path:"/admin/challenges",label:"Dfis",icon:s.jsx(fs,{className:"w-5 h-5"}),description:"Challenges & Badges"},{path:"/admin/analytics",label:"Statistiques",icon:s.jsx(ct,{className:"w-5 h-5"}),description:"Rapports & Analyses"},{path:"/admin/moderation",label:"Modration",icon:s.jsx(mn,{className:"w-5 h-5"}),description:"Contenus & Commentaires"},{path:"/admin/settings",label:"Paramtres",icon:s.jsx(ji,{className:"w-5 h-5"}),description:"Configuration systme"}];return s.jsxs(W.div,{initial:!1,animate:{width:r?80:280},transition:{duration:.3,ease:"easeInOut"},className:"bg-white border-r border-gray-200 shadow-lg flex flex-col h-full",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[!r&&s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"A"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-bold text-gray-900 text-sm",children:"Administration"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Vakio Boky"})]})]}),s.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:r?s.jsx(r0,{className:"w-4 h-4 text-gray-600"}):s.jsx(s0,{className:"w-4 h-4 text-gray-600"})})]})}),s.jsx("nav",{className:"flex-1 p-4 space-y-2 overflow-y-auto",children:n.map(i=>{const a=t.pathname===i.path;return s.jsxs(tr,{to:i.path,className:`flex items-center gap-3 px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 group relative ${a?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,title:r?i.label:i.description,children:[s.jsx("span",{className:`${a?"text-white":"text-gray-500 group-hover:text-gray-700"}`,children:i.icon}),!r&&s.jsx(W.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{delay:.1},className:"truncate",children:i.label}),a&&s.jsx(W.div,{layoutId:"activeTab",className:"absolute right-2 w-2 h-2 bg-white rounded-full"}),r&&s.jsxs("div",{className:"absolute left-full ml-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:[i.label,s.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]})]},i.path)})}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:!r&&s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Version 1.0.0"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:" 2024 Vakio Boky"})]})})]})}function c7({children:r}){const{user:e,logout:t}=st(),n=qs(),[i,a]=R.useState(!1),[o,l]=R.useState(!1),u=()=>{t(),a(!1),n("/")},h=()=>{a(!1),n("/profile")},c=e?.nom||e?.user?.nom||"Administrateur",f=c.split(" ")[0];return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[s.jsx(l7,{isCollapsed:o,onToggleCollapse:()=>l(!o)}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>l(!o),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:s.jsx(rP,{className:"w-5 h-5 text-gray-600"})}),s.jsxs("nav",{className:"flex items-center gap-2 text-sm",children:[s.jsxs(tr,{to:"/",className:"flex items-center gap-1 text-gray-500 hover:text-blue-600 transition-colors",children:[s.jsx(n0,{className:"w-4 h-4"}),"Accueil"]}),s.jsx("span",{className:"text-gray-300",children:"/"}),s.jsx("span",{className:"text-gray-900 font-medium",children:"Administration"})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"relative",children:[s.jsxs(W.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>a(!i),className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-white text-blue-600 rounded-full flex items-center justify-center text-sm font-bold",children:c.charAt(0).toUpperCase()}),s.jsxs("div",{className:"text-left hidden sm:block",children:[s.jsx("span",{className:"text-sm font-semibold block leading-tight",children:f.length>12?f.slice(0,12)+"...":f}),s.jsx("span",{className:"text-xs opacity-90 block leading-tight",children:"Administrateur"})]})]}),i&&s.jsxs(W.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"absolute right-0 mt-3 w-56 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:c}),s.jsx("p",{className:"text-xs text-gray-500 truncate",children:e?.email})]}),s.jsxs("button",{onClick:h,className:"flex items-center gap-3 w-full px-4 py-3 text-gray-700 hover:bg-gray-50 transition-colors text-left",children:[s.jsx(Qt,{size:16,className:"text-gray-400"}),s.jsx("span",{className:"text-sm font-medium",children:"Mon Profil"})]}),s.jsxs("button",{onClick:u,className:"flex items-center gap-3 w-full px-4 py-3 text-red-600 hover:bg-red-50 transition-colors text-left",children:[s.jsx(Jk,{size:16}),s.jsx("span",{className:"text-sm font-medium",children:"Dconnexion"})]})]})]})})]})}),s.jsx("main",{className:"flex-1 overflow-y-auto",children:s.jsx("div",{className:"p-6",children:r})})]}),!o&&s.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/10 z-40",onClick:()=>l(!0)}),i&&s.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>a(!1)})]})}function d7(){const{user:r,isAuthenticated:e,logout:t}=st(),[n,i]=R.useState({products:0,orders:0,users:0,donations:0,pendingOrders:0,activeCampaigns:0,publishedBooks:0,activeChallenges:0}),[a,o]=R.useState([]),[l,u]=R.useState(!0),[h,c]=R.useState(!1),[f,m]=R.useState("");R.useEffect(()=>{e&&g()},[e]);const g=async()=>{try{u(!0),m("");const w=r?.token;if(!w){m("Token non trouv. Veuillez vous reconnecter.");return}console.log(" Token utilis depuis useAuth:",w);const k=await fetch("https://vakio-boky-backend.onrender.com/api/admin/dashboard/stats",{method:"GET",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}});if(console.log(" Statut rponse stats:",k.status),k.status===403){m("Accs refus. Vrifiez vos permissions administrateur.");return}if(!k.ok)throw new Error(`Erreur HTTP: ${k.status}`);const N=await k.json();console.log(" Donnes stats:",N),N.success?i(N.stats):m(N.error||"Erreur lors de la rcupration des statistiques");const E=await fetch("https://vakio-boky-backend.onrender.com/api/admin/dashboard/activity",{method:"GET",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}});if(console.log(" Statut rponse activit:",E.status),E.status===403){f||m("Accs refus pour l'activit rcente.");return}if(!E.ok)throw new Error(`Erreur HTTP: ${E.status}`);const S=await E.json();console.log(" Donnes activit:",S),S.success&&o(S.activity)}catch(w){console.error(" Erreur chargement dashboard:",w),m(w.message),i({products:3,orders:4,users:3,donations:101481,pendingOrders:0,activeCampaigns:2,publishedBooks:2,activeChallenges:0})}finally{u(!1),c(!1)}},v=()=>{c(!0),m(""),g()},y=[{title:"Gestion Marketplace",description:"Grer les produits, commandes et inventaire",icon:s.jsx(qr,{className:"w-8 h-8"}),path:"/admin/marketplace",color:"bg-blue-500",stats:`${n.products} Produits actifs`},{title:"Commandes & Ventes",description:"Suivre les commandes et analyser les ventes",icon:s.jsx(xs,{className:"w-8 h-8"}),path:"/admin/orders",color:"bg-green-500",stats:`${n.pendingOrders} Commandes en attente`},{title:"Campagnes de Financement",description:"Grer les campagnes de dons et collectes",icon:s.jsx($t,{className:"w-8 h-8"}),path:"/admin/campaigns",color:"bg-red-500",stats:`${n.activeCampaigns} Campagnes actives`},{title:"vnements",description:"Organiser et grer les vnements littraires",icon:s.jsx(Je,{className:"w-8 h-8"}),path:"/admin/events",color:"bg-purple-500",stats:"vnements  venir"},{title:"Utilisateurs",description:"Grer les comptes utilisateurs et rles",icon:s.jsx(Me,{className:"w-8 h-8"}),path:"/admin/users",color:"bg-indigo-500",stats:`${n.users} Utilisateurs actifs`},{title:"Bibliothque",description:"Approuver et grer les livres publis",icon:s.jsx(et,{className:"w-8 h-8"}),path:"/admin/books",color:"bg-yellow-500",stats:`${n.publishedBooks} Livres publis`},{title:"Dfis & Badges",description:"Crer et grer les challenges de lecture",icon:s.jsx(fs,{className:"w-8 h-8"}),path:"/admin/challenges",color:"bg-orange-500",stats:`${n.activeChallenges} Dfis actifs`},{title:"Statistiques",description:"Analyser les mtriques de la plateforme",icon:s.jsx(ct,{className:"w-8 h-8"}),path:"/admin/analytics",color:"bg-teal-500",stats:"Rapports disponibles"},{title:"Modration",description:"Grer les commentaires et contenus",icon:s.jsx(mn,{className:"w-8 h-8"}),path:"/admin/moderation",color:"bg-pink-500",stats:"lments en attente"},{title:"Paramtres Systme",description:"Configuration gnrale de la plateforme",icon:s.jsx(ji,{className:"w-8 h-8"}),path:"/admin/settings",color:"bg-gray-500",stats:"Paramtres actifs"}],x=w=>{switch(w){case"order":return s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"});case"user":return s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"});case"campaign":return s.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"});case"donation":return s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"});default:return s.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"})}},b=w=>{const k=new Date,N=new Date(w),E=Math.floor((k-N)/(1e3*60));return E<1?" l'instant":E<60?`Il y a ${E} min`:E<1440?`Il y a ${Math.floor(E/60)}h`:`Il y a ${Math.floor(E/1440)}j`};return e?l?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-lg",children:"Chargement du tableau de bord..."})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Tableau de Bord Administrateur"}),s.jsxs("p",{className:"text-blue-100 text-lg",children:["Bienvenue, ",r?.nom||r?.user?.nom||"Administrateur",". Grez votre plateforme littraire."]}),f&&s.jsxs("div",{className:"mt-4 p-3 bg-red-500/80 rounded-lg",children:[s.jsx("p",{className:"text-white text-sm",children:f}),s.jsx("button",{onClick:t,className:"mt-2 px-4 py-2 bg-white text-red-600 rounded-lg text-sm font-medium",children:"Se reconnecter"})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("button",{onClick:v,disabled:h,className:"flex items-center space-x-2 bg-white/20 hover:bg-white/30 transition-colors px-4 py-2 rounded-lg backdrop-blur-sm",children:[s.jsx(Wr,{className:`w-4 h-4 ${h?"animate-spin":""}`}),s.jsx("span",{className:"text-sm",children:"Actualiser"})]}),s.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-blue-200 text-sm",children:"Connect en tant que"}),s.jsx("p",{className:"font-semibold text-white",children:r?.email||r?.user?.email}),s.jsxs("p",{className:"text-blue-200 text-sm",children:["Rle: ",r?.role||r?.user?.role]})]}),s.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:s.jsx("span",{className:"text-white font-bold text-xl",children:r?.nom?.charAt(0)||r?.user?.nom?.charAt(0)||"A"})})]})]})]})}),s.jsxs("div",{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(qr,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Produits"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.products})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(xs,{className:"w-6 h-6 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Commandes"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.orders})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Me,{className:"w-6 h-6 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.users})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx($t,{className:"w-6 h-6 text-red-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dons"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",n.donations.toLocaleString()]})]})]})})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mt-8",children:y.map((w,k)=>s.jsx(tr,{to:w.path,className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 group",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:`p-3 rounded-lg ${w.color} text-white group-hover:scale-110 transition-transform duration-200`,children:w.icon}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-xs text-gray-500",children:w.stats})})]}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:w.title}),s.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:w.description}),s.jsxs("div",{className:"mt-4 flex items-center text-blue-600 group-hover:text-blue-700",children:[s.jsx("span",{className:"text-sm font-medium",children:"Accder"}),s.jsx("svg",{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})},k))}),s.jsxs("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activit Rcente"}),s.jsxs("button",{onClick:v,disabled:h,className:"text-blue-600 hover:text-blue-700 text-sm flex items-center space-x-1",children:[s.jsx(Wr,{className:`w-3 h-3 ${h?"animate-spin":""}`}),s.jsx("span",{children:"Actualiser"})]})]}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"space-y-4",children:a.length>0?a.map((w,k)=>s.jsxs("div",{className:"flex items-center space-x-3",children:[x(w.type),s.jsxs("p",{className:"text-sm text-gray-600 flex-1",children:[s.jsx("span",{className:"font-medium",children:w.title})," - ",w.description]}),s.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:b(w.timestamp)})]},k)):s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Aucune activit rcente"})})})]})]})]}):s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"text-lg text-red-600",children:"Non authentifi. Veuillez vous connecter."})})}function tk(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(""),[u,h]=R.useState("all"),[c,f]=R.useState("all"),[m,g]=R.useState([]),[v,y]=R.useState(null),[x,b]=R.useState({nom:"",email:"",telephone:"",genre_prefere:"",bio:""}),[w,k]=R.useState(null),[N,E]=R.useState(null);R.useEffect(()=>{A()},[]);const S=H=>{E(H),setTimeout(()=>E(null),3e3)},A=async()=>{try{n(!0),a(null);const V=JSON.parse(localStorage.getItem("vakio_user"))?.token;if(!V){a("Token d'authentification manquant - Veuillez vous reconnecter"),n(!1);return}const O=await fetch("https://vakio-boky-backend.onrender.com/api/admin/users",{headers:{Authorization:`Bearer ${V}`,"Content-Type":"application/json"}});if(!O.ok){if(O.status===401){a("Session expire - Veuillez vous reconnecter"),localStorage.removeItem("vakio_user");return}if(O.status===403){a("Accs refus - Droits administrateur requis");return}throw new Error(`Erreur serveur: ${O.status}`)}const U=await O.json();U.success?(e(U.users||[]),S("Liste des utilisateurs actualise")):a(U.error||"Erreur lors du chargement des utilisateurs")}catch(H){console.error(" Erreur chargement utilisateurs:",H),a(H.message||"Erreur de connexion au serveur")}finally{n(!1)}},C=r.filter(H=>{const V=H.nom?.toLowerCase().includes(o.toLowerCase())||H.email?.toLowerCase().includes(o.toLowerCase()),O=u==="all"||H.role===u,U=c==="all"||c==="active"&&H.role!=="blocked"||c==="inactive"&&H.role==="blocked";return V&&O&&U}),I=async(H,V)=>{try{k(`role-${H}`);const U=JSON.parse(localStorage.getItem("vakio_user"))?.token,se=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/${H}/promote`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`},body:JSON.stringify({newRole:V})})).json();se.success?(await A(),S(se.message||"Rle modifi avec succs")):alert(se.error||"Erreur lors de la mise  jour du rle")}catch(O){console.error(" Erreur mise  jour rle:",O),alert("Erreur lors de la mise  jour du rle")}finally{k(null)}},L=async(H,V)=>{try{k(`action-${H}`);const U=JSON.parse(localStorage.getItem("vakio_user"))?.token,K=V==="block"?"bloquer":"dbloquer";if(!window.confirm(`tes-vous sr de vouloir ${K} cet utilisateur ?`)){k(null);return}const te=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/${H}/block`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`},body:JSON.stringify({action:V})})).json();te.success?(await A(),S(te.message||`Utilisateur ${K} avec succs`)):alert(te.error||"Erreur lors de l'action")}catch(O){console.error(" Erreur action utilisateur:",O),alert("Erreur lors de l'action sur l'utilisateur")}finally{k(null)}},M=H=>{y(H),b({nom:H.nom||"",email:H.email||"",telephone:H.telephone||"",genre_prefere:H.genre_prefere||"",bio:H.bio||""})},D=async()=>{if(!x.nom||!x.email){alert("Le nom et l'email sont obligatoires");return}try{k("edit");const V=JSON.parse(localStorage.getItem("vakio_user"))?.token,U=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/${v.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V}`},body:JSON.stringify(x)})).json();U.success?(await A(),y(null),S(U.message||"Utilisateur modifi avec succs")):alert(U.error||"Erreur lors de la modification")}catch(H){console.error(" Erreur modification utilisateur:",H),alert("Erreur lors de la modification")}finally{k(null)}},F=async H=>{const V=r.find(O=>O.id===H);if(V&&window.confirm(`tes-vous sr de vouloir supprimer dfinitivement l'utilisateur "${V.nom}" ?

Cette action est irrversible !`))try{k(`delete-${H}`);const U=JSON.parse(localStorage.getItem("vakio_user"))?.token,se=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/${H}`,{method:"DELETE",headers:{Authorization:`Bearer ${U}`}})).json();se.success?(await A(),S(se.message||"Utilisateur supprim avec succs")):alert(se.error||"Erreur lors de la suppression")}catch(O){console.error(" Erreur suppression:",O),alert("Erreur lors de la suppression")}finally{k(null)}},q=async H=>{if(m.length===0)return;const V=H==="block"?"bloquer":"dbloquer";if(window.confirm(`tes-vous sr de vouloir ${V} ${m.length} utilisateur(s) ?`))try{k("bulk");const U=JSON.parse(localStorage.getItem("vakio_user"))?.token,K=m.map(X=>fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/${X}/block`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`},body:JSON.stringify({action:H})}).then(Q=>Q.json())),te=(await Promise.all(K)).filter(X=>!X.success);te.length===0?(await A(),g([]),S(`${m.length} utilisateur(s) ${V}(s) avec succs`)):alert(`${te.length} action(s) ont chou`)}catch(O){console.error(" Erreur action groupe:",O),alert("Erreur lors de l'action groupe")}finally{k(null)}},B=()=>{const H=[["Nom","Email","Rle","Tlphone","Genre prfr","Date d'inscription","Statut"],...C.map(K=>[`"${K.nom||""}"`,`"${K.email||""}"`,`"${G(K.role)}"`,`"${K.telephone||""}"`,`"${K.genre_prefere||""}"`,K.created_at?new Date(K.created_at).toLocaleDateString("fr-FR"):"N/A",K.role==="blocked"?"Bloqu":"Actif"])].map(K=>K.join(",")).join(`
`),V=new Blob([H],{type:"text/csv;charset=utf-8;"}),O=window.URL.createObjectURL(V),U=document.createElement("a");U.href=O,U.download=`utilisateurs_vakio_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(U),U.click(),document.body.removeChild(U),window.URL.revokeObjectURL(O),S("Export CSV termin")},z=H=>{switch(H){case"admin":return"bg-red-100 text-red-800 border border-red-200";case"editeur":return"bg-blue-100 text-blue-800 border border-blue-200";case"auteur":return"bg-green-100 text-green-800 border border-green-200";case"blocked":return"bg-gray-100 text-gray-800 border border-gray-200";default:return"bg-purple-100 text-purple-800 border border-purple-200"}},G=H=>{switch(H){case"admin":return"Administrateur";case"editeur":return"diteur";case"auteur":return"Auteur";case"blocked":return"Bloqu";default:return"Lecteur"}},Y=H=>w===H;return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des utilisateurs..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N&&s.jsx("div",{className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ms,{className:"text-green-600"}),s.jsx("span",{children:N})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Me,{className:"text-blue-600"}),"Gestion des Utilisateurs"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez les comptes utilisateurs, rles et permissions"})]}),s.jsxs("button",{onClick:A,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s.jsx(Wr,{className:t?"animate-spin":""}),"Actualiser"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(Me,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(H=>H.role!=="blocked").length})]}),s.jsx(a0,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Bloqus"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(H=>H.role==="blocked").length})]}),s.jsx(Ka,{className:"text-red-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Administrateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(H=>H.role==="admin").length})]}),s.jsx(Tn,{className:"text-purple-600 text-2xl"})]})})]}),i&&s.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Fs,{className:"text-red-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{children:i}),s.jsx("button",{onClick:A,className:"mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Ressayer"})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between items-start lg:items-center",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher un utilisateur...",value:o,onChange:H=>l(H.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-64"})]}),s.jsxs("select",{value:u,onChange:H=>h(H.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les rles"}),s.jsx("option",{value:"admin",children:"Administrateur"}),s.jsx("option",{value:"editeur",children:"diteur"}),s.jsx("option",{value:"auteur",children:"Auteur"}),s.jsx("option",{value:"lecteur",children:"Lecteur"}),s.jsx("option",{value:"blocked",children:"Bloqu"})]}),s.jsxs("select",{value:c,onChange:H=>f(H.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"active",children:"Actif"}),s.jsx("option",{value:"inactive",children:"Bloqu"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(Qu,{}),"Exporter CSV"]}),m.length>0&&s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>q("block"),disabled:Y("bulk"),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:[Y("bulk")?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):null,"Bloquer (",m.length,")"]}),s.jsxs("button",{onClick:()=>q("unblock"),disabled:Y("bulk"),className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors disabled:opacity-50",children:[Y("bulk")?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):null,"Dbloquer (",m.length,")"]})]})]})]}),s.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[C.length," utilisateur(s) trouv(s) sur ",r.length," au total",m.length>0&&` | ${m.length} slectionn(s)`]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s.jsx("input",{type:"checkbox",checked:m.length===C.length&&C.length>0,onChange:H=>{H.target.checked?g(C.map(V=>V.id)):g([])},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rle"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Inscription"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(H=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("input",{type:"checkbox",checked:m.includes(H.id),onChange:V=>{V.target.checked?g([...m,H.id]):g(m.filter(O=>O!==H.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",disabled:H.role==="admin"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"h-10 w-10 flex-shrink-0",children:[H.photo_profil?s.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:H.photo_profil,alt:H.nom,onError:V=>{V.target.style.display="none",V.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:`h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center ${H.photo_profil?"hidden":""}`,children:s.jsx("span",{className:"text-gray-600 font-medium",children:H.nom?.charAt(0).toUpperCase()||"U"})})]}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.nom||"Nom non renseign"}),s.jsx("div",{className:"text-sm text-gray-500",children:H.genre_prefere||"Genre non spcifi"})]})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm text-gray-900 flex items-center gap-1",children:[s.jsx($r,{className:"text-gray-400"}),H.email]}),H.telephone&&s.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[s.jsx(Ju,{className:"text-gray-400"}),H.telephone]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("select",{value:H.role,onChange:V=>I(H.id,V.target.value),disabled:H.role==="admin"||Y(`role-${H.id}`),className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[s.jsx("option",{value:"lecteur",children:"Lecteur"}),s.jsx("option",{value:"auteur",children:"Auteur"}),s.jsx("option",{value:"editeur",children:"diteur"}),s.jsx("option",{value:"admin",children:"Administrateur"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${z(H.role)}`,children:G(H.role)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"text-gray-400"}),H.created_at?new Date(H.created_at).toLocaleDateString("fr-FR"):"N/A"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>M(H),disabled:Y("edit"),className:"text-blue-600 hover:text-blue-900 p-1 disabled:opacity-50",title:"Modifier",children:s.jsx(as,{size:16})}),H.role!=="admin"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>L(H.id,H.role==="blocked"?"unblock":"block"),disabled:Y(`action-${H.id}`),className:`p-1 disabled:opacity-50 ${H.role==="blocked"?"text-green-600 hover:text-green-900":"text-red-600 hover:text-red-900"}`,title:H.role==="blocked"?"Dbloquer":"Bloquer",children:Y(`action-${H.id}`)?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):s.jsx(Ka,{size:16})}),s.jsx("button",{onClick:()=>F(H.id),disabled:Y(`delete-${H.id}`),className:"text-red-600 hover:text-red-900 p-1 disabled:opacity-50",title:"Supprimer",children:Y(`delete-${H.id}`)?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):s.jsx(zt,{size:16})})]})]})})]},H.id))})]})}),C.length===0&&!t&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Me,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucun utilisateur trouv"}),o||u!=="all"||c!=="all"?s.jsx("button",{onClick:()=>{l(""),h("all"),f("all")},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm",children:"Rinitialiser les filtres"}):null]})]}),v&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Modifier l'utilisateur"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom *"}),s.jsx("input",{type:"text",value:x.nom,onChange:H=>b({...x,nom:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),s.jsx("input",{type:"email",value:x.email,onChange:H=>b({...x,email:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tlphone"}),s.jsx("input",{type:"text",value:x.telephone,onChange:H=>b({...x,telephone:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Genre prfr"}),s.jsx("input",{type:"text",value:x.genre_prefere,onChange:H=>b({...x,genre_prefere:H.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio"}),s.jsx("textarea",{value:x.bio,onChange:H=>b({...x,bio:H.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsxs("button",{onClick:D,disabled:Y("edit"),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[Y("edit")?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(Er,{size:16}),"Sauvegarder"]}),s.jsxs("button",{onClick:()=>y(null),disabled:Y("edit"),className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[s.jsx(ot,{size:16}),"Annuler"]})]})]})})]})})}function u7(){const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState(!0),[o,l]=R.useState(null),[u,h]=R.useState(null),[c,f]=R.useState(!1),[m,g]=R.useState({name:"",description:"",permissions:[],is_active:!0});R.useEffect(()=>{v(),y()},[]);const v=async()=>{try{const S=localStorage.getItem("vakio_token"),C=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/roles",{headers:{Authorization:`Bearer ${S}`}})).json();C.success?e(C.roles||[]):l(C.error||"Erreur lors du chargement des rles")}catch(S){l("Erreur lors du chargement des rles"),console.error(" Erreur chargement rles:",S)}},y=async()=>{try{const S=localStorage.getItem("vakio_token"),C=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/permissions",{headers:{Authorization:`Bearer ${S}`}})).json();C.success&&n(C.permissions||[])}catch(S){console.error(" Erreur chargement permissions:",S)}finally{a(!1)}},x=async S=>{S.preventDefault();try{const A=localStorage.getItem("vakio_token"),C=u?`https://vakio-boky-backend.onrender.com/api/admin/roles/${u.id}`:"https://vakio-boky-backend.onrender.com/api/admin/roles",M=await(await fetch(C,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify(m)})).json();M.success?(await v(),f(!1),h(null),N(),alert(u?"Rle modifi avec succs":"Rle cr avec succs")):alert(M.error||"Erreur lors de la sauvegarde")}catch(A){console.error(" Erreur sauvegarde:",A),alert("Erreur lors de la sauvegarde")}},b=S=>{h(S),g({name:S.name,description:S.description,permissions:S.permissions||[],is_active:S.is_active}),f(!0)},w=async S=>{if(window.confirm("tes-vous sr de vouloir supprimer ce rle ?"))try{const A=localStorage.getItem("vakio_token"),I=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/roles/${S}`,{method:"DELETE",headers:{Authorization:`Bearer ${A}`}})).json();I.success?(await v(),alert("Rle supprim avec succs")):alert(I.error||"Erreur lors de la suppression")}catch(A){console.error(" Erreur suppression:",A),alert("Erreur lors de la suppression")}},k=S=>{g(A=>({...A,permissions:A.permissions.includes(S)?A.permissions.filter(C=>C!==S):[...A.permissions,S]}))},N=()=>{g({name:"",description:"",permissions:[],is_active:!0})},E=()=>({"Gestion des utilisateurs":t.filter(A=>A.category==="users"),"Gestion du contenu":t.filter(A=>A.category==="content"),"Gestion des vnements":t.filter(A=>A.category==="events"),"Gestion du marketplace":t.filter(A=>A.category==="marketplace"),"Administration systme":t.filter(A=>A.category==="system")});return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des rles..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Tn,{className:"text-purple-600"}),"Gestion des Rles et Permissions"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Dfinissez les rles utilisateur et leurs permissions d'accs"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Rles"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(Tn,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rles Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(S=>S.is_active).length})]}),s.jsx(ms,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Permissions"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),s.jsx(ji,{className:"text-blue-600 text-2xl"})]})})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>{N(),h(null),f(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2",children:[s.jsx(bt,{}),"Nouveau Rle"]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((S,A)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:A*.1},className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx(Tn,{className:"text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:S.name}),s.jsx("p",{className:"text-sm text-gray-600",children:S.description})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${S.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:S.is_active?"Actif":"Inactif"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:["Permissions (",S.permissions?.length||0,")"]}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[S.permissions?.slice(0,3).map(C=>{const I=t.find(L=>L.id===C);return I?s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:I.name},C):null}),S.permissions?.length>3&&s.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",S.permissions.length-3," autres"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>b(S),className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(as,{className:"w-4 h-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>w(S.id),className:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Supprimer"]})]})]},S.id))}),r.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Tn,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun rle trouv"}),s.jsxs("button",{onClick:()=>{N(),h(null),f(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier rle"]})]}),c&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:u?"Modifier le rle":"Nouveau rle"}),s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du rle *"}),s.jsx("input",{type:"text",value:m.name,onChange:S=>g({...m,name:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),s.jsxs("select",{value:m.is_active,onChange:S=>g({...m,is_active:S.target.value==="true"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:!0,children:"Actif"}),s.jsx("option",{value:!1,children:"Inactif"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:m.description,onChange:S=>g({...m,description:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Permissions"}),s.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:Object.entries(E()).map(([S,A])=>s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:S}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 ml-4",children:A.map(C=>s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:m.permissions.includes(C.id),onChange:()=>k(C.id),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:C.name})]},C.id))})]},S))})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:u?"Modifier":"Crer"}),s.jsx("button",{type:"button",onClick:()=>{f(!1),h(null),N()},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})]})}),o&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[o,s.jsx("button",{onClick:v,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function h7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d");R.useEffect(()=>{u()},[o]);const u=async()=>{try{n(!0);const h=localStorage.getItem("vakio_token"),f=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/users/analytics?range=${o}`,{headers:{Authorization:`Bearer ${h}`}})).json();f.success?e(f.analytics):a(f.error||"Erreur lors du chargement")}catch(h){a("Erreur lors du chargement des statistiques"),console.error(" Erreur chargement statistiques utilisateurs:",h)}finally{n(!1)}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-blue-600"}),"Analytics Utilisateurs"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez le comportement et l'engagement des utilisateurs"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsxs("select",{value:o,onChange:h=>l(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?r.totalUsers:0}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["+",r?.userGrowth||0,"% vs priode prcdente"]})]}),s.jsx(Me,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.activeUsers||0}),s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:[r?.activeUsersPercentage||0,"% du total"]})]}),s.jsx(a0,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nouveaux Utilisateurs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.newUsers||0}),s.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Cette priode"})]}),s.jsx(ct,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux de Rtention"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.retentionRate||0,"%"]}),s.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Utilisateurs revenant"})]}),s.jsx(rs,{className:"text-orange-600 text-2xl"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activit Quotidienne"}),s.jsx("div",{className:"space-y-4",children:r?.dailyActivity?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(cn,{className:"text-blue-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(h.date).toLocaleDateString("fr-FR",{weekday:"long"})})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.active_users}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.percentage,"%"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne d'activit"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Rle"}),s.jsx("div",{className:"space-y-4",children:r?.roleDistribution?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:s.jsx(Me,{className:"text-purple-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:h.role})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-purple-600",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.percentage,"%"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de rpartition"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Mtriques d'Engagement"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r?.engagementMetrics?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(Ss,{className:"text-blue-600 text-xl"})}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:h.name}),s.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:h.value}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:h.description})]},c))||s.jsx("div",{className:"col-span-3 text-center py-8",children:s.jsx("p",{className:"text-gray-500",children:"Aucune mtrique d'engagement disponible"})})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Utilisateurs les Plus Actifs"}),s.jsx("div",{className:"space-y-4",children:r?.topActiveUsers?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsxs("span",{className:"text-blue-600 font-bold",children:["#",c+1]})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:h.name}),s.jsx("p",{className:"text-sm text-gray-600",children:h.email})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.activity_score}),s.jsx("p",{className:"text-sm text-gray-600",children:"Score d'activit"})]})]},h.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun utilisateur actif trouv"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"volution des Inscriptions"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:r?.registrationTrends?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:c*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:h.month}),s.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:h.registrations}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"nouvelles inscriptions"})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-4",children:"Aucune donne d'inscription"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Genre"}),s.jsx("div",{className:"space-y-4",children:r?.genderDistribution?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:h.genre||"Non spcifi"}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-pink-600",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.percentage,"%"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de genre"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Genres Littraires Prfrs"}),s.jsx("div",{className:"space-y-4",children:r?.preferredGenres?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.genre_prefere||"Non spcifi"}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-indigo-600",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.percentage,"%"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de genre prfr"})})]})]}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:u,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function sk(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(""),[u,h]=R.useState("pending"),[c,f]=R.useState(null),[m,g]=R.useState(!1),[v,y]=R.useState(null),[x,b]=R.useState(""),[w,k]=R.useState(!1),[N,E]=R.useState(null),[S,A]=R.useState([]),[C,I]=R.useState(!1),[L,M]=R.useState(!1),[D,F]=R.useState(null),[q,B]=R.useState({titre:"",description:"",genre:"",isbn:"",statut:"brouillon"}),[z,G]=R.useState([]),[Y,H]=R.useState(!1);R.useEffect(()=>{V()},[u]);const V=async()=>{try{n(!0),a(null);const ce=JSON.parse(localStorage.getItem("vakio_user"))?.token;if(!ce){a("Token d'authentification manquant - Veuillez vous reconnecter"),n(!1);return}const ge=await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books?status=${u}`,{headers:{Authorization:`Bearer ${ce}`,"Content-Type":"application/json"}});if(!ge.ok){if(ge.status===401){a("Session expire - Veuillez vous reconnecter"),localStorage.removeItem("vakio_user");return}if(ge.status===403){a("Accs refus - Droits administrateur requis");return}throw new Error(`Erreur serveur: ${ge.status}`)}const ve=await ge.json();ve.success?e(ve.books||[]):a(ve.error||"Erreur lors du chargement")}catch(ee){console.error(" Erreur chargement livres:",ee),a(ee.message||"Erreur de connexion au serveur")}finally{n(!1)}},O=r.filter(ee=>ee.titre?.toLowerCase().includes(o.toLowerCase())||ee.auteur_nom?.toLowerCase().includes(o.toLowerCase())||ee.genre?.toLowerCase().includes(o.toLowerCase())||ee.auteur_email?.toLowerCase().includes(o.toLowerCase())),U=ee=>{y(ee),setTimeout(()=>y(null),3e3)},K=async ee=>{if(window.confirm("tes-vous sr d'approuver ce livre ? Il sera publi et visible par tous les utilisateurs."))try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books/${ee}/approve`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ge}`}})).json();pe.success?(await V(),U(pe.message||"Livre approuv avec succs")):alert(pe.error||"Erreur lors de l'approbation")}catch(ce){console.error(" Erreur approbation livre:",ce),alert("Erreur lors de l'approbation du livre")}},se=async ee=>{if(!x||x.trim().length<10){alert("Veuillez fournir un motif de rejet dtaill (au moins 10 caractres)");return}try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books/${ee}/reject`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ge}`},body:JSON.stringify({reason:x})})).json();pe.success?(await V(),k(!1),E(null),b(""),U(pe.message||"Livre rejet avec succs")):alert(pe.error||"Erreur lors du rejet")}catch(ce){console.error(" Erreur rejet livre:",ce),alert("Erreur lors du rejet du livre")}},te=async(ee,ce)=>{try{const ve=JSON.parse(localStorage.getItem("vakio_user"))?.token,Ue=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books/${ee}/feature`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`},body:JSON.stringify({featured:ce})})).json();Ue.success?(await V(),U(Ue.message||"Livre mis  jour avec succs")):alert(Ue.error||"Erreur lors de la mise  jour")}catch(ge){console.error(" Erreur mise en avant livre:",ge),alert("Erreur lors de la mise  jour du livre")}},X=async ee=>{try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/books/${ee}`,{headers:{Authorization:`Bearer ${ge}`}})).json();pe.success?(F(pe.book),B({titre:pe.book.titre||"",description:pe.book.description||"",genre:pe.book.genre||"",isbn:pe.book.isbn||"",statut:pe.book.statut||"brouillon"}),M(!0)):alert(pe.error||"Erreur lors du chargement du livre")}catch(ce){console.error(" Erreur chargement livre:",ce),alert("Erreur lors du chargement du livre")}},Q=async()=>{if(D)try{const ce=JSON.parse(localStorage.getItem("vakio_user"))?.token,ve=await(await fetch(`https://vakio-boky-backend.onrender.com/api/books/${D.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ce}`},body:JSON.stringify(q)})).json();ve.success?(await V(),M(!1),F(null),U("Livre modifi avec succs")):alert(ve.error||"Erreur lors de la modification")}catch(ee){console.error(" Erreur modification livre:",ee),alert("Erreur lors de la modification")}},ae=async ee=>{if(window.confirm("tes-vous sr de vouloir supprimer dfinitivement ce livre ? Cette action est irrversible."))try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/books/${ee}`,{method:"DELETE",headers:{Authorization:`Bearer ${ge}`}})).json();pe.success?(await V(),U("Livre supprim avec succs")):alert(pe.error||"Erreur lors de la suppression")}catch(ce){console.error(" Erreur suppression livre:",ce),alert("Erreur lors de la suppression")}},J=async ee=>{if(window.confirm("tes-vous sr de vouloir dpublier ce livre ? Il ne sera plus visible par les utilisateurs."))try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/books/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ge}`},body:JSON.stringify({...q,statut:"brouillon"})})).json();pe.success?(await V(),U("Livre dpubli avec succs")):alert(pe.error||"Erreur lors du dpublication")}catch(ce){console.error(" Erreur dpublication livre:",ce),alert("Erreur lors du dpublication")}},ue=async ee=>{if(window.confirm("tes-vous sr de vouloir archiver ce livre ?"))try{const ge=JSON.parse(localStorage.getItem("vakio_user"))?.token,pe=await(await fetch(`https://vakio-boky-backend.onrender.com/api/books/${ee}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ge}`},body:JSON.stringify({...q,statut:"archiv"})})).json();pe.success?(await V(),U("Livre archiv avec succs")):alert(pe.error||"Erreur lors de l'archivage")}catch(ce){console.error(" Erreur archivage livre:",ce),alert("Erreur lors de l'archivage")}},we=async ee=>{const ce=prompt("Quelles modifications sont ncessaires ? (Dcrivez en dtail)");if(!ce||ce.trim().length<10){alert("Veuillez fournir une description dtaille des modifications ncessaires");return}try{const ve=JSON.parse(localStorage.getItem("vakio_user"))?.token,Ue=await(await fetch("https://vakio-boky-backend.onrender.com/api/notifications",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`},body:JSON.stringify({user_id:D?.auteur_id,titre:" Modifications requises",message:`Votre livre ncessite des modifications : ${ce}`,type:"book",lien:`/books/${ee}/edit`})})).json();Ue.success?(await V(),U("Demande de modifications envoye  l'auteur")):alert(Ue.error||"Erreur lors de la demande")}catch(ge){console.error(" Erreur demande modifications:",ge),alert("Erreur lors de la demande de modifications")}},_e=ee=>{S.includes(ee)?A(S.filter(ce=>ce!==ee)):A([...S,ee])},Ce=()=>{A(C?[]:O.map(ee=>ee.id)),I(!C),H(!C)},Le=async ee=>{if(S.length===0){alert("Veuillez slectionner au moins un livre");return}const ce={approve:`tes-vous sr de vouloir approuver ${S.length} livre(s) ?`,reject:`tes-vous sr de vouloir rejeter ${S.length} livre(s) ?`,delete:`tes-vous sr de vouloir supprimer dfinitivement ${S.length} livre(s) ?`,archive:`tes-vous sr de vouloir archiver ${S.length} livre(s) ?`}[ee];if(window.confirm(ce))try{for(const ge of S)ee==="approve"?await K(ge):ee==="delete"?await ae(ge):ee==="archive"&&await ue(ge);A([]),I(!1),H(!1),U(`${S.length} livre(s) ${ee==="approve"?"approuv(s)":ee==="delete"?"supprim(s)":"archiv(s)"} avec succs`)}catch(ge){console.error(` Erreur action groupe ${ee}:`,ge),alert(`Erreur lors de l'action ${ee}`)}},Qe=ee=>{z.includes(ee)?G(z.filter(ce=>ce!==ee)):G([...z,ee])},St=ee=>{switch(ee){case"publi":return"bg-green-100 text-green-800 border border-green-200";case"brouillon":return"bg-yellow-100 text-yellow-800 border border-yellow-200";case"rejet":return"bg-red-100 text-red-800 border border-red-200";case"archiv":return"bg-gray-100 text-gray-800 border border-gray-200";default:return"bg-gray-100 text-gray-800 border border-gray-200"}},at=ee=>{switch(ee){case"publi":return"Publi";case"brouillon":return"En attente";case"rejet":return"Rejet";case"archiv":return"Archiv";default:return ee}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des livres..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[v&&s.jsx("div",{className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ms,{className:"text-green-600"}),s.jsx("span",{children:v})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(et,{className:"text-blue-600"}),"Modration des Livres"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Approuvez, rejetez ou mettez en avant les livres soumis par les auteurs"})]}),s.jsxs("button",{onClick:V,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s.jsx(Wr,{className:t?"animate-spin":""}),"Actualiser"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Livres"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(et,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En Attente"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.filter(ee=>ee.statut==="brouillon").length})]}),s.jsx(ps,{className:"text-yellow-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Publis"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.filter(ee=>ee.statut==="publi").length})]}),s.jsx(ms,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rejets"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:r.filter(ee=>ee.statut==="rejet").length})]}),s.jsx(ot,{className:"text-red-600 text-2xl"})]})})]}),Y&&S.length>0&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"font-medium text-blue-800",children:[S.length," livre(s) slectionn(s)"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>Le("approve"),className:"px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center gap-2",children:[s.jsx(ms,{size:16}),"Approuver"]}),s.jsxs("button",{onClick:()=>Le("reject"),className:"px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm flex items-center gap-2",children:[s.jsx(ot,{size:16}),"Rejeter"]}),s.jsxs("button",{onClick:()=>Le("archive"),className:"px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm flex items-center gap-2",children:[s.jsx(Bj,{size:16}),"Archiver"]}),s.jsxs("button",{onClick:()=>Le("delete"),className:"px-3 py-2 bg-red-700 text-white rounded-lg hover:bg-red-800 transition-colors text-sm flex items-center gap-2",children:[s.jsx(zt,{size:16}),"Supprimer"]})]})]}),s.jsx("button",{onClick:()=>{A([]),I(!1),H(!1)},className:"text-blue-600 hover:text-blue-800 text-sm",children:"Annuler"})]})}),i&&s.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(ps,{className:"text-red-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{children:i}),s.jsx("button",{onClick:V,className:"mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Ressayer"})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[s.jsx("div",{className:"flex flex-col lg:flex-row gap-4 justify-between items-start lg:items-center",children:s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher un livre, auteur ou genre...",value:o,onChange:ee=>l(ee.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-64"})]}),s.jsxs("select",{value:u,onChange:ee=>h(ee.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"pending",children:"En attente (Brouillons)"}),s.jsx("option",{value:"published",children:"Publis"}),s.jsx("option",{value:"rejected",children:"Rejets"}),s.jsx("option",{value:"archived",children:"Archivs"}),s.jsx("option",{value:"all",children:"Tous les statuts"})]})]})}),s.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[O.length," livre(s) trouv(s) sur ",r.length," au total"]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:s.jsx("input",{type:"checkbox",checked:C,onChange:Ce,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Livre"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Auteur"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Genre"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(ee=>s.jsxs(s.Fragment,{children:[s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("input",{type:"checkbox",checked:S.includes(ee.id),onChange:()=>_e(ee.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>Qe(ee.id),className:"text-gray-400 hover:text-gray-600",children:z.includes(ee.id)?s.jsx(XD,{size:16}):s.jsx(KD,{size:16})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"h-12 w-12 flex-shrink-0",children:[ee.couverture_url?s.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:ee.couverture_url,alt:ee.titre,onError:ce=>{ce.target.style.display="none",ce.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:`h-12 w-12 bg-gray-200 rounded-lg flex items-center justify-center ${ee.couverture_url?"hidden":""}`,children:s.jsx(et,{className:"text-gray-400 text-xl"})})]}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:ee.titre||"Sans titre"}),s.jsxs("div",{className:"text-sm text-gray-500 line-clamp-1",children:[ee.description?.substring(0,50),"..."]})]})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:ee.auteur_nom||"Auteur inconnu"}),s.jsx("div",{className:"text-xs text-gray-500",children:ee.auteur_email})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 border border-purple-200",children:ee.genre||"Non spcifi"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${St(ee.statut)}`,children:at(ee.statut)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"text-gray-400"}),ee.created_at?new Date(ee.created_at).toLocaleDateString("fr-FR"):"N/A"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{f(ee),g(!0)},className:"text-blue-600 hover:text-blue-900 p-2 rounded-lg hover:bg-blue-50 transition-colors",title:"Voir dtails",children:s.jsx(Ss,{size:18})}),s.jsx("button",{onClick:()=>X(ee.id),className:"text-indigo-600 hover:text-indigo-900 p-2 rounded-lg hover:bg-indigo-50 transition-colors",title:"Modifier",children:s.jsx(as,{size:18})}),ee.statut==="brouillon"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>K(ee.id),className:"text-green-600 hover:text-green-900 p-2 rounded-lg hover:bg-green-50 transition-colors",title:"Approuver",children:s.jsx(ms,{size:18})}),s.jsx("button",{onClick:()=>{E(ee),k(!0)},className:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Rejeter",children:s.jsx(ot,{size:18})}),s.jsx("button",{onClick:()=>we(ee.id),className:"text-orange-600 hover:text-orange-900 p-2 rounded-lg hover:bg-orange-50 transition-colors",title:"Demander modifications",children:s.jsx(mn,{size:18})})]}),ee.statut==="publi"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>te(ee.id,!ee.featured),className:`p-2 rounded-lg transition-colors ${ee.featured?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-50":"text-purple-600 hover:text-purple-900 hover:bg-purple-50"}`,title:ee.featured?"Retirer des recommandations":"Mettre en avant",children:s.jsx(Nt,{size:18})}),s.jsx("button",{onClick:()=>J(ee.id),className:"text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Dpublier",children:s.jsx(Ya,{size:18})})]}),s.jsx("button",{onClick:()=>ue(ee.id),className:"text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Archiver",children:s.jsx(Bj,{size:18})}),s.jsx("button",{onClick:()=>ae(ee.id),className:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Supprimer",children:s.jsx(zt,{size:18})}),s.jsx("div",{className:"relative",children:s.jsx("button",{className:"text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Plus d'options",children:s.jsx(aP,{size:18})})})]})})]},ee.id),z.includes(ee.id)&&s.jsx("tr",{className:"bg-gray-50",children:s.jsx("td",{colSpan:"8",className:"px-6 py-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700",children:"Description :"}),s.jsx("p",{className:"text-gray-600 mt-1",children:ee.description||"Aucune description"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700",children:"ISBN :"}),s.jsx("p",{className:"text-gray-600 mt-1",children:ee.isbn||"Non spcifi"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-700",children:"Dernire modification :"}),s.jsx("p",{className:"text-gray-600 mt-1",children:ee.updated_at?new Date(ee.updated_at).toLocaleString("fr-FR"):"Jamais modifi"})]})]})})})]}))})]})}),O.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(et,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun livre trouv"}),(o||u!=="pending")&&s.jsx("button",{onClick:()=>{l(""),h("pending")},className:"text-blue-600 hover:text-blue-800 text-sm",children:"Rinitialiser les filtres"})]})]}),m&&c&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-start mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:c.titre}),s.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ot,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[c.couverture_url&&s.jsx("img",{src:c.couverture_url,alt:c.titre,className:"w-full h-64 object-cover rounded-lg mb-4"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Auteur"}),s.jsx("p",{className:"text-gray-900",children:c.auteur_nom}),s.jsx("p",{className:"text-sm text-gray-600",children:c.auteur_email})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Genre"}),s.jsx("p",{className:"text-gray-900",children:c.genre||"Non spcifi"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ISBN"}),s.jsx("p",{className:"text-gray-900",children:c.isbn||"Non spcifi"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Statut"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${St(c.statut)}`,children:at(c.statut)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Date de cration"}),s.jsx("p",{className:"text-gray-900",children:new Date(c.created_at).toLocaleDateString("fr-FR")})]})]})]}),s.jsxs("div",{children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),s.jsx("div",{className:"text-gray-900 mt-1 p-3 bg-gray-50 rounded-lg",children:c.description||"Aucune description"})]}),c.rejection_reason&&s.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx("label",{className:"text-sm font-medium text-red-700",children:"Motif du rejet"}),s.jsx("p",{className:"text-red-700 mt-1",children:c.rejection_reason})]}),c.featured&&s.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("label",{className:"text-sm font-medium text-yellow-700",children:" Mise en avant"}),s.jsx("p",{className:"text-yellow-700 mt-1",children:"Ce livre est actuellement mis en avant sur la page d'accueil"})]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200 mt-6",children:[c.statut==="brouillon"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{K(c.id),g(!1)},className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[s.jsx(ms,{className:"inline mr-2"}),"Approuver"]}),s.jsxs("button",{onClick:()=>{g(!1),E(c),k(!0)},className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(ot,{className:"inline mr-2"}),"Rejeter"]})]}),c.statut==="publi"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{te(c.id,!c.featured),g(!1)},className:`flex-1 px-4 py-2 rounded-lg transition-colors flex items-center justify-center gap-2 ${c.featured?"bg-gray-600 text-white hover:bg-gray-700":"bg-yellow-600 text-white hover:bg-yellow-700"}`,children:[s.jsx(Nt,{}),c.featured?"Retirer des recommandations":"Mettre en avant"]}),s.jsxs("button",{onClick:()=>{J(c.id),g(!1)},className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Ya,{}),"Dpublier"]})]}),s.jsxs("button",{onClick:()=>{X(c.id),g(!1)},className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(as,{}),"Modifier"]}),s.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Fermer"})]})]})}),w&&N&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"Rejeter le livre"}),s.jsxs("p",{className:"text-gray-600 mb-4",children:["Vous tes sur le point de rejeter le livre :",s.jsx("br",{}),s.jsxs("strong",{children:['"',N.titre,'"']})," par"," ",N.auteur_nom]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motif du rejet *"}),s.jsx("textarea",{value:x,onChange:ee=>b(ee.target.value),placeholder:"Expliquez pourquoi ce livre est rejet (minimum 10 caractres)...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",rows:4,required:!0}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x.length,"/10 caractres minimum"]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>se(N.id),disabled:x.trim().length<10,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:"Confirmer le rejet"}),s.jsx("button",{onClick:()=>{k(!1),E(null),b("")},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})}),L&&D&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4 text-blue-600",children:"Modifier le livre"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre *"}),s.jsx("input",{type:"text",value:q.titre,onChange:ee=>B({...q,titre:ee.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:q.description,onChange:ee=>B({...q,description:ee.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Genre"}),s.jsx("input",{type:"text",value:q.genre,onChange:ee=>B({...q,genre:ee.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISBN"}),s.jsx("input",{type:"text",value:q.isbn,onChange:ee=>B({...q,isbn:ee.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),s.jsxs("select",{value:q.statut,onChange:ee=>B({...q,statut:ee.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"publi",children:"Publi"}),s.jsx("option",{value:"rejet",children:"Rejet"}),s.jsx("option",{value:"archiv",children:"Archiv"})]})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:Q,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Enregistrer"}),s.jsx("button",{onClick:()=>{M(!1),F(null)},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})})]})})}function f7(){const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState([]),[o,l]=R.useState(!0),[u,h]=R.useState(null),[c,f]=R.useState("genres"),[m,g]=R.useState(!1),[v,y]=R.useState(null),[x,b]=R.useState(null),[w,k]=R.useState({name:"",description:"",type:"genre",is_active:!0});R.useEffect(()=>{N()},[]);const N=async()=>{try{l(!0),h(null);const F=JSON.parse(localStorage.getItem("vakio_user"))?.token;if(!F){h("Token d'authentification manquant - Veuillez vous reconnecter"),l(!1);return}const B=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/books/genres",{headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"}})).json(),G=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/books/collections",{headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"}})).json(),H=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/books/featured",{headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"}})).json();B.success&&e(B.genres||[]),G.success&&n(G.collections||[]),H.success&&a(H.books||[])}catch(D){console.error(" Erreur chargement catalogue:",D),h("Erreur de connexion au serveur")}finally{l(!1)}},E=D=>{b(D),setTimeout(()=>b(null),3e3)},S=async D=>{D.preventDefault();try{const q=JSON.parse(localStorage.getItem("vakio_user"))?.token;if(!q){alert("Session expire - Veuillez vous reconnecter");return}let B,z,G;w.type==="genre"?v?(G="https://vakio-boky-backend.onrender.com/api/admin/books/genres/update",z="PUT"):(G="https://vakio-boky-backend.onrender.com/api/admin/books/genres",z="POST"):v?(G=`https://vakio-boky-backend.onrender.com/api/admin/books/collections/${v.id}`,z="PUT"):(G="https://vakio-boky-backend.onrender.com/api/admin/books/collections",z="POST");const H=await(await fetch(G,{method:z,headers:{"Content-Type":"application/json",Authorization:`Bearer ${q}`},body:JSON.stringify(w.type==="genre"&&v?{oldName:v.name,newName:w.name}:w)})).json();H.success?(await N(),g(!1),y(null),L(),E(`${w.type==="genre"?"Genre":"Collection"} ${v?"modifi":"cr"} avec succs`)):alert(H.error||"Erreur lors de la sauvegarde")}catch(F){console.error(" Erreur sauvegarde:",F),alert("Erreur lors de la sauvegarde")}},A=(D,F)=>{y(D),k({name:D.name,description:D.description||"",type:F,is_active:D.is_active!==void 0?D.is_active:!0}),g(!0)},C=async(D,F)=>{if(window.confirm(`tes-vous sr de vouloir supprimer ce ${F==="genre"?"genre":"collection"} ?`))try{const B=JSON.parse(localStorage.getItem("vakio_user"))?.token;let z,G,Y;F==="genre"?(z="genres/delete",Y="DELETE",G=`https://vakio-boky-backend.onrender.com/api/admin/books/${z}`):(z="collections",Y="DELETE",G=`https://vakio-boky-backend.onrender.com/api/admin/books/${z}/${D}`);const V=await(await fetch(G,{method:Y,headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`},body:F==="genre"?JSON.stringify({genreName:r.find(O=>O.name===D)?.name}):void 0})).json();V.success?(await N(),E(`${F==="genre"?"Genre":"Collection"} supprim avec succs`)):alert(V.error||"Erreur lors de la suppression")}catch(q){console.error(" Erreur suppression:",q),alert("Erreur lors de la suppression")}},I=async(D,F)=>{try{const B=JSON.parse(localStorage.getItem("vakio_user"))?.token,G=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books/${D}/feature`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`},body:JSON.stringify({featured:F})})).json();G.success?(await N(),E(F?"Livre ajout aux recommandations":"Livre retir des recommandations")):alert(G.error||"Erreur lors de la mise  jour")}catch(q){console.error(" Erreur mise en avant livre:",q),alert("Erreur lors de la mise  jour du livre")}},L=()=>{k({name:"",description:"",type:"genre",is_active:!0})},M=[{id:"genres",label:"Genres",icon:Qi,count:r.length},{id:"collections",label:"Collections",icon:Pd,count:t.length},{id:"featured",label:"Recommandations",icon:Nt,count:i.length}];return o?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement du catalogue..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[x&&s.jsx("div",{className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ms,{className:"text-green-600"}),s.jsx("span",{children:x})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(eP,{className:"text-green-600"}),"Gestion du Catalogue"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Organisez les genres, collections et recommandations de livres"})]}),s.jsxs("button",{onClick:N,disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s.jsx(Wr,{className:o?"animate-spin":""}),"Actualiser"]})]})}),u&&s.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Fs,{className:"text-red-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{children:u}),s.jsx("button",{onClick:N,className:"mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Ressayer"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Genres"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(Qi,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Collections"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),s.jsx(Pd,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recommandations"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]}),s.jsx(Nt,{className:"text-yellow-600 text-2xl"})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:[s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"flex space-x-8 px-6",children:M.map(D=>{const F=D.icon;return s.jsxs("button",{onClick:()=>f(D.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${c===D.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(F,{className:"w-4 h-4"}),D.label,s.jsx("span",{className:`ml-1 py-0.5 px-2 rounded-full text-xs ${c===D.id?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:D.count})]},D.id)})})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:M.find(D=>D.id===c)?.label}),c!=="featured"&&s.jsxs("button",{onClick:()=>{L(),k(D=>({...D,type:c==="genres"?"genre":"collection"})),y(null),g(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(bt,{}),"Ajouter ",c==="genres"?"un genre":"une collection"]})]}),c==="genres"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.map((D,F)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:F*.1},className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Qi,{className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:D.name}),s.jsx("p",{className:"text-sm text-gray-600",children:D.description}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[D.book_count||0," livre(s)"]})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${D.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:D.is_active?"Actif":"Inactif"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>A(D,"genre"),className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(as,{className:"w-4 h-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>C(D.name,"genre"),className:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Supprimer"]})]})]},D.name)),r.length===0&&s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(Qi,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun genre trouv"}),s.jsxs("button",{onClick:()=>{L(),k(D=>({...D,type:"genre"})),y(null),g(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier genre"]})]})]}),c==="collections"&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.map((D,F)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:F*.1},className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx(Pd,{className:"text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:D.name}),s.jsx("p",{className:"text-sm text-gray-600",children:D.description}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[D.book_count||0," livre(s)"]})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${D.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:D.is_active?"Actif":"Inactif"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>A(D,"collection"),className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(as,{className:"w-4 h-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>C(D.id,"collection"),className:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Supprimer"]})]})]},D.id)),t.length===0&&s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(Pd,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucune collection trouve"}),s.jsxs("button",{onClick:()=>{L(),k(D=>({...D,type:"collection"})),y(null),g(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer la premire collection"]})]})]}),c==="featured"&&s.jsxs("div",{className:"space-y-4",children:[i.map((D,F)=>s.jsx(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:F*.1},className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:s.jsx(Nt,{className:"text-yellow-600"})}),s.jsxs("div",{className:"flex items-center gap-4",children:[D.couverture_url&&s.jsx("img",{src:D.couverture_url,alt:D.titre,className:"w-10 h-14 object-cover rounded"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:D.titre}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Par ",D.auteur_nom]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Genre: ",D.genre]})]})]})]}),s.jsxs("button",{onClick:()=>I(D.id,!1),className:"bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Retirer"]})]})},D.id)),i.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Nt,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucun livre en recommandation"}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Utilisez la modration pour mettre des livres en avant"})]})]})]})]}),m&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:v?`Modifier ${w.type==="genre"?"le genre":"la collection"}`:`Nouveau ${w.type==="genre"?"genre":"collection"}`}),s.jsxs("form",{onSubmit:S,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom *"}),s.jsx("input",{type:"text",value:w.name,onChange:D=>k({...w,name:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:w.description,onChange:D=>k({...w,description:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"is_active",checked:w.is_active,onChange:D=>k({...w,is_active:D.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Actif"})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:v?"Modifier":"Crer"}),s.jsx("button",{type:"button",onClick:()=>{g(!1),y(null),L()},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})]})})]})})}function m7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d"),[u,h]=R.useState(null);R.useEffect(()=>{c()},[o]);const c=async()=>{try{n(!0),a(null);const v=JSON.parse(localStorage.getItem("vakio_user"))?.token;if(!v){a("Token d'authentification manquant - Veuillez vous reconnecter"),n(!1);return}const y=await fetch(`https://vakio-boky-backend.onrender.com/api/admin/books/analytics?range=${o}`,{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(!y.ok){if(y.status===401){a("Session expire - Veuillez vous reconnecter"),localStorage.removeItem("vakio_user");return}if(y.status===403){a("Accs refus - Droits administrateur requis");return}throw new Error(`Erreur serveur: ${y.status}`)}const x=await y.json();x.success?e(x.analytics):a(x.error||"Erreur lors du chargement")}catch(g){console.error(" Erreur chargement statistiques livres:",g),a(g.message||"Erreur de connexion au serveur")}finally{n(!1)}},f=g=>{h(g),setTimeout(()=>h(null),3e3)},m=()=>{c(),f("Statistiques actualises")};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u&&s.jsx("div",{className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg animate-fade-in",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ct,{className:"text-green-600"}),s.jsx("span",{children:u})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-purple-600"}),"Analytics Livres"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances et l'engagement des livres"})]}),s.jsxs("button",{onClick:m,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s.jsx(Wr,{className:t?"animate-spin":""}),"Actualiser"]})]})}),i&&s.jsx("div",{className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Fs,{className:"text-red-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{children:i}),s.jsx("button",{onClick:c,className:"mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Ressayer"})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsxs("select",{value:o,onChange:g=>l(g.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Livres"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?r.totalBooks:0}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["+",r?.booksGrowth||0,"% vs priode prcdente"]})]}),s.jsx(et,{className:"text-blue-600 text-2xl"})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lectures Totales"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalReads?.toLocaleString()||0}),s.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Lectures enregistres"})]}),s.jsx(Ss,{className:"text-green-600 text-2xl"})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tlchargements"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalDownloads?.toLocaleString()||0}),s.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Livres tlchargs"})]}),s.jsx(Qu,{className:"text-purple-600 text-2xl"})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Note Moyenne"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.averageRating||0,"/5"]}),s.jsxs("p",{className:"text-sm text-orange-600 mt-1",children:["Sur ",r?.totalRatings?.toLocaleString()||0," avis"]})]}),s.jsx(Nt,{className:"text-yellow-600 text-2xl"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Activit de Lecture Quotidienne"}),s.jsx("div",{className:"space-y-4",children:r?.dailyActivity?.map((g,v)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(Ss,{className:"text-green-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(g.date).toLocaleDateString("fr-FR",{weekday:"long"})})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:g.reads}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.percentage,"%"]})]})]},v))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne d'activit de lecture"})})]}),s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Genres Populaires"}),s.jsx("div",{className:"space-y-4",children:r?.popularGenres?.map((g,v)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:g.genre}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:g.reads?.toLocaleString()}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.percentage,"%"]})]})]},v))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de genre"})})]})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Livres les Plus Performants"}),s.jsx("div",{className:"space-y-4",children:r?.topBooks?.map((g,v)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-purple-600 font-bold",children:["#",v+1]})}),s.jsxs("div",{className:"flex items-center gap-4",children:[g.couverture_url&&s.jsx("img",{src:g.couverture_url,alt:g.titre,className:"w-10 h-14 object-cover rounded"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:g.titre}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Par ",g.auteur_nom]})]})]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:g.reads?.toLocaleString()}),s.jsx("p",{className:"text-sm text-gray-600",children:"Lectures"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:g.downloads?.toLocaleString()}),s.jsx("p",{className:"text-sm text-gray-600",children:"Tlchargements"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Nt,{className:"text-yellow-500"}),s.jsx("p",{className:"text-lg font-bold text-yellow-600",children:g.rating})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.ratings_count," avis"]})]})]})})]},g.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun livre trouv"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Performance des Auteurs"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r?.authorPerformance?.map((g,v)=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(Me,{className:"text-blue-600 text-xl"})}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:g.name}),s.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:g.total_reads?.toLocaleString()}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Lectures totales"}),s.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[s.jsxs("p",{children:[g.books_count," livre(s)"]}),s.jsxs("p",{children:["Note moyenne: ",g.avg_rating,"/5"]})]})]},g.id))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-full",children:"Aucune donne d'auteur"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"volution des Lectures"}),s.jsx("div",{className:"space-y-4",children:r?.monthlyTrends?.map((g,v)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.month}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:g.reads?.toLocaleString()}),s.jsxs("p",{className:"text-sm text-gray-600",children:[g.growth,"%"]})]})]},v))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de tendance"})})]}),s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Mtriques d'Engagement"}),s.jsx("div",{className:"space-y-4",children:r?.engagementMetrics?.map((g,v)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(rs,{className:"text-blue-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:g.name})]}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:g.value})]},v))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune mtrique d'engagement"})})]})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Statut"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:r?.statusDistribution?.map((g,v)=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:g.status}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:g.count}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[g.percentage,"%"]})]},v))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-4",children:"Aucune donne de statut"})})]})]})})}function p7({isOpen:r,onClose:e,onSuccess:t}){const{addProduct:n,loading:i}=dh(),[a,o]=R.useState({name:"",description:"",price:"",stock_quantity:"",category:"",image_url:"",file_url:""}),l=["Livres","Vtements","Accessoires","Goodies","dition Limite","Autre"],u=async f=>{f.preventDefault();try{const m={...a,price:parseFloat(a.price),stock_quantity:parseInt(a.stock_quantity)};await n(m),t(),o({name:"",description:"",price:"",stock_quantity:"",category:"",image_url:"",file_url:""})}catch(m){console.error(" Erreur ajout produit:",m)}},h=(f,m)=>{o(g=>({...g,[f]:m}))},c=()=>{o({name:"",description:"",price:"",stock_quantity:"",category:"",image_url:"",file_url:""}),e()};return r?s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:c,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:f=>f.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(xs,{}),"Ajouter un nouveau produit"]}),s.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("form",{onSubmit:u,className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du produit *"}),s.jsx(Ve,{type:"text",value:a.name,onChange:f=>h("name",f.target.value),placeholder:"Ex: Livre Vakio Boky dition Limite",required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{value:a.description,onChange:f=>h("description",f.target.value),placeholder:"Dcrivez le produit en dtail...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix () *"}),s.jsx(Ve,{type:"number",step:"0.01",min:"0",value:a.price,onChange:f=>h("price",f.target.value),placeholder:"29.99",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantit en stock *"}),s.jsx(Ve,{type:"number",min:"0",value:a.stock_quantity,onChange:f=>h("stock_quantity",f.target.value),placeholder:"100",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catgorie *"}),s.jsxs("select",{value:a.category,onChange:f=>h("category",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"Slectionnez une catgorie"}),l.map(f=>s.jsx("option",{value:f,children:f},f))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image"}),s.jsx(Ve,{type:"url",value:a.image_url,onChange:f=>h("image_url",f.target.value),placeholder:"https://example.com/image.jpg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL du fichier (pour ebooks)"}),s.jsx(Ve,{type:"url",value:a.file_url,onChange:f=>h("file_url",f.target.value),placeholder:"https://example.com/ebook.pdf"})]}),a.image_url&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aperu de l'image"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[s.jsx("img",{src:a.image_url,alt:"Aperu",className:"max-h-32 mx-auto rounded-lg",onError:f=>{f.target.style.display="none"}}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"L'image s'affichera ici si l'URL est valide"})]})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end pt-6 mt-6 border-t border-gray-200",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:c,disabled:i,children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",loading:i,disabled:i,children:[s.jsx(xs,{className:"mr-2"}),"Ajouter le produit"]})]})]})]})}):null}function g7({product:r,isOpen:e,onClose:t,onSuccess:n}){const{updateProduct:i,loading:a}=dh(),[o,l]=R.useState({name:"",description:"",price:"",stock_quantity:"",category:"",image_url:"",file_url:"",status:"active"}),u=["Livres","Vtements","Accessoires","Goodies","dition Limite","Autre"];R.useEffect(()=>{r&&l({name:r.name||"",description:r.description||"",price:r.price||"",stock_quantity:r.stock_quantity||"",category:r.category||"",image_url:r.image_url||"",file_url:r.file_url||"",status:r.status||"active"})},[r]);const h=async f=>{f.preventDefault();try{const m={...o,price:parseFloat(o.price),stock_quantity:parseInt(o.stock_quantity)};await i(r.id,m),n()}catch(m){console.error(" Erreur modification produit:",m)}},c=(f,m)=>{l(g=>({...g,[f]:m}))};return!e||!r?null:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:f=>f.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(xs,{}),"Modifier le produit"]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("form",{onSubmit:h,className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du produit *"}),s.jsx(Ve,{type:"text",value:o.name,onChange:f=>c("name",f.target.value),placeholder:"Ex: Livre Vakio Boky dition Limite",required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{value:o.description,onChange:f=>c("description",f.target.value),placeholder:"Dcrivez le produit en dtail...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix () *"}),s.jsx(Ve,{type:"number",step:"0.01",min:"0",value:o.price,onChange:f=>c("price",f.target.value),placeholder:"29.99",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantit en stock *"}),s.jsx(Ve,{type:"number",min:"0",value:o.stock_quantity,onChange:f=>c("stock_quantity",f.target.value),placeholder:"100",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catgorie *"}),s.jsxs("select",{value:o.category,onChange:f=>c("category",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"",children:"Slectionnez une catgorie"}),u.map(f=>s.jsx("option",{value:f,children:f},f))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),s.jsxs("select",{value:o.status,onChange:f=>c("status",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"active",children:"Actif"}),s.jsx("option",{value:"inactive",children:"Inactif"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image"}),s.jsx(Ve,{type:"url",value:o.image_url,onChange:f=>c("image_url",f.target.value),placeholder:"https://example.com/image.jpg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL du fichier (pour ebooks)"}),s.jsx(Ve,{type:"url",value:o.file_url,onChange:f=>c("file_url",f.target.value),placeholder:"https://example.com/ebook.pdf"})]}),o.image_url&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aperu de l'image"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[s.jsx("img",{src:o.image_url,alt:"Aperu",className:"max-h-32 mx-auto rounded-lg",onError:f=>{f.target.style.display="none"}}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"L'image s'affichera ici si l'URL est valide"})]})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end pt-6 mt-6 border-t border-gray-200",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:t,disabled:a,children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",loading:a,disabled:a,children:[s.jsx(Er,{className:"mr-2"}),"Enregistrer les modifications"]})]})]})]})})}function x7(){const{adminProducts:r=[],loading:e,error:t,fetchAdminProducts:n,deleteProduct:i}=dh(),{isAdmin:a,isAuthenticated:o}=st(),[l,u]=R.useState(!1),[h,c]=R.useState(null),[f,m]=R.useState("");R.useEffect(()=>{o&&n()},[o]);const g=r.filter(w=>w?.name?.toLowerCase().includes(f.toLowerCase())||w?.category?.toLowerCase().includes(f.toLowerCase())),v=async w=>{if(window.confirm("tes-vous sr de vouloir supprimer ce produit ?"))try{await i(w)}catch(k){console.error(" Erreur suppression:",k)}},y=async w=>{try{const k=localStorage.getItem("vakio_token"),E=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/${w}/approve`,{method:"PUT",headers:{Authorization:`Bearer ${k}`}})).json();if(E.success)n();else throw new Error(E.error||"Erreur lors de l'approbation")}catch(k){console.error(" Erreur approbation:",k),setError("Erreur lors de l'approbation du produit")}},x=async w=>{const k=prompt("Raison du rejet (optionnel):");try{const N=localStorage.getItem("vakio_token"),S=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/${w}/reject`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({reason:k})})).json();if(S.success)n();else throw new Error(S.error||"Erreur lors du rejet")}catch(N){console.error(" Erreur rejet:",N),setError("Erreur lors du rejet du produit")}},b=w=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(w);return e?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des produits..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(xs,{className:"text-blue-600"}),"Administration Marketplace"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grer les produits du marketplace Vakio Boky"})]}),s.jsxs(oe,{variant:"primary",onClick:()=>u(!0),className:"flex items-center gap-2",children:[s.jsx(bt,{}),"Ajouter un produit"]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsx(Ve,{placeholder:"Rechercher un produit...",value:f,onChange:w=>m(w.target.value),className:"md:w-80"}),s.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[s.jsxs("span",{children:["Total: ",r.length," produits"]}),s.jsxs("span",{children:["Approuvs:"," ",r.filter(w=>w?.status==="approved").length]}),s.jsxs("span",{children:["En attente:"," ",r.filter(w=>w?.status==="pending").length]}),s.jsxs("span",{children:["Rejets:"," ",r.filter(w=>w?.status==="rejected").length]})]})]})}),t&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[t,s.jsx(oe,{variant:"primary",size:"sm",onClick:n,className:"ml-4",children:"Ressayer"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:g.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xs,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:f?"Aucun produit correspondant  votre recherche":"Aucun produit trouv"}),s.jsxs(oe,{variant:"primary",onClick:()=>u(!0),className:"mt-4",children:[s.jsx(bt,{className:"mr-2"}),"Ajouter un produit"]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produit"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Catgorie"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prix"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(w=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:w.image_url?s.jsx("img",{className:"h-10 w-10 rounded-lg object-cover",src:w.image_url,alt:w.name}):s.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-lg flex items-center justify-center",children:s.jsx(xs,{className:"text-gray-400"})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.name}),s.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:w.description})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:w.category})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b(w.price)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.jsx("span",{className:w.stock_quantity>10?"text-green-600":w.stock_quantity>0?"text-orange-600":"text-red-600",children:w.stock_quantity})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${w.status==="approved"?"bg-green-100 text-green-800":w.status==="pending"?"bg-yellow-100 text-yellow-800":w.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.status==="approved"?s.jsxs(s.Fragment,{children:[s.jsx(Ss,{className:"inline mr-1"}),"Approuv"]}):w.status==="pending"?s.jsxs(s.Fragment,{children:[s.jsx(Ya,{className:"inline mr-1"}),"En attente"]}):w.status==="rejected"?s.jsxs(s.Fragment,{children:[s.jsx(Ya,{className:"inline mr-1"}),"Rejet"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ya,{className:"inline mr-1"}),w.status]})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[w.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{variant:"primary",size:"sm",onClick:()=>y(w.id),className:"flex items-center gap-1 bg-green-600 hover:bg-green-700",children:[s.jsx(Ss,{}),"Approuver"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>x(w.id),className:"flex items-center gap-1",children:[s.jsx(Ya,{}),"Rejeter"]})]}),s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>c(w),className:"flex items-center gap-1",children:[s.jsx(as,{}),"Modifier"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>v(w.id),className:"flex items-center gap-1",children:[s.jsx(zt,{}),"Supprimer"]})]})})]},w.id))})]})})}),s.jsx(p7,{isOpen:l,onClose:()=>u(!1),onSuccess:()=>{u(!1),n()}}),s.jsx(g7,{product:h,isOpen:!!h,onClose:()=>c(null),onSuccess:()=>{c(null),n()}})]})})}function y7(){const[r,e]=R.useState([]),[t,n]=R.useState(!1),[i,a]=R.useState(null),[o,l]=R.useState(!1),[u,h]=R.useState(null),[c,f]=R.useState({name:"",description:""});R.useEffect(()=>{m()},[]);const m=async()=>{n(!0);try{const b=await(await fetch("https://vakio-boky-backend.onrender.com/api/marketplace/categories")).json();if(b.success)e(b.categories);else throw new Error(b.error||"Erreur lors du chargement")}catch(x){a("Erreur lors du chargement des catgories"),console.error(" Erreur chargement catgories:",x)}finally{n(!1)}},g=async()=>{if(c.name.trim())try{const x=localStorage.getItem("vakio_token"),w=await(await fetch("https://vakio-boky-backend.onrender.com/api/marketplace/categories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify(c)})).json();if(w.success)e([...r,w.category]),f({name:"",description:""}),l(!1);else throw new Error(w.error||"Erreur lors de l'ajout")}catch(x){a("Erreur lors de l'ajout de la catgorie"),console.error(" Erreur ajout catgorie:",x)}},v=async()=>{if(u.name.trim())try{const x=localStorage.getItem("vakio_token"),w=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/categories/${u.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify({name:u.name,description:u.description})})).json();if(w.success)e(r.map(k=>k.id===u.id?w.category:k)),h(null);else throw new Error(w.error||"Erreur lors de la modification")}catch(x){a("Erreur lors de la modification de la catgorie"),console.error(" Erreur modification catgorie:",x)}},y=async x=>{if(window.confirm("tes-vous sr de vouloir supprimer cette catgorie ?"))try{const b=localStorage.getItem("vakio_token"),k=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/categories/${x}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}})).json();if(k.success)e(r.filter(N=>N.id!==x));else throw new Error(k.error||"Erreur lors de la suppression")}catch(b){a("Erreur lors de la suppression de la catgorie"),console.error(" Erreur suppression catgorie:",b)}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des catgories..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Qi,{className:"text-blue-600"}),"Gestion des Catgories"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Organisez les produits du marketplace par catgories"})]}),s.jsxs(oe,{variant:"primary",onClick:()=>l(!0),className:"flex items-center gap-2",children:[s.jsx(bt,{}),"Ajouter une catgorie"]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex gap-4 text-sm text-gray-600",children:[s.jsxs("span",{children:["Total: ",r.length," catgories"]}),s.jsxs("span",{children:["Produits totaux:"," ",r.reduce((x,b)=>x+b.product_count,0)]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx(oe,{variant:"primary",size:"sm",onClick:m,className:"ml-4",children:"Ressayer"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Qi,{className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:x.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[x.product_count," produits"]})]})]})}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:x.description}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>h(x),className:"flex items-center gap-1",children:[s.jsx(as,{}),"Modifier"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>y(x.id),className:"flex items-center gap-1",children:[s.jsx(zt,{}),"Supprimer"]})]})]},x.id))}),r.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Qi,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucune catgorie trouve"}),s.jsxs(oe,{variant:"primary",onClick:()=>l(!0),children:[s.jsx(bt,{className:"mr-2"}),"Crer la premire catgorie"]})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Ajouter une catgorie"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ve,{label:"Nom de la catgorie",value:c.name,onChange:x=>f({...c,name:x.target.value}),placeholder:"Ex: Romans"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:c.description,onChange:x=>f({...c,description:x.target.value}),placeholder:"Description de la catgorie"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx(oe,{variant:"secondary",onClick:()=>l(!1),children:"Annuler"}),s.jsx(oe,{variant:"primary",onClick:g,children:"Ajouter"})]})]})}),u&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Modifier la catgorie"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(Ve,{label:"Nom de la catgorie",value:u.name,onChange:x=>h({...u,name:x.target.value}),placeholder:"Ex: Romans"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,value:u.description,onChange:x=>h({...u,description:x.target.value}),placeholder:"Description de la catgorie"})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx(oe,{variant:"secondary",onClick:()=>h(null),children:"Annuler"}),s.jsx(oe,{variant:"primary",onClick:v,children:"Modifier"})]})]})})]})})}function v7(){const[r,e]=R.useState(null),[t,n]=R.useState(!1),[i,a]=R.useState(null),[o,l]=R.useState("30d");R.useEffect(()=>{u()},[o]);const u=async()=>{n(!0);try{const c=localStorage.getItem("vakio_token"),m=await(await fetch("https://vakio-boky-backend.onrender.com/api/marketplace/analytics",{headers:{Authorization:`Bearer ${c}`}})).json();if(m.success)e(m.analytics);else throw new Error(m.error||"Erreur lors du chargement")}catch(c){a("Erreur lors du chargement des statistiques"),console.error(" Erreur chargement statistiques:",c)}finally{n(!1)}},h=c=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(c);return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-blue-600"}),"Statistiques Marketplace"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances de vente et les tendances"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{value:o,onChange:c=>l(c.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"7d",children:"7 jours"}),s.jsx("option",{value:"30d",children:"30 jours"}),s.jsx("option",{value:"90d",children:"90 jours"}),s.jsx("option",{value:"1y",children:"1 an"})]}),s.jsx(oe,{variant:"primary",onClick:u,children:"Actualiser"})]})]}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx(oe,{variant:"primary",size:"sm",onClick:u,className:"ml-4",children:"Ressayer"})]}),r&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(ln,{className:"w-6 h-6 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Chiffre d'affaires"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h(r.totalRevenue)}),s.jsxs("p",{className:`text-sm ${r.revenueChange>=0?"text-green-600":"text-red-600"}`,children:[r.revenueChange>=0?"+":"",r.revenueChange,"% vs priode prcdente"]})]})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(qr,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Commandes"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalOrders}),s.jsxs("p",{className:`text-sm ${r.ordersChange>=0?"text-green-600":"text-red-600"}`,children:[r.ordersChange>=0?"+":"",r.ordersChange,"% vs priode prcdente"]})]})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(ct,{className:"w-6 h-6 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Produits actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalProducts}),s.jsxs("p",{className:`text-sm ${r.productsChange>=0?"text-green-600":"text-red-600"}`,children:[r.productsChange>=0?"+":"",r.productsChange,"% vs priode prcdente"]})]})]})}),s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:s.jsx(Me,{className:"w-6 h-6 text-orange-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clients"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalCustomers}),s.jsxs("p",{className:`text-sm ${r.customersChange>=0?"text-green-600":"text-red-600"}`,children:[r.customersChange>=0?"+":"",r.customersChange,"% vs priode prcdente"]})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Produits les plus vendus"}),s.jsx("div",{className:"space-y-4",children:r.topProducts.map((c,f)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:f+1}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:c.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[c.sales," ventes"]})]})]}),s.jsx("span",{className:"font-semibold text-gray-900",children:h(c.revenue)})]},f))})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Commandes rcentes"}),s.jsx("div",{className:"space-y-4",children:r.recentOrders.map(c=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:c.id}),s.jsx("p",{className:"text-sm text-gray-600",children:c.customer}),s.jsx("p",{className:"text-xs text-gray-500",children:c.date})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-gray-900",children:h(c.amount)}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${c.status==="confirmed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:c.status==="confirmed"?"Confirme":"En attente"})]})]},c.id))})]})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-lg shadow-sm p-6 mt-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"volution du chiffre d'affaires"}),s.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsx(gs,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Graphique en cours d'implmentation"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Intgration Chart.js prvue"})]})})]})]})]})})}function b7(){const{user:r}=st(),[e,t]=R.useState([]),[n,i]=R.useState([]),[a,o]=R.useState(!0),[l,u]=R.useState(null),[h,c]=R.useState("all"),[f,m]=R.useState(""),[g,v]=R.useState(1),[y,x]=R.useState(null),[b,w]=R.useState(!1),k=10,[N,E]=R.useState({totalOrders:0,pendingOrders:0,confirmedOrders:0,totalRevenue:0,averageOrderValue:0});R.useEffect(()=>{M()},[]),R.useEffect(()=>{S()},[e]),R.useEffect(()=>{A()},[e,h,f]);const S=()=>{const Y=e.length,H=e.filter(K=>K.status==="pending").length,V=e.filter(K=>K.status==="confirmed"||K.status==="paid").length,O=e.filter(K=>K.status==="confirmed"||K.status==="paid").reduce((K,se)=>K+parseFloat(se.total_amount||0),0),U=V>0?O/V:0;E({totalOrders:Y,pendingOrders:H,confirmedOrders:V,totalRevenue:O,averageOrderValue:U})},A=()=>{let Y=e;if(h!=="all"&&(Y=Y.filter(H=>H.status===h)),f){const H=f.toLowerCase();Y=Y.filter(V=>V.id.toString().includes(f)||V.customer_name&&V.customer_name.toLowerCase().includes(H)||V.product_name&&V.product_name.toLowerCase().includes(H)||V.shipping_address&&V.shipping_address.toLowerCase().includes(H))}i(Y),v(1)},C=Math.ceil(n.length/k),I=(g-1)*k,L=n.slice(I,I+k),M=async()=>{try{if(o(!0),u(null),!r?.token)throw new Error("Utilisateur non authentifi");const Y=await fetch("https://vakio-boky-backend.onrender.com/api/marketplace/admin/orders",{headers:{Authorization:`Bearer ${r.token}`}});if(!Y.ok)throw new Error(`Erreur HTTP: ${Y.status}`);const H=await Y.json();if(H.success){const V=H.orders.map(O=>({...O,customer_name:`Utilisateur ${O.user_id}`}));t(V)}else throw new Error(H.error||"Erreur lors du chargement des commandes")}catch(Y){u(Y.message),console.error(" Erreur rcupration commandes:",Y)}finally{o(!1)}},D=async Y=>{try{u(null);const V=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/orders/${Y}/confirm`,{method:"PUT",headers:{Authorization:`Bearer ${r?.token}`,"Content-Type":"application/json"}})).json();if(V.success)t(e.map(O=>O.id===Y?{...O,status:"confirmed",payment_status:"paid"}:O));else throw new Error(V.error||"Erreur lors de la confirmation")}catch(H){u(H.message),console.error(" Erreur confirmation commande:",H)}},F=async(Y,H,V=null)=>{try{u(null);const U=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/orders/${Y}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify({status:H,tracking_number:V})})).json();if(U.success)t(e.map(K=>K.id===Y?{...K,status:H,tracking_number:V,updated_at:new Date().toISOString()}:K)),w(!1),x(null);else throw new Error(U.error||"Erreur lors de la mise  jour")}catch(O){u(O.message),console.error(" Erreur mise  jour statut:",O)}},q=async(Y,H,V)=>{try{u(null);const U=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/orders/${Y}/dispute`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify({reason:H,description:V})})).json();if(U.success)t(e.map(K=>K.id===Y?{...K,dispute_status:"open",has_dispute:!0}:K));else throw new Error(U.error||"Erreur lors de la cration du litige")}catch(O){u(O.message),console.error(" Erreur cration litige:",O)}},B=Y=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(Y),z=Y=>{switch(Y){case"confirmed":case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":case"refunded":return"bg-red-100 text-red-800";case"shipped":return"bg-blue-100 text-blue-800";case"delivered":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},G=Y=>{switch(Y){case"confirmed":return"Confirme";case"pending":return"En attente";case"cancelled":return"Annule";case"paid":return"Paye";case"shipped":return"Expdie";case"delivered":return"Livre";case"refunded":return"Rembourse";default:return Y}};return r?a?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des commandes..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(qr,{className:"text-blue-600"}),"Gestion des Commandes"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Confirmer et grer les commandes des utilisateurs"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(qr,{className:"text-blue-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Commandes"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.totalOrders})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Pn,{className:"text-yellow-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En Attente"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.pendingOrders})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ms,{className:"text-green-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Confirmes"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.confirmedOrders})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ln,{className:"text-purple-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenue Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:B(N.totalRevenue)})]})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher par ID, client, produit ou adresse...",value:f,onChange:Y=>m(Y.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-80"})]}),s.jsxs("select",{value:h,onChange:Y=>c(Y.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"confirmed",children:"Confirme"}),s.jsx("option",{value:"paid",children:"Paye"}),s.jsx("option",{value:"shipped",children:"Expdie"}),s.jsx("option",{value:"delivered",children:"Livre"}),s.jsx("option",{value:"cancelled",children:"Annule"}),s.jsx("option",{value:"refunded",children:"Rembourse"})]})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[n.length," commande(s) trouve(s)"]})]})}),l&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 flex justify-between items-center",children:[s.jsx("span",{children:l}),s.jsx(oe,{variant:"primary",size:"sm",onClick:M,children:"Ressayer"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(qr,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucune commande trouve"}),s.jsx(oe,{variant:"primary",onClick:M,className:"mt-4",children:"Actualiser"})]}):n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nr,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucune commande ne correspond  vos critres de recherche"}),s.jsx(oe,{variant:"outline",onClick:()=>{m(""),c("all")},className:"mt-4",children:"Rinitialiser les filtres"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commande"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produit"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montant"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(Y=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",Y.id]}),s.jsx("div",{className:"text-sm text-gray-500",children:new Date(Y.created_at).toLocaleDateString("fr-FR")})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qt,{className:"text-gray-400 mr-2"}),s.jsx("div",{className:"text-sm text-gray-900",children:Y.customer_name})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(xs,{className:"text-gray-400 mr-2"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:Y.product_name||`Produit #${Y.product_id}`}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Quantit: ",Y.quantity]})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:B(Y.total_amount)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${z(Y.status)}`,children:G(Y.status)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>{x(Y),w(!0)},className:"flex items-center gap-1",children:[s.jsx(Ss,{}),"Dtails"]}),Y.status==="pending"&&s.jsxs(oe,{variant:"primary",size:"sm",onClick:()=>D(Y.id),className:"flex items-center gap-1",children:[s.jsx(ms,{}),"Confirmer"]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>{const H=prompt("Motif du litige:");if(H){const V=prompt("Description du litige:");V&&q(Y.id,H,V)}},className:"flex items-center gap-1 text-orange-600 border-orange-300 hover:bg-orange-50",children:[s.jsx(ps,{}),"Litige"]})]})})]},Y.id))})]})})}),C>1&&s.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[s.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>v(Math.max(1,g-1)),disabled:g===1,children:"Prcdent"}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>v(Math.min(C,g+1)),disabled:g===C,children:"Suivant"})]}),s.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s.jsx("div",{children:s.jsxs("p",{className:"text-sm text-gray-700",children:["Affichage de"," ",s.jsx("span",{className:"font-medium",children:I+1})," ",""," ",s.jsx("span",{className:"font-medium",children:Math.min(I+k,n.length)})," ","sur"," ",s.jsx("span",{className:"font-medium",children:n.length})," ","rsultats"]})}),s.jsx("div",{children:s.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>v(Math.max(1,g-1)),disabled:g===1,className:"rounded-l-md",children:s.jsx(s0,{className:"h-4 w-4"})}),Array.from({length:Math.min(5,C)},(Y,H)=>{const V=Math.max(1,Math.min(C-4,g-2))+H;return V>C?null:s.jsx(oe,{variant:g===V?"primary":"outline",size:"sm",onClick:()=>v(V),className:"rounded-none",children:V},V)}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>v(Math.min(C,g+1)),disabled:g===C,className:"rounded-r-md",children:s.jsx(r0,{className:"h-4 w-4"})})]})})]})]}),b&&y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold",children:["Dtails de la commande #",y.id]}),s.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ot,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),s.jsx("p",{className:"text-sm text-gray-900",children:y.customer_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),s.jsx("p",{className:"text-sm text-gray-900",children:new Date(y.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${z(y.status)}`,children:G(y.status)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut Paiement"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${y.payment_status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:y.payment_status==="paid"?"Pay":"En attente"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Montant"}),s.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:B(y.total_amount)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantit"}),s.jsx("p",{className:"text-sm text-gray-900",children:y.quantity})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Produit"}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("p",{className:"font-medium",children:y.product_name||`Produit #${y.product_id}`}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Quantit: ",y.quantity]}),y.product_id&&s.jsxs("p",{className:"text-sm text-gray-600",children:["ID Produit: ",y.product_id]})]})]}),y.shipping_address&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse de livraison"}),s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:s.jsx("p",{className:"text-sm whitespace-pre-line",children:y.shipping_address})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mettre  jour le statut"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[y.status==="pending"&&s.jsx(oe,{variant:"primary",size:"sm",onClick:()=>F(y.id,"confirmed"),children:"Confirmer la commande"}),y.status==="confirmed"&&s.jsxs(s.Fragment,{children:[s.jsx(oe,{variant:"primary",size:"sm",onClick:()=>{const Y=prompt("Numro de suivi:");Y&&F(y.id,"shipped",Y)},children:"Marquer comme expdie"}),s.jsx(oe,{variant:"success",size:"sm",onClick:()=>F(y.id,"delivered"),children:"Marquer comme livre"})]}),["confirmed","shipped"].includes(y.status)&&s.jsx(oe,{variant:"danger",size:"sm",onClick:()=>F(y.id,"cancelled"),children:"Annuler la commande"}),y.status==="cancelled"&&s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>F(y.id,"refunded"),children:"Marquer comme rembourse"})]})]})]})]})})]})}):s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Non authentifi"}),s.jsx("p",{className:"text-gray-600",children:"Veuillez vous connecter pour accder  cette page."})]})})}function j7(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(null),[u,h]=R.useState(!1);R.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const y=localStorage.getItem("vakio_token"),b=await(await fetch("https://vakio-boky-backend.onrender.com/api/marketplace/admin/disputes",{headers:{Authorization:`Bearer ${y}`}})).json();b.success?e(b.disputes||[]):a(b.error||"Erreur lors du chargement")}catch(y){a("Erreur lors du chargement des litiges"),console.error(" Erreur chargement litiges:",y)}finally{n(!1)}},f=async(y,x,b)=>{try{const w=localStorage.getItem("vakio_token"),N=await(await fetch(`https://vakio-boky-backend.onrender.com/api/marketplace/admin/disputes/${y}/resolve`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify({resolution:x,notes:b})})).json();N.success?(e(r.map(E=>E.id===y?{...E,status:"resolved",resolution:x,resolution_notes:b}:E)),h(!1),l(null)):alert(N.error||"Erreur lors de la rsolution")}catch(w){a("Erreur lors de la rsolution du litige"),console.error(" Erreur rsolution litige:",w)}},m=async(y,x)=>{try{e(r.map(b=>b.id===y?{...b,messages:[...b.messages,{from:"admin",message:x,date:new Date().toISOString().split("T")[0]}]}:b))}catch{a("Erreur lors de l'ajout du message")}},g=y=>{switch(y){case"open":return"bg-red-100 text-red-800";case"resolved":return"bg-green-100 text-green-800";case"investigating":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},v=y=>{switch(y){case"open":return"Ouvert";case"resolved":return"Rsolu";case"investigating":return"En cours";default:return y}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des litiges..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ps,{className:"text-orange-600"}),"Gestion des Litiges"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Rsoudre les problmes et rclamations clients"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ps,{className:"text-red-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Litiges ouverts"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(y=>y.status==="open").length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(mn,{className:"text-blue-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En cours"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(y=>y.status==="investigating").length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ms,{className:"text-green-600 text-2xl"}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rsolus"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(y=>y.status==="resolved").length})]})]})})]}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx(oe,{variant:"primary",size:"sm",onClick:c,className:"ml-4",children:"Ressayer"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:r.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ps,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucun litige trouv"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Litige"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motif"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(y=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",y.id]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Commande #",y.order_id]})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qt,{className:"text-gray-400 mr-2"}),s.jsx("div",{className:"text-sm text-gray-900",children:y.customer_name})]})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:y.reason}),s.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:y.description})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g(y.status)}`,children:v(y.status)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>{l(y),h(!0)},className:"flex items-center gap-1",children:[s.jsx(mn,{}),"Grer"]}),y.status==="open"&&s.jsxs(oe,{variant:"primary",size:"sm",onClick:()=>f(y.id,"refund","Remboursement approuv"),className:"flex items-center gap-1",children:[s.jsx(ms,{}),"Rsoudre"]})]})})]},y.id))})]})})}),u&&o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold",children:["Litige #",o.id," - Commande #",o.order_id]}),s.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ot,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.customer_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Motif"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.reason})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.description})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut"}),s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g(o.status)}`,children:v(o.status)})]}),o.resolution&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rsolution"}),s.jsx("p",{className:"text-sm text-gray-900",children:o.resolution}),o.resolution_notes&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.resolution_notes})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Messages"}),s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg max-h-64 overflow-y-auto",children:o.messages.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"Aucun message"}):s.jsx("div",{className:"space-y-3",children:o.messages.map((y,x)=>s.jsx("div",{className:`flex ${y.from==="admin"?"justify-end":"justify-start"}`,children:s.jsxs("div",{className:`max-w-xs px-3 py-2 rounded-lg text-sm ${y.from==="admin"?"bg-blue-600 text-white":"bg-white text-gray-900 border"}`,children:[s.jsx("p",{children:y.message}),s.jsx("p",{className:`text-xs mt-1 ${y.from==="admin"?"text-blue-200":"text-gray-500"}`,children:y.date})]})},x))})}),s.jsx("div",{className:"mt-4",children:s.jsx("textarea",{placeholder:"Ajouter un message...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,onKeyDown:y=>{if(y.key==="Enter"&&!y.shiftKey){y.preventDefault();const x=y.target.value.trim();x&&(m(o.id,x),y.target.value="")}}})})]})]}),o.status==="open"&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rsoudre le litige"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{variant:"success",size:"sm",onClick:()=>f(o.id,"refund","Remboursement complet approuv"),children:"Approuver le remboursement"}),s.jsx(oe,{variant:"primary",size:"sm",onClick:()=>f(o.id,"replacement","Remplacement du produit"),children:"Remplacer le produit"}),s.jsx(oe,{variant:"danger",size:"sm",onClick:()=>f(o.id,"rejected","Rclamation rejete"),children:"Rejeter la rclamation"})]})]})]})})]})})}function rk(){const{user:r,isAdmin:e,isAuthenticated:t}=st(),[n,i]=R.useState([]),[a,o]=R.useState([]),[l,u]=R.useState(!0),[h,c]=R.useState(null),[f,m]=R.useState(""),[g,v]=R.useState("all"),[y,x]=R.useState(!1),[b,w]=R.useState(null);R.useEffect(()=>{t&&e&&N()},[t,e]),R.useEffect(()=>{k()},[n,f,g]);const k=()=>{let B=n;f&&(B=B.filter(z=>z.title.toLowerCase().includes(f.toLowerCase())||z.description.toLowerCase().includes(f.toLowerCase()))),g!=="all"&&(B=B.filter(z=>z.status===g)),o(B)},N=async()=>{try{if(u(!0),c(null),!r?.token)throw new Error("Utilisateur non authentifi");const B=await fetch("https://vakio-boky-backend.onrender.com/api/campaigns/admin/all",{headers:{Authorization:`Bearer ${r.token}`}});if(!B.ok)throw new Error(`Erreur HTTP: ${B.status}`);const z=await B.json();if(z.success)i(z.campaigns||[]);else throw new Error(z.error||"Erreur lors du chargement des campagnes")}catch(B){c(B.message),console.error(" Erreur rcupration campagnes:",B)}finally{u(!1)}},E=async B=>{if(window.confirm("tes-vous sr de vouloir supprimer cette campagne ?"))try{c(null);const G=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/${B}`,{method:"DELETE",headers:{Authorization:`Bearer ${r?.token}`}})).json();if(G.success)await N();else throw new Error(G.error||"Erreur lors de la suppression")}catch(z){c(z.message),console.error(" Erreur suppression:",z)}},S=async B=>{try{c(null);const G=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/admin/${B}/approve`,{method:"PUT",headers:{Authorization:`Bearer ${r?.token}`}})).json();if(G.success)await N();else throw new Error(G.error||"Erreur lors de l'approbation")}catch(z){c(z.message),console.error(" Erreur approbation:",z)}},A=async B=>{const z=prompt("Motif du rejet:");if(z)try{c(null);const Y=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/admin/${B}/reject`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify({reason:z})})).json();if(Y.success)await N();else throw new Error(Y.error||"Erreur lors du rejet")}catch(G){c(G.message),console.error(" Erreur rejet:",G)}},C=async(B,z)=>{try{c(null);const Y=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/admin/${B}/feature`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify({featured:z})})).json();if(Y.success)await N();else throw new Error(Y.error||"Erreur lors de la mise  jour")}catch(G){c(G.message),console.error(" Erreur mise en avant:",G)}},I=async B=>{try{c(null);const G=await(await fetch("https://vakio-boky-backend.onrender.com/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify(B)})).json();if(G.success)x(!1),await N();else throw new Error(G.error||"Erreur lors de la cration")}catch(z){c(z.message),console.error(" Erreur cration campagne:",z)}},L=async(B,z)=>{try{c(null);const Y=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/${B}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r?.token}`},body:JSON.stringify(z)})).json();if(Y.success)w(null),await N();else throw new Error(Y.error||"Erreur lors de la modification")}catch(G){c(G.message),console.error(" Erreur modification campagne:",G)}},M=B=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(B),D=B=>!B.target_amount||B.target_amount===0?0:Math.min(B.current_amount/B.target_amount*100,100),F=B=>{switch(B){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},q=B=>{switch(B){case"active":return"Active";case"pending":return"En attente";case"rejected":return"Rejete";case"completed":return"Termine";default:return B}};return!t||!e?s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Accs Refus"}),s.jsx("p",{className:"text-gray-600",children:"Cette page est rserve aux administrateurs."})]})}):l?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des campagnes..."})]})})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ct,{className:"text-green-600"}),"Administration Campagnes"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grer les campagnes de collecte de fonds Vakio Boky"})]}),s.jsxs(oe,{variant:"primary",onClick:()=>x(!0),className:"flex items-center gap-2",children:[s.jsx(bt,{}),"Nouvelle campagne"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Campagnes"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]}),s.jsx(Ss,{className:"text-blue-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Montant Total Collect"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:M(n.reduce((B,z)=>B+parseFloat(z.current_amount||0),0))})]}),s.jsx(ct,{className:"text-green-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Campagnes Actives"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(B=>B.status==="active").length})]}),s.jsx(Me,{className:"text-purple-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Campagnes en Avant"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.filter(B=>B.featured).length})]}),s.jsx(Nt,{className:"text-yellow-600 text-xl"})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher une campagne...",value:f,onChange:B=>m(B.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-80"})]}),s.jsxs("select",{value:g,onChange:B=>v(B.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"completed",children:"Termine"}),s.jsx("option",{value:"rejected",children:"Rejete"})]})]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[a.length," campagne(s) trouve(s)"]})]})}),h&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 flex justify-between items-center",children:[s.jsx("span",{children:h}),s.jsx(oe,{variant:"primary",size:"sm",onClick:N,children:"Ressayer"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ct,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucune campagne trouve"}),s.jsxs(oe,{variant:"primary",onClick:()=>x(!0),className:"mt-4",children:[s.jsx(bt,{className:"mr-2"}),"Crer une campagne"]})]}):a.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(nr,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucune campagne ne correspond  vos critres de recherche"}),s.jsx(oe,{variant:"outline",onClick:()=>{m(""),v("all")},className:"mt-4",children:"Rinitialiser les filtres"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campagne"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progression"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montants"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dons"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(B=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:B.image_url?s.jsx("img",{className:"h-10 w-10 rounded-lg object-cover",src:B.image_url,alt:B.title}):s.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded-lg flex items-center justify-center",children:s.jsx(ct,{className:"text-gray-400"})})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:B.title}),s.jsx("div",{className:"text-sm text-gray-500 line-clamp-1 max-w-xs",children:B.description}),s.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(B.created_at).toLocaleDateString("fr-FR")})]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"w-32",children:[s.jsx("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:s.jsxs("span",{children:[D(B).toFixed(1),"%"]})}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${D(B)}%`}})})]})}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[s.jsx("div",{className:"font-medium text-green-600",children:M(B.current_amount||0)}),s.jsxs("div",{className:"text-gray-500",children:["sur ",M(B.target_amount)]})]}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[B.donor_count||0," donateurs"]}),s.jsxs("td",{className:"px-6 py-4",children:[s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${F(B.status)}`,children:q(B.status)}),B.featured&&s.jsx("div",{className:"mt-1",children:s.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:[s.jsx(Nt,{className:"w-3 h-3 mr-1"}),"En avant"]})})]}),s.jsx("td",{className:"px-6 py-4 text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[B.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{variant:"success",size:"sm",onClick:()=>S(B.id),className:"flex items-center gap-1",children:[s.jsx(ms,{}),"Approuver"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>A(B.id),className:"flex items-center gap-1",children:[s.jsx(ot,{}),"Rejeter"]})]}),s.jsxs(oe,{variant:B.featured?"warning":"outline",size:"sm",onClick:()=>C(B.id,!B.featured),className:"flex items-center gap-1",children:[s.jsx(Nt,{}),B.featured?"Retirer":"Mettre en avant"]}),s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>w(B),className:"flex items-center gap-1",children:[s.jsx(as,{}),"Modifier"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>E(B.id),className:"flex items-center gap-1",children:[s.jsx(zt,{}),"Supprimer"]})]})})]},B.id))})]})})})]}),y&&s.jsx(w7,{onClose:()=>x(!1),onSubmit:I}),b&&s.jsx(N7,{campaign:b,onClose:()=>w(null),onSubmit:L})]})}function w7({onClose:r,onSubmit:e}){const[t,n]=R.useState({title:"",description:"",target_amount:"",start_date:"",end_date:"",image_url:""}),i=a=>{a.preventDefault(),e(t)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Crer une nouvelle campagne"}),s.jsxs("form",{onSubmit:i,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Titre"}),s.jsx("input",{type:"text",required:!0,value:t.title,onChange:a=>n({...t,title:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),s.jsx("textarea",{required:!0,value:t.description,onChange:a=>n({...t,description:a.target.value}),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Montant cible"}),s.jsx("input",{type:"number",required:!0,value:t.target_amount,onChange:a=>n({...t,target_amount:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Image URL"}),s.jsx("input",{type:"url",value:t.image_url,onChange:a=>n({...t,image_url:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de dbut"}),s.jsx("input",{type:"date",required:!0,value:t.start_date,onChange:a=>n({...t,start_date:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de fin"}),s.jsx("input",{type:"date",required:!0,value:t.end_date,onChange:a=>n({...t,end_date:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:r,children:"Annuler"}),s.jsx(oe,{type:"submit",variant:"primary",children:"Crer la campagne"})]})]})]})})}function N7({campaign:r,onClose:e,onSubmit:t}){const[n,i]=R.useState({title:r.title,description:r.description,target_amount:r.target_amount,start_date:r.start_date?.split("T")[0],end_date:r.end_date?.split("T")[0],image_url:r.image_url||"",status:r.status}),a=o=>{o.preventDefault(),t(r.id,n)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Modifier la campagne"}),s.jsxs("form",{onSubmit:a,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Titre"}),s.jsx("input",{type:"text",required:!0,value:n.title,onChange:o=>i({...n,title:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),s.jsx("textarea",{required:!0,value:n.description,onChange:o=>i({...n,description:o.target.value}),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Montant cible"}),s.jsx("input",{type:"number",required:!0,value:n.target_amount,onChange:o=>i({...n,target_amount:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut"}),s.jsxs("select",{value:n.status,onChange:o=>i({...n,status:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"completed",children:"Termine"}),s.jsx("option",{value:"rejected",children:"Rejete"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de dbut"}),s.jsx("input",{type:"date",required:!0,value:n.start_date,onChange:o=>i({...n,start_date:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de fin"}),s.jsx("input",{type:"date",required:!0,value:n.end_date,onChange:o=>i({...n,end_date:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Image URL"}),s.jsx("input",{type:"url",value:n.image_url,onChange:o=>i({...n,image_url:o.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:e,children:"Annuler"}),s.jsx(oe,{type:"submit",variant:"primary",children:"Modifier la campagne"})]})]})]})})}function k7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d");R.useEffect(()=>{u()},[o]);const u=async()=>{try{n(!0);const c=localStorage.getItem("vakio_token"),m=await(await fetch(`https://vakio-boky-backend.onrender.com/api/campaigns/admin/analytics?range=${o}`,{headers:{Authorization:`Bearer ${c}`}})).json();m.success?e(m.analytics):a(m.error||"Erreur lors du chargement")}catch(c){a("Erreur lors du chargement des statistiques"),console.error(" Erreur chargement statistiques campagnes:",c)}finally{n(!1)}},h=c=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(c);return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-blue-600"}),"Analytics Campagnes"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances des campagnes de collecte de fonds"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsxs("select",{value:o,onChange:c=>l(c.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Collect"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?h(r.totalRaised):"0"}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["+",r?.growth||0,"% vs priode prcdente"]})]}),s.jsx(ln,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nombre de Dons"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalDonations||0}),s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["+",r?.donationGrowth||0,"% vs priode prcdente"]})]}),s.jsx(ct,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Donateurs Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.activeDonors||0}),s.jsxs("p",{className:"text-sm text-purple-600 mt-1",children:["+",r?.donorGrowth||0,"% vs priode prcdente"]})]}),s.jsx(Me,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Campagnes Actives"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.activeCampaigns||0}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r?.completedCampaigns||0," termines"]})]}),s.jsx(rs,{className:"text-orange-600 text-2xl"})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Campagnes les Plus Performantes"}),s.jsx("div",{className:"space-y-4",children:r?.topCampaigns?.map((c,f)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:f*.1},className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-blue-600 font-bold",children:["#",f+1]})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:c.title}),s.jsxs("p",{className:"text-sm text-gray-600",children:[c.donations," dons"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:h(c.amount)}),s.jsxs("p",{className:"text-sm text-gray-600",children:[Math.round(c.amount/c.target*100),"% objectif"]})]})]},c.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne disponible"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Dons Rcents"}),s.jsx("div",{className:"space-y-4",children:r?.recentDonations?.map((c,f)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:f*.1},className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(ln,{className:"text-green-600 text-sm"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:c.anonymous?"Don anonyme":`Don de ${c.donor_name}`}),s.jsx("p",{className:"text-sm text-gray-600",children:c.campaign_title})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-green-600",children:h(c.amount)}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(c.created_at).toLocaleDateString("fr-FR")})]})]},f))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun don rcent"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"volution Mensuelle"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r?.monthlyTrends?.map((c,f)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:f*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:c.month}),s.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:h(c.amount)}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[c.donations," dons"]})]},f))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-3",children:"Aucune donne mensuelle disponible"})})]}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:u,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function E7(){const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState(!0),[o,l]=R.useState(null),[u,h]=R.useState(!1);R.useEffect(()=>{c()},[]);const c=async()=>{try{a(!0);const b=localStorage.getItem("vakio_token"),k=await(await fetch("https://vakio-boky-backend.onrender.com/api/campaigns/admin/all",{headers:{Authorization:`Bearer ${b}`}})).json();if(k.success){const N=k.campaigns||[],E=N.filter(A=>A.featured).sort((A,C)=>(A.featured_order||0)-(C.featured_order||0)),S=N.filter(A=>!A.featured&&A.status==="active");e(S),n(E)}else l(k.error||"Erreur lors du chargement")}catch(b){l("Erreur lors du chargement des campagnes"),console.error(" Erreur chargement campagnes:",b)}finally{a(!1)}},f=async b=>{const w=r.find(S=>S.id===b);if(!w)return;const k=t.length,N=[...t,{...w,featured:!0,featured_order:k}],E=r.filter(S=>S.id!==b);n(N),e(E),await v(N)},m=async b=>{const w=t.find(E=>E.id===b);if(!w)return;const k=t.filter(E=>E.id!==b),N=[...r,{...w,featured:!1}];n(k),e(N),await v(k)},g=async(b,w)=>{const k=t.findIndex(S=>S.id===b);if(k===-1)return;const N=w==="up"?k-1:k+1;if(N<0||N>=t.length)return;const E=[...t];[E[k],E[N]]=[E[N],E[k]],E.forEach((S,A)=>{S.featured_order=A}),n(E),await v(E)},v=async b=>{try{h(!0);const w=localStorage.getItem("vakio_token"),k=b.map((S,A)=>({id:S.id,featured:!0,featured_order:A,featured_until:null})),E=await(await fetch("https://vakio-boky-backend.onrender.com/api/campaigns/admin/featured/batch",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify({updates:k})})).json();E.success||(console.error("Erreur sauvegarde:",E.error),await c())}catch(w){console.error(" Erreur sauvegarde ordre:",w),await c()}finally{h(!1)}},y=b=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(b),x=b=>Math.min(b.current_amount/b.target_amount*100,100);return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des campagnes..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Nt,{className:"text-yellow-600"}),"Campagnes Mises en Avant"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez les campagnes mises en avant sur la plateforme"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Campagnes en Avant"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),s.jsx(Nt,{className:"text-yellow-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Campagnes Disponibles"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(ct,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Collect"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y(t.reduce((b,w)=>b+parseFloat(w.current_amount),0))})]}),s.jsx(Ss,{className:"text-green-600 text-2xl"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Campagnes Mises en Avant"}),u&&s.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),s.jsx("span",{className:"text-sm",children:"Sauvegarde..."})]})]}),s.jsx("div",{className:"space-y-4",children:t.length===0?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune campagne mise en avant"}):t.map((b,w)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:w*.1},className:"border border-yellow-200 bg-yellow-50 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Nt,{className:"text-yellow-600"}),s.jsxs("span",{className:"text-sm font-medium text-yellow-800",children:["Position ",w+1]})]}),s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:b.title}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:b.description}),s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsxs("span",{className:"text-green-600 font-medium",children:[y(b.current_amount)," collect"]}),s.jsxs("span",{className:"text-gray-500",children:[x(b).toFixed(1),"% objectif"]})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>g(b.id,"up"),disabled:w===0,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Xk,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>g(b.id,"down"),disabled:w===t.length-1,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Kk,{className:"w-4 h-4"})})]}),s.jsx("button",{onClick:()=>m(b.id),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"Retirer"})]})]})},b.id))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Campagnes Disponibles"}),s.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.length===0?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune campagne disponible"}):r.map((b,w)=>s.jsx(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:w*.1},className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:b.title}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:b.description}),s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsxs("span",{className:"text-green-600 font-medium",children:[y(b.current_amount)," collect"]}),s.jsxs("span",{className:"text-gray-500",children:[x(b).toFixed(1),"% objectif"]})]})]}),s.jsx("button",{onClick:()=>f(b.id),className:"ml-4 px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"Ajouter"})]})},b.id))})]})]}),o&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[o,s.jsx("button",{onClick:c,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function S7({event:r,isOpen:e,onClose:t,onSuccess:n}){const[i,a]=R.useState({title:"",description:"",event_date:"",event_time:"",location:"",max_participants:"",price:"",image_url:"",status:"active"}),[o,l]=R.useState(!1);R.useEffect(()=>{if(r){const c=new Date(r.event_date);a({title:r.title||"",description:r.description||"",event_date:c.toISOString().split("T")[0],event_time:c.toTimeString().slice(0,5),location:r.location||"",max_participants:r.max_participants||"",price:r.price||"",image_url:r.image_url||"",status:r.status||"active"})}},[r]);const u=async c=>{c.preventDefault(),l(!0);try{const f={...i,event_date:`${i.event_date}T${i.event_time}:00`,max_participants:i.max_participants?parseInt(i.max_participants):null,price:i.price?parseFloat(i.price):0},m=await fetch(`https://vakio-boky-backend.onrender.com/api/events/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.getItem("user"))?.token}`},body:JSON.stringify(f)});if(!m.ok)throw new Error("Erreur lors de la mise  jour");const g=await m.json();if(g.success)alert("vnement mis  jour avec succs"),n();else throw new Error(g.error||"Erreur lors de la mise  jour")}catch(f){console.error(" Erreur modification vnement:",f),alert("Erreur lors de la mise  jour de l'vnement")}finally{l(!1)}},h=(c,f)=>{a(m=>({...m,[c]:f}))};return!e||!r?null:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:"Modifier l'vnement"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]}),s.jsxs("form",{onSubmit:u,className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre de l'vnement *"}),s.jsx(Ve,{type:"text",value:i.title,onChange:c=>h("title",c.target.value),required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{value:i.description,onChange:c=>h("description",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),s.jsx(Ve,{type:"date",value:i.event_date,onChange:c=>h("event_date",c.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Heure *"}),s.jsx(Ve,{type:"time",value:i.event_time,onChange:c=>h("event_time",c.target.value),required:!0})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lieu *"}),s.jsx(Ve,{type:"text",value:i.location,onChange:c=>h("location",c.target.value),icon:s.jsx(Mn,{className:"text-gray-400"}),required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Participants maximum"}),s.jsx(Ve,{type:"number",min:"1",value:i.max_participants,onChange:c=>h("max_participants",c.target.value),icon:s.jsx(Me,{className:"text-gray-400"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix ()"}),s.jsx(Ve,{type:"number",step:"0.01",min:"0",value:i.price,onChange:c=>h("price",c.target.value),icon:s.jsx(Je,{className:"text-gray-400"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),s.jsxs("select",{value:i.status,onChange:c=>h("status",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[s.jsx("option",{value:"active",children:"Actif"}),s.jsx("option",{value:"inactive",children:"Inactif"})]})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL de l'image"}),s.jsx(Ve,{type:"url",value:i.image_url,onChange:c=>h("image_url",c.target.value)})]}),i.image_url&&s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aperu de l'image"}),s.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:s.jsx("img",{src:i.image_url,alt:"Aperu vnement",className:"max-h-32 mx-auto rounded-lg",onError:c=>{c.target.style.display="none"}})})]})]}),s.jsxs("div",{className:"flex gap-3 justify-end pt-6 mt-6 border-t border-gray-200",children:[s.jsx(oe,{type:"button",variant:"secondary",onClick:t,disabled:o,children:"Annuler"}),s.jsxs(oe,{type:"submit",variant:"primary",loading:o,disabled:o,children:[s.jsx(Er,{className:"mr-2"}),"Enregistrer"]})]})]})]})})}function _7({event:r,isOpen:e,onClose:t}){const[n,i]=R.useState([]),[a,o]=R.useState(!1);R.useEffect(()=>{e&&r&&l()},[e,r]);const l=async()=>{o(!0);try{const f=await(await fetch(`https://vakio-boky-backend.onrender.com/api/evenements/${r.id}/registrations`)).json();f.success&&i(f.registrations||[])}catch(c){console.error(" Erreur rcupration inscriptions:",c)}finally{o(!1)}},u=c=>new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(c)),h=()=>{const c=["Nom","Prnom","Email","Date inscription"],f=n.map(x=>[x.last_name||"",x.first_name||"",x.email||"",u(x.created_at)]),m=[c.join(","),...f.map(x=>x.join(","))].join(`
`),g=new Blob([m],{type:"text/csv"}),v=window.URL.createObjectURL(g),y=document.createElement("a");y.href=v,y.download=`inscriptions-${r.title}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(v)};return!e||!r?null:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:s.jsxs(W.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Me,{className:"text-blue-500"}),"Inscriptions - ",r.title]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.length," participant",n.length!==1?"s":""," inscrit",n.length!==1?"s":""]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[n.length>0&&s.jsx(oe,{variant:"secondary",size:"sm",onClick:h,className:"flex items-center gap-2",children:"Exporter CSV"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ot,{size:24})})]})]}),s.jsxs("div",{className:"p-6 max-h-[calc(90vh-120px)] overflow-y-auto",children:[a?s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des inscriptions..."})]}):n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Me,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune inscription pour le moment"}),s.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Les inscriptions apparatront ici quand les utilisateurs s'inscriront  l'vnement."})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-2 bg-gray-50 rounded-lg font-semibold text-sm text-gray-700",children:[s.jsx("div",{className:"col-span-4",children:"Participant"}),s.jsx("div",{className:"col-span-5",children:"Email"}),s.jsx("div",{className:"col-span-3",children:"Date d'inscription"})]}),n.map((c,f)=>s.jsxs(W.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:f*.05},className:"grid grid-cols-12 gap-4 px-4 py-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"col-span-4 flex items-center",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:s.jsx("span",{className:"text-blue-600 text-sm font-semibold",children:c.first_name?.[0]?.toUpperCase()||"U"})}),s.jsx("div",{children:s.jsxs("div",{className:"font-medium text-gray-900",children:[c.first_name," ",c.last_name]})})]}),s.jsxs("div",{className:"col-span-5 flex items-center",children:[s.jsx($r,{className:"text-gray-400 mr-2 flex-shrink-0"}),s.jsx("span",{className:"text-gray-600 text-sm truncate",children:c.email})]}),s.jsxs("div",{className:"col-span-3 flex items-center text-sm text-gray-500",children:[s.jsx(Je,{className:"text-gray-400 mr-2 flex-shrink-0"}),u(c.created_at)]})]},c.id))]}),n.length>0&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),s.jsx("div",{className:"text-sm text-blue-800",children:"Total inscrits"})]}),r.max_participants&&s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.max_participants-n.length}),s.jsx("div",{className:"text-sm text-green-800",children:"Places restantes"})]}),s.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.max_participants?`${Math.round(n.length/r.max_participants*100)}%`:"100%"}),s.jsx("div",{className:"text-sm text-purple-800",children:"Taux de remplissage"})]})]})]})]})]})})}function nk(){const{events:r,loading:e,error:t,fetchAdminEvents:n,approveEvent:i,rejectEvent:a,featureEvent:o,deleteEvent:l}=hh(),{isAdmin:u,isAuthenticated:h}=st(),[c,f]=R.useState(!1),[m,g]=R.useState(null),[v,y]=R.useState(null),[x,b]=R.useState(""),[w,k]=R.useState("all"),[N,E]=R.useState(null);if(R.useEffect(()=>{h&&u&&n()},[h,u]),!h||!u)return s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Accs Refus"}),s.jsx("p",{className:"text-gray-600",children:"Cette page est rserve aux administrateurs."})]})});const S=r.filter(B=>{const z=B.title?.toLowerCase().includes(x.toLowerCase())||B.description?.toLowerCase().includes(x.toLowerCase())||B.location?.toLowerCase().includes(x.toLowerCase()),G=w==="all"||B.status===w;return z&&G}),A=B=>{try{return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(B))}catch{return"Date invalide"}},C=B=>{try{return new Date(B)>new Date}catch{return!1}},I=async B=>{E(B);const z=await i(B);E(null),z.success?alert("vnement approuv avec succs"):alert("Erreur: "+z.error)},L=async B=>{const z=prompt("Motif du rejet:");if(!z||z.trim()===""){alert("Veuillez fournir un motif de rejet");return}E(B);const G=await a(B,z);E(null),G.success?alert("vnement rejet"):alert("Erreur: "+G.error)},M=async(B,z)=>{E(B);const G=await o(B,z);E(null),G.success?alert(z?"vnement mis en avant":"vnement retir des mises en avant"):alert("Erreur: "+G.error)},D=async B=>{if(!window.confirm("tes-vous sr de vouloir supprimer cet vnement ? Cette action est irrversible."))return;E(B);const z=await l(B);E(null),z.success?alert("vnement supprim avec succs"):alert("Erreur: "+z.error)},F=(B,z)=>{const Y={active:{label:C(z)?" venir":"Termin",class:C(z)?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},pending:{label:"En attente",class:"bg-yellow-100 text-yellow-800"},rejected:{label:"Rejet",class:"bg-red-100 text-red-800"}}[B]||{label:"Inconnu",class:"bg-gray-100 text-gray-800"};return s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Y.class}`,children:Y.label})},q={total:r.length,upcoming:r.filter(B=>C(B.event_date)&&B.status==="active").length,past:r.filter(B=>!C(B.event_date)&&B.status==="active").length,pending:r.filter(B=>B.status==="pending").length,totalParticipants:r.reduce((B,z)=>B+(z.registered_count||0),0)};return e&&r.length===0?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des vnements..."})]})})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Je,{className:"text-purple-600"}),"Administration vnements"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez tous les vnements de la plateforme Vakio Boky"})]}),s.jsxs(oe,{variant:"primary",onClick:()=>f(!0),className:"flex items-center gap-2",children:[s.jsx(bt,{}),"Nouvel vnement"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.total})]}),s.jsx(Je,{className:"text-purple-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:" venir"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.upcoming})]}),s.jsx(Ss,{className:"text-green-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-gray-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Termins"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.past})]}),s.jsx(Me,{className:"text-gray-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-yellow-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.pending})]}),s.jsx(Je,{className:"text-yellow-600 text-xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Participants"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.totalParticipants})]}),s.jsx(Me,{className:"text-blue-600 text-xl"})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx(Ve,{placeholder:"Rechercher un vnement...",value:x,onChange:B=>b(B.target.value),className:"pl-10 w-full"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(ko,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsxs("select",{value:w,onChange:B=>k(B.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"active",children:"Actifs"}),s.jsx("option",{value:"rejected",children:"Rejets"})]})]})]}),s.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 px-3 py-2 rounded-md",children:[S.length," vnement(s) trouv(s)"]})]})}),t&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Erreur: "}),t]}),s.jsx("button",{onClick:n,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors",children:"Ressayer"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:S.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Je,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg mb-2",children:x||w!=="all"?"Aucun vnement correspondant":"Aucun vnement trouv"}),s.jsx("p",{className:"text-gray-400 text-sm mb-6",children:x||w!=="all"?"Essayez de modifier vos critres de recherche":"Commencez par crer votre premier vnement"}),s.jsxs(oe,{variant:"primary",onClick:()=>f(!0),className:"flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer un vnement"]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"vnement"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Lieu"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(B=>s.jsxs(W.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"h-12 w-12 flex-shrink-0",children:[B.image_url?s.jsx("img",{className:"h-12 w-12 rounded-lg object-cover",src:B.image_url,alt:B.title,onError:z=>{z.target.style.display="none",z.target.nextSibling.style.display="flex"}}):null,s.jsx("div",{className:`h-12 w-12 bg-gradient-to-br from-purple-100 to-blue-100 rounded-lg flex items-center justify-center ${B.image_url?"hidden":"flex"}`,children:s.jsx(Je,{className:"text-purple-600 text-lg"})})]}),s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900 line-clamp-1",children:B.title||"Sans titre"}),s.jsx("div",{className:"text-sm text-gray-500 line-clamp-2 mt-1",children:B.description||"Aucune description"})]})]})}),s.jsxs("td",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:A(B.event_date)}),s.jsxs("div",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[s.jsx(Je,{className:"w-3 h-3"}),B.location||"Non spcifi"]})]}),s.jsxs("td",{className:"px-6 py-4",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[B.registered_count||0," / ",B.max_participants||""]}),B.price>0?s.jsxs("div",{className:"text-sm text-green-600 font-medium",children:[B.price," "]}):s.jsx("div",{className:"text-sm text-gray-500",children:"Gratuit"})]}),s.jsxs("td",{className:"px-6 py-4",children:[F(B.status,B.event_date),B.featured&&s.jsx("div",{className:"mt-1",children:s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:[s.jsx(ct,{className:"w-3 h-3"}),"Mis en avant"]})})]}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[B.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(oe,{variant:"success",size:"sm",onClick:()=>I(B.id),disabled:N===B.id,className:"flex items-center gap-1",children:[N===B.id?s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}):s.jsx(ms,{className:"w-3 h-3"}),"Approuver"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>L(B.id),disabled:N===B.id,className:"flex items-center gap-1",children:[s.jsx(ot,{className:"w-3 h-3"}),"Rejeter"]})]}),s.jsxs(oe,{variant:B.featured?"warning":"outline",size:"sm",onClick:()=>M(B.id,!B.featured),disabled:N===B.id,className:"flex items-center gap-1",children:[s.jsx(ct,{className:"w-3 h-3"}),B.featured?"Retirer":"Mettre en avant"]}),s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>y(B),className:"flex items-center gap-1",children:[s.jsx(Me,{className:"w-3 h-3"}),"Inscrits"]}),s.jsxs(oe,{variant:"secondary",size:"sm",onClick:()=>g(B),className:"flex items-center gap-1",children:[s.jsx(as,{className:"w-3 h-3"}),"Modifier"]}),s.jsxs(oe,{variant:"danger",size:"sm",onClick:()=>D(B.id),disabled:N===B.id,className:"flex items-center gap-1",children:[N===B.id?s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}):s.jsx(zt,{className:"w-3 h-3"}),"Supprimer"]})]})})]},B.id))})]})})})]}),s.jsx(r_,{isOpen:c,onClose:()=>f(!1),onSuccess:()=>{f(!1),n()}}),s.jsx(S7,{event:m,isOpen:!!m,onClose:()=>g(null),onSuccess:()=>{g(null),n()}}),s.jsx(_7,{event:v,isOpen:!!v,onClose:()=>y(null)})]})}function A7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d");R.useEffect(()=>{u()},[o]);const u=async()=>{try{n(!0);const h=localStorage.getItem("vakio_token"),f=await(await fetch(`https://vakio-boky-backend.onrender.com/api/events/admin/analytics?range=${o}`,{headers:{Authorization:`Bearer ${h}`}})).json();f.success?e(f.analytics):a(f.error||"Erreur lors du chargement")}catch(h){a("Erreur lors du chargement des statistiques"),console.error(" Erreur chargement statistiques vnements:",h)}finally{n(!1)}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-purple-600"}),"Analytics vnements"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances des vnements et l'engagement des participants"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsxs("select",{value:o,onChange:h=>l(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total vnements"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?r.totalEvents:0}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["+",r?.eventsGrowth||0,"% vs priode prcdente"]})]}),s.jsx(Je,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Participants"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalParticipants||0}),s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["+",r?.participantsGrowth||0,"% vs priode prcdente"]})]}),s.jsx(Me,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux de Participation"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.participationRate||0,"%"]}),s.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Participation moyenne"})]}),s.jsx(ct,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"vnements Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.activeEvents||0}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r?.upcomingEvents||0,"  venir"]})]}),s.jsx(fn,{className:"text-orange-600 text-2xl"})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"vnements les Plus Populaires"}),s.jsx("div",{className:"space-y-4",children:r?.topEvents?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-purple-600 font-bold",children:["#",c+1]})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:h.title}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.participants," participants"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-purple-600",children:h.participants}),s.jsxs("p",{className:"text-sm text-gray-600",children:[Math.round(h.participants/h.capacity*100),"% remplissage"]})]})]},h.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne disponible"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Type d'vnement"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r?.eventTypes?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:c*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:h.name}),s.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-2",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[h.percentage,"% du total"]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-3",children:"Aucune donne disponible"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Inscriptions Rcentes"}),s.jsx("div",{className:"space-y-4",children:r?.recentRegistrations?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:s.jsx(Me,{className:"text-purple-600 text-sm"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:h.user_name}),s.jsx("p",{className:"text-sm text-gray-600",children:h.event_title})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-sm text-gray-600",children:new Date(h.registered_at).toLocaleDateString("fr-FR")})})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune inscription rcente"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"volution Mensuelle"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r?.monthlyTrends?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:c*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:h.month}),s.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:h.events}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[h.participants," participants"]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-3",children:"Aucune donne mensuelle disponible"})})]}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:u,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function C7(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(!1),[u,h]=R.useState(null),[c,f]=R.useState({name:"",description:"",type:"conference",default_duration:120,default_capacity:50,default_location:"",default_description:"",is_active:!0});R.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const N=localStorage.getItem("vakio_token"),S=await(await fetch("https://vakio-boky-backend.onrender.com/api/events/admin/templates",{headers:{Authorization:`Bearer ${N}`}})).json();S.success?e(S.templates||[]):a(S.error||"Erreur lors du chargement")}catch(N){a("Erreur lors du chargement des modles"),console.error(" Erreur chargement modles:",N)}finally{n(!1)}},g=async N=>{N.preventDefault();try{const E=localStorage.getItem("vakio_token"),S=u?`https://vakio-boky-backend.onrender.com/api/events/admin/templates/${u.id}`:"https://vakio-boky-backend.onrender.com/api/events/admin/templates",I=await(await fetch(S,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify(c)})).json();I.success?(await m(),l(!1),h(null),b(),alert(u?"Modle modifi avec succs":"Modle cr avec succs")):alert(I.error||"Erreur lors de la sauvegarde")}catch(E){console.error(" Erreur sauvegarde:",E),alert("Erreur lors de la sauvegarde")}},v=N=>{h(N),f({name:N.name,description:N.description,type:N.type,default_duration:N.default_duration,default_capacity:N.default_capacity,default_location:N.default_location||"",default_description:N.default_description||"",is_active:N.is_active}),l(!0)},y=async N=>{if(window.confirm("tes-vous sr de vouloir supprimer ce modle ?"))try{const E=localStorage.getItem("vakio_token"),A=await(await fetch(`https://vakio-boky-backend.onrender.com/api/events/admin/templates/${N}`,{method:"DELETE",headers:{Authorization:`Bearer ${E}`}})).json();A.success?(await m(),alert("Modle supprim avec succs")):alert(A.error||"Erreur lors de la suppression")}catch(E){console.error(" Erreur suppression:",E),alert("Erreur lors de la suppression")}},x=async N=>{const E={...N,name:`${N.name} (Copie)`,id:void 0};try{const S=localStorage.getItem("vakio_token"),C=await(await fetch("https://vakio-boky-backend.onrender.com/api/events/admin/templates",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(E)})).json();C.success?(await m(),alert("Modle dupliqu avec succs")):alert(C.error||"Erreur lors de la duplication")}catch(S){console.error(" Erreur duplication:",S),alert("Erreur lors de la duplication")}},b=()=>{f({name:"",description:"",type:"conference",default_duration:120,default_capacity:50,default_location:"",default_description:"",is_active:!0})},w=N=>{switch(N){case"conference":return s.jsx(Me,{className:"text-blue-600"});case"workshop":return s.jsx(mi,{className:"text-green-600"});case"networking":return s.jsx(Me,{className:"text-purple-600"});case"webinar":return s.jsx(Mn,{className:"text-orange-600"});default:return s.jsx(FiCalendar,{className:"text-gray-600"})}},k=N=>{switch(N){case"conference":return"Confrence";case"workshop":return"Atelier";case"networking":return"Networking";case"webinar":return"Webinaire";default:return N}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des modles..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(mi,{className:"text-indigo-600"}),"Modles d'vnements"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez les modles d'vnements pour faciliter la cration"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Modles"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(mi,{className:"text-indigo-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Modles Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(N=>N.is_active).length})]}),s.jsx(fn,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Types Diffrents"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Set(r.map(N=>N.type)).size})]}),s.jsx(Me,{className:"text-purple-600 text-2xl"})]})})]}),s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>{b(),h(null),l(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2",children:[s.jsx(bt,{}),"Nouveau Modle"]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((N,E)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:E*.1},className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:w(N.type)}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:N.name}),s.jsx("p",{className:"text-sm text-gray-600",children:k(N.type)})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs ${N.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:N.is_active?"Actif":"Inactif"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:N.description}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(fn,{className:"w-4 h-4"}),s.jsxs("span",{children:[N.default_duration," min"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Me,{className:"w-4 h-4"}),s.jsxs("span",{children:[N.default_capacity," participants max"]})]}),N.default_location&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Mn,{className:"w-4 h-4"}),s.jsx("span",{children:N.default_location})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>v(N),className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(as,{className:"w-4 h-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>x(N),className:"flex-1 bg-green-100 text-green-700 px-3 py-2 rounded text-sm hover:bg-green-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(JD,{className:"w-4 h-4"}),"Dupliquer"]}),s.jsxs("button",{onClick:()=>y(N.id),className:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Supprimer"]})]})]},N.id))}),r.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(mi,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun modle d'vnement trouv"}),s.jsxs("button",{onClick:()=>{b(),h(null),l(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier modle"]})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:u?"Modifier le modle":"Nouveau modle"}),s.jsxs("form",{onSubmit:g,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom du modle *"}),s.jsx("input",{type:"text",value:c.name,onChange:N=>f({...c,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:c.description,onChange:N=>f({...c,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",rows:3})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type d'vnement *"}),s.jsxs("select",{value:c.type,onChange:N=>f({...c,type:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[s.jsx("option",{value:"conference",children:"Confrence"}),s.jsx("option",{value:"workshop",children:"Atelier"}),s.jsx("option",{value:"networking",children:"Networking"}),s.jsx("option",{value:"webinar",children:"Webinaire"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dure (min) *"}),s.jsx("input",{type:"number",value:c.default_duration,onChange:N=>f({...c,default_duration:parseInt(N.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",min:"15",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacit max *"}),s.jsx("input",{type:"number",value:c.default_capacity,onChange:N=>f({...c,default_capacity:parseInt(N.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",min:"1",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lieu par dfaut"}),s.jsx("input",{type:"text",value:c.default_location,onChange:N=>f({...c,default_location:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Salle de confrence, En ligne, etc."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description par dfaut"}),s.jsx("textarea",{value:c.default_description,onChange:N=>f({...c,default_description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",rows:3,placeholder:"Description qui sera pr-remplie lors de la cration d'un vnement"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"is_active",checked:c.is_active,onChange:N=>f({...c,is_active:N.target.checked}),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),s.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Modle actif"})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors",children:u?"Modifier":"Crer"}),s.jsx("button",{type:"button",onClick:()=>{l(!1),h(null),b()},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:m,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function ik(){const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState(!0),[o,l]=R.useState(null),[u,h]=R.useState(!1),[c,f]=R.useState(null),[m,g]=R.useState({search:"",status:"all",type:"all"}),[v,y]=R.useState({title:"",description:"",type:"reading",target_value:1,reward_badge_id:"",end_date:"",status:"draft"});R.useEffect(()=>{const D=localStorage.getItem("vakio_token");if(console.log(" Token trouv:",D?"OUI":"NON"),!D){l(" Vous n'tes pas connect. Veuillez vous connecter d'abord."),a(!1);return}x(),b()},[]);const x=async()=>{try{a(!0);const D=localStorage.getItem("vakio_token");if(!D){l(" Token manquant. Connectez-vous : http://localhost:5173/login"),a(!1);return}console.log(" Envoi requte : /api/challenges/admin/all"),console.log(" Token utilis:",D.substring(0,20)+"...");const F=await fetch("https://vakio-boky-backend.onrender.com/api/challenges/admin/all",{headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"}});if(console.log(" Rponse status:",F.status),F.status===401){l(" Session expire. Reconnectez-vous."),localStorage.removeItem("vakio_token"),a(!1);return}if(F.status===403){l(" Accs interdit. Vous n'tes pas administrateur."),a(!1);return}const q=await F.json();console.log(" Donnes reues:",q),q.success?(e(q.challenges||[]),l(null)):l(q.error||"Erreur lors du chargement")}catch(D){console.error(" Erreur complte:",D),l("Erreur de connexion. Vrifiez que le serveur backend est dmarr sur le port 5000.")}finally{a(!1)}},b=async()=>{try{const D=localStorage.getItem("vakio_token");if(!D)return;const q=await(await fetch("https://vakio-boky-backend.onrender.com/api/challenges/admin/badges/all",{headers:{Authorization:`Bearer ${D}`,"Content-Type":"application/json"}})).json();q.success&&n(q.badges||[])}catch(D){console.error(" Erreur chargement badges:",D)}},w=r.filter(D=>!(m.search&&!D.title.toLowerCase().includes(m.search.toLowerCase())&&!D.description.toLowerCase().includes(m.search.toLowerCase())||m.status!=="all"&&D.status!==m.status||m.type!=="all"&&D.type!==m.type)),k=async D=>{D.preventDefault();try{const F=localStorage.getItem("vakio_token");if(!F){alert(" Vous n'tes pas connect.");return}const q=c?`https://vakio-boky-backend.onrender.com/api/challenges/admin/${c.id}`:"https://vakio-boky-backend.onrender.com/api/challenges/admin",G=await(await fetch(q,{method:c?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify(v)})).json();G.success?(await x(),h(!1),f(null),A(),alert(c?" Dfi modifi avec succs":" Dfi cr avec succs")):alert(" "+(G.error||"Erreur lors de la sauvegarde"))}catch(F){console.error(" Erreur sauvegarde:",F),alert(" Erreur lors de la sauvegarde")}},N=D=>{f(D),y({title:D.title,description:D.description,type:D.type,target_value:D.target_value,reward_badge_id:D.reward_badge_id||"",end_date:D.end_date?new Date(D.end_date).toISOString().split("T")[0]:"",status:D.status}),h(!0)},E=async D=>{if(window.confirm("tes-vous sr de vouloir supprimer ce dfi ?"))try{const F=localStorage.getItem("vakio_token");if(!F){alert(" Vous n'tes pas connect.");return}const B=await(await fetch(`https://vakio-boky-backend.onrender.com/api/challenges/admin/${D}`,{method:"DELETE",headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"}})).json();B.success?(await x(),alert(" Dfi supprim avec succs")):alert(" "+(B.error||"Erreur lors de la suppression"))}catch(F){console.error(" Erreur suppression:",F),alert(" Erreur lors de la suppression")}},S=async(D,F)=>{try{const q=localStorage.getItem("vakio_token");if(!q){alert(" Vous n'tes pas connect.");return}const z=await(await fetch(`https://vakio-boky-backend.onrender.com/api/challenges/admin/${D}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${q}`},body:JSON.stringify({status:F})})).json();z.success?(await x(),alert(` Dfi ${F==="active"?"activ":"dsactiv"} avec succs`)):alert(" "+(z.error||"Erreur lors de la mise  jour"))}catch(q){console.error(" Erreur changement statut:",q),alert(" Erreur lors de la mise  jour du statut")}},A=()=>{y({title:"",description:"",type:"reading",target_value:1,reward_badge_id:"",end_date:"",status:"draft"})},C=D=>({reading:"Lecture",writing:"criture",social:"Social"})[D]||D,I=D=>{switch(D){case"active":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},L=D=>{switch(D){case"active":return"Actif";case"draft":return"Brouillon";case"completed":return"Termin";default:return D}},M={total:r.length,active:r.filter(D=>D.status==="active").length,participants:r.reduce((D,F)=>D+(F.participants_count||0),0),completionRate:r.length>0?Math.round(r.reduce((D,F)=>D+(F.completion_rate||0),0)/r.length):0};return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des dfis..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(rs,{className:"text-orange-600"}),"Gestion des Dfis"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Crez et grez les dfis de lecture pour motiver vos utilisateurs"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Dfis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:M.total})]}),s.jsx(rs,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dfis Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:M.active})]}),s.jsx(Gg,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Participants"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:M.participants})]}),s.jsx(Me,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux Russite"}),s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[M.completionRate,"%"]})]}),s.jsx(ct,{className:"text-orange-600 text-2xl"})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher un dfi...",value:m.search,onChange:D=>g({...m,search:D.target.value}),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("select",{value:m.status,onChange:D=>g({...m,status:D.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"active",children:"Actif"}),s.jsx("option",{value:"draft",children:"Brouillon"}),s.jsx("option",{value:"completed",children:"Termin"})]}),s.jsxs("select",{value:m.type,onChange:D=>g({...m,type:D.target.value}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tous les types"}),s.jsx("option",{value:"reading",children:"Lecture"}),s.jsx("option",{value:"writing",children:"criture"}),s.jsx("option",{value:"social",children:"Social"})]}),s.jsxs("button",{onClick:()=>g({search:"",status:"all",type:"all"}),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[s.jsx(ko,{}),"Rinitialiser"]})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Tous les Dfis (",w.length,")"]}),s.jsxs("button",{onClick:()=>{A(),f(null),h(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(bt,{}),"Nouveau Dfi"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dfi"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objectif"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fin"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(D=>s.jsxs(W.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3",children:s.jsx(rs,{className:"text-orange-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.title}),s.jsx("div",{className:"text-sm text-gray-500 line-clamp-1 max-w-xs",children:D.description})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:C(D.type)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.target_value}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:D.participants_count||0}),s.jsxs("span",{className:"text-xs text-gray-500",children:[D.completions_count||0," termins"]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${I(D.status)}`,children:L(D.status)})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"text-gray-400"}),D.end_date?new Date(D.end_date).toLocaleDateString("fr-FR"):"Pas de limite"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>N(D),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Modifier",children:s.jsx(as,{})}),D.status==="draft"&&s.jsx("button",{onClick:()=>S(D.id,"active"),className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-50",title:"Activer",children:s.jsx(Gg,{})}),D.status==="active"&&s.jsx("button",{onClick:()=>S(D.id,"draft"),className:"text-yellow-600 hover:text-yellow-900 p-1 rounded hover:bg-yellow-50",title:"Dsactiver",children:s.jsx(oP,{})}),s.jsx("button",{onClick:()=>E(D.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Supprimer",children:s.jsx(zt,{})})]})})]},D.id))})]})})]}),w.length===0&&!o&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(rs,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:r.length===0?"Aucun dfi trouv":"Aucun dfi ne correspond aux filtres"}),r.length===0?s.jsxs("button",{onClick:()=>{A(),f(null),h(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier dfi"]}):s.jsx("button",{onClick:()=>g({search:"",status:"all",type:"all"}),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2 mx-auto",children:"Rinitialiser les filtres"})]}),u&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:c?"Modifier le Dfi":"Nouveau Dfi"}),s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre *"}),s.jsx("input",{type:"text",value:v.title,onChange:D=>y({...v,title:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),s.jsxs("select",{value:v.type,onChange:D=>y({...v,type:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"reading",children:"Lecture"}),s.jsx("option",{value:"writing",children:"criture"}),s.jsx("option",{value:"social",children:"Social"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{value:v.description,onChange:D=>y({...v,description:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objectif *"}),s.jsx("input",{type:"number",min:"1",value:v.target_value,onChange:D=>y({...v,target_value:parseInt(D.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Badge Rcompense"}),s.jsxs("select",{value:v.reward_badge_id,onChange:D=>y({...v,reward_badge_id:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Aucun badge"}),t.map(D=>s.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),s.jsx("input",{type:"date",value:v.end_date,onChange:D=>y({...v,end_date:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),s.jsxs("select",{value:v.status,onChange:D=>y({...v,status:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"draft",children:"Brouillon"}),s.jsx("option",{value:"active",children:"Actif"})]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:c?"Modifier":"Crer"}),s.jsx("button",{type:"button",onClick:()=>{h(!1),f(null),A()},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})]})}),o&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-bold",children:o}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{localStorage.removeItem("vakio_token"),window.location.href="/login"},className:"ml-4 bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition-colors",children:"Se connecter"}),s.jsx("button",{onClick:x,className:"ml-2 bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition-colors",children:"Ressayer"})]})]}),s.jsxs("div",{className:"mt-2 text-sm",children:[s.jsx("p",{children:"Pour vous connecter:"}),s.jsxs("ol",{className:"list-decimal ml-4 mt-1",children:[s.jsxs("li",{children:["Allez sur ",s.jsx("a",{href:"http://localhost:5173/login",className:"text-blue-600 underline",children:"http://localhost:5173/login"})]}),s.jsx("li",{children:"Connectez-vous avec un compte administrateur"}),s.jsx("li",{children:"Revenez sur cette page"})]})]})]})]})})}function T7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d");R.useEffect(()=>{u()},[o]);const u=async()=>{try{n(!0);const h=localStorage.getItem("vakio_token");if(!h){a("Token d'authentification manquant. Veuillez vous reconnecter."),n(!1);return}const c=await fetch(`https://vakio-boky-backend.onrender.com/api/challenges/admin/analytics?range=${o}`,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(c.status===401||c.status===403){a("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("vakio_token"),n(!1);return}const f=await c.json();f.success?(e(f.analytics),a(null)):a(f.error||"Erreur lors du chargement")}catch(h){a("Erreur de connexion au serveur"),console.error(" Erreur chargement statistiques dfis:",h)}finally{n(!1)}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-orange-600"}),"Analytics Dfis"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances et l'engagement des dfis de lecture"})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsxs("select",{value:o,onChange:h=>l(h.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Dfis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?r.totalChallenges:0}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["+",r?.challengesGrowth||0,"% vs priode prcdente"]})]}),s.jsx(rs,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Participants"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalParticipants||0}),s.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Utilisateurs actifs"})]}),s.jsx(Me,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux Russite"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.completionRate||0,"%"]}),s.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Dfis termins"})]}),s.jsx(Ct,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Badges Dcerns"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalBadges||0}),s.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Rcompenses distribues"})]}),s.jsx(fs,{className:"text-yellow-600 text-2xl"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Participation Quotidienne"}),s.jsx("div",{className:"space-y-4",children:r?.dailyParticipation?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:s.jsx(Me,{className:"text-orange-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date(h.date).toLocaleDateString("fr-FR",{weekday:"long"})})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-orange-600",children:h.participants}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.completions," termins"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de participation"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Types de Dfis Populaires"}),s.jsx("div",{className:"space-y-4",children:r?.challengeTypes?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:h.type}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.percentage,"%"]})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de type"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Dfis les Plus Performants"}),s.jsx("div",{className:"space-y-4",children:r?.topChallenges?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-orange-600 font-bold",children:["#",c+1]})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:h.title}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Type: ",h.type]})]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.participants}),s.jsx("p",{className:"text-sm text-gray-600",children:"Participants"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:h.completions}),s.jsx("p",{className:"text-sm text-gray-600",children:"Termins"})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[h.completion_rate,"%"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Taux russite"})]})]})})]},h.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun dfi trouv"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Top Participants"}),s.jsx("div",{className:"space-y-4",children:r?.topParticipants?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsxs("span",{className:"text-blue-600 font-bold text-sm",children:["#",c+1]})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.challenges_completed}),s.jsx("p",{className:"text-sm text-gray-600",children:"Dfis termins"})]})]},h.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun participant trouv"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Distribution des Badges"}),s.jsx("div",{className:"space-y-4",children:r?.badgeDistribution?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:s.jsx(fs,{className:"text-yellow-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-yellow-600",children:h.earned_count}),s.jsx("p",{className:"text-sm text-gray-600",children:"Dcerns"})]})]},h.id))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucun badge trouv"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"volution des Dfis"}),s.jsx("div",{className:"space-y-4",children:r?.monthlyTrends?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.month}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:h.challenges_created}),s.jsx("p",{className:"text-sm text-gray-600",children:"Crs"})]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune donne de tendance"})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Mtriques d'Engagement"}),s.jsx("div",{className:"space-y-4",children:r?.engagementMetrics?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:c*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(ct,{className:"text-blue-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:h.name})]}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:h.value})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Aucune mtrique d'engagement"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Statut"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:r?.statusDistribution?.map((h,c)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:c*.1},className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:h.status}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:h.count}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[h.percentage,"%"]})]},c))||s.jsx("p",{className:"text-gray-500 text-center py-8 col-span-4",children:"Aucune donne de statut"})})]}),i&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:i}),s.jsx("button",{onClick:u,className:"ml-4 bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition-colors",children:"Ressayer"})]})})]})})}function R7(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(!1),[u,h]=R.useState(null),[c,f]=R.useState({name:"",description:"",icon_url:"",category:"achievement",rarity:"common",points:10});R.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const S=localStorage.getItem("vakio_token");if(!S){a("Token d'authentification manquant. Veuillez vous reconnecter."),n(!1);return}const A=await fetch("https://vakio-boky-backend.onrender.com/api/challenges/admin/badges/all",{headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"}});if(A.status===401||A.status===403){a("Session expire. Veuillez vous reconnecter."),localStorage.removeItem("vakio_token"),n(!1);return}const C=await A.json();C.success?(e(C.badges||[]),a(null)):a(C.error||"Erreur lors du chargement")}catch(S){a("Erreur de connexion au serveur"),console.error(" Erreur chargement badges:",S)}finally{n(!1)}},g=async S=>{S.preventDefault();try{const A=localStorage.getItem("vakio_token");if(!A){alert("Session expire. Veuillez vous reconnecter.");return}const C=u?`https://vakio-boky-backend.onrender.com/api/challenges/admin/badges/${u.id}`:"https://vakio-boky-backend.onrender.com/api/challenges/admin/badges",M=await(await fetch(C,{method:u?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A}`},body:JSON.stringify(c)})).json();M.success?(await m(),l(!1),h(null),x(),alert(u?"Badge modifi avec succs":"Badge cr avec succs")):alert(M.error||"Erreur lors de la sauvegarde")}catch(A){console.error(" Erreur sauvegarde:",A),alert("Erreur lors de la sauvegarde")}},v=S=>{h(S),f({name:S.name,description:S.description,icon_url:S.icon_url||"",category:S.category||"achievement",rarity:S.rarity||"common",points:S.points||10}),l(!0)},y=async S=>{if(window.confirm("tes-vous sr de vouloir supprimer ce badge ?"))try{const A=localStorage.getItem("vakio_token");if(!A){alert("Session expire. Veuillez vous reconnecter.");return}const I=await(await fetch(`https://vakio-boky-backend.onrender.com/api/challenges/admin/badges/${S}`,{method:"DELETE",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}})).json();I.success?(await m(),alert("Badge supprim avec succs")):alert(I.error||"Erreur lors de la suppression")}catch(A){console.error(" Erreur suppression:",A),alert("Erreur lors de la suppression")}},x=()=>{f({name:"",description:"",icon_url:"",category:"achievement",rarity:"common",points:10})},b=S=>{switch(S){case"common":return"bg-gray-100 text-gray-800";case"uncommon":return"bg-green-100 text-green-800";case"rare":return"bg-blue-100 text-blue-800";case"epic":return"bg-purple-100 text-purple-800";case"legendary":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},w=S=>{switch(S){case"common":return"Commun";case"uncommon":return"Peu commun";case"rare":return"Rare";case"epic":return"pique";case"legendary":return"Lgendaire";default:return S}},k=S=>{switch(S){case"achievement":return s.jsx(Nt,{className:"w-5 h-5"});case"reading":return s.jsx(Nt,{className:"w-5 h-5"});case"social":return s.jsx(Me,{className:"w-5 h-5"});case"special":return s.jsx(Nt,{className:"w-5 h-5"});default:return s.jsx(fs,{className:"w-5 h-5"})}},N=S=>{switch(S){case"achievement":return"Accomplissement";case"reading":return"Lecture";case"social":return"Social";case"special":return"Spcial";default:return S}},E=[{name:"Trophy",icon:"",value:"trophy"},{name:"Star",icon:"",value:"star"},{name:"Medal",icon:"",value:"medal"},{name:"Shield",icon:"",value:"shield"},{name:"Crown",icon:"",value:"crown"},{name:"Lightning",icon:"",value:"lightning"},{name:"Fire",icon:"",value:"fire"},{name:"Heart",icon:"",value:"heart"},{name:"Book",icon:"",value:"book"},{name:"Target",icon:"",value:"target"}];return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des badges..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(fs,{className:"text-yellow-600"}),"Gestion des Badges"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Crez et grez les badges et rcompenses pour motiver vos utilisateurs"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Badges"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),s.jsx(fs,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Badges Dcerns"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.reduce((S,A)=>S+(A.earned_count||0),0)})]}),s.jsx(Nt,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Points Totaux"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.reduce((S,A)=>S+(A.points||0),0)})]}),s.jsx(Nt,{className:"text-purple-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Badges Lgendaires"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.filter(S=>S.rarity==="legendary").length})]}),s.jsx(Nt,{className:"text-yellow-600 text-2xl"})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Tous les Badges"}),s.jsxs("button",{onClick:()=>{x(),h(null),l(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(bt,{}),"Nouveau Badge"]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.map((S,A)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:A*.1},className:"bg-gradient-to-br from-white to-gray-50 rounded-lg p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:S.icon_url?s.jsx("span",{className:"text-2xl",children:S.icon_url}):s.jsx(fs,{className:"text-yellow-600 text-xl"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:S.name}),s.jsx("p",{className:"text-sm text-gray-600",children:S.description})]})]}),s.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(S.rarity)}`,children:w(S.rarity)})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[k(S.category),s.jsx("span",{children:N(S.category)})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Nt,{className:"text-yellow-500"}),s.jsxs("span",{children:[S.points," points"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Me,{className:"text-blue-500"}),s.jsxs("span",{children:[S.earned_count||0," dcerns"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>v(S),className:"flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(as,{className:"w-4 h-4"}),"Modifier"]}),s.jsxs("button",{onClick:()=>y(S.id),className:"flex-1 bg-red-100 text-red-700 px-3 py-2 rounded text-sm hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(zt,{className:"w-4 h-4"}),"Supprimer"]})]})]},S.id)),r.length===0&&s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(fs,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Aucun badge trouv"}),s.jsxs("button",{onClick:()=>{x(),h(null),l(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 mx-auto",children:[s.jsx(bt,{}),"Crer le premier badge"]})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Catgorie"}),s.jsx("div",{className:"space-y-4",children:["achievement","reading","social","special"].map(S=>{const A=r.filter(I=>I.category===S).length,C=r.length>0?Math.round(A/r.length*100):0;return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[k(S),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:N(S)})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:A}),s.jsxs("p",{className:"text-sm text-gray-600",children:[C,"%"]})]})]},S)})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Rpartition par Raret"}),s.jsx("div",{className:"space-y-4",children:["common","uncommon","rare","epic","legendary"].map(S=>{const A=r.filter(I=>I.rarity===S).length,C=r.length>0?Math.round(A/r.length*100):0;return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(S)}`,children:w(S)}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-gray-900",children:A}),s.jsxs("p",{className:"text-sm text-gray-600",children:[C,"%"]})]})]},S)})})]})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:u?"Modifier le Badge":"Nouveau Badge"}),s.jsxs("form",{onSubmit:g,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom *"}),s.jsx("input",{type:"text",value:c.name,onChange:S=>f({...c,name:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points *"}),s.jsx("input",{type:"number",min:"1",value:c.points,onChange:S=>f({...c,points:parseInt(S.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{value:c.description,onChange:S=>f({...c,description:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catgorie *"}),s.jsxs("select",{value:c.category,onChange:S=>f({...c,category:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"achievement",children:"Accomplissement"}),s.jsx("option",{value:"reading",children:"Lecture"}),s.jsx("option",{value:"social",children:"Social"}),s.jsx("option",{value:"special",children:"Spcial"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Raret *"}),s.jsxs("select",{value:c.rarity,onChange:S=>f({...c,rarity:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"common",children:"Commun"}),s.jsx("option",{value:"uncommon",children:"Peu commun"}),s.jsx("option",{value:"rare",children:"Rare"}),s.jsx("option",{value:"epic",children:"pique"}),s.jsx("option",{value:"legendary",children:"Lgendaire"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icne"}),s.jsx("div",{className:"grid grid-cols-5 gap-2 mb-3",children:E.map(S=>s.jsx("button",{type:"button",onClick:()=>f({...c,icon_url:S.icon}),className:`p-2 rounded-lg border-2 transition-colors ${c.icon_url===S.icon?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:s.jsx("span",{className:"text-2xl",children:S.icon})},S.value))}),s.jsx("input",{type:"text",value:c.icon_url,onChange:S=>f({...c,icon_url:S.target.value}),placeholder:"Ou entrez un emoji personnalis",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:u?"Modifier":"Crer"}),s.jsx("button",{type:"button",onClick:()=>{l(!1),h(null),x()},className:"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Annuler"})]})]})]})}),i&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:i}),s.jsx("button",{onClick:m,className:"ml-4 bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition-colors",children:"Ressayer"})]})})]})})}function ak(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d"),[u,h]=R.useState("");R.useEffect(()=>{c()},[o]);const c=async()=>{try{n(!0);const m=localStorage.getItem("vakio_token"),v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/analytics/overview?range=${o}`,{headers:{Authorization:`Bearer ${m}`}})).json();v.success?(e(v.analytics),h(v.note||"")):a(v.error||"Erreur lors du chargement")}catch(m){a("Erreur lors du chargement des statistiques"),console.error(" Erreur chargement analytics:",m)}finally{n(!1)}},f=()=>{switch(o){case"7d":return"7 derniers jours";case"30d":return"30 derniers jours";case"90d":return"90 derniers jours";case"1y":return"1 an";default:return"30 derniers jours"}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques relles..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-blue-600"}),"Vue d'ensemble de la plateforme"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Mtriques cls et sant globale de la plateforme Vakio Boky"}),u&&s.jsxs("div",{className:"mt-3 bg-blue-50 border border-blue-200 text-blue-700 px-4 py-2 rounded-lg inline-flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{className:"text-sm",children:u})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Donnes relles de votre base"})]}),s.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]}),s.jsx("div",{className:"mt-4 text-sm text-gray-500",children:s.jsxs("p",{children:[" Affichage des donnes relles pour: ",s.jsx("span",{className:"font-semibold",children:f()})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Totaux"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?r.totalUsers:0}),s.jsx("div",{className:"flex items-center mt-1",children:r?.userGrowth>=0?s.jsxs(s.Fragment,{children:[s.jsx(ct,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:["+",r?.userGrowth||0,"% croissance"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(po,{className:"text-red-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-red-600",children:[r?.userGrowth||0,"% croissance"]})]})})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(Me,{className:"text-blue-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsxs("p",{children:["Dont ",r?.activeUsers||0," actifs"]})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Actifs"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.activeUsers||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(cn,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:[r?.activeUsersPercentage||0,"% du total"]})]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(cn,{className:"text-green-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Mis  jour dans la priode"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Livres Publis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalBooks||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(et,{className:"text-purple-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-purple-600",children:["+",r?.booksGrowth||0,"% croissance"]})]})]}),s.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:s.jsx(et,{className:"text-purple-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Dans la base de donnes"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-yellow-500 opacity-80",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenus Totaux"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",r?.totalRevenue||0]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(ln,{className:"text-yellow-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-yellow-600",children:" implmenter"})]})]}),s.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:s.jsx(ln,{className:"text-yellow-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{className:"text-yellow-600",children:"Systme de paiement  ajouter"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(Je,{className:"mr-2 text-blue-600"}),"Tendance des Utilisateurs Actifs (7 derniers jours)"]}),r?.dailyActiveUsers?.length>0?s.jsx("div",{className:"space-y-4",children:r.dailyActiveUsers.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Me,{className:"text-blue-600 text-sm"})}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 block",children:new Date(m.date).toLocaleDateString("fr-FR",{weekday:"long"})}),s.jsx("span",{className:"text-xs text-gray-500",children:new Date(m.date).toLocaleDateString("fr-FR")})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.users}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"% du total"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Je,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne d'activit disponible"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Les utilisateurs n'ont pas encore mis  jour leur profil"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(Me,{className:"mr-2 text-green-600"}),"Rpartition par Rle"]}),r?.contentEngagement?.length>0?s.jsx("div",{className:"space-y-4",children:r.contentEngagement.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${m.type.includes("Admin")?"bg-red-100":m.type.includes("Auteur")?"bg-purple-100":"bg-blue-100"}`,children:[m.type.includes("Admin")&&s.jsx(Me,{className:"text-red-600 text-sm"}),m.type.includes("Auteur")&&s.jsx(et,{className:"text-purple-600 text-sm"}),m.type.includes("Lecteur")&&s.jsx(Ss,{className:"text-blue-600 text-sm"})]}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:m.type.toLowerCase()})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-green-600",children:m.engagement}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Me,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucun rle dfini"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Vrifiez la table utilisateur"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Utilisation des Fonctionnalits"}),r?.featureUsage?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.featureUsage.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:g*.1},className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:[m.icon==="book"&&s.jsx(et,{className:"text-blue-600 text-xl"}),m.icon==="users"&&s.jsx(Me,{className:"text-blue-600 text-xl"}),m.icon==="target"&&s.jsx(rs,{className:"text-blue-600 text-xl"}),m.icon==="shopping"&&s.jsx(qr,{className:"text-blue-600 text-xl"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.name}),s.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:m.usage}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[m.percentage,"% des utilisateurs"]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(cn,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne d'utilisation disponible"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(ln,{className:"mr-2 text-green-600"}),"Rpartition des Revenus"]}),r?.revenueBreakdown?.[0]?.amount>0?s.jsx("div",{className:"space-y-4",children:r.revenueBreakdown.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(ln,{className:"text-green-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.source})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-green-600",children:["",m.amount]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8 bg-yellow-50 rounded-lg",children:[s.jsx(ln,{className:"text-yellow-500 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-700",children:"Systme de revenus  implmenter"}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Ajoutez un systme de paiement pour suivre les revenus"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(ct,{className:"mr-2 text-blue-600"}),"Mtriques de Croissance (",f(),")"]}),r?.growthMetrics?.length>0?s.jsx("div",{className:"space-y-4",children:r.growthMetrics.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:m.change>=0?s.jsx(ct,{className:"text-green-600 text-sm"}):s.jsx(po,{className:"text-red-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:`text-lg font-bold ${m.change>=0?"text-green-600":"text-red-600"}`,children:m.value}),s.jsxs("p",{className:`text-sm ${m.change>=0?"text-green-600":"text-red-600"}`,children:[m.change>=0?"+":"",m.change,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ct,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune mtrique de croissance"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Indicateurs de Sant de la Plateforme"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r?.healthIndicators?.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:g*.1},className:"text-center p-4 bg-gray-50 rounded-lg border",children:[s.jsxs("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3 ${m.status==="good"?"bg-green-100 border-2 border-green-200":m.status==="warning"?"bg-yellow-100 border-2 border-yellow-200":"bg-red-100 border-2 border-red-200"}`,children:[m.status==="good"&&s.jsx(Ct,{className:"text-green-600 text-2xl"}),m.status==="warning"&&s.jsx(Fs,{className:"text-yellow-600 text-2xl"}),m.status==="critical"&&s.jsx(Fs,{className:"text-red-600 text-2xl"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.name}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:m.value}),s.jsx("p",{className:`text-sm mt-1 font-medium ${m.status==="good"?"text-green-600":m.status==="warning"?"text-yellow-600":"text-red-600"}`,children:m.statusText})]},g))||s.jsxs("div",{className:"col-span-3 text-center py-8",children:[s.jsx(Wg,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucun indicateur de sant disponible"})]})})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(Fs,{className:"text-blue-600 text-xl mr-3 mt-1"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Informations sur les donnes affiches"}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Donnes relles"})," : Tous les chiffres proviennent de votre base de donnes"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:" implmenter"})," : Revenus et mtriques avances d'engagement"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Priode"})," : Les donnes couvrent ",f()]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Actualisation"})," : Changez la priode pour voir diffrentes statistiques"]})]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{children:i})]}),s.jsx("button",{onClick:c,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Ressayer le chargement"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:c,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center mx-auto",children:[s.jsx(cn,{className:"mr-2"}),"Actualiser les statistiques"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Dernire mise  jour : ",new Date().toLocaleTimeString("fr-FR")]})]})]})})}function D7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d"),[u,h]=R.useState("");R.useEffect(()=>{c()},[o]);const c=async()=>{try{n(!0);const m=localStorage.getItem("vakio_token"),v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/analytics/users?range=${o}`,{headers:{Authorization:`Bearer ${m}`}})).json();v.success?(e(v.analytics),h(v.note||"")):a(v.error||"Erreur lors du chargement")}catch(m){a("Erreur lors du chargement des statistiques utilisateurs"),console.error(" Erreur chargement analytics utilisateurs:",m)}finally{n(!1)}},f=()=>{switch(o){case"7d":return"7 derniers jours";case"30d":return"30 derniers jours";case"90d":return"90 derniers jours";case"1y":return"1 an";default:return"30 derniers jours"}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques utilisateurs..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Me,{className:"text-green-600"}),"Analytics Utilisateurs"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez l'engagement, la rtention et les comportements des utilisateurs"}),u&&s.jsxs("div",{className:"mt-3 bg-green-50 border border-green-200 text-green-700 px-4 py-2 rounded-lg inline-flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{className:"text-sm",children:u})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Donnes relles de votre base"})]}),s.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]}),s.jsx("div",{className:"mt-4 text-sm text-gray-500",children:s.jsxs("p",{children:[" Analyse des utilisateurs pour: ",s.jsx("span",{className:"font-semibold",children:f()})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Actifs (DAU)"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.dailyActiveUsers||0}),s.jsx("div",{className:"flex items-center mt-1",children:r?.dauGrowth>=0?s.jsxs(s.Fragment,{children:[s.jsx(ct,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:["+",r?.dauGrowth||0,"% vs hier"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(po,{className:"text-red-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-red-600",children:[r?.dauGrowth||0,"% vs hier"]})]})})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(a0,{className:"text-blue-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Actifs aujourd'hui"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Mensuels (MAU)"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.monthlyActiveUsers||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(cn,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:[r?.mauPercentage||0,"% du total"]})]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(cn,{className:"text-green-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsxs("p",{children:["Actifs sur ",f()]})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-purple-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux de Rtention"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.retentionRate||0,"%"]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(rs,{className:"text-purple-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-purple-600",children:"7 jours aprs inscription"})]})]}),s.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:s.jsx(rs,{className:"text-purple-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Bas sur cohortes rcentes"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-orange-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Score d'Engagement Moyen"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.avgEngagementScore||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(gs,{className:"text-orange-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-orange-600",children:"Sur 100 points"})]})]}),s.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:s.jsx(gs,{className:"text-orange-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Bas sur activit"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(Me,{className:"mr-2 text-blue-600"}),"Rpartition par Rle"]}),r?.engagementCategories?.length>0?s.jsx("div",{className:"space-y-4",children:r.engagementCategories.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${m.level==="high"?"bg-red-100":m.level==="medium"?"bg-purple-100":"bg-blue-100"}`,children:[m.level==="high"&&s.jsx(ct,{className:"text-red-600 text-sm"}),m.level==="medium"&&s.jsx(cn,{className:"text-purple-600 text-sm"}),m.level==="low"&&s.jsx(po,{className:"text-blue-600 text-sm"})]}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.users}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Me,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne de rle disponible"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx($t,{className:"mr-2 text-red-600"}),"Prfrences des Utilisateurs"]}),r?.userBehaviors?.length>0?s.jsx("div",{className:"space-y-4",children:r.userBehaviors.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx($t,{className:"text-red-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-red-600",children:m.count}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx($t,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune prfrence spcifie"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Les utilisateurs n'ont pas dfini de genre prfr"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(Je,{className:"mr-2 text-purple-600"}),"Analyse de Cohorte - Rtention"]}),r?.cohortRetention?.length>0?s.jsx("div",{className:"space-y-4",children:r.cohortRetention.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:s.jsx(Je,{className:"text-purple-600 text-sm"})}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.cohort}),s.jsxs("p",{className:"text-xs text-gray-500",children:[m.users," inscrits"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:`text-lg font-bold ${m.retention>=50?"text-green-600":m.retention>=30?"text-yellow-600":"text-red-600"}`,children:[m.retention,"%"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"rtention"})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Je,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne de cohorte"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Insufficient data for cohort analysis"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(gs,{className:"mr-2 text-yellow-600"}),"Segmentation Utilisateurs"]}),r?.userSegments?.length>0?s.jsx("div",{className:"space-y-4",children:r.userSegments.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${m.type==="power"?"bg-yellow-100":m.type==="regular"?"bg-blue-100":"bg-green-100"}`,children:s.jsx(Me,{className:`text-sm ${m.type==="power"?"text-yellow-600":m.type==="regular"?"text-blue-600":"text-green-600"}`})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.users}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(gs,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne de segmentation"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(rs,{className:"mr-2 text-green-600"}),"Entonnoir d'Utilisation"]}),r?.userFunnel?.length>0?s.jsx("div",{className:"space-y-4",children:r.userFunnel.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-blue-600 font-bold text-sm",children:g+1})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:m.step}),s.jsx("p",{className:"text-sm text-gray-600",children:"tape du parcours utilisateur"})]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.users}),s.jsx("p",{className:"text-sm text-gray-600",children:"Utilisateurs"})]}),s.jsxs("div",{children:[s.jsxs("p",{className:`text-lg font-bold ${m.conversion>=70?"text-green-600":m.conversion>=40?"text-yellow-600":"text-red-600"}`,children:[m.conversion,"%"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Conversion"})]})]})})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(rs,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne d'entonnoir disponible"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Donnes d'engagement  collecter"})]})]}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(Fs,{className:"text-green-600 text-xl mr-3 mt-1"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:" propos des donnes utilisateurs"}),s.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Rles rels"}),' : Bas sur la colonne "role" de la table utilisateur']}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Prfrences"}),' : Bas sur "genre_prefere" des utilisateurs']}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Activit"}),' : Calcule  partir de "updated_at"']}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Engagement dtaill"})," : Ncessite un systme de tracking"]})]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{children:i})]}),s.jsx("button",{onClick:c,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Ressayer le chargement"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:c,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center mx-auto",children:[s.jsx(cn,{className:"mr-2"}),"Actualiser les statistiques utilisateurs"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Analyse base sur ",f()]})]})]})})}function P7(){const[r,e]=R.useState(null),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState("30d"),[u,h]=R.useState("");R.useEffect(()=>{c()},[o]);const c=async()=>{try{n(!0);const m=localStorage.getItem("vakio_token"),v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/analytics/content?range=${o}`,{headers:{Authorization:`Bearer ${m}`}})).json();v.success?(e(v.analytics),h(v.note||"")):a(v.error||"Erreur lors du chargement")}catch(m){a("Erreur lors du chargement des statistiques de contenu"),console.error(" Erreur chargement analytics contenu:",m)}finally{n(!1)}},f=()=>{switch(o){case"7d":return"7 derniers jours";case"30d":return"30 derniers jours";case"90d":return"90 derniers jours";case"1y":return"1 an";default:return"30 derniers jours"}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des statistiques de contenu..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(gs,{className:"text-purple-600"}),"Analytics de Contenu"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Analysez les performances de tous les contenus de la plateforme"}),u&&s.jsxs("div",{className:"mt-3 bg-purple-50 border border-purple-200 text-purple-700 px-4 py-2 rounded-lg inline-flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{className:"text-sm",children:u})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Priode d'analyse"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Donnes relles de votre base"})]}),s.jsxs("select",{value:o,onChange:m=>l(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"7d",children:"7 derniers jours"}),s.jsx("option",{value:"30d",children:"30 derniers jours"}),s.jsx("option",{value:"90d",children:"90 derniers jours"}),s.jsx("option",{value:"1y",children:"1 an"})]})]}),s.jsx("div",{className:"mt-4 text-sm text-gray-500",children:s.jsxs("p",{children:[" Analyse du contenu pour:"," ",s.jsx("span",{className:"font-semibold",children:f()})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Lectures"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalReads?.toLocaleString()||0}),s.jsx("div",{className:"flex items-center mt-1",children:r?.readsGrowth>=0?s.jsxs(s.Fragment,{children:[s.jsx(ct,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:["+",r?.readsGrowth||0,"% croissance"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(po,{className:"text-red-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-red-600",children:[r?.readsGrowth||0,"% croissance"]})]})})]}),s.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:s.jsx(Ss,{className:"text-blue-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Estimations bases sur livres"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-red-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Interactions Totales"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r?.totalInteractions?.toLocaleString()||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx($t,{className:"text-red-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-red-600",children:"Likes, commentaires, partages"})]})]}),s.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:s.jsx($t,{className:"text-red-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Interactions estimes"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-orange-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Temps de Lecture Moyen"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.avgReadingTime||0,"min"]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(fn,{className:"text-orange-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-orange-600",children:"Par session de lecture"})]})]}),s.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:s.jsx(fn,{className:"text-orange-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Valeur estime"})})]}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taux d'Achvement"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[r?.completionRate||0,"%"]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(rs,{className:"text-green-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-green-600",children:"Livres termins"})]})]}),s.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:s.jsx(rs,{className:"text-green-600 text-2xl"})})]}),s.jsx("div",{className:"mt-4 text-xs text-gray-500",children:s.jsx("p",{children:"Valeur estime"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(et,{className:"mr-2 text-blue-600"}),"Performance des Livres (",r?.booksPerformance?.length||0,")"]}),r?.booksPerformance?.length>0?s.jsx("div",{className:"space-y-4",children:r.booksPerformance.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(et,{className:"text-blue-600 text-sm"})}),s.jsxs("div",{className:"max-w-xs",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 block truncate",children:m.title||"Sans titre"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Statut: ",m.status||"Inconnu"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.reads}),s.jsx("p",{className:"text-sm text-gray-600",children:"lectures"})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(et,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucun livre dans la base"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Ajoutez des livres pour voir les statistiques"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(gs,{className:"mr-2 text-purple-600"}),"Engagement par Type de Contenu"]}),r?.contentEngagement?.length>0?s.jsx("div",{className:"space-y-4",children:r.contentEngagement.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:[m.type==="books"&&s.jsx(et,{className:"text-purple-600 text-sm"}),m.type==="posts"&&s.jsx(mn,{className:"text-purple-600 text-sm"}),m.type==="events"&&s.jsx(Me,{className:"text-purple-600 text-sm"}),m.type==="challenges"&&s.jsx(rs,{className:"text-purple-600 text-sm"})]}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:m.type==="books"?"Livres":m.type==="posts"?"Publications":m.type==="events"?"vnements":"Dfis"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-purple-600",children:m.engagement}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(gs,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne d'engagement"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx(et,{className:"mr-2 text-blue-600"}),"Livres les Plus Lus"]}),r?.topBooks?.length>0?s.jsx("div",{className:"space-y-4",children:r.topBooks.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-blue-600 font-bold",children:["#",g+1]})}),s.jsxs("div",{className:"max-w-xs",children:[s.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:m.title}),s.jsxs("p",{className:"text-sm text-gray-600 truncate",children:["par ",m.author||"Auteur inconnu"]}),m.status&&s.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 rounded-full text-gray-600",children:m.status})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:m.reads}),s.jsx("p",{className:"text-sm text-gray-600",children:"lectures"})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(et,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucun livre trouv"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[s.jsx($t,{className:"mr-2 text-orange-600"}),"Genres Populaires"]}),r?.popularGenres?.length>0?s.jsx("div",{className:"space-y-4",children:r.popularGenres.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:s.jsx($t,{className:"text-orange-600 text-sm"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-orange-600",children:m.reads}),s.jsxs("p",{className:"text-sm text-gray-600",children:[m.percentage,"%"]})]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx($t,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucun genre spcifi"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Les utilisateurs n'ont pas dfini de prfrences"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Mtriques de Qualit du Contenu"}),r?.qualityMetrics?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.qualityMetrics.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:g*.1},className:"text-center p-4 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(Nt,{className:"text-yellow-600 text-xl"})}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.name}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-2",children:m.value}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:m.unit})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Nt,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune mtrique de qualit disponible"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Tendances de Contenu (",f(),")"]}),r?.contentTrends?.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:r.contentTrends.map((m,g)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:g*.1},className:"text-center p-4 bg-gray-50 rounded-lg border",children:[s.jsxs("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3 ${m.trend==="up"?"bg-green-100 border-2 border-green-200":m.trend==="down"?"bg-red-100 border-2 border-red-200":"bg-blue-100 border-2 border-blue-200"}`,children:[m.trend==="up"&&s.jsx(ct,{className:"text-green-600 text-2xl"}),m.trend==="down"&&s.jsx(po,{className:"text-red-600 text-2xl"}),m.trend==="stable"&&s.jsx(gs,{className:"text-blue-600 text-2xl"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.metric}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:m.value}),s.jsxs("p",{className:`text-sm mt-1 font-medium ${m.trend==="up"?"text-green-600":m.trend==="down"?"text-red-600":"text-blue-600"}`,children:[m.change>=0?"+":"",m.change,"% vs priode prcdente"]})]},g))}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ct,{className:"text-gray-400 text-4xl mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Aucune donne de tendance disponible"})]})]}),s.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(Fs,{className:"text-purple-600 text-xl mr-3 mt-1"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-purple-800 mb-2",children:" propos des donnes de contenu"}),s.jsxs("ul",{className:"text-sm text-purple-700 space-y-1",children:[s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Livres rels"}),' : Donnes extraites de la table "livres"']}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Auteurs"}),' : Jointure avec table "utilisateur"']}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Mtriques d'engagement"})," ",": Estimations jusqu' implmentation tracking"]}),s.jsxs("li",{children:[" ",s.jsx("span",{className:"font-medium",children:"Tendances"})," : Bases sur donnes disponibles"]})]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Fs,{className:"mr-2"}),s.jsx("span",{children:i})]}),s.jsx("button",{onClick:c,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Ressayer le chargement"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:c,className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center mx-auto",children:[s.jsx(FiActivity,{className:"mr-2"}),"Actualiser les statistiques de contenu"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Donnes actualises  ",new Date().toLocaleTimeString("fr-FR")]})]})]})})}function ok(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(null),[u,h]=R.useState("all"),[c,f]=R.useState("");R.useEffect(()=>{m()},[u]);const m=async()=>{try{n(!0);const w=localStorage.getItem("vakio_token"),N=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/moderation/queue?filter=${u}`,{headers:{Authorization:`Bearer ${w}`}})).json();N.success?e(N.items||[]):a(N.error||"Erreur lors du chargement")}catch(w){a("Erreur lors du chargement de la file de modration"),console.error(" Erreur chargement file modration:",w)}finally{n(!1)}},g=async(w,k,N="")=>{try{const E=localStorage.getItem("vakio_token"),A=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/moderation/queue/${w}/action`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({action:k,reason:N})})).json();A.success?(await m(),l(null),alert(`Action "${k}" applique avec succs`)):alert(A.error||"Erreur lors de l'action")}catch(E){console.error(" Erreur action modration:",E),alert("Erreur lors de l'action")}},v=w=>{switch(w){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=w=>{switch(w){case"post":return s.jsx(mn,{className:"w-5 h-5"});case"comment":return s.jsx(mn,{className:"w-5 h-5"});case"user":return s.jsx(Qt,{className:"w-5 h-5"});case"book":return s.jsx(FiBook,{className:"w-5 h-5"});default:return s.jsx(pi,{className:"w-5 h-5"})}},x=w=>{switch(w){case"pending":return"bg-yellow-100 text-yellow-800";case"in_review":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";case"dismissed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},b=r.filter(w=>w.content?.toLowerCase().includes(c.toLowerCase())||w.reported_user?.toLowerCase().includes(c.toLowerCase())||w.reason?.toLowerCase().includes(c.toLowerCase()));return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement de la file de modration..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ps,{className:"text-orange-600"}),"File de Modration"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez tous les contenus signals et ncessitant une modration"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.filter(w=>w.status==="pending").length})]}),s.jsx(fn,{className:"text-yellow-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En rvision"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.filter(w=>w.status==="in_review").length})]}),s.jsx(Ss,{className:"text-blue-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rsolus"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.filter(w=>w.status==="resolved").length})]}),s.jsx(Ct,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critiques"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:r.filter(w=>w.priority==="critical").length})]}),s.jsx(Fs,{className:"text-red-600 text-2xl"})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsx("div",{className:"flex gap-4",children:s.jsxs("select",{value:u,onChange:w=>h(w.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[s.jsx("option",{value:"all",children:"Tous les lments"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"in_review",children:"En rvision"}),s.jsx("option",{value:"critical",children:"Critiques seulement"}),s.jsx("option",{value:"posts",children:"Publications"}),s.jsx("option",{value:"comments",children:"Commentaires"}),s.jsx("option",{value:"users",children:"Utilisateurs"})]})}),s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher...",value:c,onChange:w=>f(w.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 w-64"})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["lments  modrer (",b.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:b.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"text-4xl text-green-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:c?"Aucun lment ne correspond  votre recherche":"La file de modration est vide"})]}):b.map((w,k)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:k*.05},className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:`p-2 rounded-lg border ${v(w.priority)}`,children:y(w.type)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:[w.type==="post"&&"Publication signale",w.type==="comment"&&"Commentaire signal",w.type==="user"&&"Utilisateur signal",w.type==="book"&&"Livre signal"]}),s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(w.status)}`,children:[w.status==="pending"&&"En attente",w.status==="in_review"&&"En rvision",w.status==="resolved"&&"Rsolu",w.status==="dismissed"&&"Rejet"]}),s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${v(w.priority)}`,children:[w.priority==="critical"&&"Critique",w.priority==="high"&&"lev",w.priority==="medium"&&"Moyen",w.priority==="low"&&"Faible"]})]}),s.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:w.content||"Contenu non disponible"}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Qt,{className:"w-4 h-4"}),w.reported_user||"Utilisateur inconnu"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"w-4 h-4"}),new Date(w.created_at).toLocaleDateString("fr-FR")]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(pi,{className:"w-4 h-4"}),w.reason||"Raison non spcifie"]}),w.reports_count>1&&s.jsxs("span",{className:"flex items-center gap-1 text-orange-600",children:[s.jsx(ps,{className:"w-4 h-4"}),w.reports_count," signalements"]})]})]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[s.jsxs("button",{onClick:()=>l(w),className:"px-3 py-2 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition-colors flex items-center gap-1",children:[s.jsx(Ss,{className:"w-4 h-4"}),"Voir"]}),s.jsxs("button",{onClick:()=>g(w.id,"approve"),className:"px-3 py-2 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 transition-colors flex items-center gap-1",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Approuver"]}),s.jsxs("button",{onClick:()=>g(w.id,"reject"),className:"px-3 py-2 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200 transition-colors flex items-center gap-1",children:[s.jsx(Hr,{className:"w-4 h-4"}),"Rejeter"]})]})]})},w.id))})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dtails de l'lment signal"}),s.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hr,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Informations gnrales"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Type:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900 capitalize",children:o.type})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Utilisateur signal:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900",children:o.reported_user})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Signal par:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900",children:o.reporter_user})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Date:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900",children:new Date(o.created_at).toLocaleString("fr-FR")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Raison:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900",children:o.reason})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Priorit:"}),s.jsxs("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${v(o.priority)}`,children:[o.priority==="critical"&&"Critique",o.priority==="high"&&"lev",o.priority==="medium"&&"Moyen",o.priority==="low"&&"Faible"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Nombre de signalements:"}),s.jsx("span",{className:"ml-2 text-sm text-gray-900",children:o.reports_count||1})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Contenu signal"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:o.content||"Contenu non disponible"})}),o.additional_info&&s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informations supplmentaires"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:o.additional_info})})]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>g(o.id,"approve"),className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5"}),"Approuver le contenu"]}),s.jsxs("button",{onClick:()=>g(o.id,"warn_user"),className:"flex-1 bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ps,{className:"w-5 h-5"}),"Avertir l'utilisateur"]}),s.jsxs("button",{onClick:()=>g(o.id,"remove_content"),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(zt,{className:"w-5 h-5"}),"Supprimer le contenu"]}),s.jsxs("button",{onClick:()=>g(o.id,"ban_user"),className:"flex-1 bg-red-800 text-white px-4 py-2 rounded-lg hover:bg-red-900 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Hr,{className:"w-5 h-5"}),"Bannir l'utilisateur"]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:m,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function M7(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState(null),[u,h]=R.useState("all"),[c,f]=R.useState(""),[m,g]=R.useState({});R.useEffect(()=>{v(),y()},[u]);const v=async()=>{try{n(!0);const E=localStorage.getItem("vakio_token"),A=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/moderation/reports?filter=${u}`,{headers:{Authorization:`Bearer ${E}`}})).json();A.success?e(A.reports||[]):a(A.error||"Erreur lors du chargement")}catch(E){a("Erreur lors du chargement des signalements"),console.error(" Erreur chargement signalements:",E)}finally{n(!1)}},y=async()=>{try{const E=localStorage.getItem("vakio_token"),A=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/moderation/reports/stats",{headers:{Authorization:`Bearer ${E}`}})).json();A.success&&g(A.stats||{})}catch(E){console.error(" Erreur chargement stats:",E)}},x=async(E,S,A="")=>{try{const C=localStorage.getItem("vakio_token"),L=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/moderation/reports/${E}/resolve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({action:S,notes:A})})).json();L.success?(await v(),await y(),l(null),alert(`Signalement ${S==="resolved"?"rsolu":"rejet"} avec succs`)):alert(L.error||"Erreur lors de la rsolution")}catch(C){console.error(" Erreur rsolution signalement:",C),alert("Erreur lors de la rsolution")}},b=E=>{switch(E){case"pending":return"bg-yellow-100 text-yellow-800";case"in_review":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";case"dismissed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},w=E=>{switch(E){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},k=E=>{switch(E){case"harassment":return s.jsx(Qt,{className:"w-5 h-5"});case"spam":return s.jsx(mn,{className:"w-5 h-5"});case"inappropriate":return s.jsx(ps,{className:"w-5 h-5"});case"copyright":return s.jsx(pi,{className:"w-5 h-5"});default:return s.jsx(pi,{className:"w-5 h-5"})}},N=r.filter(E=>E.reporter_name?.toLowerCase().includes(c.toLowerCase())||E.reported_user?.toLowerCase().includes(c.toLowerCase())||E.reason?.toLowerCase().includes(c.toLowerCase())||E.description?.toLowerCase().includes(c.toLowerCase()));return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des signalements..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(pi,{className:"text-red-600"}),"Gestion des Signalements"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez tous les signalements utilisateurs et suivez leur rsolution"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Signalements"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.total_reports||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(ct,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:["+",m.reports_growth||0,"% ce mois"]})]})]}),s.jsx(pi,{className:"text-gray-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En attente"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:m.pending_reports||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(fn,{className:"text-yellow-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-yellow-600",children:"Ncessitent attention"})]})]}),s.jsx(fn,{className:"text-yellow-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rsolus"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:m.resolved_reports||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(Ct,{className:"text-green-500 text-sm mr-1"}),s.jsxs("p",{className:"text-sm text-green-600",children:[m.resolution_rate||0,"% taux de rsolution"]})]})]}),s.jsx(Ct,{className:"text-green-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Temps moyen"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[m.avg_resolution_time||0,"h"]}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(gs,{className:"text-blue-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-blue-600",children:"Pour rsolution"})]})]}),s.jsx(gs,{className:"text-blue-600 text-2xl"})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center",children:[s.jsx("div",{className:"flex gap-4",children:s.jsxs("select",{value:u,onChange:E=>h(E.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",children:[s.jsx("option",{value:"all",children:"Tous les signalements"}),s.jsx("option",{value:"pending",children:"En attente"}),s.jsx("option",{value:"in_review",children:"En rvision"}),s.jsx("option",{value:"resolved",children:"Rsolus"}),s.jsx("option",{value:"critical",children:"Critiques seulement"}),s.jsx("option",{value:"harassment",children:"Harclement"}),s.jsx("option",{value:"spam",children:"Spam"}),s.jsx("option",{value:"inappropriate",children:"Contenu inappropri"})]})}),s.jsxs("div",{className:"relative",children:[s.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher des signalements...",value:c,onChange:E=>f(E.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 w-64"})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Signalements (",N.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:N.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"text-4xl text-green-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:c?"Aucun signalement ne correspond  votre recherche":"Aucun signalement trouv"})]}):N.map((E,S)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:S*.05},className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:`p-2 rounded-lg border ${w(E.severity)}`,children:k(E.type)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Signalement #",E.id]}),s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(E.status)}`,children:[E.status==="pending"&&"En attente",E.status==="in_review"&&"En rvision",E.status==="resolved"&&"Rsolu",E.status==="dismissed"&&"Rejet"]}),s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${w(E.severity)}`,children:[E.severity==="critical"&&"Critique",E.severity==="high"&&"lev",E.severity==="medium"&&"Moyen",E.severity==="low"&&"Faible"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Signal par:"})," ",E.reporter_name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Utilisateur signal:"})," ",E.reported_user]})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Type:"})," ",E.type]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(E.created_at).toLocaleDateString("fr-FR")]})]})]}),s.jsxs("p",{className:"text-gray-700 mb-2",children:[s.jsx("span",{className:"font-medium",children:"Raison:"})," ",E.reason]}),E.description&&s.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:E.description}),s.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"w-4 h-4"}),new Date(E.created_at).toLocaleString("fr-FR")]}),E.assigned_moderator&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Qt,{className:"w-4 h-4"}),"Modrateur: ",E.assigned_moderator]})]})]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[s.jsxs("button",{onClick:()=>l(E),className:"px-3 py-2 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition-colors flex items-center gap-1",children:[s.jsx(Ss,{className:"w-4 h-4"}),"Dtails"]}),E.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>x(E.id,"resolved"),className:"px-3 py-2 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 transition-colors flex items-center gap-1",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Rsoudre"]}),s.jsxs("button",{onClick:()=>x(E.id,"dismissed"),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded text-sm hover:bg-gray-200 transition-colors flex items-center gap-1",children:[s.jsx(Hr,{className:"w-4 h-4"}),"Rejeter"]})]})]})]})},E.id))})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Dtails du Signalement #",o.id]}),s.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hr,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Statut:"}),s.jsx("div",{className:"mt-1",children:s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(o.status)}`,children:[o.status==="pending"&&"En attente",o.status==="in_review"&&"En rvision",o.status==="resolved"&&"Rsolu",o.status==="dismissed"&&"Rejet"]})})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Svrit:"}),s.jsx("div",{className:"mt-1",children:s.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${w(o.severity)}`,children:[o.severity==="critical"&&"Critique",o.severity==="high"&&"lev",o.severity==="medium"&&"Moyen",o.severity==="low"&&"Faible"]})})]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Type de signalement:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:o.type})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Signal par:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:o.reporter_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Utilisateur signal:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:o.reported_user})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Date du signalement:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:new Date(o.created_at).toLocaleString("fr-FR")})]}),o.assigned_moderator&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Modrateur assign:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:o.assigned_moderator})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Dtails du signalement"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Raison principale:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1 font-medium",children:o.reason})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Description dtaille:"}),s.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:o.description||"Aucune description dtaille fournie."})})]}),o.evidence&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Preuves/lments:"}),s.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:o.evidence})})]}),o.resolution_notes&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Notes de rsolution:"}),s.jsx("div",{className:"mt-1 p-3 bg-blue-50 rounded-lg",children:s.jsx("p",{className:"text-sm text-blue-900 whitespace-pre-wrap",children:o.resolution_notes})})]})]})]})]}),o.status==="pending"&&s.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>x(o.id,"resolved","Signalement rsolu aprs investigation"),className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5"}),"Marquer comme rsolu"]}),s.jsxs("button",{onClick:()=>x(o.id,"dismissed","Signalement rejet - ne ncessite pas d'action"),className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Hr,{className:"w-5 h-5"}),"Rejeter le signalement"]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:v,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function O7(){const[r,e]=R.useState([]),[t,n]=R.useState(!0),[i,a]=R.useState(null),[o,l]=R.useState({}),[u,h]=R.useState(null),[c,f]=R.useState("all");R.useEffect(()=>{m(),g()},[c]);const m=async()=>{try{n(!0);const b=localStorage.getItem("vakio_token"),k=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/moderation/actions?filter=${c}`,{headers:{Authorization:`Bearer ${b}`}})).json();k.success?e(k.actions||[]):a(k.error||"Erreur lors du chargement")}catch(b){a("Erreur lors du chargement des actions de modration"),console.error(" Erreur chargement actions modration:",b)}finally{n(!1)}},g=async()=>{try{const b=localStorage.getItem("vakio_token"),k=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/moderation/actions/stats",{headers:{Authorization:`Bearer ${b}`}})).json();k.success&&l(k.stats||{})}catch(b){console.error(" Erreur chargement stats actions:",b)}},v=b=>{switch(b){case"warn_user":return s.jsx(ps,{className:"w-5 h-5 text-yellow-600"});case"remove_content":return s.jsx(zt,{className:"w-5 h-5 text-red-600"});case"ban_user":return s.jsx(Ka,{className:"w-5 h-5 text-red-800"});case"suspend_user":return s.jsx(fn,{className:"w-5 h-5 text-orange-600"});case"approve_content":return s.jsx(Ct,{className:"w-5 h-5 text-green-600"});case"restore_content":return s.jsx(Ct,{className:"w-5 h-5 text-blue-600"});default:return s.jsx(Tn,{className:"w-5 h-5 text-gray-600"})}},y=b=>{switch(b){case"warn_user":return"bg-yellow-100 text-yellow-800";case"remove_content":return"bg-red-100 text-red-800";case"ban_user":return"bg-red-200 text-red-900";case"suspend_user":return"bg-orange-100 text-orange-800";case"approve_content":return"bg-green-100 text-green-800";case"restore_content":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},x=b=>{switch(b){case"warn_user":return"Avertissement utilisateur";case"remove_content":return"Suppression contenu";case"ban_user":return"Bannissement utilisateur";case"suspend_user":return"Suspension utilisateur";case"approve_content":return"Approbation contenu";case"restore_content":return"Restauration contenu";default:return b}};return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des actions de modration..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(Tn,{className:"text-purple-600"}),"Actions de Modration"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Historique et suivi de toutes les actions de modration effectues"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Actions Totales"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.total_actions||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(cn,{className:"text-blue-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-blue-600",children:"Ce mois-ci"})]})]}),s.jsx(Tn,{className:"text-gray-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avertissements"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:o.warning_actions||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(ps,{className:"text-yellow-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-yellow-600",children:"Utilisateurs avertis"})]})]}),s.jsx(ps,{className:"text-yellow-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Contenus Supprims"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:o.removed_content||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(zt,{className:"text-red-500 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-red-600",children:"Publications/commentaires"})]})]}),s.jsx(zt,{className:"text-red-600 text-2xl"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Utilisateurs Bannis"}),s.jsx("p",{className:"text-2xl font-bold text-red-800",children:o.banned_users||0}),s.jsxs("div",{className:"flex items-center mt-1",children:[s.jsx(Ka,{className:"text-red-700 text-sm mr-1"}),s.jsx("p",{className:"text-sm text-red-700",children:"Comptes suspendus"})]})]}),s.jsx(Ka,{className:"text-red-800 text-2xl"})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions Rapides"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("button",{className:"flex items-center gap-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg hover:bg-yellow-100 transition-colors",children:[s.jsx(ps,{className:"text-yellow-600 text-xl"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Avertir un utilisateur"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Envoyer un avertissement"})]})]}),s.jsxs("button",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors",children:[s.jsx(zt,{className:"text-red-600 text-xl"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Supprimer du contenu"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Retirer publication/commentaire"})]})]}),s.jsxs("button",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-300 rounded-lg hover:bg-red-100 transition-colors",children:[s.jsx(Ka,{className:"text-red-800 text-xl"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Bannir un utilisateur"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Suspendre dfinitivement"})]})]})]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtrer les actions"}),s.jsxs("select",{value:c,onChange:b=>f(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"all",children:"Toutes les actions"}),s.jsx("option",{value:"warnings",children:"Avertissements"}),s.jsx("option",{value:"removals",children:"Suppressions"}),s.jsx("option",{value:"bans",children:"Bannissements"}),s.jsx("option",{value:"approvals",children:"Approbations"}),s.jsx("option",{value:"today",children:"Aujourd'hui"}),s.jsx("option",{value:"week",children:"Cette semaine"}),s.jsx("option",{value:"month",children:"Ce mois"})]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Historique des Actions (",r.length,")"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:r.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ct,{className:"text-4xl text-green-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Aucune action de modration trouve"})]}):r.map((b,w)=>s.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:w*.05},className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:v(b.action_type)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:x(b.action_type)}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(b.action_type)}`,children:b.action_type.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Modrateur:"})," ",b.moderator_name]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Utilisateur affect:"})," ",b.affected_user]})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Type de contenu:"})," ",b.content_type||"N/A"]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(b.created_at).toLocaleString("fr-FR")]})]})]}),b.reason&&s.jsxs("p",{className:"text-gray-700 mb-2",children:[s.jsx("span",{className:"font-medium",children:"Raison:"})," ",b.reason]}),b.notes&&s.jsxs("p",{className:"text-gray-600 text-sm",children:[s.jsx("span",{className:"font-medium",children:"Notes:"})," ",b.notes]}),s.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Je,{className:"w-4 h-4"}),new Date(b.created_at).toLocaleDateString("fr-FR")]}),b.expires_at&&s.jsxs("span",{className:"flex items-center gap-1 text-orange-600",children:[s.jsx(fn,{className:"w-4 h-4"}),"Expire le ",new Date(b.expires_at).toLocaleDateString("fr-FR")]}),b.is_reversible&&s.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Action rversible"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>h(b),className:"px-3 py-2 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition-colors flex items-center gap-1",children:[s.jsx(Ss,{className:"w-4 h-4"}),"Dtails"]}),b.is_reversible&&s.jsxs("button",{className:"px-3 py-2 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 transition-colors flex items-center gap-1",children:[s.jsx(Ct,{className:"w-4 h-4"}),"Annuler"]})]})]})},b.id))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(ji,{className:"text-gray-600"}),"Paramtres de Modration"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seuil d'auto-modration"}),s.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{children:"Faible (5+ signalements)"}),s.jsx("option",{children:"Moyen (3+ signalements)"}),s.jsx("option",{children:"lev (1+ signalement critique)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dure des suspensions automatiques"}),s.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{children:"24 heures"}),s.jsx("option",{children:"7 jours"}),s.jsx("option",{children:"30 jours"}),s.jsx("option",{children:"Indfinie"})]})]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notifications modrateurs"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),s.jsx("span",{className:"text-sm",children:"Nouveaux signalements critiques"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),s.jsx("span",{className:"text-sm",children:"Actions de modration"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",className:"mr-2"}),s.jsx("span",{className:"text-sm",children:"Rapports hebdomadaires"})]})]})]})})]})]}),u&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs(W.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Dtails de l'Action #",u.id]}),s.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Hr,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:v(u.action_type)}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:x(u.action_type)}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Effectue le ",new Date(u.created_at).toLocaleString("fr-FR")]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Modrateur:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:u.moderator_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Utilisateur affect:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:u.affected_user})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Type de contenu:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:u.content_type||"N/A"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"ID du contenu:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:u.content_id||"N/A"})]})]}),u.reason&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Raison:"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:u.reason})]}),u.notes&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Notes dtailles:"}),s.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:u.notes})})]}),u.expires_at&&s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Expiration:"}),s.jsx("p",{className:"text-sm text-orange-600 mt-1",children:new Date(u.expires_at).toLocaleString("fr-FR")})]}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ct,{className:`w-5 h-5 ${u.is_reversible?"text-green-600":"text-gray-400"}`}),s.jsx("span",{className:"text-sm text-gray-600",children:u.is_reversible?"Action rversible":"Action irrversible"})]}),u.is_reversible&&s.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Annuler l'action"})]})]})]})}),i&&s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6",children:[i,s.jsx("button",{onClick:m,className:"ml-4 underline hover:no-underline",children:"Ressayer"})]})]})})}function lk(){const[r,e]=R.useState({}),[t,n]=R.useState(!0),[i,a]=R.useState(!1),[o,l]=R.useState(null),[u,h]=R.useState(null),[c,f]=R.useState("general");R.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const x=localStorage.getItem("vakio_token"),w=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/platform",{headers:{Authorization:`Bearer ${x}`}})).json();w.success?e(w.settings||{}):l(w.error||"Erreur lors du chargement")}catch(x){l("Erreur lors du chargement des paramtres"),console.error(" Erreur chargement paramtres:",x)}finally{n(!1)}},g=async()=>{try{a(!0),l(null),h(null);const x=localStorage.getItem("vakio_token"),w=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/platform",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify({settings:r})})).json();w.success?(h("Paramtres sauvegards avec succs"),setTimeout(()=>h(null),3e3)):l(w.error||"Erreur lors de la sauvegarde")}catch(x){l("Erreur lors de la sauvegarde"),console.error(" Erreur sauvegarde paramtres:",x)}finally{a(!1)}},v=(x,b)=>{e(w=>({...w,[x]:b}))},y=[{id:"general",label:"Gnral",icon:s.jsx(ji,{className:"w-5 h-5"})},{id:"users",label:"Utilisateurs",icon:s.jsx(Me,{className:"w-5 h-5"})},{id:"content",label:"Contenu",icon:s.jsx(sP,{className:"w-5 h-5"})},{id:"security",label:"Scurit",icon:s.jsx(Tn,{className:"w-5 h-5"})},{id:"notifications",label:"Notifications",icon:s.jsx($r,{className:"w-5 h-5"})}];return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des paramtres..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ji,{className:"text-blue-600"}),"Paramtres de la Plateforme"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Configurez les paramtres gnraux de votre plateforme Vakio Boky"})]}),u&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5"}),u]}),o&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(ps,{className:"w-5 h-5"}),o]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Catgories"}),s.jsx("nav",{className:"space-y-2",children:y.map(x=>s.jsxs("button",{onClick:()=>f(x.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${c===x.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[x.icon,s.jsx("span",{className:"text-sm font-medium",children:x.label})]},x.id))})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:y.find(x=>x.id===c)?.label}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:m,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[s.jsx(Wr,{className:"w-4 h-4"}),"Actualiser"]}),s.jsxs("button",{onClick:g,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[i?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(Er,{className:"w-4 h-4"}),"Sauvegarder"]})]})]})}),s.jsxs("div",{className:"p-6",children:[c==="general"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom de la plateforme"}),s.jsx("input",{type:"text",value:r.platform_name||"",onChange:x=>v("platform_name",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Vakio Boky"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Version de la plateforme"}),s.jsx("input",{type:"text",value:r.platform_version||"",onChange:x=>v("platform_version",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.0.0"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description de la plateforme"}),s.jsx("textarea",{value:r.platform_description||"",onChange:x=>v("platform_description",x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Plateforme littraire collaborative..."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Langue par dfaut"}),s.jsxs("select",{value:r.default_language||"fr",onChange:x=>v("default_language",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"fr",children:"Franais"}),s.jsx("option",{value:"en",children:"English"}),s.jsx("option",{value:"mg",children:"Malagasy"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fuseau horaire"}),s.jsxs("select",{value:r.timezone||"Indian/Antananarivo",onChange:x=>v("timezone",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"Indian/Antananarivo",children:"Madagascar (UTC+3)"}),s.jsx("option",{value:"Europe/Paris",children:"Paris (UTC+1)"}),s.jsx("option",{value:"UTC",children:"UTC"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"maintenance_mode",checked:r.maintenance_mode||!1,onChange:x=>v("maintenance_mode",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"maintenance_mode",className:"text-sm font-medium text-gray-700",children:"Mode maintenance activ"})]})]}),c==="users"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Inscription ouverte"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"registration_open",checked:r.registration_open!==!1,onChange:x=>v("registration_open",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"registration_open",className:"text-sm text-gray-600",children:"Permettre les nouvelles inscriptions"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vrification email requise"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"email_verification_required",checked:r.email_verification_required!==!1,onChange:x=>v("email_verification_required",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"email_verification_required",className:"text-sm text-gray-600",children:"Exiger la vrification des emails"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limite de publications par jour"}),s.jsx("input",{type:"number",value:r.daily_post_limit||10,onChange:x=>v("daily_post_limit",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limite de commentaires par heure"}),s.jsx("input",{type:"number",value:r.hourly_comment_limit||20,onChange:x=>v("hourly_comment_limit",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"200"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rles utilisateur par dfaut"}),s.jsxs("select",{value:r.default_user_role||"user",onChange:x=>v("default_user_role",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"user",children:"Utilisateur"}),s.jsx("option",{value:"author",children:"Auteur"}),s.jsx("option",{value:"moderator",children:"Modrateur"})]})]})]}),c==="content"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Modration automatique active"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"auto_moderation",checked:r.auto_moderation!==!1,onChange:x=>v("auto_moderation",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"auto_moderation",className:"text-sm text-gray-600",children:"Activer la modration automatique"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approbation requise pour les publications"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"content_approval_required",checked:r.content_approval_required||!1,onChange:x=>v("content_approval_required",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"content_approval_required",className:"text-sm text-gray-600",children:"Ncessiter l'approbation des publications"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taille maximale des fichiers (MB)"}),s.jsx("input",{type:"number",value:r.max_file_size||10,onChange:x=>v("max_file_size",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formats de fichiers autoriss"}),s.jsx("input",{type:"text",value:r.allowed_file_types||"jpg,jpeg,png,pdf,doc,docx",onChange:x=>v("allowed_file_types",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"jpg,jpeg,png,pdf"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mots-cls interdits (spars par des virgules)"}),s.jsx("textarea",{value:r.forbidden_keywords||"",onChange:x=>v("forbidden_keywords",x.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"mot1,mot2,mot3"})]})]}),c==="security"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tentatives de connexion max"}),s.jsx("input",{type:"number",value:r.max_login_attempts||5,onChange:x=>v("max_login_attempts",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"3",max:"20"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dure du blocage (minutes)"}),s.jsx("input",{type:"number",value:r.lockout_duration||30,onChange:x=>v("lockout_duration",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"5",max:"1440"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forcer le changement de mot de passe"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"force_password_change",checked:r.force_password_change||!1,onChange:x=>v("force_password_change",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"force_password_change",className:"text-sm text-gray-600",children:"Obliger le changement priodique"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dure de validit des mots de passe (jours)"}),s.jsx("input",{type:"number",value:r.password_validity_days||90,onChange:x=>v("password_validity_days",parseInt(x.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"30",max:"365"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Politiques de scurit"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"two_factor_required",checked:r.two_factor_required||!1,onChange:x=>v("two_factor_required",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"two_factor_required",className:"text-sm text-gray-600",children:"Authentification  deux facteurs obligatoire pour les admins"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"session_timeout",checked:r.session_timeout!==!1,onChange:x=>v("session_timeout",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"session_timeout",className:"text-sm text-gray-600",children:"Dconnexion automatique aprs inactivit"})]})]})]})]}),c==="notifications"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notifications par email actives"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"email_notifications_enabled",checked:r.email_notifications_enabled!==!1,onChange:x=>v("email_notifications_enabled",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"email_notifications_enabled",className:"text-sm text-gray-600",children:"Activer les notifications par email"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notifications push actives"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:"push_notifications_enabled",checked:r.push_notifications_enabled!==!1,onChange:x=>v("push_notifications_enabled",x.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"push_notifications_enabled",className:"text-sm text-gray-600",children:"Activer les notifications push"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Types de notifications"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"new_user_registration",label:"Nouvelles inscriptions"},{key:"new_content_published",label:"Nouveau contenu publi"},{key:"content_reported",label:"Contenu signal"},{key:"user_banned",label:"Utilisateur banni"},{key:"system_alerts",label:"Alertes systme"},{key:"weekly_reports",label:"Rapports hebdomadaires"}].map(x=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",id:x.key,checked:r[x.key]!==!1,onChange:b=>v(x.key,b.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:x.key,className:"text-sm text-gray-600",children:x.label})]},x.key))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email expditeur par dfaut"}),s.jsx("input",{type:"email",value:r.default_sender_email||"",onChange:x=>v("default_sender_email",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"noreply@vakioboky.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom expditeur par dfaut"}),s.jsx("input",{type:"text",value:r.default_sender_name||"",onChange:x=>v("default_sender_name",x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Vakio Boky"})]})]})]})]})]})})]})]})})}function L7(){const[r,e]=R.useState([]),[t,n]=R.useState(null),[i,a]=R.useState(!0),[o,l]=R.useState(!1),[u,h]=R.useState(null),[c,f]=R.useState(null),[m,g]=R.useState(!1),[v,y]=R.useState("");R.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const E=localStorage.getItem("vakio_token"),A=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/email/templates",{headers:{Authorization:`Bearer ${E}`}})).json();A.success?(e(A.templates||[]),!t&&A.templates?.length>0&&n(A.templates[0])):h(A.error||"Erreur lors du chargement")}catch(E){h("Erreur lors du chargement des templates"),console.error(" Erreur chargement templates:",E)}finally{a(!1)}},b=async()=>{if(t)try{l(!0),h(null),f(null);const E=localStorage.getItem("vakio_token"),A=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/settings/email/templates/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({name:t.name,category:t.category,description:t.description,subject:t.subject,html_content:t.html_content,text_content:t.text_content||""})})).json();A.success?(f("Template sauvegard avec succs"),await x(),setTimeout(()=>f(null),3e3)):h(A.error||"Erreur lors de la sauvegarde")}catch(E){h("Erreur lors de la sauvegarde"),console.error(" Erreur sauvegarde template:",E)}finally{l(!1)}},w=async()=>{if(!(!t||!v))try{const E=localStorage.getItem("vakio_token"),A=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/email/test",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({templateId:t.id,email:v})})).json();A.success?(f("Email de test envoy avec succs"),setTimeout(()=>f(null),3e3)):h(A.error||"Erreur lors de l'envoi du test")}catch(E){h("Erreur lors de l'envoi du test"),console.error(" Erreur envoi test:",E)}},k=(E,S)=>{n(A=>({...A,[E]:S}))},N=[{variable:"{{user_name}}",description:"Nom de l'utilisateur"},{variable:"{{user_email}}",description:"Email de l'utilisateur"},{variable:"{{platform_name}}",description:"Nom de la plateforme"},{variable:"{{current_year}}",description:"Anne en cours"},{variable:"{{login_link}}",description:"Lien de connexion"},{variable:"{{reset_link}}",description:"Lien de rinitialisation"},{variable:"{{verification_link}}",description:"Lien de vrification"}];return i?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des templates email..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx($r,{className:"text-green-600"}),"Templates Email & Notifications"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Grez les templates d'emails et de notifications de votre plateforme"})]}),c&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5"}),c]}),u&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(ps,{className:"w-5 h-5"}),u]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Templates"}),s.jsx("button",{onClick:x,className:"p-1 text-gray-400 hover:text-gray-600",children:s.jsx(Wr,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"space-y-2",children:r.map(E=>s.jsxs("button",{onClick:()=>n(E),className:`w-full text-left p-3 rounded-lg transition-colors ${t?.id===E.id?"bg-blue-100 text-blue-700 border border-blue-200":"hover:bg-gray-100 text-gray-700"}`,children:[s.jsx("div",{className:"font-medium text-sm",children:E.name}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:E.category})]},E.id))})]})}),s.jsx("div",{className:"lg:col-span-3",children:t?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t.name}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>g(!m),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[m?s.jsx(QD,{className:"w-4 h-4"}):s.jsx(Ss,{className:"w-4 h-4"}),m?"diter":"Prvisualiser"]}),s.jsxs("button",{onClick:b,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[o?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(Er,{className:"w-4 h-4"}),"Sauvegarder"]})]})]})}),s.jsx("div",{className:"p-6",children:m?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aperu de l'email"}),s.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:s.jsxs("div",{className:"bg-white border rounded p-4 shadow-sm",children:[s.jsx("h3",{className:"font-bold text-lg mb-4",children:t.subject}),s.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:t.html_content}})]})})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"Envoyer un email de test"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("input",{type:"email",value:v,onChange:E=>y(E.target.value),placeholder:"votre.email@test.com",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsxs("button",{onClick:w,disabled:!v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[s.jsx(i0,{className:"w-4 h-4"}),"Tester"]})]})]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du template"}),s.jsx("input",{type:"text",value:t.name,onChange:E=>k("name",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catgorie"}),s.jsxs("select",{value:t.category,onChange:E=>k("category",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"auth",children:"Authentification"}),s.jsx("option",{value:"notifications",children:"Notifications"}),s.jsx("option",{value:"marketing",children:"Marketing"}),s.jsx("option",{value:"system",children:"Systme"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("input",{type:"text",value:t.description,onChange:E=>k("description",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sujet de l'email"}),s.jsx("input",{type:"text",value:t.subject,onChange:E=>k("subject",E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenu HTML"}),s.jsx("textarea",{value:t.html_content,onChange:E=>k("html_content",E.target.value),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"<html>...</html>"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contenu texte brut (optionnel)"}),s.jsx("textarea",{value:t.text_content||"",onChange:E=>k("text_content",E.target.value),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"Version texte de l'email..."})]})]})})]}):s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[s.jsx($r,{className:"text-4xl text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Slectionnez un template pour commencer l'dition"})]})})]}),t&&!m&&s.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow-sm p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(uP,{className:"text-blue-600"}),"Variables disponibles"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(E=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("code",{className:"text-sm font-mono text-blue-600 bg-blue-100 px-2 py-1 rounded",children:E.variable}),s.jsx("span",{className:"text-sm text-gray-600",children:E.description})]},E.variable))}),s.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(ps,{className:"text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Conseil"}),s.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Cliquez sur une variable pour l'insrer dans votre contenu. Les variables seront automatiquement remplaces lors de l'envoi."})]})]})})]})]})})}function I7(){const[r,e]=R.useState({}),[t,n]=R.useState(!0),[i,a]=R.useState(!1),[o,l]=R.useState(null),[u,h]=R.useState(null),[c,f]=R.useState("database"),[m,g]=R.useState({});R.useEffect(()=>{v()},[]);const v=async()=>{try{n(!0);const k=localStorage.getItem("vakio_token"),E=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/system",{headers:{Authorization:`Bearer ${k}`}})).json();E.success?e(E.config||{}):l(E.error||"Erreur lors du chargement")}catch(k){l("Erreur lors du chargement de la configuration"),console.error(" Erreur chargement config:",k)}finally{n(!1)}},y=async()=>{try{a(!0),l(null),h(null);const k=localStorage.getItem("vakio_token"),E=await(await fetch("https://vakio-boky-backend.onrender.com/api/admin/settings/system",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify({config:r})})).json();E.success?(h("Configuration sauvegarde avec succs"),setTimeout(()=>h(null),3e3)):l(E.error||"Erreur lors de la sauvegarde")}catch(k){l("Erreur lors de la sauvegarde"),console.error(" Erreur sauvegarde config:",k)}finally{a(!1)}},x=async k=>{try{const N=localStorage.getItem("vakio_token"),S=await(await fetch(`https://vakio-boky-backend.onrender.com/api/admin/settings/system/test/${k}`,{headers:{Authorization:`Bearer ${N}`}})).json();g(A=>({...A,[k]:S.success})),S.success?(h(`Connexion ${k} russie`),setTimeout(()=>h(null),3e3)):l(`chec de connexion ${k}: ${S.error}`)}catch(N){g(E=>({...E,[k]:!1})),l(`Erreur lors du test ${k}`),console.error(` Erreur test ${k}:`,N)}},b=(k,N,E)=>{e(S=>({...S,[k]:{...S[k],[N]:E}}))},w=[{id:"database",label:"Base de donnes",icon:s.jsx(Wg,{className:"w-5 h-5"})},{id:"payment",label:"Paiement",icon:s.jsx(Pn,{className:"w-5 h-5"})},{id:"storage",label:"Stockage",icon:s.jsx(Fj,{className:"w-5 h-5"})},{id:"email",label:"Email",icon:s.jsx(Uj,{className:"w-5 h-5"})},{id:"external",label:"Services externes",icon:s.jsx(zj,{className:"w-5 h-5"})}];return t?s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement de la configuration systme..."})]})})}):s.jsx("div",{className:"min-h-screen bg-gray-50 pt-20",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[s.jsx(ji,{className:"text-purple-600"}),"Configuration Systme"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Configurez les services externes et paramtres systme de votre plateforme"})]}),u&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(Ct,{className:"w-5 h-5"}),u]}),o&&s.jsxs(W.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[s.jsx(ps,{className:"w-5 h-5"}),o]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Services"}),s.jsx("nav",{className:"space-y-2",children:w.map(k=>s.jsxs("button",{onClick:()=>f(k.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${c===k.id?"bg-purple-100 text-purple-700":"text-gray-600 hover:bg-gray-100"}`,children:[k.icon,s.jsx("span",{className:"text-sm font-medium",children:k.label})]},k.id))})]})}),s.jsx("div",{className:"lg:col-span-3",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:w.find(k=>k.id===c)?.label}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:v,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[s.jsx(Wr,{className:"w-4 h-4"}),"Actualiser"]}),s.jsxs("button",{onClick:y,disabled:i,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[i?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(Er,{className:"w-4 h-4"}),"Sauvegarder"]})]})]})}),s.jsxs("div",{className:"p-6",children:[c==="database"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wg,{className:"text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-blue-900",children:"Configuration PostgreSQL"}),s.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Paramtres de connexion  la base de donnes principale"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hte"}),s.jsx("input",{type:"text",value:r.database?.host||"",onChange:k=>b("database","host",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"localhost"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Port"}),s.jsx("input",{type:"number",value:r.database?.port||5432,onChange:k=>b("database","port",parseInt(k.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom de la base"}),s.jsx("input",{type:"text",value:r.database?.database||"",onChange:k=>b("database","database",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"vakio_boky"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schma"}),s.jsx("input",{type:"text",value:r.database?.schema||"public",onChange:k=>b("database","schema",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Utilisateur"}),s.jsx("input",{type:"text",value:r.database?.username||"",onChange:k=>b("database","username",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),s.jsx("input",{type:"password",value:r.database?.password||"",onChange:k=>b("database","password",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>x("database"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[s.jsx(Er,{className:"w-4 h-4"}),"Tester la connexion"]}),m.database!==void 0&&s.jsxs("div",{className:`flex items-center gap-2 ${m.database?"text-green-600":"text-red-600"}`,children:[m.database?s.jsx(Ct,{className:"w-5 h-5"}):s.jsx(Hr,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:m.database?"Connexion russie":"chec de connexion"})]})]})]}),c==="payment"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Pn,{className:"text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-green-900",children:"Configuration des paiements"}),s.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Paramtres pour les passerelles de paiement"})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Passerelle de paiement principale"}),s.jsxs("select",{value:r.payment?.provider||"stripe",onChange:k=>b("payment","provider",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"stripe",children:"Stripe"}),s.jsx("option",{value:"paypal",children:"PayPal"}),s.jsx("option",{value:"flutterwave",children:"Flutterwave"}),s.jsx("option",{value:"orange_money",children:"Orange Money"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cl publique API"}),s.jsx("input",{type:"password",value:r.payment?.public_key||"",onChange:k=>b("payment","public_key",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"pk_live_..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cl secrte API"}),s.jsx("input",{type:"password",value:r.payment?.secret_key||"",onChange:k=>b("payment","secret_key",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"sk_live_..."})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Devise par dfaut"}),s.jsxs("select",{value:r.payment?.currency||"MGA",onChange:k=>b("payment","currency",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"MGA",children:"Ariary malgache (MGA)"}),s.jsx("option",{value:"EUR",children:"Euro (EUR)"}),s.jsx("option",{value:"USD",children:"Dollar amricain (USD)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mode de paiement"}),s.jsxs("select",{value:r.payment?.mode||"live",onChange:k=>b("payment","mode",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"live",children:"Production"}),s.jsx("option",{value:"test",children:"Test"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>x("payment"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[s.jsx(Er,{className:"w-4 h-4"}),"Tester l'API"]}),m.payment!==void 0&&s.jsxs("div",{className:`flex items-center gap-2 ${m.payment?"text-green-600":"text-red-600"}`,children:[m.payment?s.jsx(Ct,{className:"w-5 h-5"}):s.jsx(Hr,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:m.payment?"API fonctionnelle":"Erreur API"})]})]})]}),c==="storage"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Fj,{className:"text-indigo-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-indigo-900",children:"Configuration du stockage"}),s.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:"Paramtres pour le stockage des fichiers et mdias"})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service de stockage"}),s.jsxs("select",{value:r.storage?.provider||"local",onChange:k=>b("storage","provider",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"local",children:"Stockage local"}),s.jsx("option",{value:"aws_s3",children:"Amazon S3"}),s.jsx("option",{value:"cloudinary",children:"Cloudinary"}),s.jsx("option",{value:"azure",children:"Azure Blob Storage"})]})]}),r.storage?.provider==="aws_s3"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Key ID"}),s.jsx("input",{type:"password",value:r.storage?.aws_access_key||"",onChange:k=>b("storage","aws_access_key",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secret Access Key"}),s.jsx("input",{type:"password",value:r.storage?.aws_secret_key||"",onChange:k=>b("storage","aws_secret_key",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rgion AWS"}),s.jsx("input",{type:"text",value:r.storage?.aws_region||"eu-west-1",onChange:k=>b("storage","aws_region",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du bucket"}),s.jsx("input",{type:"text",value:r.storage?.aws_bucket||"",onChange:k=>b("storage","aws_bucket",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taille max des fichiers (MB)"}),s.jsx("input",{type:"number",value:r.storage?.max_file_size||10,onChange:k=>b("storage","max_file_size",parseInt(k.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",min:"1",max:"100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rpertoire de stockage local"}),s.jsx("input",{type:"text",value:r.storage?.local_path||"./uploads",onChange:k=>b("storage","local_path",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>x("storage"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-2",children:[s.jsx(Er,{className:"w-4 h-4"}),"Tester le stockage"]}),m.storage!==void 0&&s.jsxs("div",{className:`flex items-center gap-2 ${m.storage?"text-green-600":"text-red-600"}`,children:[m.storage?s.jsx(Ct,{className:"w-5 h-5"}):s.jsx(Hr,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:m.storage?"Stockage oprationnel":"Erreur de stockage"})]})]})]}),c==="email"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Uj,{className:"text-orange-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-orange-900",children:"Configuration SMTP"}),s.jsx("p",{className:"text-sm text-orange-700 mt-1",children:"Paramtres pour l'envoi d'emails transactionnels"})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service de messagerie"}),s.jsxs("select",{value:r.email?.provider||"smtp",onChange:k=>b("email","provider",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"smtp",children:"SMTP personnalis"}),s.jsx("option",{value:"sendgrid",children:"SendGrid"}),s.jsx("option",{value:"mailgun",children:"Mailgun"}),s.jsx("option",{value:"ses",children:"Amazon SES"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Serveur SMTP"}),s.jsx("input",{type:"text",value:r.email?.smtp_host||"",onChange:k=>b("email","smtp_host",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"smtp.gmail.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Port SMTP"}),s.jsx("input",{type:"number",value:r.email?.smtp_port||587,onChange:k=>b("email","smtp_port",parseInt(k.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom d'utilisateur"}),s.jsx("input",{type:"text",value:r.email?.smtp_username||"",onChange:k=>b("email","smtp_username",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),s.jsx("input",{type:"password",value:r.email?.smtp_password||"",onChange:k=>b("email","smtp_password",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email expditeur"}),s.jsx("input",{type:"email",value:r.email?.from_email||"",onChange:k=>b("email","from_email",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"noreply@vakioboky.com"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom expditeur"}),s.jsx("input",{type:"text",value:r.email?.from_name||"",onChange:k=>b("email","from_name",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Vakio Boky"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>x("email"),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2",children:[s.jsx(Er,{className:"w-4 h-4"}),"Tester SMTP"]}),m.email!==void 0&&s.jsxs("div",{className:`flex items-center gap-2 ${m.email?"text-green-600":"text-red-600"}`,children:[m.email?s.jsx(Ct,{className:"w-5 h-5"}):s.jsx(Hr,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:m.email?"SMTP oprationnel":"Erreur SMTP"})]})]})]}),c==="external"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(zj,{className:"text-teal-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-teal-900",children:"Services externes"}),s.jsx("p",{className:"text-sm text-teal-700 mt-1",children:"Intgrations avec des services tiers"})]})]})}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Google Analytics"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking ID"}),s.jsx("input",{type:"text",value:r.external?.google_analytics_id||"",onChange:k=>b("external","google_analytics_id",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"GA_MEASUREMENT_ID"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"ga_enabled",checked:r.external?.google_analytics_enabled!==!1,onChange:k=>b("external","google_analytics_enabled",k.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),s.jsx("label",{htmlFor:"ga_enabled",className:"ml-2 text-sm text-gray-700",children:"Activer Google Analytics"})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Rseaux sociaux"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Facebook App ID"}),s.jsx("input",{type:"text",value:r.external?.facebook_app_id||"",onChange:k=>b("external","facebook_app_id",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Twitter API Key"}),s.jsx("input",{type:"password",value:r.external?.twitter_api_key||"",onChange:k=>b("external","twitter_api_key",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"CDN & Cache"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cloudflare Zone ID"}),s.jsx("input",{type:"text",value:r.external?.cloudflare_zone_id||"",onChange:k=>b("external","cloudflare_zone_id",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Token"}),s.jsx("input",{type:"password",value:r.external?.cloudflare_api_token||"",onChange:k=>b("external","cloudflare_api_token",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]}),s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Monitoring & Alertes"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sentry DSN"}),s.jsx("input",{type:"password",value:r.external?.sentry_dsn||"",onChange:k=>b("external","sentry_dsn",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"sentry_enabled",checked:r.external?.sentry_enabled!==!1,onChange:k=>b("external","sentry_enabled",k.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),s.jsx("label",{htmlFor:"sentry_enabled",className:"ml-2 text-sm text-gray-700",children:"Activer Sentry"})]})]})]})]})]})]})})]})]})})}function B7(){return s.jsx(o7,{children:s.jsx(c7,{children:s.jsxs(Wk,{children:[s.jsx(Ye,{path:"/",element:s.jsx(d7,{})}),s.jsx(Ye,{path:"/marketplace",element:s.jsx(x7,{})}),s.jsx(Ye,{path:"/marketplace/categories",element:s.jsx(y7,{})}),s.jsx(Ye,{path:"/marketplace/analytics",element:s.jsx(v7,{})}),s.jsx(Ye,{path:"/orders",element:s.jsx(b7,{})}),s.jsx(Ye,{path:"/orders/disputes",element:s.jsx(j7,{})}),s.jsx(Ye,{path:"/campaigns",element:s.jsx(rk,{})}),s.jsx(Ye,{path:"/campaigns/moderation",element:s.jsx(rk,{})}),s.jsx(Ye,{path:"/campaigns/analytics",element:s.jsx(k7,{})}),s.jsx(Ye,{path:"/campaigns/featured",element:s.jsx(E7,{})}),s.jsx(Ye,{path:"/events",element:s.jsx(nk,{})}),s.jsx(Ye,{path:"/events/moderation",element:s.jsx(nk,{})}),s.jsx(Ye,{path:"/events/analytics",element:s.jsx(A7,{})}),s.jsx(Ye,{path:"/events/templates",element:s.jsx(C7,{})}),s.jsx(Ye,{path:"/users",element:s.jsx(tk,{})}),s.jsx(Ye,{path:"/users/dashboard",element:s.jsx(tk,{})}),s.jsx(Ye,{path:"/users/roles",element:s.jsx(u7,{})}),s.jsx(Ye,{path:"/users/analytics",element:s.jsx(h7,{})}),s.jsx(Ye,{path:"/books",element:s.jsx(sk,{})}),s.jsx(Ye,{path:"/books/moderation",element:s.jsx(sk,{})}),s.jsx(Ye,{path:"/books/catalog",element:s.jsx(f7,{})}),s.jsx(Ye,{path:"/books/analytics",element:s.jsx(m7,{})}),s.jsx(Ye,{path:"/challenges",element:s.jsx(ik,{})}),s.jsx(Ye,{path:"/challenges/management",element:s.jsx(ik,{})}),s.jsx(Ye,{path:"/challenges/analytics",element:s.jsx(T7,{})}),s.jsx(Ye,{path:"/challenges/badges",element:s.jsx(R7,{})}),s.jsx(Ye,{path:"/analytics",element:s.jsx(ak,{})}),s.jsx(Ye,{path:"/analytics/overview",element:s.jsx(ak,{})}),s.jsx(Ye,{path:"/analytics/users",element:s.jsx(D7,{})}),s.jsx(Ye,{path:"/analytics/content",element:s.jsx(P7,{})}),s.jsx(Ye,{path:"/moderation",element:s.jsx(ok,{})}),s.jsx(Ye,{path:"/moderation/queue",element:s.jsx(ok,{})}),s.jsx(Ye,{path:"/moderation/reports",element:s.jsx(M7,{})}),s.jsx(Ye,{path:"/moderation/actions",element:s.jsx(O7,{})}),s.jsx(Ye,{path:"/settings",element:s.jsx(lk,{})}),s.jsx(Ye,{path:"/settings/platform",element:s.jsx(lk,{})}),s.jsx(Ye,{path:"/settings/email",element:s.jsx(L7,{})}),s.jsx(Ye,{path:"/settings/system",element:s.jsx(I7,{})}),s.jsx(Ye,{path:"*",element:s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Page non trouve"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"La page d'administration que vous recherchez n'existe pas."}),s.jsx("a",{href:"/admin",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retour au tableau de bord"})]})})]})})})}const Is=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Lx=[.001,0,0,.001,0,0],Pg=1.35,cr={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ui={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ql="pdfjs_internal_editor_",Ke={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},F7={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ix={TRIANGLES:1,LATTICE:2},js={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},hu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ts={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},$a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},jh={ERRORS:0,WARNINGS:1,INFOS:5},Jl={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},xl={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},z7={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let wh=jh.WARNINGS;function U7(r){Number.isInteger(r)&&(wh=r)}function H7(){return wh}function Nh(r){wh>=jh.INFOS&&console.info(`Info: ${r}`)}function $e(r){wh>=jh.WARNINGS&&console.warn(`Warning: ${r}`)}function vt(r){throw new Error(r)}function it(r,e){r||vt(e)}function V7(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ZA(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=Y7(r)}catch{}const n=e?URL.parse(r,e):URL.parse(r);return V7(n)?n:null}function eC(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&ZA(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Xe(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const xa=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class ck extends xa{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Mg extends xa{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Bx extends xa{constructor(e){super(e,"InvalidPDFException")}}class Hu extends xa{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class q7 extends xa{constructor(e){super(e,"FormatError")}}class Si extends xa{constructor(e){super(e,"AbortException")}}function tC(r){(typeof r!="object"||r?.length===void 0)&&vt("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let i=0;i<e;i+=t){const a=Math.min(i+t,e),o=r.subarray(i,a);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function dc(r){typeof r!="string"&&vt("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function $7(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function W7(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function G7(){try{return new Function(""),!0}catch{return!1}}class Es{static get isLittleEndian(){return Xe(this,"isLittleEndian",W7())}static get isEvalSupported(){return Xe(this,"isEvalSupported",G7())}static get isOffscreenCanvasSupported(){return Xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Xe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Xe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Xe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Xe(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Xe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Og=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class Ae{static makeHexColor(e,t,n){return`#${Og[e]}${Og[t]}${Og[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const i=e[n],a=e[n+1];e[n]=i*t[0]+a*t[2]+t[4],e[n+1]=i*t[1]+a*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],a=t[1],o=t[2],l=t[3],u=t[4],h=t[5];for(let c=0;c<6;c+=2){const f=e[n+c],m=e[n+c+1];e[n+c]=f*i+m*o+u,e[n+c+1]=f*a+m*l+h}}static applyInverseTransform(e,t){const n=e[0],i=e[1],a=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/a,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/a}static axialAlignedBoundingBox(e,t,n){const i=t[0],a=t[1],o=t[2],l=t[3],u=t[4],h=t[5],c=e[0],f=e[1],m=e[2],g=e[3];let v=i*c+u,y=v,x=i*m+u,b=x,w=l*f+h,k=w,N=l*g+h,E=N;if(a!==0||o!==0){const S=a*c,A=a*m,C=o*f,I=o*g;v+=C,b+=C,x+=I,y+=I,w+=S,E+=S,N+=A,k+=A}n[0]=Math.min(n[0],v,x,y,b),n[1]=Math.min(n[1],w,N,k,E),n[2]=Math.max(n[2],v,x,y,b),n[3]=Math.max(n[3],w,N,k,E)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],a=e[2],o=e[3],l=n**2+i**2,u=n*a+i*o,h=a**2+o**2,c=(l+h)/2,f=Math.sqrt(c**2-(l*h-u**2));t[0]=Math.sqrt(c+f||1),t[1]=Math.sqrt(c-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>o?null:[n,a,i,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,a){a[0]=Math.min(a[0],e,n),a[1]=Math.min(a[1],t,i),a[2]=Math.max(a[2],e,n),a[3]=Math.max(a[3],t,i)}static#e(e,t,n,i,a,o,l,u,h,c){if(h<=0||h>=1)return;const f=1-h,m=h*h,g=m*h,v=f*(f*(f*e+3*h*t)+3*m*n)+g*i,y=f*(f*(f*a+3*h*o)+3*m*l)+g*u;c[0]=Math.min(c[0],v),c[1]=Math.min(c[1],y),c[2]=Math.max(c[2],v),c[3]=Math.max(c[3],y)}static#t(e,t,n,i,a,o,l,u,h,c,f,m){if(Math.abs(h)<1e-12){Math.abs(c)>=1e-12&&this.#e(e,t,n,i,a,o,l,u,-f/c,m);return}const g=c**2-4*f*h;if(g<0)return;const v=Math.sqrt(g),y=2*h;this.#e(e,t,n,i,a,o,l,u,(-c+v)/y,m),this.#e(e,t,n,i,a,o,l,u,(-c-v)/y,m)}static bezierBoundingBox(e,t,n,i,a,o,l,u,h){h[0]=Math.min(h[0],e,l),h[1]=Math.min(h[1],t,u),h[2]=Math.max(h[2],e,l),h[3]=Math.max(h[3],t,u),this.#t(e,n,a,l,t,i,o,u,3*(-e+3*(n-a)+l),6*(e-2*n+a),3*(n-e),h),this.#t(e,n,a,l,t,i,o,u,3*(-t+3*(i-o)+u),6*(t-2*i+o),3*(i-t),h)}}function Y7(r){return decodeURIComponent(escape(r))}let Lg=null,dk=null;function K7(r){return Lg||(Lg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,dk=new Map([["","t"]])),r.replaceAll(Lg,(e,t,n)=>t?t.normalize("NFKC"):dk.get(n))}function sC(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),tC(r)}const so="pdfjs_internal_id_";function X7(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,i,...a]=t;if(!r(n)&&!Number.isInteger(n)||!e(i))return!1;const o=a.length;let l=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;l=!1;break;default:return!1}for(const u of a)if(!(typeof u=="number"||l&&u===null))return!1;return!0}function Bs(r,e,t){return Math.min(Math.max(r,e),t)}function rC(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(tC(r))}function Q7(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):dc(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});class Zl{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(a){if(!a)return;let o=null;const l=a.name;if(l==="#text")o=a.value;else if(Zl.shouldBuildText(l))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&t.push({str:o}),!!a.children)for(const u of a.children)i(u)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class nC{static setupStorage(e,t,n,i,a){const o=i.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),a==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",l=>{i.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),a==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const l of n.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const u=l.target.options,h=u.selectedIndex===-1?"":u[u.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:a}){const{attributes:o}=t,l=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[u,h]of Object.entries(o))if(h!=null)switch(u){case"class":h.length&&e.setAttribute(u,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!l||u!=="href"&&u!=="newWindow")&&e.setAttribute(u,h)}l&&a.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,a=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:a,linkService:n});const l=a!=="richText",u=e.div;if(u.append(o),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;u.style.transform=f}l&&u.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const f=document.createTextNode(i.value);o.append(f),l&&Zl.shouldBuildText(i.name)&&h.push(f)}return{textDivs:h}}const c=[[i,-1,o]];for(;c.length>0;){const[f,m,g]=c.at(-1);if(m+1===f.children.length){c.pop();continue}const v=f.children[++c.at(-1)[1]];if(v===null)continue;const{name:y}=v;if(y==="#text"){const b=document.createTextNode(v.value);h.push(b),g.append(b);continue}const x=v?.attributes?.xmlns?document.createElementNS(v.attributes.xmlns,y):document.createElement(y);if(g.append(x),v.attributes&&this.setAttributes({html:x,element:v,storage:t,intent:a,linkService:n}),v.children?.length>0)c.push([v,-1,x]);else if(v.value){const b=document.createTextNode(v.value);l&&Zl.shouldBuildText(y)&&h.push(b),x.append(b)}}for(const f of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const _n="http://www.w3.org/2000/svg";class jo{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function uc(r,e="text"){if(El(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class hc{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:a=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=o,n*=t;const u=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let c,f,m,g;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,f=0,m=0,g=1;break;case 90:c=0,f=1,m=1,g=0;break;case 270:c=0,f=-1,m=-1,g=0;break;case 0:c=1,f=0,m=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,g=-g);let v,y,x,b;c===0?(v=Math.abs(h-e[1])*n+a,y=Math.abs(u-e[0])*n+o,x=(e[3]-e[1])*n,b=(e[2]-e[0])*n):(v=Math.abs(u-e[0])*n+a,y=Math.abs(h-e[1])*n+o,x=(e[2]-e[0])*n,b=(e[3]-e[1])*n),this.transform=[c*n,f*n,m*n,g*n,v-c*n*u-m*n*h,y-f*n*u-g*n*h],this.width=x,this.height=b}get rawDims(){const e=this.viewBox;return Xe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new hc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){const n=[e,t];return Ae.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Ae.applyTransform(t,this.transform);const n=[e[2],e[3]];return Ae.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Ae.applyInverseTransform(n,this.transform),n}}class ky extends xa{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function kh(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Ey(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function J7(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function Z7(r,e="document.pdf"){if(typeof r!="string")return e;if(kh(r))return $e('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const i=l=>{try{let u=decodeURIComponent(l);return u.includes("/")?(u=u.split("/").at(-1),u.test(/^\.pdf$/i)?u:l):u}catch{return l}},a=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(a.test(o))return i(o);if(n.searchParams.size>0){const l=Array.from(n.searchParams.values()).reverse();for(const h of l)if(a.test(h))return i(h);const u=Array.from(n.searchParams.keys()).reverse();for(const h of u)if(a.test(h))return i(h)}if(n.hash){const u=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(u)return i(u[0])}return e}class uk{started=Object.create(null);times=[];time(e){e in this.started&&$e(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||$e(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-i}ms
`);return e.join("")}}function El(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function Cr(r){r.preventDefault()}function qt(r){r.preventDefault(),r.stopPropagation()}function eU(r){console.log("Deprecated API usage: "+r)}class Fx{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let u=parseInt(t[6],10);u=u>=0&&u<=59?u:0;const h=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,h==="-"?(o+=c,l+=f):h==="+"&&(o-=c,l-=f),new Date(Date.UTC(n,i,a,o,l,u))}}function tU(r,{scale:e=1,rotation:t=0}){const{width:n,height:i}=r.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new hc({viewBox:a,userUnit:1,scale:e,rotation:t})}function fc(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):($e(`Not a valid color format: "${r}"`),[0,0,0])}function sU(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,fc(n))}e.remove()}function It(r){const{a:e,b:t,c:n,d:i,e:a,f:o}=r.getTransform();return[e,t,n,i,a,o]}function sn(r){const{a:e,b:t,c:n,d:i,e:a,f:o}=r.getTransform().invertSelf();return[e,t,n,i,a,o]}function ha(r,e,t=!1,n=!0){if(e instanceof hc){const{pageWidth:i,pageHeight:a}=e.rawDims,{style:o}=r,l=Es.isCSSRoundSupported,u=`var(--total-scale-factor) * ${i}px`,h=`var(--total-scale-factor) * ${a}px`,c=l?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,f=l?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(o.width=c,o.height=f):(o.width=f,o.height=c)}n&&r.setAttribute("data-main-rotation",e.rotation)}class gn{constructor(){const{pixelRatio:e}=gn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,a=-1){let o=1/0,l=1/0,u=1/0;n=gn.capPixels(n,a),n>0&&(o=Math.sqrt(n/(e*t))),i!==-1&&(l=i/e,u=i/t);const h=Math.min(o,l,u);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const zx=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class rU{static get isDarkMode(){return Xe(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class nU{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Xe(this,"commentForegroundColor",fc(n))}}function iU(r,e,t,n){n=Math.min(Math.max(n??1,0),1);const i=255*(1-n);return r=Math.round(r*n+i),e=Math.round(e*n+i),t=Math.round(t*n+i),[r,e,t]}function hk(r,e){const t=r[0]/255,n=r[1]/255,i=r[2]/255,a=Math.max(t,n,i),o=Math.min(t,n,i),l=(a+o)/2;if(a===o)e[0]=e[1]=0;else{const u=a-o;switch(e[1]=l<.5?u/(a+o):u/(2-a-o),a){case t:e[0]=((n-i)/u+(n<i?6:0))*60;break;case n:e[0]=((i-t)/u+2)*60;break;case i:e[0]=((t-n)/u+4)*60;break}}e[2]=l}function Ux(r,e){const t=r[0],n=r[1],i=r[2],a=(1-Math.abs(2*i-1))*n,o=a*(1-Math.abs(t/60%2-1)),l=i-a/2;switch(Math.floor(t/60)){case 0:e[0]=a+l,e[1]=o+l,e[2]=l;break;case 1:e[0]=o+l,e[1]=a+l,e[2]=l;break;case 2:e[0]=l,e[1]=a+l,e[2]=o+l;break;case 3:e[0]=l,e[1]=o+l,e[2]=a+l;break;case 4:e[0]=o+l,e[1]=l,e[2]=a+l;break;case 5:case 6:e[0]=a+l,e[1]=l,e[2]=o+l;break}}function fk(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function mk(r,e,t){Ux(r,t),t.map(fk);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];Ux(e,t),t.map(fk);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}const pk=new Map;function aU(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=pk.get(t);if(n)return n;const i=new Float32Array(9),a=i.subarray(0,3),o=i.subarray(3,6);hk(r,o);const l=i.subarray(6,9);hk(e,l);const u=l[2]<.5,h=u?12:4.5;if(o[2]=u?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),mk(o,l,a)<h){let c,f;u?(c=o[2],f=1):(c=0,f=o[2]);const m=.005;for(;f-c>m;){const g=o[2]=(c+f)/2;u===mk(o,l,a)<h?c=g:f=g}o[2]=u?f:c}return Ux(o,a),n=Ae.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),pk.set(t,n),n}function iC({html:r,dir:e,className:t},n){const i=document.createDocumentFragment();if(typeof r=="string"){const a=document.createElement("p");a.dir=e||"auto";const o=r.split(/(?:\r\n?|\n)/);for(let l=0,u=o.length;l<u;++l){const h=o[l];a.append(document.createTextNode(h)),l<u-1&&a.append(document.createElement("br"))}i.append(a)}else nC.render({xfaHtml:r,div:i,intent:"richText"});i.firstChild.classList.add("richText",t),n.append(i)}function aC(r){const e=new Path2D;if(!r)return e;for(let t=0,n=r.length;t<n;)switch(r[t++]){case xl.moveTo:e.moveTo(r[t++],r[t++]);break;case xl.lineTo:e.lineTo(r[t++],r[t++]);break;case xl.curveTo:e.bezierCurveTo(r[t++],r[t++],r[t++],r[t++],r[t++],r[t++]);break;case xl.quadraticCurveTo:e.quadraticCurveTo(r[t++],r[t++],r[t++],r[t++]);break;case xl.closePath:e.closePath();break;default:$e(`Unrecognized drawing path operator: ${r[t-1]}`);break}return e}class Ll{#e=null;#t=null;#r;#s=null;#a=null;#i=null;#n=null;#o=null;static#c=null;constructor(e){this.#r=e,Ll.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#r._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Cr,{signal:t}),e.addEventListener("pointerdown",Ll.#l,{signal:t}));const n=this.#s=document.createElement("div");n.className="buttons",e.append(n);const i=this.#r.toolbarPosition;if(i){const{style:a}=e,o=this.#r._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#r._focusEventsAllowed=!1,qt(e)}#u(e){this.#r._focusEventsAllowed=!0,qt(e)}#f(e){const t=this.#r._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Cr,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#r,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Ll.#c[e]),this.#f(n)&&n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#s.append(n)}get#g(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#s.append(t,this.#g),this.#a=e}addComment(e,t=null){if(this.#i)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const i=this.#n=this.#g;t?(this.#s.insertBefore(n,t),this.#s.insertBefore(i,t)):this.#s.append(n,i),this.#i=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#s.append(t,this.#g)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#r);this.#f(t),this.#s.append(t,this.#g)}removeButton(e){switch(e){case"comment":this.#i?.removeToolbarCommentButton(),this.#i=null,this.#n?.remove(),this.#n=null;break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const i=this.#s.querySelector(n);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class oU{#e=null;#t=null;#r;constructor(e){this.#r=e}#s(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#r._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Cr,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#r.hasCommentManager()&&this.#i("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#r.commentSelection("floating_button")}),this.#i("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#r.highlightSelection("floating_button")}),e}#a(e,t){let n=0,i=0;for(const a of e){const o=a.y+a.height;if(o<n)continue;const l=a.x+(t?a.width:0);if(o>n){i=l,n=o;continue}t?l>i&&(i=l):l<i&&(i=l)}return[t?1-i:i,n]}show(e,t,n){const[i,a]=this.#a(t,n),{style:o}=this.#t||=this.#s();e.append(this.#t),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(e,t,n,i){const a=document.createElement("button");a.classList.add("basic",e),a.tabIndex=0,a.setAttribute("data-l10n-id",t);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",n);const l=this.#r._signal;l instanceof AbortSignal&&!l.aborted&&(a.addEventListener("contextmenu",Cr,{signal:l}),a.addEventListener("click",i,{signal:l})),this.#e.append(a)}}function oC(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}class ft{static#e=NaN;static#t=null;static#r=NaN;static#s=null;static initializeAndAddPointerId(e){(ft.#t||=new Set).add(e)}static setPointer(e,t){ft.#e||=t,ft.#s??=e}static setTimeStamp(e){ft.#r=e}static isSamePointerId(e){return ft.#e===e}static isSamePointerIdOrRemove(e){return ft.#e===e?!0:(ft.#t?.delete(e),!1)}static isSamePointerType(e){return ft.#s===e}static isInitializedAndDifferentPointerType(e){return ft.#s!==null&&!ft.isSamePointerType(e)}static isSameTimeStamp(e){return ft.#r===e}static isUsingMultiplePointers(){return ft.#t?.size>=1}static clearPointerType(){ft.#s=null}static clearPointerIds(){ft.#e=NaN,ft.#t=null}static clearTimeStamp(){ft.#r=NaN}}class lU{#e=0;get id(){return`${Ql}${this.#e++}`}}class Sy{#e=sC();#t=0;#r=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Xe(this,"_isSVGFittingCanvas",a)}async#s(e,t){this.#r||=new Map;let n=this.#r.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(n.url=t,i=await uc(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const a=Sy._isSVGFittingCanvas,o=new FileReader,l=new Image,u=new Promise((h,c)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,h()},o.onload=async()=>{const f=n.svgUrl=o.result;l.src=await a?`${f}#svgView(preserveAspectRatio(none))`:f},l.onerror=o.onerror=c});o.readAsDataURL(i),await u}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){$e(i),n=null}return this.#r.set(e,n),n&&this.#r.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:i,type:a}=e;return this.#s(`${t}_${n}_${i}_${a}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromBlob(e,t){const n=await t;return this.#s(e,n)}async getFromId(e){this.#r||=new Map;const t=this.#r.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#r||=new Map;let n=this.#r.get(e);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#r.set(e,n),this.#r.set(n.id,n),n}getSvgUrl(e){const t=this.#r.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#r||=new Map;const t=this.#r.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class cU{#e=[];#t=!1;#r;#s=-1;constructor(e=128){this.#r=e}add({cmd:e,undo:t,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&e(),this.#t)return;const u={cmd:e,undo:t,post:n,type:a};if(this.#s===-1){this.#e.length>0&&(this.#e.length=0),this.#s=0,this.#e.push(u);return}if(o&&this.#e[this.#s].type===a){l&&(u.undo=this.#e[this.#s].undo),this.#e[this.#s]=u;return}const h=this.#s+1;h===this.#r?this.#e.splice(0,1):(this.#s=h,h<this.#e.length&&this.#e.splice(h)),this.#e.push(u)}undo(){if(this.#s===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1,this.#s-=1}redo(){if(this.#s<this.#e.length-1){this.#s+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#s];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#e.length-1}cleanType(e){if(this.#s!==-1){for(let t=this.#s;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#s-t),this.#s=t;return}this.#e.length=0,this.#s=-1}}destroy(){this.#e=null}}class mc{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Es.platform;for(const[n,i,a={}]of e)for(const o of n){const l=o.startsWith("mac+");t&&l?(this.callbacks.set(o.slice(4),{callback:i,options:a}),this.allKeys.add(o.split("+").at(-1))):!t&&!l&&(this.callbacks.set(o,{callback:i,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:o=[],checker:l=null}}=n;l&&!l(e,t)||(i.bind(e,...o,t)(),a||qt(t))}}class _y{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return sU(e),Xe(this,"_colors",e)}convert(e){const t=fc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((a,o)=>a===t[o]))return _y._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Ae.makeHexColor(...t):e}}class _i{#e=new AbortController;#t=null;#r=null;#s=new Map;#a=new Map;#i=null;#n=null;#o=null;#c=new cU;#l=null;#h=null;#u=null;#f=0;#g=new Set;#p=null;#d=null;#m=new Set;_editorUndoBar=null;#x=!1;#v=!1;#y=!1;#E=null;#N=null;#j=null;#_=null;#b=!1;#k=null;#T=new lU;#A=!1;#C=!1;#I=!1;#D=null;#M=null;#B=null;#O=null;#q=null;#S=Ke.NONE;#w=new Set;#P=null;#F=null;#U=null;#G=null;#W=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#L=null;#$=null;#J=null;#Z=null;#z=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=_i.prototype,t=o=>o.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:u}=l;return u!=="text"&&u!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new mc([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#$.contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,n,i,a,o,l,u,h,c,f,m,g,v,y,x){const b=this._signal=this.#e.signal;this.#$=e,this.#J=t,this.#Z=n,this.#i=i,this.#l=a,this.#F=o,this.#W=u,this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:b}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),l._on("setpreference",this.onSetPreference.bind(this),{signal:b}),l._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:b}),window.addEventListener("pointerdown",()=>{this.#C=!0},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{this.#C=!1},{capture:!0,signal:b}),this.#ae(),this.#he(),this.#te(),this.#n=u.annotationStorage,this.#E=u.filterFactory,this.#U=h,this.#_=c||null,this.#x=f,this.#v=m,this.#y=g,this.#q=v||null,this.viewParameters={realScale:jo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=x!==!1,a?.setSidebarUiManager(this)}destroy(){this.#z?.resolve(),this.#z=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#s.clear(),this.#m.clear(),this.#O?.clear(),this.#t=null,this.#w.clear(),this.#c.destroy(),this.#i?.destroy(),this.#l?.destroy(),this.#F?.destroy(),this.#k?.hide(),this.#k=null,this.#B?.destroy(),this.#B=null,this.#r=null,this.#N&&(clearTimeout(this.#N),this.#N=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#W=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Xe(this,"hcmFilter",this.#U?this.#E.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return Xe(this,"direction",getComputedStyle(this.#$).direction)}get _highlightColors(){return Xe(this,"_highlightColors",this.#_?new Map(this.#_.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Xe(this,"highlightColors",null);const t=new Map,n=!!this.#U;for(const[i,a]of e){const o=i.endsWith("_HCM");if(n&&o){t.set(i.replace("_HCM",""),a);continue}!n&&!o&&t.set(i,a)}return Xe(this,"highlightColors",t)}get highlightColorNames(){return Xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,i){this.#l?.showDialog(this,e,t,n,i)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=a=>{a.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){this.#F?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#F}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#y=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#$.focus()}findParent(e,t){for(const n of this.#a.values()){const{x:i,y:a,width:o,height:l}=n.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=a&&t<=a+l)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#m.add(e)}removeShouldRescale(e){this.#m.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*jo.PDF_TO_CSS_UNITS;for(const t of this.#m)t.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#a.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:a,focusNode:o,focusOffset:l}=n,u=n.toString(),c=this.#Q(n).closest(".textLayer"),f=this.getSelectionBoxes(c);if(!f)return;n.empty();const m=this.#ee(c),g=this.#S===Ke.NONE,v=()=>{const y=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:i,anchorOffset:a,focusNode:o,focusOffset:l,text:u});g&&this.showAllEditors("highlight",!0,!0),t&&y?.editComment()};if(g){this.switchToMode(Ke.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}#ne(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Q(e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#k||=new oU(this),this.#k.show(n,i,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#n)return null;const t=`${Ql}${e}`,n=this.#n.getRawValue(t);return n&&this.#n.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#n&&!this.#n.has(e.id)&&this.#n.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#ie(){const e=document.getSelection();if(!e||e.isCollapsed){this.#P&&(this.#k?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#P)return;const i=this.#Q(e).closest(".textLayer");if(!i){this.#P&&(this.#k?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#P=t,this.#R({hasSelectedText:!0}),!(this.#S!==Ke.HIGHLIGHT&&this.#S!==Ke.NONE)&&(this.#S===Ke.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#S===Ke.HIGHLIGHT?this.#ee(i):null;if(a?.toggleDrawing(),this.#C){const o=new AbortController,l=this.combinedSignal(o),u=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),a?.toggleDrawing(!0),h.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}else a?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(e=""){this.#S===Ke.HIGHLIGHT?this.highlightSelection(e):this.#x&&this.#ne()}#ae(){document.addEventListener("selectionchange",this.#ie.bind(this),{signal:this._signal})}#oe(){if(this.#j)return;this.#j=new AbortController;const e=this.combinedSignal(this.#j);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#j?.abort(),this.#j=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#w)if(t.div.contains(e)){this.#M=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[e,t]=this.#M;this.#M=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#D)return;this.#D=new AbortController;const e=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#D?.abort(),this.#D=null}#de(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ue(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#w){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const o of this.#d)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){$e(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const u of n){const h=await i.deserialize(u);if(!h)return;a.push(h)}const o=()=>{for(const u of a)this.#se(u);this.#re(a)},l=()=>{for(const u of a)u.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(a){$e(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==Ke.NONE&&!this.isEditorHandlingKeyboard&&_i._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(e){Object.entries(e).some(([n,i])=>this.#Y[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,e)}),this.#S===Ke.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#V([[nt.HIGHLIGHT_FREE,!0]]))}#V(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#de(),this.#R({isEditing:this.#S!==Ke.NONE,isEmpty:this.#X(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#ue(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#d){this.#d=e;for(const t of this.#d)this.#V(t.defaultPropertiesToUpdate)}}getId(){return this.#T.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#a.set(e.pageIndex,e),this.#A?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1,a=!1){if(this.#S!==e&&!(this.#z&&(await this.#z.promise,!this.#z))){if(this.#z=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#S===Ke.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#S=e,e===Ke.NONE){this.setEditingState(!1),this.#me();for(const o of this.#s.values())o.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#z.resolve();return}for(const o of this.#s.values())o.addStandaloneCommentButton();e===Ke.SIGNATURE&&await this.#F?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const o of this.#a.values())o.updateMode(e);if(e===Ke.POPUP){this.#r||=await this.#W.getAnnotationsByType(new Set(this.#d.map(u=>u._editorType)));const o=new Set,l=[];for(const u of this.#s.values()){const{annotationElementId:h,hasComment:c,deleted:f}=u;h&&o.add(h),c&&!f&&l.push(u.getData())}for(const u of this.#r){const{id:h,popupRef:c,contentsObj:f}=u;c&&f?.str&&!o.has(h)&&!this.#g.has(h)&&l.push(u)}this.#l?.showSidebar(l)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#z.resolve();return}for(const o of this.#s.values())o.uid===t?(this.setSelected(o),a?o.editComment():i?o.enterInEditMode():o.focus()):o.unselect();this.#z.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#d){switch(e){case nt.CREATE:this.currentLayer.addNewEditor(t);return;case nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#w)n.updateParams(e,t);else for(const n of this.#d)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const a of this.#s.values())a.editorType===e&&a.show(t);(this.#G?.get(nt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#V([[nt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#I!==e){this.#I=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#A){this.#A=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#me(){if(this.unselectAll(),this.#A){this.#A=!1;for(const e of this.#a.values())e.disable();for(const e of this.#s.values())e.disable()}}*getEditors(e){for(const t of this.#s.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.focusMainContainer(),this.#N=null},0)),this.#s.delete(e.id),e.annotationElementId&&this.#O?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#g.has(e.annotationElementId))&&this.#n?.remove(e.id)}addDeletedAnnotationElement(e){this.#g.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#g.has(e)}removeDeletedAnnotationElement(e){this.#g.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#se(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#V(e.propertiesToUpdate))}get#pe(){let e=null;for(e of this.#w);return e}updateUI(e){this.#pe===e&&this.#V(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#V(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#w.has(e)){this.#w.delete(e),e.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#w.add(e),e.select(),this.#V(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#u?.commitOrRemove();for(const t of this.#w)t!==e&&t.unselect();this.#w.clear(),this.#w.add(e),e.select(),this.#V(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(e){return this.#w.has(e)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(e){e.unselect(),this.#w.delete(e),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#X()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#X()})}addCommands(e){this.#c.add(e),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#X()})}cleanUndoStack(e){this.#c.cleanType(e)}#X(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#w],n=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const a of t)this.#se(a)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#re(e){for(const t of this.#w)t.unselect();this.#w.clear();for(const t of e)t.isEmpty()||(this.#w.add(t),t.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#w)e.commit();this.#re(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#S!==Ke.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const e of this.#w)e.unselect();this.#w.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=e,this.#H[1]+=t;const[i,a]=this.#H,o=[...this.#w],l=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const u of o)this.#s.has(u.id)&&(u.translateInPage(i,a),u.translationDone())},undo:()=>{for(const u of o)this.#s.has(u.id)&&(u.translateInPage(-i,-a),u.translationDone())},mustExec:!1})},l);for(const u of o)u.translateInPage(e,t),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const e of this.#w)this.#p.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const e=this.#p;this.#p=null;let t=!1;for(const[{x:i,y:a,pageIndex:o},l]of e)l.newX=i,l.newY=a,l.newPageIndex=o,t||=i!==l.savedX||a!==l.savedY||o!==l.savedPageIndex;if(!t)return!1;const n=(i,a,o,l)=>{if(this.#s.has(i.id)){const u=this.#a.get(l);u?i._setParentAndPosition(u,a,o):(i.pageIndex=l,i.x=a,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:o,newPageIndex:l}]of e)n(i,a,o,l)},undo:()=>{for(const[i,{savedX:a,savedY:o,savedPageIndex:l}]of e)n(i,a,o,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#p)for(const n of this.#p.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#S}isEditingMode(){return this.#S!==Ke.NONE}get imageManager(){return Xe(this,"imageManager",new Sy)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,c=t.rangeCount;h<c;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:o}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(h,c,f,m)=>({x:(c-i)/o,y:1-(h+f-n)/a,width:m/o,height:f/a});break;case"180":l=(h,c,f,m)=>({x:1-(h+f-n)/a,y:1-(c+m-i)/o,width:f/a,height:m/o});break;case"270":l=(h,c,f,m)=>({x:1-(c+m-i)/o,y:(h-n)/a,width:m/o,height:f/a});break;default:l=(h,c,f,m)=>({x:(h-n)/a,y:(c-i)/o,width:f/a,height:m/o});break}const u=[];for(let h=0,c=t.rangeCount;h<c;h++){const f=t.getRangeAt(h);if(!f.collapsed)for(const{x:m,y:g,width:v,height:y}of f.getClientRects())v===0||y===0||u.push(l(m,g,v,y))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#n.getRawValue(t);n&&(this.#S===Ke.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const i=this.#O?.get(e);i&&(i.setCanvas(t,n),this.#O.delete(e))}addMissingCanvas(e,t){(this.#O||=new Map).set(e,t)}}class an{#e=null;#t=!1;#r=null;#s=null;#a=null;#i=null;#n=!1;#o=null;#c=null;#l=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#u=e._uiManager.useNewAltTextFlow,an.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){an._l10n??=e}async render(){const e=this.#r=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#s=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",an.#f.missing),t.setAttribute("data-l10n-id",an.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",Cr,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#n=!0,i(a))},{signal:n}),await this.#p(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#r&&(this.#r.focus({focusVisible:this.#n}),this.#n=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await an._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(this.#l=n,this.#h=i),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#r&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#r?.remove(),this.#r=null,this.#s=null,this.#a=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#r;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",an.#f[this.#g]),this.#s?.setAttribute("data-l10n-id",an.#f[`${this.#g}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const i=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#a?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class $d{#e=null;#t=null;#r=!1;#s=null;#a=null;#i=null;#n=null;#o=null;#c=!1;#l=null;constructor(e){this.#s=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#s.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#s._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=this.#s.commentButtonColor;i&&(n.backgroundColor=i)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#s.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#s._uiManager.updatePopupColor(this.#s)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#s.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:i,y:a,width:o,height:l}=this.#s.parent.boundingClientRect;return[(e-i)/o,(t+n-a)/l]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#s._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#s._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#s._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Cr,{signal:n}),t&&(e.addEventListener("focusin",a=>{this.#s._focusEventsAllowed=!1,qt(a)},{capture:!0,signal:n}),e.addEventListener("focusout",a=>{this.#s._focusEventsAllowed=!0,qt(a)},{capture:!0,signal:n})),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),e===this.#t?this.edit():this.#s.toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#r=!0,i(a))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#s.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#s.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=this.#s.commentButtonPosition;const{width:c,height:f,x:m,y:g}=this.#s;n=m+n*c,i=g+i*f}const a=this.#s.parent.boundingClientRect,{x:o,y:l,width:u,height:h}=a;this.#s._uiManager.editComment(this.#s,o+n*u,l+i*h,{...e,parentDimensions:a})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#r}),this.#r=!1)}isDeleted(){return this.#c||this.#n===""}isEmpty(){return this.#n===null}hasBeenEdited(){return this.isDeleted()||this.#n!==this.#a}serialize(){return this.data}get data(){return{text:this.#n,richText:this.#i,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#n&&(this.#i=null),e===null){this.#n="",this.#c=!0;return}this.#n=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#i=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#n="",this.#i=null,this.#o=null,this.#s=null,this.#r=!1,this.#c=!1}}class Eh{#e;#t=!1;#r=null;#s;#a;#i;#n;#o=null;#c;#l=null;#h;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:o=null,signal:l}){this.#e=e,this.#r=n,this.#s=t,this.#a=i,this.#i=a,this.#n=o,this.#h=new AbortController,this.#c=AbortSignal.any([l,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/gn.pixelRatio}#f(e){if(this.#s?.())return;if(e.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,a=AbortSignal.any([this.#c,i.signal]),o=this.#e,l={capture:!0,signal:a,passive:!1},u=h=>{h.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",h=>{h.pointerType==="touch"&&(qt(h),u(h))},l),o.addEventListener("pointerup",u,l),o.addEventListener("pointercancel",u,l);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#c,this.#u.signal]),a=this.#e,o={signal:i,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),o);const l=this.#p.bind(this);a.addEventListener("touchend",l,o),a.addEventListener("touchcancel",l,o),o.capture=!0,a.addEventListener("pointerdown",qt,o),a.addEventListener("pointermove",qt,o),a.addEventListener("pointercancel",qt,o),a.addEventListener("pointerup",qt,o),this.#a?.()}if(qt(e),e.touches.length!==2||this.#r?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(e){if(!this.#l||e.touches.length!==2)return;qt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:a}=t,{screenX:o,screenY:l}=n,u=this.#l,{touch0X:h,touch0Y:c,touch1X:f,touch1Y:m}=u,g=f-h,v=m-c,y=o-i,x=l-a,b=Math.hypot(y,x)||1,w=Math.hypot(g,v)||1;if(!this.#t&&Math.abs(w-b)<=Eh.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=i,u.touch0Y=a,u.touch1X=o,u.touch1Y=l,!this.#t){this.#t=!0;return}const k=[(i+o)/2,(a+l)/2];this.#i?.(k,w,b)}#p(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#n?.()),this.#l&&(qt(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Oe{#e=null;#t=null;#r=null;#s=null;#a=null;#i=!1;#n=null;#o="";#c=null;#l=null;#h=null;#u=null;#f=null;#g="";#p=!1;#d=null;#m=!1;#x=!1;#v=!1;#y=null;#E=0;#N=0;#j=null;#_=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#b=!1;#k=Oe._zIndex++;static _borderLineWidth=-1;static _colorManager=new _y;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Oe.prototype._resizeWithKeyboard,t=_i.TRANSLATE_SMALL,n=_i.TRANSLATE_BIG;return Xe(this,"_resizerKeyboardManager",new mc([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Oe.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,o];const[l,u]=this.parentDimensions;this.x=e.x/l,this.y=e.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new dU({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Oe._l10n??=e,Oe._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Oe._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Oe._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){vt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#b}set _isDraggable(e){this.#b=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#L(),this.#u?.remove(),this.#u=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[a,o]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/a,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}#T([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#T(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#d||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,a]}=this;if(this.x+=e/i,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[u,h]=this.getBaseTranslation();o+=u,l+=h;const{style:c}=n;c.left=`${(100*o).toFixed(2)}%`,c.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}get _hasBeenResized(){return!!this.#d&&(this.#d[2]!==this.width||this.#d[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Oe,i=n/e,a=n/t;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:a,y:o,width:l,height:u}=this;if(l*=n,u*=i,a*=n,o*=i,this._mustFixPosition)switch(e){case 0:a=Bs(a,0,n-l),o=Bs(o,0,i-u);break;case 90:a=Bs(a,0,n-u),o=Bs(o,l,i);break;case 180:a=Bs(a,l,n),o=Bs(o,u,i);break;case 270:a=Bs(a,u,n),o=Bs(o,0,i-l);break}this.x=a/=n,this.y=o/=i;const[h,c]=this.getBaseTranslation();a+=h,o+=c,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#A(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Oe.#A(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Oe.#A(e,t,360-this.parentRotation)}#C(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#I(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");this.#c.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#D.bind(this,n),{signal:t}),i.addEventListener("contextmenu",Cr,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#c)}#D(e,t){t.preventDefault();const{isMac:n}=Es.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#r?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#O.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",qt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Cr,{signal:o}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#r?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=u,this.#B()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#M(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=this.#h;this.#h=null;const a=this.x,o=this.y,l=this.width,u=this.height;a===e&&o===t&&l===n&&u===i||this.addCommands({cmd:this.#M.bind(this,a,o,l,u),undo:this.#M.bind(this,e,t,n,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#O(e,t){const[n,i]=this.parentDimensions,a=this.x,o=this.y,l=this.width,u=this.height,h=Oe.MIN_SIZE/n,c=Oe.MIN_SIZE/i,f=this.#C(this.rotation),m=(z,G)=>[f[0]*z+f[2]*G,f[1]*z+f[3]*G],g=this.#C(360-this.rotation),v=(z,G)=>[g[0]*z+g[2]*G,g[1]*z+g[3]*G];let y,x,b=!1,w=!1;switch(e){case"topLeft":b=!0,y=(z,G)=>[0,0],x=(z,G)=>[z,G];break;case"topMiddle":y=(z,G)=>[z/2,0],x=(z,G)=>[z/2,G];break;case"topRight":b=!0,y=(z,G)=>[z,0],x=(z,G)=>[0,G];break;case"middleRight":w=!0,y=(z,G)=>[z,G/2],x=(z,G)=>[0,G/2];break;case"bottomRight":b=!0,y=(z,G)=>[z,G],x=(z,G)=>[0,0];break;case"bottomMiddle":y=(z,G)=>[z/2,G],x=(z,G)=>[z/2,0];break;case"bottomLeft":b=!0,y=(z,G)=>[0,G],x=(z,G)=>[z,0];break;case"middleLeft":w=!0,y=(z,G)=>[0,G/2],x=(z,G)=>[z,G/2];break}const k=y(l,u),N=x(l,u);let E=m(...N);const S=Oe._round(a+E[0]),A=Oe._round(o+E[1]);let C=1,I=1,L,M;if(t.fromKeyboard)({deltaX:L,deltaY:M}=t);else{const{screenX:z,screenY:G}=t,[Y,H]=this.#l;[L,M]=this.screenToPageTranslation(z-Y,G-H),this.#l[0]=z,this.#l[1]=G}if([L,M]=v(L/n,M/i),b){const z=Math.hypot(l,u);C=I=Math.max(Math.min(Math.hypot(N[0]-k[0]-L,N[1]-k[1]-M)/z,1/l,1/u),h/l,c/u)}else w?C=Bs(Math.abs(N[0]-k[0]-L),h,1)/l:I=Bs(Math.abs(N[1]-k[1]-M),c,1)/u;const D=Oe._round(l*C),F=Oe._round(u*I);E=m(...x(D,F));const q=S-E[0],B=A-E[1];this.#d||=[this.x,this.y,this.width,this.height],this.width=D,this.height=F,this.x=q,this.y=B,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#r?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#x)return this._editToolbar;this._editToolbar=new Ll(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#r?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#r||(an.initialize(Oe._l10n),this.#r=new an(this),this.#e&&(this.#r.data=this.#e,this.#e=null)),this.#r}get altTextData(){return this.#r?.data}set altTextData(e){this.#r&&(this.#r.data=e)}get guessedAltText(){return this.#r?.guessedText}async setGuessedAltText(e){await this.#r?.setGuessedText(e)}serializeAltText(e){return this.#r?.serialize(e)}hasAltText(){return!!this.#r&&!this.#r.isEmpty()}hasAltTextData(){return this.#r?.hasData()??!1}focusCommentButton(){this.#s?.focusButton()}addCommentButton(){return this.canAddComment?this.#s||=new $d(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#s.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#s.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:i}}=this.#s;return{text:t,richText:e,date:n,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#s||=new $d(this),this.#s.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#s||=new $d(this),this.#s.setInitialText(e,n),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){return this.#s?.hasBeenEdited()}get hasDeletedComment(){return this.#s?.isDeleted()}get hasComment(){return!!this.#s&&!this.#s.isEmpty()&&!this.#s.isDeleted()}async editComment(e){this.#s||=new $d(this),this.#s.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#s.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,l=o+a+1,u=i-100,h=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,u,h,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#s.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#i?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#U();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[i,a]=this.getInitialTranslation();return this.translate(i,a),oC(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#_||=new Eh({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#S.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#q(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#r?.toggle(!1),this.parent.togglePointerEvents(!1)}#S(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const o=this.#C(this.rotation),l=(S,A)=>[o[0]*S+o[2]*A,o[1]*S+o[3]*A],[u,h]=this.parentDimensions,c=this.x,f=this.y,m=this.width,g=this.height,v=Oe.MIN_SIZE/u,y=Oe.MIN_SIZE/h;a=Math.max(Math.min(a,1/m,1/g),v/m,y/g);const x=Oe._round(m*a),b=Oe._round(g*a);if(x===m&&b===g)return;this.#d||=[c,f,m,g];const w=l(m/2,g/2),k=Oe._round(c+w[0]),N=Oe._round(f+w[1]),E=l(x/2,b/2);this.x=k-E[0],this.y=N-E[1],this.width=x,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#r?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=Es.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#F(e);return}this.#P(e)}#P(e){const{isMac:t}=Es.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#F(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:a},l=h=>{i.abort(),this.#n=null,this.#p=!1,this._uiManager.endDragSession()||this.#P(h),n&&this._onStopDragging()};t&&(this.#E=e.clientX,this.#N=e.clientY,this.#n=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",h=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:c,clientY:f,pointerId:m}=h;if(m!==this.#n){qt(h);return}const[g,v]=this.screenToPageTranslation(c-this.#E,f-this.#N);this.#E=c,this.#N=f,this._uiManager.dragSelectedEditors(g,v)},o),window.addEventListener("touchmove",qt,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#o&&(this.#_||h.isPrimary)&&l(h),qt(h)},o));const u=h=>{if(!this.#n||this.#n===h.pointerId){l(h);return}qt(h)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[a,o]=this.pageDimensions,[l,u]=this.pageTranslation,h=e/i,c=t/i,f=this.x*a,m=this.y*o,g=this.width*a,v=this.height*o;switch(n){case 0:return[f+h+l,o-m-c-v+u,f+h+g+l,o-m-c+u];case 90:return[f+c+l,o-m+h+u,f+c+v+l,o-m+h+g+u];case 180:return[f-h-g+l,o-m+c+u,f-h+l,o-m+c+v+u];case 270:return[f-c-v+l,o-m-h-g+u,f-c+l,o-m-h+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,a,o]=e,l=a-n,u=o-i;switch(this.rotation){case 0:return[n,t-o,l,u];case 90:return[n,t-i,u,l];case 180:return[a,t-i,l,u];case 270:return[a,t-o,u,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Oe._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#s?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:a,richText:o},uid:l,pageIndex:u,creationDate:h,modificationDate:c}=this;return{id:l,pageIndex:u,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:h,modificationDate:n||c,popupRef:!a,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#x=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#x=!1,!0):!1}isInEditMode(){return this.#x}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return t<o&&i>0&&e<a&&n>0}#U(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#U()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[a,o]=i.pageDimensions,[l,u,h,c]=i.getRectInCurrentCoords(e.rect,o);return i.x=l/a,i.y=u/o,i.width=h/a,i.height=c/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#L(),this.removeEditToolbar(),this.#j){for(const e of this.#j.values())clearTimeout(e);this.#j=null}this.parent=null,this.#_?.destroy(),this.#_=null,this.#u?.remove(),this.#u=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,a,o]=this.getPDFRect();return[Oe._round(n+(a-n)*e),Oe._round(i+(o-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#s.commentPopupPositionInLayer}set commentPopupPosition(e){this.#s.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#s.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#s.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#s?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const o=this.#G.bind(this),l=this.#W.bind(this),u=this._uiManager._signal;for(const h of this.#t){const c=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:u}),h.addEventListener("blur",l,{signal:u}),h.addEventListener("focus",this.#Y.bind(this,c),{signal:u}),h.setAttribute("data-l10n-id",Oe._l10nResizer[c])}}const n=this.#t[0];let i=0;for(const o of t){if(o===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==i){if(a<i)for(let l=0;l<i-a;l++)this.#c.append(this.#c.firstChild);else if(a>i)for(let l=0;l<a-i;l++)this.#c.firstChild.before(this.#c.lastChild);let o=0;for(const l of t){const h=this.#t[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Oe._l10nResizer[h])}}this.#H(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#G(e){Oe._resizerKeyboardManager.exec(this,e)}#W(e){this.#v&&e.relatedTarget?.parentNode!==this.#c&&this.#L()}#Y(e){this.#g=this.#v?e:""}#H(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#v&&this.#O(this.#g,{deltaX:e,deltaY:t,fromKeyboard:!0})}#L(){this.#v=!1,this.#H(-1),this.#B()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#r?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#r?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#m}set isEditing(e){this.#m=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#j||=new Map;const{action:n}=e;let i=this.#j.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#j.delete(n),this.#j.size===0&&(this.#j=null)},Oe._telemetryTimeout),this.#j.set(n,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}updateFakeAnnotationElement(e){if(!this.#u&&!this.deleted){this.#u=e.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class dU extends Oe{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const gk=3285377520,jr=4294901760,rn=65535;class lC{constructor(e){this.h1=e?e&4294967295:gk,this.h2=e?e&4294967295:gk}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let y=0,x=e.length;y<x;y++){const b=e.charCodeAt(y);b<=255?t[n++]=b:(t[n++]=b>>>8,t[n++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,o=new Uint32Array(t.buffer,0,i);let l=0,u=0,h=this.h1,c=this.h2;const f=3432918353,m=461845907,g=f&rn,v=m&rn;for(let y=0;y<i;y++)y&1?(l=o[y],l=l*f&jr|l*g&rn,l=l<<15|l>>>17,l=l*m&jr|l*v&rn,h^=l,h=h<<13|h>>>19,h=h*5+3864292196):(u=o[y],u=u*f&jr|u*g&rn,u=u<<15|u>>>17,u=u*m&jr|u*v&rn,c^=u,c=c<<13|c>>>19,c=c*5+3864292196);switch(l=0,a){case 3:l^=t[i*4+2]<<16;case 2:l^=t[i*4+1]<<8;case 1:l^=t[i*4],l=l*f&jr|l*g&rn,l=l<<15|l>>>17,l=l*m&jr|l*v&rn,i&1?h^=l:c^=l}this.h1=h,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&jr|e*36045&rn,t=t*4283543511&jr|((t<<16|e>>>16)*2950163797&jr)>>>16,e^=t>>>1,e=e*444984403&jr|e*60499&rn,t=t*3301882366&jr|((t<<16|e>>>16)*3120437893&jr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Hx=Object.freeze({map:null,hash:"",transfer:void 0});class Ay{#e=!1;#t=null;#r=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#s.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#s.get(e)}remove(e){const t=this.#s.get(e);if(t!==void 0&&(t instanceof Oe&&this.#r.delete(t.annotationElementId),this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#s.values())if(n instanceof Oe)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#s.get(e);let i=!1;if(n!==void 0)for(const[a,o]of Object.entries(t))n[a]!==o&&(i=!0,n[a]=o);else i=!0,this.#s.set(e,t);i&&this.#a(),t instanceof Oe&&((this.#r||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#s.has(e)}get size(){return this.#s.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new cC(this)}get serializable(){if(this.#s.size===0)return Hx;const e=new Map,t=new lC,n=[],i=Object.create(null);let a=!1;for(const[o,l]of this.#s){const u=l instanceof Oe?l.serialize(!1,i):l;u&&(e.set(o,u),t.update(`${o}:${JSON.stringify(u)}`),a||=!!u.bitmap)}if(a)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Hx}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const a of this.#s.values()){if(!(a instanceof Oe)){a.popup&&(a.popup.deleted?i+=1:n+=1);continue}a.isCommentDeleted?i+=1:a.hasEditedComment&&(n+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:l}=o;t.has(l)||t.set(l,Object.getPrototypeOf(a).constructor),e||=Object.create(null);const u=e[l]||=new Map;for(const[h,c]of Object.entries(o)){if(h==="type")continue;let f=u.get(h);f||(f=new Map,u.set(h,f));const m=f.get(c)??0;f.set(c,m+1)}}if((i>0||n>0)&&(e||=Object.create(null),e.comments={deleted:i,edited:n}),!e)return null;for(const[a,o]of t)e[a]=o.computeTelemetryFinalData(e[a]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#r?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#r?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#r)for(const t of this.#r.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class cC extends Ay{#e;constructor(e){super();const{map:t,hash:n,transfer:i}=e.serializable,a=structuredClone(t,i?{transfer:i}:null);this.#e={map:a,hash:n,transfer:i}}get print(){vt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Xe(this,"modifiedIds",{ids:new Set,hash:""})}}class uU{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(it(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:o}=e,l=new FontFace(i,a,o);this.addNativeFontFace(l);try{await l.load(),this.#e.add(i),n?.(e)}catch{$e(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}vt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw $e(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Xe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Xe(this,"isSyncFontLoadingSupported",Is||Es.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(it(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Xe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(N,E){return N.charCodeAt(E)<<24|N.charCodeAt(E+1)<<16|N.charCodeAt(E+2)<<8|N.charCodeAt(E+3)&255}function i(N,E,S,A){const C=N.substring(0,E),I=N.substring(E+S);return C+A+I}let a,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let h=0;function c(N,E){if(++h>30){$e("Load test font never loaded."),E();return}if(u.font="30px "+N,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(c.bind(null,N,E))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,f.length,f);const v=16,y=1482184792;let x=n(m,v);for(a=0,o=f.length-3;a<o;a+=4)x=x-y+n(f,a)|0;a<f.length&&(x=x-y+n(f+"XXX",a)|0),m=i(m,v,4,$7(x));const b=`url(data:font/opentype;base64,${btoa(m)});`,w=`@font-face {font-family:"${f}";src:${b}}`;this.insertRule(w);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const N of[e.loadedName,f]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=N,k.append(E)}this._document.body.append(k),c(f,()=>{k.remove(),t.complete()})}}class hU{#e;constructor(e,t=null,n,i){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${rC(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(o){$e(`getPathGenerator - ignoring character: "${o}".`)}const a=aC(i);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class co{#e;#t;#r;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let i=0;for(const h of co.strings){const c=t.encode(e[h]);n[h]=c,i+=4+c.length}const a=new ArrayBuffer(i),o=new Uint8Array(a),l=new DataView(a);let u=0;for(const h of co.strings){const c=n[h],f=c.length;l.setUint32(u,f),o.set(c,u+4),u+=4+f}return it(u===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#r=new TextDecoder}#s(e){it(e<co.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#r.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#s(0)}get fontWeight(){return this.#s(1)}get italicAngle(){return this.#s(2)}}class uo{#e;#t;#r;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let i=0;for(const m of uo.strings){const g=t.encode(e[m]);n[m]=g,i+=4+g.length}i+=4;let a,o,l=1+i;e.style&&(a=t.encode(e.style.style),o=t.encode(e.style.weight),l+=4+a.length+4+o.length);const u=new ArrayBuffer(l),h=new Uint8Array(u),c=new DataView(u);let f=0;c.setUint8(f++,e.guessFallback?1:0),c.setUint32(f,0),f+=4,i=0;for(const m of uo.strings){const g=n[m],v=g.length;i+=4+v,c.setUint32(f,v),h.set(g,f+4),f+=4+v}return c.setUint32(f-i-4,i),e.style&&(c.setUint32(f,a.length),h.set(a,f+4),f+=4+a.length,c.setUint32(f,o.length),h.set(o,f+4),f+=4+o.length),it(f<=u.byteLength,"SubstitionInfo.write: Buffer overflow"),u.transferToFixedLength(f)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#r=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#s(e){it(e<uo.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#r.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#s(0)}get loadedName(){return this.#s(1)}get baseFontName(){return this.#s(2)}get src(){return this.#s(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#r.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const i=this.#t.getUint32(e),a=this.#r.decode(new Uint8Array(this.#e,e+4,i));return{style:n,weight:a}}}class yt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#r=this.#t+1+8;static#s=this.#r+1+48;static#a=this.#s+1+6;#i;#n;#o;constructor({data:e,extra:t}){this.#i=e,this.#n=new TextDecoder,this.#o=new DataView(this.#i),t&&Object.assign(this,t)}#c(e){it(e<yt.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,i=this.#o.getUint8(t)>>n&3;return i===0?void 0:i===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return it(e<yt.numbers.length,"Invalid number index"),this.#o.getFloat64(yt.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=yt.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<4;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=yt.#r;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<6;i++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=yt.#s;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<3;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#h(e){it(e<yt.strings.length,"Invalid string index");let t=yt.#a+4;for(let a=0;a<e;a++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(this.#i,t+4,n)),this.#n.decode(i)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=yt.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const a=this.#o.getUint32(e);if(a!==0)return new Uint8Array(this.#i,e+4,a)}clearData(){let e=yt.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const a=this.#o.getUint32(e);new Uint8Array(this.#i,e+4,a).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=yt.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#i,e+4,i)),new co(a.buffer)}get systemFontInfo(){let e=yt.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(this.#i,e+4,n)),new uo(i.buffer)}static write(e){const t=e.systemFontInfo?uo.write(e.systemFontInfo):null,n=e.cssFontInfo?co.write(e.cssFontInfo):null,i=new TextEncoder,a={};let o=0;for(const y of yt.strings)a[y]=i.encode(e[y]),o+=4+a[y].length;const l=yt.#a+4+o+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),u=new ArrayBuffer(l),h=new Uint8Array(u),c=new DataView(u);let f=0;const m=yt.bools.length;let g=0,v=0;for(let y=0;y<m;y++){const x=e[yt.bools[y]];g|=(x===void 0?0:x?2:1)<<v,v+=2,(v===8||y===m-1)&&(c.setUint8(f++,g),g=0,v=0)}it(f===yt.#e,"FontInfo.write: Boolean properties offset mismatch");for(const y of yt.numbers)c.setFloat64(f,e[y]),f+=8;if(it(f===yt.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(f++,4);for(const y of e.bbox)c.setInt16(f,y,!0),f+=2}else c.setUint8(f++,0),f+=8;if(it(f===yt.#r,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(f++,6);for(const y of e.fontMatrix)c.setFloat64(f,y,!0),f+=8}else c.setUint8(f++,0),f+=48;if(it(f===yt.#s,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(f++,1);for(const y of e.defaultVMetrics)c.setInt16(f,y,!0),f+=2}else c.setUint8(f++,0),f+=6;it(f===yt.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(yt.#a,0),f+=4;for(const y of yt.strings){const x=a[y],b=x.length;c.setUint32(f,b),h.set(x,f+4),f+=4+b}if(c.setUint32(yt.#a,f-yt.#a-4),!t)c.setUint32(f,0),f+=4;else{const y=t.byteLength;c.setUint32(f,y),it(f+4+y<=u.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(t),f+4),f+=4+y}if(!n)c.setUint32(f,0),f+=4;else{const y=n.byteLength;c.setUint32(f,y),it(f+4+y<=u.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(n),f+4),f+=4+y}return e.data===void 0?(c.setUint32(f,0),f+=4):(c.setUint32(f,e.data.length),h.set(e.data,f+4),f+=4+e.data.length),it(f<=u.byteLength,"FontInfo.write: Buffer overflow"),u.transferToFixedLength(f)}}class us{static#e=0;static#t=1;static#r=2;static#s=3;static#a=4;static#i=8;static#n=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],a=[],o=[],l=[],u=null,h=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],o=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,u=e[1],i=e[2],a=e[3],l=e[4]||[],n=e[6],h=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const c=Math.floor(i.length/2),f=Math.floor(a.length/3),m=o.length,g=l.length;let v=0;for(const E of l)v+=1,v=Math.ceil(v/4)*4,v+=4+E.coords.length*4,v+=4+E.colors.length*4,E.verticesPerRow!==void 0&&(v+=4);const y=20+c*8+f*3+m*8+(n?16:0)+(h?3:0)+v,x=new ArrayBuffer(y),b=new DataView(x),w=new Uint8Array(x);b.setUint8(us.#e,t),b.setUint8(us.#t,n?1:0),b.setUint8(us.#r,h?1:0),b.setUint8(us.#s,u),b.setUint32(us.#a,c,!0),b.setUint32(us.#i,f,!0),b.setUint32(us.#n,m,!0),b.setUint32(us.#o,g,!0);let k=20;new Float32Array(x,k,c*2).set(i),k+=c*8,w.set(a,k),k+=f*3;for(const[E,S]of o)b.setFloat32(k,E,!0),k+=4,b.setUint32(k,parseInt(S.slice(1),16),!0),k+=4;if(n)for(const E of n)b.setFloat32(k,E,!0),k+=4;h&&(w.set(h,k),k+=3);for(let E=0;E<l.length;E++){const S=l[E];b.setUint8(k,S.type),k+=1,k=Math.ceil(k/4)*4,b.setUint32(k,S.coords.length,!0),k+=4,new Int32Array(x,k,S.coords.length).set(S.coords),k+=S.coords.length*4,b.setUint32(k,S.colors.length,!0),k+=4,new Int32Array(x,k,S.colors.length).set(S.colors),k+=S.colors.length*4,S.verticesPerRow!==void 0&&(b.setUint32(k,S.verticesPerRow,!0),k+=4)}return x}getIR(){const e=this.view,t=this.data[us.#e],n=!!this.data[us.#t],i=!!this.data[us.#r],a=e.getUint32(us.#a,!0),o=e.getUint32(us.#i,!0),l=e.getUint32(us.#n,!0),u=e.getUint32(us.#o,!0);let h=20;const c=new Float32Array(this.buffer,h,a*2);h+=a*8;const f=new Uint8Array(this.buffer,h,o*3);h+=o*3;const m=[];for(let x=0;x<l;++x){const b=e.getFloat32(h,!0);h+=4;const w=e.getUint32(h,!0);h+=4,m.push([b,`#${w.toString(16).padStart(6,"0")}`])}let g=null;if(n){g=[];for(let x=0;x<4;++x)g.push(e.getFloat32(h,!0)),h+=4}let v=null;i&&(v=new Uint8Array(this.buffer,h,3),h+=3);const y=[];for(let x=0;x<u;++x){const b=e.getUint8(h);h+=1,h=Math.ceil(h/4)*4;const w=e.getUint32(h,!0);h+=4;const k=new Int32Array(this.buffer,h,w);h+=w*4;const N=e.getUint32(h,!0);h+=4;const E=new Int32Array(this.buffer,h,N);h+=N*4;const S={type:b,coords:k,colors:E};b===Ix.LATTICE&&(S.verticesPerRow=e.getUint32(h,!0),h+=4),y.push(S)}if(t===1)return["RadialAxial","axial",g,m,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",g,m,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(t===3){const x=this.data[us.#s];let b=null;if(c.length>0){let w=c[0],k=c[0],N=c[1],E=c[1];for(let S=0;S<c.length;S+=2){const A=c[S],C=c[S+1];w=w>A?A:w,N=N>C?C:N,k=k<A?A:k,E=E<C?C:E}b=[w,N,k,E]}return["Mesh",x,c,f,y,b,g,v]}throw new Error(`Unsupported pattern kind: ${t}`)}}function fU(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Is)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function mU(r){if(Is&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return dc(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Wd(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const Vx=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,pU=r=>typeof r=="object"&&typeof r?.name=="string",gU=X7.bind(null,Vx,pU);class xU{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){$e("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Gd={DATA:1,ERROR:2},es={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function xk(){}function Zs(r){if(r instanceof Si||r instanceof Bx||r instanceof ck||r instanceof Hu||r instanceof Mg)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||vt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Si(r.message);case"InvalidPDFException":return new Bx(r.message);case"PasswordException":return new ck(r.message,r.code);case"ResponseException":return new Hu(r.message,r.status,r.missing);case"UnknownErrorException":return new Mg(r.message,r.details)}return new Mg(r.message,r.toString())}class Sl{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#s(e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Gd.DATA)i.resolve(e.data);else if(e.callback===Gd.ERROR)i.reject(Zs(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(o){a.postMessage({sourceName:n,targetName:i,callback:Gd.DATA,callbackId:e.callbackId,data:o})},function(o){a.postMessage({sourceName:n,targetName:i,callback:Gd.ERROR,callbackId:e.callbackId,reason:Zs(o)})});return}if(e.streamId){this.#r(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(o){a.reject(o)}return a.promise}sendWithStream(e,t,n,i){const a=this.streamId++,o=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:h=>{const c=Promise.withResolvers();return this.streamControllers[a]={controller:h,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:l,action:e,streamId:a,data:t,desiredSize:h.desiredSize},i),c.promise},pull:h=>{const c=Promise.withResolvers();return this.streamControllers[a].pullCall=c,u.postMessage({sourceName:o,targetName:l,stream:es.PULL,streamId:a,desiredSize:h.desiredSize}),c.promise},cancel:h=>{it(h instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[a].cancelCall=c,this.streamControllers[a].isClosed=!0,u.postMessage({sourceName:o,targetName:l,stream:es.CANCEL,streamId:a,reason:Zs(h)}),c.promise}},n)}#r(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,o=this,l=this.actionHandler[e.action],u={enqueue(h,c=1,f){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=c,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:es.ENQUEUE,streamId:t,chunk:h},f)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:es.CLOSE,streamId:t}),delete o.streamSinks[t])},error(h){it(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:es.ERROR,streamId:t,reason:Zs(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[t]=u,Promise.try(l,e.data,u).then(function(){a.postMessage({sourceName:n,targetName:i,stream:es.START_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:es.START_COMPLETE,streamId:t,reason:Zs(h)})})}#s(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,o=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case es.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Zs(e.reason));break;case es.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Zs(e.reason));break;case es.PULL:if(!l){a.postMessage({sourceName:n,targetName:i,stream:es.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||xk).then(function(){a.postMessage({sourceName:n,targetName:i,stream:es.PULL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:es.PULL_COMPLETE,streamId:t,reason:Zs(h)})});break;case es.ENQUEUE:if(it(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case es.CLOSE:if(it(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,t);break;case es.ERROR:it(o,"error should have stream controller"),o.controller.error(Zs(e.reason)),this.#a(o,t);break;case es.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Zs(e.reason)),this.#a(o,t);break;case es.CANCEL:if(!l)break;const u=Zs(e.reason);Promise.try(l.onCancel||xk,u).then(function(){a.postMessage({sourceName:n,targetName:i,stream:es.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:n,targetName:i,stream:es.CANCEL_COMPLETE,streamId:t,reason:Zs(h)})}),l.sinkCapability.reject(u),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class dC{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){vt("Abstract method `_createCanvas` called.")}}class yU extends dC{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class uC{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){vt("Abstract method `_fetch` called.")}}class yk extends uC{async _fetch(e){const t=await uc(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):dc(t)}}class hC{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,a){return"none"}destroy(e=!1){}}class vU extends hC{#e;#t;#r;#s;#a;#i;#n=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#s=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#i||=new Map}get#l(){if(!this.#r){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#a.createElementNS(_n,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#r=this.#a.createElementNS(_n,"defs"),e.append(n),n.append(this.#r),this.#a.body.append(e)}return this.#r}#h(e){if(e.length===1){const u=e[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const c=h.join(",");return[c,c,c]}const[t,n,i]=e,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=t[u]/255,o[u]=n[u]/255,l[u]=i[u]/255;return[a.join(","),o.join(","),l.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(kh(t)?$e('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=eC(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,i,a]=this.#h(e),o=e.length===1?n:`${n}${i}${a}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const l=`g_${this.#s}_transfer_map_${this.#n++}`,u=this.#u(l);this.#o.set(e,u),this.#o.set(o,u);const h=this.#p(l);return this.#m(n,i,a,h),u}addHCMFilter(e,t){const n=`${e}-${t}`,i="base";let a=this.#c.get(i);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#c.set(i,a)),!e||!t))return a.url;const o=this.#v(e);e=Ae.makeHexColor(...o);const l=this.#v(t);if(t=Ae.makeHexColor(...l),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const u=new Array(256);for(let g=0;g<=255;g++){const v=g/255;u[g]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const h=u.join(","),c=`g_${this.#s}_hcm_filter`,f=a.filter=this.#p(c);this.#m(h,h,h,f),this.#g(f);const m=(g,v)=>{const y=o[g]/255,x=l[g]/255,b=new Array(v+1);for(let w=0;w<=v;w++)b[w]=y+w/v*(x-y);return b.join(",")};return this.#m(m(0,5),m(1,5),m(2,5),f),a.url=this.#u(c),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#h([e]),i=`alpha_${n}`;if(t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#s}_alpha_map_${this.#n++}`,o=this.#u(a);this.#o.set(e,o),this.#o.set(i,o);const l=this.#p(a);return this.#x(n,l),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,i;if(e?([n]=this.#h([e]),i=`luminosity_${n}`):i="luminosity",t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#s}_luminosity_map_${this.#n++}`,o=this.#u(a);this.#o.set(e,o),this.#o.set(i,o);const l=this.#p(a);return this.#f(l),e&&this.#x(n,l),o}addHighlightHCMFilter(e,t,n,i,a){const o=`${t}-${n}-${i}-${a}`;let l=this.#c.get(e);if(l?.key===o||(l?(l.filter?.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},this.#c.set(e,l)),!t||!n))return l.url;const[u,h]=[t,n].map(this.#v.bind(this));let c=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,g]=[i,a].map(this.#v.bind(this));f<c&&([c,f,m,g]=[f,c,g,m]),this.#l.style.color="";const v=(b,w,k)=>{const N=new Array(256),E=(f-c)/k,S=b/255,A=(w-b)/(255*k);let C=0;for(let I=0;I<=k;I++){const L=Math.round(c+I*E),M=S+I*A;for(let D=C;D<=L;D++)N[D]=M;C=L+1}for(let I=C;I<256;I++)N[I]=N[C-1];return N.join(",")},y=`g_${this.#s}_hcm_${e}_filter`,x=l.filter=this.#p(y);return this.#g(x),this.#m(v(m[0],g[0],5),v(m[1],g[1],5),v(m[2],g[2],5),x),l.url=this.#u(y),l.url}destroy(e=!1){e&&this.#i?.size||(this.#r?.parentNode.parentNode.remove(),this.#r=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#n=0)}#f(e){const t=this.#a.createElementNS(_n,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#a.createElementNS(_n,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#a.createElementNS(_n,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#d(e,t,n){const i=this.#a.createElementNS(_n,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#m(e,t,n,i){const a=this.#a.createElementNS(_n,"feComponentTransfer");i.append(a),this.#d(a,"feFuncR",e),this.#d(a,"feFuncG",t),this.#d(a,"feFuncB",n)}#x(e,t){const n=this.#a.createElementNS(_n,"feComponentTransfer");t.append(n),this.#d(n,"feFuncA",e)}#v(e){return this.#l.style.color=e,fc(getComputedStyle(this.#l).getPropertyValue("color"))}}class fC{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){vt("Abstract method `_fetch` called.")}}class vk extends fC{async _fetch(e){const t=await uc(e,"arraybuffer");return new Uint8Array(t)}}class mC{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){vt("Abstract method `_fetch` called.")}}class bk extends mC{async _fetch(e){const t=await uc(e,"arraybuffer");return new Uint8Array(t)}}Is&&$e("Please use the `legacy` build in Node.js environments.");async function Cy(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class bU extends hC{}class jU extends dC{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class wU extends uC{async _fetch(e){return Cy(e)}}class NU extends fC{async _fetch(e){return Cy(e)}}class kU extends mC{async _fetch(e){return Cy(e)}}const Va="__forcedDependency",{floor:jk,ceil:wk}=Math;function Yd(r,e,t,n,i,a){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],n),r[e*4+2]=Math.max(r[e*4+2],i),r[e*4+3]=Math.max(r[e*4+3],a)}const qx=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class EU{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===qx}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Kd=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};class SU{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[Va]:[]};#r=new Map;#s=[];#a=[];#i=[[1,0,0,1,0,0]];#n=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#u=new Map;#f;#g;#p;#d;#m;constructor(e,t,n=!1){this.#f=e.width,this.#g=e.height,this.#x(t),n&&(this.#m=new Map)}growOperationsCount(e){e>=this.#d.length&&this.#x(e,this.#d)}#x(e,t){const n=new ArrayBuffer(e*4);this.#p=new Uint8ClampedArray(n),this.#d=new Uint32Array(n),t&&t.length>0?(this.#d.set(t),this.#d.fill(qx,t.length)):this.#d.fill(qx)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[Va]:{__proto__:this.#t[Va]}},this.#n={__proto__:this.#n},this.#s.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#n=Object.getPrototypeOf(this.#n);const n=this.#s.pop();return n!==void 0&&(Kd(this.#m,e)?.dependencies.add(n),this.#d[e]=this.#d[n]),this}recordOpenMarker(e){return this.#s.push(e),this}getOpenMarker(){return this.#s.length===0?null:this.#s.at(-1)}recordCloseMarker(e){const t=this.#s.pop();return t!==void 0&&(Kd(this.#m,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Kd(this.#m,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}pushBaseTransform(e){return this.#i.push(Ae.multiplyByDOMMatrix(this.#i.at(-1),e.getTransform())),this}popBaseTransform(){return this.#i.length>1&&this.#i.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#r.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#r.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Va,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(Va,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,i,a,o){const l=Ae.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform()),u=[1/0,1/0,-1/0,-1/0];Ae.axialAlignedBoundingBox([n,a,i,o],l,u);const h=Ae.intersect(this.#n,u);return h?(this.#n[0]=h[0],this.#n[1]=h[1],this.#n[2]=h[2],this.#n[3]=h[3]):(this.#n[0]=this.#n[1]=1/0,this.#n[2]=this.#n[3]=-1/0),this}recordBBox(e,t,n,i,a,o){const l=this.#n;if(l[0]===1/0)return this;const u=Ae.multiplyByDOMMatrix(this.#i.at(-1),t.getTransform());if(l[0]===-1/0)return Ae.axialAlignedBoundingBox([n,a,i,o],u,this.#o),this;const h=[1/0,1/0,-1/0,-1/0];return Ae.axialAlignedBoundingBox([n,a,i,o],u,h),this.#o[0]=Math.min(this.#o[0],Math.max(h[0],l[0])),this.#o[1]=Math.min(this.#o[1],Math.max(h[1],l[1])),this.#o[2]=Math.max(this.#o[2],Math.min(h[2],l[2])),this.#o[3]=Math.max(this.#o[3],Math.min(h[3],l[3])),this}recordCharacterBBox(e,t,n,i=1,a=0,o=0,l){const u=n.bbox;let h,c;if(u&&(h=u[2]!==u[0]&&u[3]!==u[1]&&this.#u.get(n),h!==!1&&(c=[0,0,0,0],Ae.axialAlignedBoundingBox(u,n.fontMatrix,c),(i!==1||a!==0||o!==0)&&Ae.scaleMinMax([i,0,0,-i,a,o],c),h)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!l)return this.recordFullPageBBox(e);const f=l();return u&&c&&h===void 0&&(h=c[0]<=a-f.actualBoundingBoxLeft&&c[2]>=a+f.actualBoundingBoxRight&&c[1]<=o-f.actualBoundingBoxAscent&&c[3]>=o+f.actualBoundingBoxDescent,this.#u.set(n,h),h)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,a-f.actualBoundingBoxLeft,a+f.actualBoundingBoxRight,o-f.actualBoundingBoxAscent,o+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#n[0]),this.#o[1]=Math.max(0,this.#n[1]),this.#o[2]=Math.min(this.#f,this.#n[2]),this.#o[3]=Math.min(this.#g,this.#n[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,i=this.#e,a=this.#t;for(const o of t)o in this.#e?n.add(i[o]):o in a&&a[o].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#r.has(t)&&this.#l.add(this.#r.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Va]),this.#m){const n=Kd(this.#m,e),{dependencies:i}=n;this.#l.forEach(i.add,i),this.#s.forEach(i.add,i),this.#a.forEach(i.add,i),i.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=jk(this.#o[0]*256/this.#f),i=jk(this.#o[1]*256/this.#g),a=wk(this.#o[2]*256/this.#f),o=wk(this.#o[3]*256/this.#g);Yd(this.#p,e,n,i,a,o);for(const l of this.#l)l!==e&&Yd(this.#p,l,n,i,a,o);for(const l of this.#s)l!==e&&Yd(this.#p,l,n,i,a,o);for(const l of this.#a)l!==e&&Yd(this.#p,l,n,i,a,o);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#n[0]=Math.max(this.#n[0],this.#o[0]),this.#n[1]=Math.max(this.#n[1],this.#o[1]),this.#n[2]=Math.min(this.#n[2],this.#o[2]),this.#n[3]=Math.min(this.#n[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#u.clear(),new EU(this.#d,this.#p)}takeDebugMetadata(){return this.#m}}class Vu{#e;#t;#r;#s=0;#a=0;constructor(e,t,n){if(e instanceof Vu&&e.#r===!!n)return e;this.#e=e,this.#t=t,this.#r=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#s++,this}getOpenMarker(){return this.#s>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#s--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#r||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,i,a,o){return this.#r||this.#e.recordClipBox(this.#t,t,n,i,a,o),this}recordBBox(e,t,n,i,a,o){return this.#r||this.#e.recordBBox(this.#t,t,n,i,a,o),this}recordCharacterBBox(e,t,n,i,a,o,l){return this.#r||this.#e.recordCharacterBBox(this.#t,t,n,i,a,o,l),this}recordFullPageBBox(e){return this.#r||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#r||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const wr={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ks={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function $x(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),r.clip(i)}class Ty{isModifyingCurrentTransform(){return!1}getPattern(){vt("Abstract method `getPattern` called.")}}class _U extends Ty{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let a;if(i===ks.STROKE||i===ks.FILL){const o=t.current.getClippedPathBoundingBox(i,It(e))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,h=t.cachedCanvases.getCanvas("pattern",l,u),c=h.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-o[0],-o[1]),n=Ae.transform(n,[1,0,0,1,o[0],o[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),$x(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),a=e.createPattern(h.canvas,"no-repeat");const f=new DOMMatrix(n);a.setTransform(f)}else $x(e,this._bbox),a=this._createGradient(e);return a}}function Ig(r,e,t,n,i,a,o,l){const u=e.coords,h=e.colors,c=r.data,f=r.width*4;let m;u[t+1]>u[n+1]&&(m=t,t=n,n=m,m=a,a=o,o=m),u[n+1]>u[i+1]&&(m=n,n=i,i=m,m=o,o=l,l=m),u[t+1]>u[n+1]&&(m=t,t=n,n=m,m=a,a=o,o=m);const g=(u[t]+e.offsetX)*e.scaleX,v=(u[t+1]+e.offsetY)*e.scaleY,y=(u[n]+e.offsetX)*e.scaleX,x=(u[n+1]+e.offsetY)*e.scaleY,b=(u[i]+e.offsetX)*e.scaleX,w=(u[i+1]+e.offsetY)*e.scaleY;if(v>=w)return;const k=h[a],N=h[a+1],E=h[a+2],S=h[o],A=h[o+1],C=h[o+2],I=h[l],L=h[l+1],M=h[l+2],D=Math.round(v),F=Math.round(w);let q,B,z,G,Y,H,V,O;for(let U=D;U<=F;U++){if(U<x){const Q=U<v?0:(v-U)/(v-x);q=g-(g-y)*Q,B=k-(k-S)*Q,z=N-(N-A)*Q,G=E-(E-C)*Q}else{let Q;U>w?Q=1:x===w?Q=0:Q=(x-U)/(x-w),q=y-(y-b)*Q,B=S-(S-I)*Q,z=A-(A-L)*Q,G=C-(C-M)*Q}let K;U<v?K=0:U>w?K=1:K=(v-U)/(v-w),Y=g-(g-b)*K,H=k-(k-I)*K,V=N-(N-L)*K,O=E-(E-M)*K;const se=Math.round(Math.min(q,Y)),te=Math.round(Math.max(q,Y));let X=f*U+se*4;for(let Q=se;Q<=te;Q++)K=(q-Q)/(q-Y),K<0?K=0:K>1&&(K=1),c[X++]=B-(B-H)*K|0,c[X++]=z-(z-V)*K|0,c[X++]=G-(G-O)*K|0,c[X++]=255}}function AU(r,e,t){const n=e.coords,i=e.colors;let a,o;switch(e.type){case Ix.LATTICE:const l=e.verticesPerRow,u=Math.floor(n.length/l)-1,h=l-1;for(a=0;a<u;a++){let c=a*l;for(let f=0;f<h;f++,c++)Ig(r,t,n[c],n[c+1],n[c+l],i[c],i[c+1],i[c+l]),Ig(r,t,n[c+l+1],n[c+1],n[c+l],i[c+l+1],i[c+1],i[c+l])}break;case Ix.TRIANGLES:for(a=0,o=n.length;a<o;a+=3)Ig(r,t,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class CU extends Ty{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const l=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-l,c=Math.ceil(this._bounds[3])-u,f=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),g=h/f,v=c/m,y={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-u,scaleX:1/g,scaleY:1/v},x=f+4,b=m+4,w=n.getCanvas("mesh",x,b),k=w.context,N=k.createImageData(f,m);if(t){const S=N.data;for(let A=0,C=S.length;A<C;A+=4)S[A]=t[0],S[A+1]=t[1],S[A+2]=t[2],S[A+3]=255}for(const S of this._figures)AU(N,S,y);return k.putImageData(N,2,2),{canvas:w.canvas,offsetX:l-2*g,offsetY:u-2*v,scaleX:g,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){$x(e,this._bbox);const a=new Float32Array(2);if(i===ks.SHADING)Ae.singularValueDecompose2dScale(It(e),a);else if(this.matrix){Ae.singularValueDecompose2dScale(this.matrix,a);const[l,u]=a;Ae.singularValueDecompose2dScale(t.baseTransform,a),a[0]*=l,a[1]*=u}else Ae.singularValueDecompose2dScale(t.baseTransform,a);const o=this._createMeshCanvas(a,i===ks.SHADING?null:this._background,t.cachedCanvases);return i!==ks.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class TU extends Ty{getPattern(){return"hotpink"}}function RU(r){switch(r[0]){case"RadialAxial":return new _U(r);case"Mesh":return new CU(r);case"Dummy":return new TU}throw new Error(`Unknown IR type: ${r[0]}`)}const Nk={COLORED:1,UNCOLORED:2};class Ry{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){const{bbox:n,operatorList:i,paintType:a,tilingType:o,color:l,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:c}=this;h=Math.abs(h),c=Math.abs(c),Nh("TilingType: "+o);const f=n[0],m=n[1],g=n[2],v=n[3],y=g-f,x=v-m,b=new Float32Array(2);Ae.singularValueDecompose2dScale(this.matrix,b);const[w,k]=b;Ae.singularValueDecompose2dScale(this.baseTransform,b);const N=w*b[0],E=k*b[1];let S=y,A=x,C=!1,I=!1;const L=Math.ceil(h*N),M=Math.ceil(c*E),D=Math.ceil(y*N),F=Math.ceil(x*E);L>=D?S=h:C=!0,M>=F?A=c:I=!0;const q=this.getSizeAndScale(S,this.ctx.canvas.width,N),B=this.getSizeAndScale(A,this.ctx.canvas.height,E),z=e.cachedCanvases.getCanvas("pattern",q.size,B.size),G=z.context,Y=u.createCanvasGraphics(G,t);if(Y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Y,a,l),G.translate(-q.scale*f,-B.scale*m),Y.transform(0,q.scale,0,0,B.scale,0,0),G.save(),Y.dependencyTracker?.save(),this.clipBbox(Y,f,m,g,v),Y.baseTransform=It(Y.ctx),Y.executeOperatorList(i),Y.endDrawing(),Y.dependencyTracker?.restore(),G.restore(),C||I){const H=z.canvas;C&&(S=h),I&&(A=c);const V=this.getSizeAndScale(S,this.ctx.canvas.width,N),O=this.getSizeAndScale(A,this.ctx.canvas.height,E),U=V.size,K=O.size,se=e.cachedCanvases.getCanvas("pattern-workaround",U,K),te=se.context,X=C?Math.floor(y/h):0,Q=I?Math.floor(x/c):0;for(let ae=0;ae<=X;ae++)for(let J=0;J<=Q;J++)te.drawImage(H,U*ae,K*J,U,K,0,0,U,K);return{canvas:se.canvas,scaleX:V.scale,scaleY:O.scale,offsetX:f,offsetY:m}}return{canvas:z.canvas,scaleX:q.scale,scaleY:B.scale,offsetX:f,offsetY:m}}getSizeAndScale(e,t,n){const i=Math.max(Ry.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=i?a=i:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,i,a){const o=i-t,l=a-n;e.ctx.rect(t,n,o,l),Ae.axialAlignedBoundingBox([t,n,i,a],It(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,a=e.current;switch(t){case Nk.COLORED:const{fillStyle:o,strokeStyle:l}=this.ctx;i.fillStyle=a.fillColor=o,i.strokeStyle=a.strokeColor=l;break;case Nk.UNCOLORED:i.fillStyle=i.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new q7(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,a){let o=n;i!==ks.SHADING&&(o=Ae.transform(o,t.baseTransform),this.matrix&&(o=Ae.transform(o,this.matrix)));const l=this.createPatternCanvas(t,a);let u=new DOMMatrix(o);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const h=e.createPattern(l.canvas,"repeat");return h.setTransform(u),h}}function DU({src:r,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const l=Es.isLittleEndian?4278190080:255,[u,h]=o?[a,l]:[l,a],c=n>>3,f=n&7,m=r.length;t=new Uint32Array(t.buffer);let g=0;for(let v=0;v<i;v++){for(const x=e+c;e<x;e++){const b=e<m?r[e]:255;t[g++]=b&128?h:u,t[g++]=b&64?h:u,t[g++]=b&32?h:u,t[g++]=b&16?h:u,t[g++]=b&8?h:u,t[g++]=b&4?h:u,t[g++]=b&2?h:u,t[g++]=b&1?h:u}if(f===0)continue;const y=e<m?r[e++]:255;for(let x=0;x<f;x++)t[g++]=y&1<<7-x?h:u}return{srcPos:e,destPos:g}}const kk=16,Ek=100,PU=15,Sk=10,er=16,Bg=new DOMMatrix,dr=new Float32Array(2),ro=new Float32Array([1/0,1/0,-1/0,-1/0]);function MU(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,i,a,o,l){e.transform(t,n,i,a,o,l),this.__originalTransform(t,n,i,a,o,l)},r.setTransform=function(t,n,i,a,o,l){e.setTransform(t,n,i,a,o,l),this.__originalSetTransform(t,n,i,a,o,l)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,i,a,o,l){e.bezierCurveTo(t,n,i,a,o,l),this.__originalBezierCurveTo(t,n,i,a,o,l)},r.rect=function(t,n,i,a){e.rect(t,n,i,a),this.__originalRect(t,n,i,a)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class OU{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Xd(r,e,t,n,i,a,o,l,u,h){const[c,f,m,g,v,y]=It(r);if(f===0&&m===0){const w=o*c+v,k=Math.round(w),N=l*g+y,E=Math.round(N),S=(o+u)*c+v,A=Math.abs(Math.round(S)-k)||1,C=(l+h)*g+y,I=Math.abs(Math.round(C)-E)||1;return r.setTransform(Math.sign(c),0,0,Math.sign(g),k,E),r.drawImage(e,t,n,i,a,0,0,A,I),r.setTransform(c,f,m,g,v,y),[A,I]}if(c===0&&g===0){const w=l*m+v,k=Math.round(w),N=o*f+y,E=Math.round(N),S=(l+h)*m+v,A=Math.abs(Math.round(S)-k)||1,C=(o+u)*f+y,I=Math.abs(Math.round(C)-E)||1;return r.setTransform(0,Math.sign(f),Math.sign(m),0,k,E),r.drawImage(e,t,n,i,a,0,0,I,A),r.setTransform(c,f,m,g,v,y),[I,A]}r.drawImage(e,t,n,i,a,o,l,u,h);const x=Math.hypot(c,f),b=Math.hypot(m,g);return[x*u,b*h]}class _k{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Lx;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=js.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ro.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ks.FILL,t=null){const n=this.minMax.slice();if(e===ks.STROKE){t||vt("Stroke bounding box must include transform."),Ae.singularValueDecompose2dScale(t,dr);const i=dr[0]*this.lineWidth/2,a=dr[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const e=Ae.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ro,0)}getClippedPathBoundingBox(e=ks.FILL,t=null){return Ae.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Ak(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%er,a=(t-i)/er,o=i===0?a:a+1,l=r.createImageData(n,er);let u=0,h;const c=e.data,f=l.data;let m,g,v,y;if(e.kind===hu.GRAYSCALE_1BPP){const x=c.byteLength,b=new Uint32Array(f.buffer,0,f.byteLength>>2),w=b.length,k=n+7>>3,N=4294967295,E=Es.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(v=m<a?er:i,h=0,g=0;g<v;g++){const S=x-u;let A=0;const C=S>k?n:S*8-7,I=C&-8;let L=0,M=0;for(;A<I;A+=8)M=c[u++],b[h++]=M&128?N:E,b[h++]=M&64?N:E,b[h++]=M&32?N:E,b[h++]=M&16?N:E,b[h++]=M&8?N:E,b[h++]=M&4?N:E,b[h++]=M&2?N:E,b[h++]=M&1?N:E;for(;A<C;A++)L===0&&(M=c[u++],L=128),b[h++]=M&L?N:E,L>>=1}for(;h<w;)b[h++]=0;r.putImageData(l,0,m*er)}}else if(e.kind===hu.RGBA_32BPP){for(g=0,y=n*er*4,m=0;m<a;m++)f.set(c.subarray(u,u+y)),u+=y,r.putImageData(l,0,g),g+=er;m<o&&(y=n*i*4,f.set(c.subarray(u,u+y)),r.putImageData(l,0,g))}else if(e.kind===hu.RGB_24BPP)for(v=er,y=n*v,m=0;m<o;m++){for(m>=a&&(v=i,y=n*v),h=0,g=y;g--;)f[h++]=c[u++],f[h++]=c[u++],f[h++]=c[u++],f[h++]=255;r.putImageData(l,0,m*er)}else throw new Error(`bad image kind: ${e.kind}`)}function Ck(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%er,a=(t-i)/er,o=i===0?a:a+1,l=r.createImageData(n,er);let u=0;const h=e.data,c=l.data;for(let f=0;f<o;f++){const m=f<a?er:i;({srcPos:u}=DU({src:h,srcPos:u,dest:c,width:n,height:m,nonBlackColor:0})),r.putImageData(l,0,f*er)}}function yl(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Qd(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function Tk(r,e){if(e)return!0;Ae.singularValueDecompose2dScale(r,dr);const t=Math.fround(gn.pixelRatio*jo.PDF_TO_CSS_UNITS);return dr[0]<=t&&dr[1]<=t}const LU=["butt","round","square"],IU=["miter","round","bevel"],BU={},Rk={};class ho{constructor(e,t,n,i,a,{optionalContentConfig:o,markedContentStack:l=null},u,h,c){this.ctx=e,this.current=new _k(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new OU(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=c??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=l,n){const u=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...It(this.compositeCtx))}this.ctx.save(),Qd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=It(this.ctx)}executeOperatorList(e,t,n,i,a){const o=e.argsArray,l=e.fnArray;let u=t||0;const h=o.length;if(h===u)return u;const c=h-u>Sk&&typeof n=="function",f=c?Date.now()+PU:0;let m=0;const g=this.commonObjs,v=this.objs;let y,x;for(;;){if(i!==void 0&&u===i.nextBreakPoint)return i.breakIt(u,n),u;if(!a||a(u))if(y=l[u],x=o[u]??null,y!==Jl.dependency)x===null?this[y](u):this[y](u,...x);else for(const b of x){this.dependencyTracker?.recordNamedData(b,u);const w=b.startsWith("g_")?g:v;if(!w.has(b))return w.get(b,n),u}if(u++,u===h)return u;if(c&&++m>Sk){if(Date.now()>f)return n(),u;m=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=n,u=i,h="prescale1",c,f;for(;a>2&&l>1||o>2&&u>1;){let m=l,g=u;a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/m),o>2&&u>1&&(g=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/g),c=this.cachedCanvases.getCanvas(h,m,g),f=c.context,f.clearRect(0,0,m,g),f.drawImage(e,0,0,l,u,0,0,m,g),e=c.canvas,l=m,u=g,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:u}}_createMaskCanvas(e,t){const n=this.ctx,{width:i,height:a}=t,o=this.current.fillColor,l=this.current.patternFill,u=It(n);let h,c,f,m;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;c=JSON.stringify(l?u:[u.slice(0,4),o]),h=this._cachedBitmapsMap.get(L),h||(h=new Map,this._cachedBitmapsMap.set(L,h));const M=h.get(c);if(M&&!l){const D=Math.round(Math.min(u[0],u[2])+u[4]),F=Math.round(Math.min(u[1],u[3])+u[5]);return this.dependencyTracker?.recordDependencies(e,wr.transformAndFill),{canvas:M,offsetX:D,offsetY:F}}f=M}f||(m=this.cachedCanvases.getCanvas("maskCanvas",i,a),Ck(m.context,t));let g=Ae.transform(u,[1/i,0,0,-1/a,0,0]);g=Ae.transform(g,[1,0,0,1,0,-a]);const v=ro.slice();Ae.axialAlignedBoundingBox([0,0,i,a],g,v);const[y,x,b,w]=v,k=Math.round(b-y)||1,N=Math.round(w-x)||1,E=this.cachedCanvases.getCanvas("fillCanvas",k,N),S=E.context,A=y,C=x;S.translate(-A,-C),S.transform(...g),f||(f=this._scaleImage(m.canvas,sn(S)),f=f.img,h&&l&&h.set(c,f)),S.imageSmoothingEnabled=Tk(It(S),t.interpolate),Xd(S,f,0,0,f.width,f.height,0,0,i,a),S.globalCompositeOperation="source-in";const I=Ae.transform(sn(S),[1,0,0,1,-A,-C]);return S.fillStyle=l?o.getPattern(n,this,I,ks.FILL,e):o,S.fillRect(0,0,i,a),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(c,E.canvas)),this.dependencyTracker?.recordDependencies(e,wr.transformAndFill),{canvas:E.canvas,offsetX:Math.round(A),offsetY:Math.round(C)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=LU[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=IU[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,i]of t)switch(n){case"LW":this.setLineWidth(e,i);break;case"LC":this.setLineCap(e,i);break;case"LJ":this.setLineJoin(e,i);break;case"ML":this.setMiterLimit(e,i);break;case"D":this.setDash(e,i[0],i[1]);break;case"RI":this.setRenderingIntent(e,i);break;case"FL":this.setFlatness(e,i);break;case"Font":this.setFont(e,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),yl(this.suspendedCtx,o),MU(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),yl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const a=i[0],o=i[1],l=i[2]-a,u=i[3]-o;l===0||u===0||(this.genericComposeSMask(t.context,n,l,u,t.subtype,t.backdrop,t.transferMap,a,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,a,o,l,u,h,c,f){let m=e.canvas,g=u-c,v=h-f;if(o)if(g<0||v<0||g+n>m.width||v+i>m.height){const x=this.cachedCanvases.getCanvas("maskExtension",n,i),b=x.context;b.drawImage(m,-g,-v),b.globalCompositeOperation="destination-atop",b.fillStyle=o,b.fillRect(0,0,n,i),b.globalCompositeOperation="source-over",m=x.canvas,g=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(g,v,n,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(g,v,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const y=new Path2D;y.rect(u,h,n,i),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(m,g,v,n,i,u,h,n,i),t.restore()}save(e){this.inSMaskMode&&yl(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&yl(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,i,a,o,l){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,a,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[a]=n;if(!i){a||=n[0]=new Path2D,this[t](e,a);return}if(this.dependencyTracker!==null){const o=t===Jl.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-o,i[2]+o,i[1]-o,i[3]+o).recordDependencies(e,["transform"])}a instanceof Path2D||(a=n[0]=aC(a)),Ae.axialAlignedBoundingBox(i,It(this.ctx),this.current.minMax),this[t](e,a),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const i=this.ctx,a=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=a.getPattern(i,this,sn(i),ks.STROKE,e),o){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,wr.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ks.STROKE,It(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const i=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let l=!1;if(o){const h=a.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(e),i.save(),i.fillStyle=a.getPattern(i,this,sn(i),ks.FILL,e),h){const c=new Path2D;c.addPath(t,i.getTransform().invertSelf().multiplySelf(h)),t=c}l=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),this.dependencyTracker?.recordDependencies(e,wr.fill),l&&(i.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,u)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,wr.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=BU}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Rk}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,a=n.getTransform().invertSelf();for(const{transform:o,x:l,y:u,fontSize:h,path:c}of t)c&&i.addPath(c,new DOMMatrix(o).preMultiplySelf(a).translate(l,u).scale(h,-h));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),a=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=i.fontMatrix||Lx,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&$e("Invalid font matrix for font "+t),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const o=i.loadedName||"sans-serif",l=i.systemFontInfo?.css||`"${o}", ${i.fallbackName}`;let u="normal";i.black?u="900":i.bold&&(u="bold");const h=i.italic?"italic":"normal";let c=n;n<kk?c=kk:n>Ek&&(c=Ek),this.current.fontSizeScale=n/c,this.ctx.font=`${h} ${u} ${c}px ${l}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#r(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}paintChar(e,t,n,i,a,o){const l=this.ctx,u=this.current,h=u.font,c=u.textRenderingMode,f=u.fontSize/u.fontSizeScale,m=c&js.FILL_STROKE_MASK,g=!!(c&js.ADD_TO_PATH_FLAG),v=u.patternFill&&!h.missingFile,y=u.patternStroke&&!h.missingFile;let x;if((h.disableFontFace||g||v||y)&&!h.missingFile&&(x=h.getPathGenerator(this.commonObjs,t)),x&&(h.disableFontFace||v||y)){l.save(),l.translate(n,i),l.scale(f,-f),this.dependencyTracker?.recordCharacterBBox(e,l,h);let b;if(m===js.FILL||m===js.FILL_STROKE)if(a){b=l.getTransform(),l.setTransform(...a);const w=this.#r(x,b,a);l.fill(w)}else l.fill(x);if(m===js.STROKE||m===js.FILL_STROKE)if(o){b||=l.getTransform(),l.setTransform(...o);const{a:w,b:k,c:N,d:E}=b,S=Ae.inverseTransform(o),A=Ae.transform([w,k,N,E,0,0],S);Ae.singularValueDecompose2dScale(A,dr),l.lineWidth*=Math.max(dr[0],dr[1])/f,l.stroke(this.#r(x,b,o))}else l.lineWidth/=f,l.stroke(x);l.restore()}else(m===js.FILL||m===js.FILL_STROKE)&&(l.fillText(t,n,i),this.dependencyTracker?.recordCharacterBBox(e,l,h,f,n,i,()=>l.measureText(t))),(m===js.STROKE||m===js.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,l,h,f,n,i,()=>l.measureText(t)).recordDependencies(e,wr.stroke),l.strokeText(t,n,i));g&&((this.pendingTextPaths||=[]).push({transform:It(l),x:n,y:i,fontSize:f,path:x}),this.dependencyTracker?.recordCharacterBBox(e,l,h,f,n,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Xe(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,wr.showText).resetBBox(e),this.current.textRenderingMode&js.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(e);return}const o=this.ctx,l=n.fontSizeScale,u=n.charSpacing,h=n.wordSpacing,c=n.fontDirection,f=n.textHScale*c,m=t.length,g=i.vertical,v=g?1:-1,y=i.defaultVMetrics,x=a*n.fontMatrix[0],b=n.textRenderingMode===js.FILL&&!i.disableFontFace&&!n.patternFill;o.save(),n.textMatrix&&o.transform(...n.textMatrix),o.translate(n.x,n.y+n.textRise),c>0?o.scale(f,-1):o.scale(f,1);let w,k;if(n.patternFill){o.save();const C=n.fillColor.getPattern(o,this,sn(o),ks.FILL,e);w=It(o),o.restore(),o.fillStyle=C}if(n.patternStroke){o.save();const C=n.strokeColor.getPattern(o,this,sn(o),ks.STROKE,e);k=It(o),o.restore(),o.strokeStyle=C}let N=n.lineWidth;const E=n.textMatrixScale;if(E===0||N===0){const C=n.textRenderingMode&js.FILL_STROKE_MASK;(C===js.STROKE||C===js.FILL_STROKE)&&(N=this.getSinglePixelWidth())}else N/=E;if(l!==1&&(o.scale(l,l),N/=l),o.lineWidth=N,i.isInvalidPDFjsFont){const C=[];let I=0;for(const M of t)C.push(M.unicode),I+=M.width;const L=C.join("");if(o.fillText(L,0,0),this.dependencyTracker!==null){const M=o.measureText(L);this.dependencyTracker.recordBBox(e,this.ctx,-M.actualBoundingBoxLeft,M.actualBoundingBoxRight,-M.actualBoundingBoxAscent,M.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=I*x*f,o.restore(),this.compose();return}let S=0,A;for(A=0;A<m;++A){const C=t[A];if(typeof C=="number"){S+=v*C*a/1e3;continue}let I=!1;const L=(C.isSpace?h:0)+u,M=C.fontChar,D=C.accent;let F,q,B=C.width;if(g){const Y=C.vmetric||y,H=-(C.vmetric?Y[1]:B*.5)*x,V=Y[2]*x;B=Y?-Y[0]:B,F=H/l,q=(S+V)/l}else F=S/l,q=0;let z;if(i.remeasure&&B>0){z=o.measureText(M);const Y=z.width*1e3/a*l;if(B<Y&&this.isFontSubpixelAAEnabled){const H=B/Y;I=!0,o.save(),o.scale(H,1),F/=H}else B!==Y&&(F+=(B-Y)/2e3*a/l)}if(this.contentVisible&&(C.isInFont||i.missingFile)){if(b&&!D)o.fillText(M,F,q),this.dependencyTracker?.recordCharacterBBox(e,o,z?{bbox:null}:i,a/l,F,q,()=>z??o.measureText(M));else if(this.paintChar(e,M,F,q,w,k),D){const Y=F+a*D.offset.x/l,H=q-a*D.offset.y/l;this.paintChar(e,D.fontChar,Y,H,w,k)}}const G=g?B*x-L*c:B*x+L*c;S+=G,I&&o.restore()}g?n.y-=S:n.x+=S*f,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,a=i.font,o=i.fontSize,l=i.fontDirection,u=a.vertical?1:-1,h=i.charSpacing,c=i.wordSpacing,f=i.textHScale*l,m=i.fontMatrix||Lx,g=t.length,v=i.textRenderingMode===js.INVISIBLE;let y,x,b,w;if(v||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(f,l);const k=this.dependencyTracker;for(this.dependencyTracker=k?new Vu(k,e):null,y=0;y<g;++y){if(x=t[y],typeof x=="number"){w=u*x*o/1e3,this.ctx.translate(w,0),i.x+=w*f;continue}const N=(x.isSpace?c:0)+h,E=a.charProcOperatorList[x.operatorListId];E?this.contentVisible&&(this.save(),n.scale(o,o),n.transform(...m),this.executeOperatorList(E),this.restore()):$e(`Type3 character "${x.operatorListId}" is not available.`);const S=[x.width,0];Ae.applyTransform(S,m),b=S[0]*o+N,n.translate(b,0),i.x+=b*f}n.restore(),k&&(this.dependencyTracker=k)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,a,o,l){const u=new Path2D;u.rect(i,a,o-i,l-a),this.ctx.clip(u),this.dependencyTracker?.recordBBox(e,this.ctx,i,o,a,l).recordClipBox(e,this.ctx,i,o,a,l),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const i=this.baseTransform||It(this.ctx),a={createCanvasGraphics:(o,l)=>new ho(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Vu(this.dependencyTracker,l,!0):null)};n=new Ry(t,this.ctx,a,i)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=RU(this.getObject(e,t)),this.cachedPatterns.set(t,i)),n&&(i.matrix=n),i}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const i=this._getPattern(e,t);n.fillStyle=i.getPattern(n,this,sn(n),ks.SHADING,e);const a=sn(n);if(a){const{width:o,height:l}=n.canvas,u=ro.slice();Ae.axialAlignedBoundingBox([0,0,o,l],a,u);const[h,c,f,m]=u;this.ctx.fillRect(h,c,f-h,m-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,wr.transform).recordDependencies(e,wr.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){vt("Should not call beginInlineImage")}beginImageData(){vt("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=It(this.ctx),n)){Ae.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,a,o,l]=n,u=new Path2D;u.rect(i,a,o-i,l-a),this.ctx.clip(u),this.dependencyTracker?.recordClipBox(e,this.ctx,i,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Nh("TODO: Support non-isolated groups."),t.knockout&&$e("Knockout groups not supported.");const i=It(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=ro.slice();Ae.axialAlignedBoundingBox(t.bbox,It(n),a);const o=[0,0,n.canvas.width,n.canvas.height];a=Ae.intersect(a,o)||[0,0,0,0];const l=Math.floor(a[0]),u=Math.floor(a[1]),h=Math.max(Math.ceil(a[2])-l,1),c=Math.max(Math.ceil(a[3])-u,1);this.current.startNewPathAndClipBox([0,0,h,c]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(f,h,c),g=m.context;g.translate(-l,-u),g.transform(...i);let v=new Path2D;const[y,x,b,w]=t.bbox;if(v.rect(y,x,b-y,w-x),t.matrix){const k=new Path2D;k.addPath(v,new DOMMatrix(t.matrix)),v=k}g.clip(v),t.smask&&this.smaskStack.push({canvas:m.canvas,context:g,offsetX:l,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(l,u),n.save()),yl(n,g),this.ctx=g,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=It(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=ro.slice();Ae.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,o),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,n,i,a,o){if(this.#e(),Qd(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const l=n[2]-n[0],u=n[3]-n[1];if(o&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=l,n[3]=u,Ae.singularValueDecompose2dScale(It(this.ctx),dr);const{viewportScale:h}=this,c=Math.ceil(l*this.outputScaleX*h),f=Math.ceil(u*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(c,f);const{canvas:m,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(dr[0],0,0,-dr[1],0,u*dr[1]),Qd(this.ctx)}else{Qd(this.ctx),this.endPath(e);const h=new Path2D;h.rect(n[0],n[1],l,u),this.ctx.clip(h)}}this.current=new _k(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...a)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const i=this.ctx,a=this._createMaskCanvas(e,t),o=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,i=0,a=0,o,l){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const u=this.ctx;u.save();const h=It(u);u.transform(n,i,a,o,0,0);const c=this._createMaskCanvas(e,t);u.setTransform(1,0,0,1,c.offsetX-h[4],c.offsetY-h[5]),this.dependencyTracker?.resetBBox(e);for(let f=0,m=l.length;f<m;f+=2){const g=Ae.transform(h,[n,i,a,o,l[f],l[f+1]]);u.drawImage(c.canvas,g[4],g[5]),this.dependencyTracker?.recordBBox(e,this.ctx,g[4],g[4]+c.canvas.width,g[5],g[5]+c.canvas.height)}u.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,wr.transformAndFill);for(const o of t){const{data:l,width:u,height:h,transform:c}=o,f=this.cachedCanvases.getCanvas("maskCanvas",u,h),m=f.context;m.save();const g=this.getObject(e,l,o);Ck(m,g),m.globalCompositeOperation="source-in",m.fillStyle=a?i.getPattern(m,this,sn(n),ks.FILL,e):i,m.fillRect(0,0,u,h),m.restore(),n.save(),n.transform(...c),n.scale(1,-1),Xd(n,f.canvas,0,0,u,h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,u,0,h),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){$e("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,i,a){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){$e("Dependent image isn't ready yet");return}const l=o.width,u=o.height,h=[];for(let c=0,f=a.length;c<f;c+=2)h.push({transform:[n,0,0,i,a[c],a[c+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(e,o,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,i),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",a.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,i=t.height,a=this.ctx;this.save(e);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/n,-1/i);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const c=this.cachedCanvases.getCanvas("inlineImage",n,i).context;Ak(c,t),l=this.applyTransferMapsToCanvas(c)}const u=this._scaleImage(l,sn(a));a.imageSmoothingEnabled=Tk(It(a),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,a,0,n,-i,0).recordDependencies(e,wr.imageXObject).recordOperation(e),Xd(a,u.img,0,0,u.paintWidth,u.paintHeight,0,-i,n,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const i=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const o=t.width,l=t.height,h=this.cachedCanvases.getCanvas("inlineImage",o,l).context;Ak(h,t),a=this.applyTransferMapsToCanvas(h)}this.dependencyTracker?.resetBBox(e);for(const o of n)i.save(),i.transform(...o.transform),i.scale(1,-1),Xd(i,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,wr.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(i||(this.pendingClip===Rk?a.clip(t,"evenodd"):a.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=It(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:a}=this.ctx.getTransform();let o,l;if(n===0&&i===0){const u=Math.abs(t),h=Math.abs(a);if(u===h)if(e===0)o=l=1/u;else{const c=u*e;o=l=c<1?1/c:1}else if(e===0)o=1/u,l=1/h;else{const c=u*e,f=h*e;o=c<1?1/c:1,l=f<1?1/f:1}}else{const u=Math.abs(t*a-n*i),h=Math.hypot(t,n),c=Math.hypot(i,a);if(e===0)o=c/u,l=h/u;else{const f=e*u;o=c>f?c/f:1,l=h>f?h/f:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[a,o]=this.getScaleForStroking();if(a===o){n.lineWidth=(i||1)*a,n.stroke(e);return}const l=n.getLineDash();t&&n.save(),n.scale(a,o),Bg.a=1/a,Bg.d=1/o;const u=new Path2D;if(u.addPath(e,Bg),l.length>0){const h=Math.max(a,o);n.setLineDash(l.map(c=>c/h)),n.lineDashOffset/=h}n.lineWidth=i||1,n.stroke(u),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in Jl)ho.prototype[r]!==void 0&&(ho.prototype[Jl[r]]=ho.prototype[r]);class fo{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class FU{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Wa=Symbol("INTERNAL");class zU{#e=!1;#t=!1;#r=!1;#s=!0;constructor(e,{name:t,intent:n,usage:i,rbGroups:a}){this.#e=!!(e&cr.DISPLAY),this.#t=!!(e&cr.PRINT),this.name=t,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(this.#r)return this.#s;if(!this.#s)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Wa&&vt("Internal method `_setVisible` called."),this.#r=n,this.#s=t}}class UU{#e=null;#t=new Map;#r=null;#s=null;constructor(e,t=cr.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#s=e.order;for(const n of e.groups)this.#t.set(n.id,new zU(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(Wa,!1);for(const n of e.on)this.#t.get(n)._setVisible(Wa,!0);for(const n of e.off)this.#t.get(n)._setVisible(Wa,!1);this.#r=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const a=e[i];let o;if(Array.isArray(a))o=this.#a(a);else if(this.#t.has(a))o=this.#t.get(a).visible;else return $e(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Nh("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:($e(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return $e(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return $e(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return $e(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return $e(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return $e(`Unknown optional content policy ${e.policy}.`),!0}return $e(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const i=this.#t.get(e);if(!i){$e(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&this.#t.get(o)?._setVisible(Wa,!1,!0);i._setVisible(Wa,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=this.#t.get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#r===null||this.getHash()===this.#r}getOrder(){return this.#t.size?this.#s?this.#s.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new lC;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class HU{constructor(e,{disableRange:t=!1,disableStream:n=!1}){it(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:o,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,a?.length>0){const u=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((u,h)=>{this._onReceiveData({begin:u,chunk:h})}),e.addProgressListener((u,h)=>{this._onProgress({loaded:u,total:h})}),e.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(n),!0)});it(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){it(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new VU(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new qU(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class VU{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=Ey(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class qU{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function $U(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let c=l(t);return c=unescape(c),c=u(c),c=h(c),a(c)}if(t=o(r),t){const c=h(t);return a(c)}if(t=n("filename","i").exec(r),t){t=t[1];let c=l(t);return c=h(c),a(c)}function n(c,f){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(c,f){if(c){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const m=new TextDecoder(c,{fatal:!0}),g=dc(f);f=m.decode(g),e=!1}catch{}}return f}function a(c){return e&&/[\x80-\xff]/.test(c)&&(c=i("utf-8",c),e&&(c=i("iso-8859-1",c))),c}function o(c){const f=[];let m;const g=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=g.exec(c))!==null;){let[,y,x,b]=m;if(y=parseInt(y,10),y in f){if(y===0)break;continue}f[y]=[x,b]}const v=[];for(let y=0;y<f.length&&y in f;++y){let[x,b]=f[y];b=l(b),x&&(b=unescape(b),y===0&&(b=u(b))),v.push(b)}return v.join("")}function l(c){if(c.startsWith('"')){const f=c.slice(1).split('\\"');for(let m=0;m<f.length;++m){const g=f[m].indexOf('"');g!==-1&&(f[m]=f[m].slice(0,g),f.length=m+1),f[m]=f[m].replaceAll(/\\(.)/g,"$1")}c=f.join('"')}return c}function u(c){const f=c.indexOf("'");if(f===-1)return c;const m=c.slice(0,f),v=c.slice(f+1).replace(/^[^']*'/,"");return i(m,v)}function h(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,m,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,x){return String.fromCharCode(parseInt(x,16))}),i(m,v);try{v=atob(v)}catch{}return i(m,v)})}return""}function pC(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function Sh(r){return URL.parse(r)?.origin??null}function gC({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(r.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function xC(r){const e=r.get("Content-Disposition");if(e){let t=$U(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Ey(t))return t}return null}function pc(r,e){return new Hu(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function yC(r){return r===200||r===206}function vC(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function bC(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:($e(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class WU{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=pC(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return it(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new GU(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new YU(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class GU{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,vC(n,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=Sh(a.url),!yC(a.status))throw pc(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:l,suggestedLength:u}=gC({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=xC(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Si("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:bC(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class YU{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${n-1}`);const o=i.url;fetch(o,vC(a,this._withCredentials,this._abortController)).then(l=>{const u=Sh(l.url);if(u!==e._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${e._responseOrigin}".`);if(!yC(l.status))throw pc(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:bC(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Fg=200,zg=206;function KU(r){const e=r.response;return typeof e!="string"?e:dc(e).buffer}class XU{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=pC(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,o]of this.headers)t.setRequestHeader(a,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=zg):i.expectedStatus=Fg,t.responseType="arraybuffer",it(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||Fg;if(!(a===Fg&&n.expectedStatus===zg)&&a!==n.expectedStatus){n.onError(i.status);return}const l=KU(i);if(a===zg){const u=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);h?n.onDone({begin:parseInt(h[1],10),chunk:l}):($e('Missing or invalid "Content-Range" header.'),n.onError(0))}else l?n.onDone({begin:0,chunk:l}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class QU{constructor(e){this._source=e,this._manager=new XU(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return it(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new JU(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new ZU(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class JU{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Sh(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[u,...h]=l.split(": ");return[u,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=gC({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=xC(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=pc(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class ZU{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Sh(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=pc(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const eH=/^[a-z][a-z0-9\-+.]+:/i;function tH(r){if(eH.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class sH{constructor(e){this.source=e,this.url=tH(e.url),it(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return it(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new rH(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new nH(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class rH{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=pc(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Si("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class nH{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vl=Symbol("INITIAL_DATA");class jC{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:vl}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const n=this.#e[e];if(!n||n.data===vl)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==vl}delete(e){const t=this.#e[e];return!t||t.data===vl?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==vl&&(yield[e,t])}}}const iH=1e5,Dk=30;class Ls{#e=Promise.withResolvers();#t=null;#r=!1;#s=!!globalThis.FontInspector?.enabled;#a=null;#i=null;#n=0;#o=0;#c=null;#l=null;#h=0;#u=0;#f=Object.create(null);#g=[];#p=null;#d=[];#m=new WeakMap;#x=null;static#v=new Map;static#y=new Map;static#E=new WeakMap;static#N=null;static#j=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(u){u.enqueue(e),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#u=n.scale*gn.pixelRatio,this.#h=n.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:o,pageY:l}=n.rawDims;this.#x=[1,0,0,-1,-o,l+a],this.#o=i,this.#n=a,Ls.#C(),ha(t,n),this.#e.promise.finally(()=>{Ls.#j.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Es.platform;return Xe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#f,t.styles),this.#_(t.items),e()},this.#e.reject)};return this.#c=this.#p.getReader(),Ls.#j.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*gn.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,ha(this.#l,{rotation:i})),n!==this.#u){t?.(),this.#u=n;const a={div:null,properties:null,ctx:Ls.#T(this.#a)};for(const o of this.#d)a.properties=this.#m.get(o),a.div=o,this.#k(a)}}cancel(){const e=new Si("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#d}get textContentItemsStr(){return this.#g}#_(e){if(this.#r)return;this.#i.ctx??=Ls.#T(this.#a);const t=this.#d,n=this.#g;for(const i of e){if(t.length>iH){$e("Ignoring additional textDivs for performance reasons."),this.#r=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id&&this.#t.setAttribute("id",`${i.id}`),a.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(i.str),this.#b(i)}}#b(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#d.push(t);const i=Ae.transform(this.#x,e.transform);let a=Math.atan2(i[1],i[0]);const o=this.#f[e.fontName];o.vertical&&(a+=Math.PI/2);let l=this.#s&&o.fontSubstitution||o.fontFamily;l=Ls.fontFamilyMap.get(l)||l;const u=Math.hypot(i[2],i[3]),h=u*Ls.#I(l,o,this.#a);let c,f;a===0?(c=i[4],f=i[5]-h):(c=i[4]+h*Math.sin(a),f=i[5]-h*Math.cos(a));const m="calc(var(--total-scale-factor) *",g=t.style;this.#t===this.#l?(g.left=`${(100*c/this.#o).toFixed(2)}%`,g.top=`${(100*f/this.#n).toFixed(2)}%`):(g.left=`${m}${c.toFixed(2)}px)`,g.top=`${m}${f.toFixed(2)}px)`),g.fontSize=`${m}${(Ls.#N*u).toFixed(2)}px)`,g.fontFamily=l,n.fontSize=u,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#s&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);y!==x&&Math.max(y,x)/Math.min(y,x)>1.5&&(v=!0)}if(v&&(n.canvasWidth=o.vertical?e.height:e.width),this.#m.set(t,n),this.#i.div=t,this.#i.properties=n,this.#k(this.#i),n.hasText&&this.#t.append(t),n.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this.#t.append(y)}}#k(e){const{div:t,properties:n,ctx:i}=e,{style:a}=t;let o="";if(Ls.#N>1&&(o=`scale(${1/Ls.#N})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=a,{canvasWidth:u,fontSize:h}=n;Ls.#A(i,h*this.#u,l);const{width:c}=i.measureText(t.textContent);c>0&&(o=`scaleX(${u*this.#u/c}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#j.size>0)){this.#v.clear();for(const{canvas:e}of this.#y.values())e.remove();this.#y.clear()}}static#T(e=null){let t=this.#y.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(e,t),this.#E.set(t,{size:0,family:""})}return t}static#A(e,t,n){const i=this.#E.get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)}static#C(){if(this.#N!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#N=e.getBoundingClientRect().height,e.remove()}static#I(e,t,n){const i=this.#v.get(e);if(i)return i;const a=this.#T(n);a.canvas.width=a.canvas.height=Dk,this.#A(a,Dk,e);const o=a.measureText(""),l=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let h=.8;return l?h=l/(l+u):(Es.platform.isFirefox&&$e("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),this.#v.set(e,h),h}}const aH=100;function wC(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new Dy,{docId:t}=e,n=r.url?fU(r.url):null,i=r.data?mU(r.data):null,a=r.httpHeaders||null,o=r.withCredentials===!0,l=r.password??null,u=r.range instanceof NC?r.range:null,h=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let c=r.worker instanceof ec?r.worker:null;const f=r.verbosity,m=typeof r.docBaseUrl=="string"&&!kh(r.docBaseUrl)?r.docBaseUrl:null,g=Wd(r.cMapUrl),v=r.cMapPacked!==!1,y=r.CMapReaderFactory||(Is?wU:yk),x=Wd(r.iccUrl),b=Wd(r.standardFontDataUrl),w=r.StandardFontDataFactory||(Is?NU:vk),k=Wd(r.wasmUrl),N=r.WasmFactory||(Is?kU:bk),E=r.stopAtErrors!==!0,S=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,A=r.isEvalSupported!==!1,C=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Is,I=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Is&&(Es.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,M=typeof r.disableFontFace=="boolean"?r.disableFontFace:Is,D=r.fontExtraProperties===!0,F=r.enableXfa===!0,q=r.ownerDocument||globalThis.document,B=r.disableRange===!0,z=r.disableStream===!0,G=r.disableAutoFetch===!0,Y=r.pdfBug===!0,H=r.CanvasFactory||(Is?jU:yU),V=r.FilterFactory||(Is?bU:vU),O=r.enableHWA===!0,U=r.useWasm!==!1,K=u?u.length:r.length??NaN,se=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Is&&!M,te=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(y===yk&&w===vk&&N===bk&&g&&b&&k&&El(g,document.baseURI)&&El(b,document.baseURI)&&El(k,document.baseURI)),X=null;U7(f);const Q={canvasFactory:new H({ownerDocument:q,enableHWA:O}),filterFactory:new V({docId:t,ownerDocument:q}),cMapReaderFactory:te?null:new y({baseUrl:g,isCompressed:v}),standardFontDataFactory:te?null:new w({baseUrl:b}),wasmFactory:te?null:new N({baseUrl:k})};c||(c=ec.create({verbosity:f,port:fo.workerPort}),e._worker=c);const ae={docId:t,apiVersion:"5.4.394",data:i,password:l,disableAutoFetch:G,rangeChunkSize:h,length:K,docBaseUrl:m,enableXfa:F,evaluatorOptions:{maxImageSize:S,disableFontFace:M,ignoreErrors:E,isEvalSupported:A,isOffscreenCanvasSupported:C,isImageDecoderSupported:I,canvasMaxAreaInBytes:L,fontExtraProperties:D,useSystemFonts:se,useWasm:U,useWorkerFetch:te,cMapUrl:g,iccUrl:x,standardFontDataUrl:b,wasmUrl:k}},J={ownerDocument:q,pdfBug:Y,styleElement:X,loadingParams:{disableAutoFetch:G,enableXfa:F}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const ue=c.messageHandler.sendWithPromise("GetDocRequest",ae,i?[i.buffer]:null);let we;if(u)we=new HU(u,{disableRange:B,disableStream:z});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const _e=El(n)?WU:Is?sH:QU;we=new _e({url:n,length:K,httpHeaders:a,withCredentials:o,rangeChunkSize:h,disableRange:B,disableStream:z})}return ue.then(_e=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const Ce=new Sl(t,_e,c.port),Le=new cH(Ce,e,we,J,Q,O);e._transport=Le,Ce.send("Ready",null)})}).catch(e._capability.reject),e}class Dy{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Dy.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class NC{#e=Promise.withResolvers();#t=[];#r=[];#s=[];#a=[];constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#s.push(e)}addProgressiveReadListener(e){this.#r.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#a)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#s)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#r)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){vt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class oH{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class lH{#e=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new uk:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new jC,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new hc({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:i="display",annotationMode:a=ui.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:u=null,annotationCanvasMap:h=null,pageColors:c=null,printAnnotationStorage:f=null,isEditing:m=!1,recordOperations:g=!1,operationsFilter:v=null}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(i,a,f,m),{renderingIntent:x,cacheKey:b}=y;this.#e=!1,u||=this._transport.getOptionalContentConfig(x);let w=this._intentStates.get(b);w||(w=Object.create(null),this._intentStates.set(b,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const k=!!(x&cr.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const N=!!(this._pdfBug&&globalThis.StepperManager?.enabled),E=!this.recordedBBoxes&&(g||N),S=I=>{if(w.renderTasks.delete(A),E){const L=A.gfx?.dependencyTracker.take();L&&(A.stepper&&A.stepper.setOperatorBBoxes(L,A.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=L))}k&&(this.#e=!0),this.#t(),I?(A.capability.reject(I),this._abortOperatorList({intentState:w,reason:I instanceof Error?I:new Error(I)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new no({callback:S,params:{canvas:t,canvasContext:e,dependencyTracker:E?new SU(t,w.operatorList.length,N):null,viewport:n,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:c,enableHWA:this._transport.enableHWA,operationsFilter:v});(w.renderTasks||=new Set).add(A);const C=A.task;return Promise.all([w.displayReadyCapability.promise,u]).then(([I,L])=>{if(this.destroyed){S();return}if(this._stats?.time("Rendering"),!(L.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:I,optionalContentConfig:L}),A.operatorListChanged()}).catch(S),C}getOperatorList({intent:e="display",annotationMode:t=ui.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function a(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(e,t,n,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let u;return l.opListReadCapability||(u=Object.create(null),u.operatorListChanged=a,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(u),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Zl.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function a(){o.read().then(function({value:u,done:h}){if(h){n(l);return}l.lang??=u.lang,Object.assign(l.styles,u.styles),l.items.push(...u.items),a()},i)}const o=t.getReader(),l={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new uk),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:o}=n,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:i},o).getReader(),h=this._intentStates.get(t);h.streamReader=u;const c=()=>{u.read().then(({value:f,done:m})=>{if(m){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,h),c())},f=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const m of h.renderTasks)m.operatorListChanged();this.#t()}if(h.displayReadyCapability)h.displayReadyCapability.reject(f);else if(h.opListReadCapability)h.opListReadCapability.reject(f);else throw f}})};c()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof ky){let i=aH;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Si(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var hi,zr,Cn,ta,$u,sa,ra,Hs,fu,kC,EC,_l,mo,mu;const Dt=class Dt{constructor({name:e=null,port:t=null,verbosity:n=H7()}={}){en(this,Hs);en(this,hi,Promise.withResolvers());en(this,zr,null);en(this,Cn,null);en(this,ta,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Rt(Dt,ra).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Rt(Dt,ra).set(t,this),tn(this,Hs,kC).call(this,t)}else tn(this,Hs,EC).call(this)}get promise(){return Rt(this,hi).promise}get port(){return Rt(this,Cn)}get messageHandler(){return Rt(this,zr)}destroy(){this.destroyed=!0,Rt(this,ta)?.terminate(),Qs(this,ta,null),Rt(Dt,ra).delete(Rt(this,Cn)),Qs(this,Cn,null),Rt(this,zr)?.destroy(),Qs(this,zr,null)}static create(e){const t=Rt(this,ra).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Dt(e)}static get workerSrc(){if(fo.workerSrc)return fo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Xe(this,"_setupFakeWorkerGlobal",(async()=>Rt(this,mo,mu)?Rt(this,mo,mu):(await import(this.workerSrc)).WorkerMessageHandler)())}};hi=new WeakMap,zr=new WeakMap,Cn=new WeakMap,ta=new WeakMap,$u=new WeakMap,sa=new WeakMap,ra=new WeakMap,Hs=new WeakSet,fu=function(){Rt(this,hi).resolve(),Rt(this,zr).send("configure",{verbosity:this.verbosity})},kC=function(e){Qs(this,Cn,e),Qs(this,zr,new Sl("main","worker",e)),Rt(this,zr).on("ready",()=>{}),tn(this,Hs,fu).call(this)},EC=function(){if(Rt(Dt,sa)||Rt(Dt,mo,mu)){tn(this,Hs,_l).call(this);return}let{workerSrc:e}=Dt;try{Dt._isSameOrigin(window.location,e)||(e=Dt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Sl("main","worker",t),i=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?Rt(this,hi).reject(new Error("Worker was destroyed")):tn(this,Hs,_l).call(this)},a=new AbortController;t.addEventListener("error",()=>{Rt(this,ta)||i()},{signal:a.signal}),n.on("test",l=>{if(a.abort(),this.destroyed||!l){i();return}Qs(this,zr,n),Qs(this,Cn,t),Qs(this,ta,t),tn(this,Hs,fu).call(this)}),n.on("ready",l=>{if(a.abort(),this.destroyed){i();return}try{o()}catch{tn(this,Hs,_l).call(this)}});const o=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};o();return}catch{Nh("The worker has been disabled.")}tn(this,Hs,_l).call(this)},_l=function(){Rt(Dt,sa)||($e("Setting up fake worker."),Qs(Dt,sa,!0)),Dt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Rt(this,hi).reject(new Error("Worker was destroyed"));return}const t=new xU;Qs(this,Cn,t);const n=`fake${xj(Dt,$u)._++}`,i=new Sl(n+"_worker",n,t);e.setup(i,t),Qs(this,zr,new Sl(n,n+"_worker",t)),tn(this,Hs,fu).call(this)}).catch(e=>{Rt(this,hi).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},mo=new WeakSet,mu=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},en(Dt,mo),en(Dt,$u,0),en(Dt,sa,!1),en(Dt,ra,new WeakMap),Is&&(Qs(Dt,sa,!0),fo.workerSrc||="./pdf.worker.mjs"),Dt._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const i=new URL(t,n);return n.origin===i.origin},Dt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Dt.fromPort=e=>{if(eU("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Dt.create(e)};let ec=Dt;class cH{#e=new Map;#t=new Map;#r=new Map;#s=new Map;#a=null;constructor(e,t,n,i,a,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new jC,this.fontLoader=new uU({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#i(e,t=null){const n=this.#e.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Xe(this,"annotationStorage",new Ay)}getRenderingIntent(e,t=ui.ENABLE,n=null,i=!1,a=!1){let o=cr.DISPLAY,l=Hx;switch(e){case"any":o=cr.ANY;break;case"display":break;case"print":o=cr.PRINT;break;default:$e(`getRenderingIntent - invalid intent: ${e}`)}const u=o&cr.PRINT&&n instanceof cC?n:this.annotationStorage;switch(t){case ui.DISABLE:o+=cr.ANNOTATIONS_DISABLE;break;case ui.ENABLE:break;case ui.ENABLE_FORMS:o+=cr.ANNOTATIONS_FORMS;break;case ui.ENABLE_STORAGE:o+=cr.ANNOTATIONS_STORAGE,l=u.serializable;break;default:$e(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=cr.IS_EDITING),a&&(o+=cr.OPLIST);const{ids:h,hash:c}=u.modifiedIds,f=[o,l.hash,c];return{renderingIntent:o,cacheKey:f.join("_"),annotationStorageSerializable:l,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#r.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ls.cleanup(),this._networkStream?.cancelAllRequests(new Si("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{it(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){i.close();return}it(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:o}=this._fullReader;return(!i||!a)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{t.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:o}}),e.on("GetRangeReader",(n,i)=>{it(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:o,done:l}){if(l){i.close();return}it(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{a.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new oH(n,this))}),e.on("DocException",n=>{t._capability.reject(Zs(n))}),e.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw Zs(n);const i=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};t.onPassword(i,n.code)}catch(i){this.#a.reject(i)}return this.#a.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in a){const f=a.error;$e(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const o=new yt(a),l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,m)=>globalThis.FontInspector.fontAdded(f,m):null,u=new hU(o,l,a.extra,a.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(n,u)});break;case"CopyLocalImage":const{imageRef:h}=a;it(h,"The imageRef must be defined.");for(const f of this.#t.values())for(const[,m]of f.objs)if(m?.ref===h)return m.dataLen?(this.commonObjs.resolve(n,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(n,a);break;case"Pattern":const c=new us(a);this.commonObjs.resolve(n,c.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,a,o])=>{if(this.destroyed)return;const l=this.#t.get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":l.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&$e("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#r.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#s.set(a.refStr,e);const o=new lH(t,a,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#r.set(t,i),i}getPageIndex(e){return Vx(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new UU(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new FU(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ls.cleanup()}}cachedPageNumber(e){if(!Vx(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#s.get(t)??null}}class dH{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class no{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:o,pageIndex:l,canvasFactory:u,filterFactory:h,useRequestAnimationFrame:c=!1,pdfBug:f=!1,pageColors:m=null,enableHWA:g=!1,operationsFilter:v=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=h,this._pdfBug=f,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new dH(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(no.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");no.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:a,dependencyTracker:o}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ho(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),no.#t.delete(this._canvas),e||=new ky(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),no.#t.delete(this._canvas),this.callback())))}}const SC="5.4.394",uH="2cc809ade";class kr{#e=null;#t=null;#r;#s=null;#a=!1;#i=!1;#n=null;#o;#c=null;#l=null;static#h=null;static get _keyboardManager(){return Xe(this,"_keyboardManager",new mc([[["Escape","mac+Escape"],kr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],kr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],kr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],kr.prototype._moveToPrevious],[["Home","mac+Home"],kr.prototype._moveToBeginning],[["End","mac+End"],kr.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#n=e):this.#i=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#r=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",kr.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#n&&(e.ariaControls=`${this.#n.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#p.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#r,e.append(n),e}renderMainDropdown(){const e=this.#s=this.#u();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#u(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Cr,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#n&&(e.id=`${this.#n.id}_colorpicker_dropdown`);for(const[n,i]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",kr.#h[n]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=i,a.ariaSelected=i===this.#r,a.addEventListener("click",this.#f.bind(this,i),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:nt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#p(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#m){this.#p(e);return}if(e.target===this.#e){this.#s.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#s?.firstChild||e.target===this.#e){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#m){this.#p(e);return}this.#s.firstChild?.focus()}_moveToEnd(e){if(!this.#m){this.#p(e);return}this.#s.lastChild?.focus()}#g(e){kr._keyboardManager.exec(this,e)}#p(e){if(this.#m){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#d.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#s){this.#s.classList.remove("hidden");return}const t=this.#s=this.#u();this.#e.append(t)}#d(e){this.#s?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#m(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#m){this.#n?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#s)return;const t=this.#l.highlightColors.values();for(const n of this.#s.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#s?.remove(),this.#s=null}}class tc{#e=null;#t=null;#r=null;static#s=null;constructor(e){this.#t=e,this.#r=e._uiManager,tc.#s||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,i=this.#e=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",tc.#s[e]),i.addEventListener("input",()=>{this.#r.updateParams(t,i.value)},{signal:this.#r._signal}),i}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function Pk(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function bl(r){return Math.max(0,Math.min(255,255*r))}class Mk{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=bl(e),[e,e,e]}static G_HTML([e]){const t=Pk(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(bl)}static RGB_HTML(e){return`#${e.map(Pk).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[bl(1-Math.min(1,e+i)),bl(1-Math.min(1,n+i)),bl(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,a=1-t,o=1-n,l=Math.min(i,a,o);return["CMYK",i,a,o,l]}}class hH{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){vt("Abstract method `_createSVG` called.")}}class qu extends hH{_createSVG(e){return document.createElementNS(_n,e)}}const fH=9,fa=new WeakSet,mH=new Date().getTimezoneOffset()*60*1e3;class Ug{static create(e){switch(e.data.annotationType){case ts.LINK:return new Py(e);case ts.TEXT:return new gH(e);case ts.WIDGET:switch(e.data.fieldType){case"Tx":return new xH(e);case"Btn":return e.data.radioButton?new _C(e):e.data.checkBox?new vH(e):new bH(e);case"Ch":return new jH(e);case"Sig":return new yH(e)}return new ya(e);case ts.POPUP:return new Wx(e);case ts.FREETEXT:return new AC(e);case ts.LINE:return new NH(e);case ts.SQUARE:return new kH(e);case ts.CIRCLE:return new EH(e);case ts.POLYLINE:return new CC(e);case ts.CARET:return new _H(e);case ts.INK:return new My(e);case ts.POLYGON:return new SH(e);case ts.HIGHLIGHT:return new TC(e);case ts.UNDERLINE:return new AH(e);case ts.SQUIGGLY:return new CH(e);case ts.STRIKEOUT:return new TH(e);case ts.STAMP:return new RC(e);case ts.FILEATTACHMENT:return new RH(e);default:return new Ut(e)}}}class Ut{#e=null;#t=!1;#r=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ut._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:i}=this.data;let a=-1/0,o=-1/0;if(t?.length>=8){for(let l=0;l<t.length;l+=8)t[l+1]>o?(o=t[l+1],a=t[l+2]):t[l+1]===o&&(a=Math.max(a,t[l+2]));return[a,o]}if(n?.length>=1){for(const l of n)for(let u=0,h=l.length;u<h;u+=2)l[u+1]>o?(o=l[u+1],a=l[u]):l[u+1]===o&&(a=Math.max(a,l[u]));if(a!==1/0)return[a,o]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-a)/n,e[1]=100*(e[1]-o)/i,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${Ql}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Ql}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#r?.popup||this.popup)?.remove(),this.#r=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#s(t);let i=this.#r?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#r.popup),i&&(i.updateEdited(e),n?.deleted&&(i.remove(),this.#r=null,this.popup=null))}resetEdited(){this.#e&&(this.#s(this.#e.rect),this.#r?.popup.resetEdited(),this.#e=null)}#s(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-l)/a}%`,t.top=`${100*(o-e[3]+u)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),!(this instanceof ya)&&!(this instanceof Py)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof Wx){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,a),a}const{width:l,height:u}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(y>0||x>0){const w=`calc(${y}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof _C){const w=`calc(${l}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case $a.SOLID:o.borderStyle="solid";break;case $a.DASHED:o.borderStyle="dashed";break;case $a.BEVELED:$e("Unimplemented border style: beveled");break;case $a.INSET:$e("Unimplemented border style: inset");break;case $a.UNDERLINE:o.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(this.#t=!0,o.borderColor=Ae.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):o.borderWidth=0}const h=Ae.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:f,pageX:m,pageY:g}=i.rawDims;o.left=`${100*(h[0]-m)/c}%`,o.top=`${100*(h[1]-g)/f}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(o.width=`${100*l/c}%`,o.height=`${100*u/f}%`):this.setRotation(v,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:a,height:o}=this;e%180!==0&&([a,o]=[o,a]),t.style.width=`${100*a/n}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const a=i.detail[t],o=a[0],l=a.slice(1);i.target.style[n]=Mk[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:Mk[`${o}_rgb`](l)})};return Xe(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||n[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,a]of Object.entries(t)){const o=n[i];if(o){const l={detail:{[i]:a},target:e};o(l),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,a]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,x,b,w]=e.subarray(2,6);if(i===y&&a===x&&t===b&&n===w)return}const{style:o}=this.container;let l;if(this.#t){const{borderColor:y,borderWidth:x}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const u=i-t,h=a-n,{svgFactory:c}=this,f=c.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const m=c.createElement("defs");f.append(m);const g=c.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),m.append(g);for(let y=2,x=e.length;y<x;y+=8){const b=e[y],w=e[y+1],k=e[y+2],N=e[y+3],E=c.createElement("rect"),S=(k-t)/u,A=(a-w)/h,C=(b-k)/u,I=(w-N)/h;E.setAttribute("x",S),E.setAttribute("y",A),E.setAttribute("width",C),E.setAttribute("height",I),g.append(E),l?.push(`<rect vector-effect="non-scaling-stroke" x="${S}" y="${A}" width="${C}" height="${I}"/>`)}this.#t&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(f),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),this.#r=new Wx({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#r||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#r}render(){vt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:a,id:o,exportValues:l}of i){if(a===-1||o===t)continue;const u=typeof l=="string"?l:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!fa.has(h)){$e(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:u,domElement:h})}return n}for(const i of document.getElementsByName(e)){const{exportValue:a}=i,o=i.getAttribute("data-element-id");o!==t&&fa.has(i)&&n.push({id:o,exportValue:a,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class pH extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Py extends Ut{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(this.#r(n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",i=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#r(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const a=n.get(i);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){$e('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:i,refs:a,include:o}=t,l=[];if(i.length!==0||a.length!==0){const c=new Set(a);for(const f of i){const m=this._fieldObjects[f]||[];for(const{id:g}of m)c.add(g)}for(const f of Object.values(this._fieldObjects))for(const m of f)c.has(m.id)===o&&l.push(m)}else for(const c of Object.values(this._fieldObjects))l.push(...c);const u=this.annotationStorage,h=[];for(const c of l){const{id:f}=c;switch(h.push(f),c.type){case"text":{const g=c.defaultValue||"";u.setValue(f,{value:g});break}case"checkbox":case"radiobutton":{const g=c.defaultValue===c.exportValues;u.setValue(f,{value:g});break}case"combobox":case"listbox":{const g=c.defaultValue||"";u.setValue(f,{value:g});break}default:continue}const m=document.querySelector(`[data-element-id="${f}"]`);if(m){if(!fa.has(m)){$e(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class gH extends Ut{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class ya extends Ut{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Es.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,a){n.includes("mouse")?e.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(o)}})})}_setEventListeners(e,t,n,i){for(const[a,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,o,i),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ae.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||fH,a=e.style;let o;const l=2,u=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-l),c=Math.round(h/(Pg*i))||1,f=h/c;o=Math.min(i,u(f/Pg))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,u(h/Pg))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=Ae.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class xH extends ya{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const a=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),a.setValue(o.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let a=i.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let l=i.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:a,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=l??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",l??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),fa.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:h,datetimeType:c,timeStep:f}=this.data,m=!!c&&this.enableScripting;h&&(n.title=h),this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",v=>{e.setValue(t,{value:v.target.value}),this.setPropertyOnSiblings(n,"value",v.target.value,"value"),u.formattedValue=null}),n.addEventListener("resetform",v=>{const y=this.data.defaultFieldValue??"";n.value=u.userValue=y,u.formattedValue=null});let g=v=>{const{formattedValue:y}=u;y!=null&&(v.target.value=y),v.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",y=>{if(u.focused)return;const{target:x}=y;if(m&&(x.type=c,f&&(x.step=f)),u.userValue){const b=u.userValue;if(m)if(c==="time"){const w=new Date(b),k=[w.getHours(),w.getMinutes(),w.getSeconds()];x.value=k.map(N=>N.toString().padStart(2,"0")).join(":")}else x.value=new Date(b-mH).toISOString().split(c==="date"?"T":".",1)[0];else x.value=b}u.lastCommittedValue=x.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),n.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const x={value(b){u.userValue=b.detail.value??"",m||e.setValue(t,{value:u.userValue.toString()}),b.target.value=u.userValue},formattedValue(b){const{formattedValue:w}=b.detail;u.formattedValue=w,w!=null&&b.target!==document.activeElement&&(b.target.value=w);const k={formattedValue:w};m&&(k.value=w),e.setValue(t,k)},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{const{charLimit:w}=b.detail,{target:k}=b;if(w===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",w);let N=u.userValue;!N||N.length<=w||(N=N.slice(0,w),k.value=u.userValue=N,e.setValue(t,{value:N}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(x,y)}),n.addEventListener("keydown",y=>{u.commitKey=1;let x=-1;if(y.key==="Escape"?x=0:y.key==="Enter"&&!this.data.multiLine?x=2:y.key==="Tab"&&(u.commitKey=3),x===-1)return;const{value:b}=y.target;u.lastCommittedValue!==b&&(u.lastCommittedValue=b,u.userValue=b,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:x,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const v=g;g=null,n.addEventListener("blur",y=>{if(!u.focused||!y.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{target:x}=y;let{value:b}=x;if(m){if(b&&c==="time"){const w=b.split(":").map(k=>parseInt(k,10));b=new Date(2e3,0,1,w[0],w[1],w[2]||0).valueOf(),x.step=""}else b.includes("T")||(b=`${b}T00:00`),b=new Date(b).valueOf();x.type="text"}u.userValue=b,u.lastCommittedValue!==b&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:u.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),v(y)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",y=>{u.lastCommittedValue=null;const{data:x,target:b}=y,{value:w,selectionStart:k,selectionEnd:N}=b;let E=k,S=N;switch(y.inputType){case"deleteWordBackward":{const A=w.substring(0,k).match(/\w*[^\w]*$/);A&&(E-=A[0].length);break}case"deleteWordForward":{const A=w.substring(k).match(/^[^\w]*\w*/);A&&(S+=A[0].length);break}case"deleteContentBackward":k===N&&(E-=1);break;case"deleteContentForward":k===N&&(S+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:x||"",willCommit:!1,selStart:E,selEnd:S}})}),this._setEventListeners(n,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(g&&n.addEventListener("blur",g),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class yH extends ya{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class vH extends ya{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return fa.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:l,checked:u}=o.target;for(const h of this._getElementsByName(l,n)){const c=u&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=c),e.setValue(h.id,{value:c})}e.setValue(n,{value:u})}),a.addEventListener("resetform",o=>{const l=t.defaultFieldValue||"Off";o.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const l={value(u){u.target.checked=u.detail.value!=="Off",e.setValue(n,{value:u.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class _C extends ya{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const a=document.createElement("input");if(fa.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:l,checked:u}=o.target;for(const h of this._getElementsByName(l,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:u})}),a.addEventListener("resetform",o=>{const l=t.defaultFieldValue;o.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;a.addEventListener("updatefromsandbox",l=>{const u={value:h=>{const c=o===h.detail.value;for(const f of this._getElementsByName(h.target.name)){const m=c&&f.id===n;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class bH extends Py{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class jH extends ya{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");fa.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{const f=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===f});for(const c of this.data.options){const f=document.createElement("option");f.textContent=c.displayValue,f.value=c.exportValue,n.value.includes(c.exportValue)&&(f.setAttribute("selected",!0),a=!1),i.append(f)}let o=null;if(a){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),o=()=>{c.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=c=>{const f=c?"value":"textContent",{options:m,multiple:g}=i;return g?Array.prototype.filter.call(m,v=>v.selected).map(v=>v[f]):m.selectedIndex===-1?null:m[m.selectedIndex][f]};let u=l(!1);const h=c=>{const f=c.target.options;return Array.prototype.map.call(f,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{const f={value(m){o?.();const g=m.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(const y of i.options)y.selected=v.has(y.value);e.setValue(t,{value:l(!0)}),u=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const g=i.options,v=m.detail.remove;g[v].selected=!1,i.remove(v),g.length>0&&Array.prototype.findIndex.call(g,x=>x.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:l(!0),items:h(m)}),u=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),u=l(!1)},insert(m){const{index:g,displayValue:v,exportValue:y}=m.detail.insert,x=i.children[g],b=document.createElement("option");b.textContent=v,b.value=y,x?x.before(b):i.append(b),e.setValue(t,{value:l(!0),items:h(m)}),u=l(!1)},items(m){const{items:g}=m.detail;for(;i.length!==0;)i.remove(0);for(const v of g){const{displayValue:y,exportValue:x}=v,b=document.createElement("option");b.textContent=y,b.value=x,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:l(!0),items:h(m)}),u=l(!1)},indices(m){const g=new Set(m.detail.indices);for(const v of m.target.options)v.selected=g.has(v.index);e.setValue(t,{value:l(!0)}),u=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(f,c)}),i.addEventListener("input",c=>{const f=l(!0),m=l(!1);e.setValue(t,{value:f}),c.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:u,change:m,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Wx extends Ut{constructor(e){const{data:t,elements:n,parent:i}=e,a=!!i._commentManager;if(super(e,{isRenderable:!a&&Ut._hasPopupData(t)}),this.elements=n,a&&Ut._hasPopupData(t)){const o=this.popup=this.#e();for(const l of n)l.popup=o}else this.popup=null}#e(){return new wH({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${so}${i}`).join(",")),this.container}}class wH{#e=null;#t=this.#q.bind(this);#r=this.#F.bind(this);#s=this.#P.bind(this);#a=this.#w.bind(this);#i=null;#n=null;#o=null;#c=null;#l=null;#h=null;#u=null;#f=!1;#g=null;#p=null;#d=null;#m=null;#x=null;#v=null;#y=null;#E=null;#N=null;#j=null;#_=!1;#b=null;#k=null;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:a,contentsObj:o,richText:l,parent:u,rect:h,parentRect:c,open:f,commentManager:m=null}){this.#n=e,this.#N=i,this.#o=o,this.#E=l,this.#h=u,this.#i=t,this.#y=h,this.#u=c,this.#l=n,this.#e=m,this.#b=n[0],this.#c=Fx.toDateObject(a),this.trigger=n.flatMap(g=>g.getElementsToTriggerPopup()),m||(this.#T(),this.#n.hidden=!0,f&&this.#w())}#T(){if(this.#p)return;this.#p=new AbortController;const{signal:e}=this.#p;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#s,{signal:e}),t.addEventListener("pointerleave",this.#r,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#A(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#x=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#m){this.#m.parentNode||this.#b.container.after(this.#m);return}if(this.#x||this.#A(),!this.#x)return;const{signal:e}=this.#p=new AbortController,t=this.#b.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},a=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#m=this.#b.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=this.#m=document.createElement("button");o.className="annotationCommentButton";const l=this.#b.container;o.style.zIndex=l.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#I(),this.#C(),o.addEventListener("keydown",this.#t,{signal:e}),o.addEventListener("click",n,{signal:e}),o.addEventListener("pointerenter",i,{signal:e}),o.addEventListener("pointerleave",a,{signal:e}),l.after(o)}}#C(){if(this.#b.extraPopupElement&&!this.#b.editor)return;this.#m||this.renderCommentButton();const[e,t]=this.#x,{style:n}=this.#m;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#I(){this.#b.extraPopupElement||(this.#m||this.renderCommentButton(),this.#m.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#b.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#m?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:a}=this.#b.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:a}}get elementBeforePopup(){return this.#m}get comment(){return this.#k||=this.#b.commentText,this.#k}set comment(e){e!==this.comment&&(this.#b.commentText=this.#k=e)}focus(){this.#b.container?.focus()}get parentBoundingClientRect(){return this.#b.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#m&&(this.#m.classList.toggle("selected",e),this.#m.ariaExpanded=t)}setSelectedCommentButton(e){this.#m.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:e,y:t,height:n}=this.#m.getBoundingClientRect(),{x:i,y:a,width:o,height:l}=this.#b.layer.getBoundingClientRect();return[(e-i)/o,(t+n-a)/l]}set commentPopupPosition(e){this.#v=e}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#x}get commentButtonWidth(){return this.#m.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#v||this.commentButtonPosition.map(h=>h/100),i=this.parentBoundingClientRect,{x:a,y:o,width:l,height:u}=i;this.#e.showDialog(null,this,a+t*l,o+n*u,{...e,parentDimensions:i})}render(){if(this.#g)return;const e=this.#g=document.createElement("div");if(e.className="popup",this.#i){const n=e.style.outlineColor=Ae.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#N?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#N}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}iC({html:this.#D||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#n.append(e)}get#D(){const e=this.#E,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#E.html||null}get#M(){return this.#D?.attributes?.style?.fontSize||0}get#B(){return this.#D?.attributes?.style?.color||null}#O(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#B,fontSize:this.#M?`calc(${this.#M}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:i});return n}#q(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#k=null):t&&(t.deleted?this.remove():(this.#I(),this.#k=t.text)),e&&(this.#x=null,this.#A(),this.#C());return}if(n||t?.deleted){this.remove();return}this.#T(),this.#j||={contentsObj:this.#o,richText:this.#E},e&&(this.#d=null),t&&t.text&&(this.#E=this.#O(t.text),this.#c=Fx.toDateObject(t.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#j&&({contentsObj:this.#o,richText:this.#E}=this.#j,this.#j=null,this.#g?.remove(),this.#g=null,this.#d=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#_=!1,this.#f=!1,this.#m?.remove(),this.#m=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#S(){if(this.#d!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:a}}}=this.#h;let o=!!this.#u,l=o?this.#u:this.#y;for(const v of this.#l)if(!l||Ae.intersect(v.data.rect,l)!==null){l=v.data.rect,o=!0;break}const u=Ae.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),c=o?l[2]-l[0]+5:0,f=u[0]+c,m=u[1];this.#d=[100*(f-i)/t,100*(m-a)/n];const{style:g}=this.#n;g.left=`${this.#d[0]}%`,g.top=`${this.#d[1]}%`}#w(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#P(),this.#n.addEventListener("click",this.#a),this.#n.addEventListener("keydown",this.#t)):(this.#F(),this.#n.removeEventListener("click",this.#a),this.#n.removeEventListener("keydown",this.#t))}#P(){this.#g||this.render(),this.isVisible?this.#f&&this.#n.classList.add("focused"):(this.#S(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#F(){this.#n.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#n.hidden=!0)}maybeShow(){this.#e||(this.#T(),this.#_&&(this.#g||this.#P(),this.#_=!1,this.#n.hidden=!1))}get isVisible(){return this.#e?!1:this.#n.hidden===!1}}class AC extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ke.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class NH extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class kH extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",t-a),o.setAttribute("height",n-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class EH extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-a/2),o.setAttribute("ry",n/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class CC extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:a,height:o}=this;if(!t)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let c=0,f=t.length;c<f;c+=2){const m=t[c]-e[0],g=e[3]-t[c+1];u.push(`${m},${g}`)}u=u.join(" ");const h=this.#e=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",u),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class SH extends CC{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _H extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class My extends Ut{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ke.HIGHLIGHT:Ke.INK}#r(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:a}}=this,{transform:o,width:l,height:u}=this.#r(t,e),h=this.svgFactory.create(l,u,!0),c=this.#e=this.svgFactory.createElement("svg:g");h.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",o);for(let f=0,m=n.length;f<m;f++){const g=this.svgFactory.createElement(this.svgElementName);this.#t.push(g),g.setAttribute("points",n[f].join(",")),c.append(g)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),n)for(let o=0,l=this.#t.length;o<l;o++)this.#t[o].setAttribute("points",n[o].join(","));if(i){const{transform:o,width:l,height:u}=this.#r(this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class TC extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ke.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class AH extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class CH extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class TH extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class RC extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ke.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class RH extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:i}=Es.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Oy{#e=null;#t=null;#r=null;#s=new Map;#a=null;#i=null;#n=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:o,structTreeLayer:l,commentManager:u,linkService:h,annotationStorage:c}){this.div=e,this.#e=t,this.#t=n,this.#a=l||null,this.#i=h||null,this.#r=c||new Ay,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=u||null}hasEditableAnnotations(){return this.#s.size>0}async render(e){const{annotations:t}=e,n=this.div;ha(n,this.viewport);const i=new Map,a=[],o={data:null,layer:n,linkService:this.#i,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new qu,annotationStorage:this.#r,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===ts.POPUP;if(u){const f=i.get(l.id);if(!f)continue;if(!this._commentManager){a.push(l);continue}o.elements=f}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=Ug.create(o);if(!h.isRenderable)continue;if(!u&&(this.#n.push(h),l.popupRef)){const f=i.get(l.popupRef);f?f.push(h):i.set(l.popupRef,[h])}const c=h.render();l.hidden&&(c.style.visibility="hidden"),h._isEditable&&(this.#s.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}await this.#c();for(const l of a){const u=o.elements=i.get(l.id);o.data=l;const h=Ug.create(o);if(!h.isRenderable)continue;const c=h.render();h.contentElement.id=`${so}${l.id}`,l.hidden&&(c.style.visibility="hidden"),u.at(-1).container.after(c)}this.#l()}async#c(){if(this.#n.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:i}}of this.#n){const a=n.id=`${so}${i}`;e.push(this.#a?.getAriaAttributes(a).then(o=>{if(o)for(const[l,u]of o)n.setAttribute(l,u)}))}}this.#n.sort(({data:{rect:[n,i,a,o]}},{data:{rect:[l,u,h,c]}})=>{if(n===a&&i===o)return 1;if(l===h&&u===c)return-1;const f=o,m=i,g=(i+o)/2,v=c,y=u,x=(u+c)/2;if(g>=v&&x<=m)return-1;if(x>=f&&g<=y)return 1;const b=(n+a)/2,w=(l+h)/2;return b-w});const t=document.createDocumentFragment();for(const n of this.#n)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#n)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#i,svgFactory:new qu,parent:this};for(const n of e){n.borderStyle||=Oy._defaultBorderStyle,t.data=n;const i=Ug.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${so}${n.id}`,this.#n.push(i))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,ha(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n);const o=this.#s.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,n),o._hasNoCanvas=!1):o.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,a=new pH({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#i,annotationStorage:this.#r});return a.render(),a.contentElement.id=`${so}${n}`,a.createOrUpdatePopup(),this.#n.push(a),a}removeAnnotation(e){const t=this.#n.findIndex(i=>i.data.id===e);if(t<0)return;const[n]=this.#n.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Xe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:$a.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Jd=/\r\n?|\n/g;class hs extends Oe{#e="";#t=`${this.id}-editor`;#r=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=hs.prototype,t=a=>a.isEmpty(),n=_i.TRANSLATE_SMALL,i=_i.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new mc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=Ke.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||hs._defaultColor||Oe._defaultLineColor,this.#s=e.fontSize||hs._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){Oe.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case nt.FREETEXT_SIZE:hs._defaultFontSize=t;break;case nt.FREETEXT_COLOR:hs._defaultColor=t;break}}updateParams(e,t){switch(e){case nt.FREETEXT_SIZE:this.#a(t);break;case nt.FREETEXT_COLOR:this.#i(t);break}}static get defaultPropertiesToUpdate(){return[[nt.FREETEXT_SIZE,hs._defaultFontSize],[nt.FREETEXT_COLOR,hs._defaultColor||Oe._defaultLineColor]]}get propertiesToUpdate(){return[[nt.FREETEXT_SIZE,this.#s],[nt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new tc(this),[["colorPicker",this._colorPicker]]}get colorType(){return nt.FREETEXT_COLOR}#a(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#s)*this.parentScale),this.#s=i,this.#o()},n=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#i(e){const t=i=>{this.color=i,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-hs._internalPadding*e,-(hs._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;const e=this._uiManager.combinedSignal(this.#r);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#n(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(hs.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#n().trimEnd();if(e===t)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){hs._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,c]=this.pageDimensions,[f,m]=this.pageTranslation;let g,v;switch(this.rotation){case 0:g=e+(o[0]-f)/h,v=t+this.height-(o[1]-m)/c;break;case 90:g=e+(o[0]-f)/h,v=t-(o[1]-m)/c,[l,u]=[u,-l];break;case 180:g=e-this.width+(o[0]-f)/h,v=t-(o[1]-m)/c,[l,u]=[-l,-u];break;case 270:g=e+(o[0]-f-this.height*c)/h,v=t+(o[1]-m-this.width*h)/c,[l,u]=[-u,l];break}this.setAt(g*i,v*a,l,u)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Jd,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const i=hs.#u(t.getData("text")||"").replaceAll(Jd,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,h=[],c=[];if(l.nodeType===Node.TEXT_NODE){const g=l.parentElement;if(c.push(l.nodeValue.slice(u).replaceAll(Jd,"")),g!==this.editorDiv){let v=h;for(const y of this.editorDiv.childNodes){if(y===g){v=c;continue}v.push(hs.#c(y))}}h.push(l.nodeValue.slice(0,u).replaceAll(Jd,""))}else if(l===this.editorDiv){let g=h,v=0;for(const y of this.editorDiv.childNodes)v++===u&&(g=c),g.push(hs.#c(y))}this.#e=`${h.join(`
`)}${i}${c.join(`
`)}`,this.#l();const f=new Range;let m=Math.sumPrecise(h.map(g=>g.length));for(const{firstChild:g}of this.editorDiv.childNodes)if(g.nodeType===Node.TEXT_NODE){const v=g.nodeValue.length;if(m<=v){f.setStart(g,m),f.setEnd(g,m);break}m-=v}a.removeAllRanges(),a.addRange(f)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#u(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=hs._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof AC){const{data:{defaultAppearanceData:{fontSize:o,fontColor:l},rect:u,rotation:h,id:c,popupRef:f,richText:m,contentsObj:g,creationDate:v,modificationDate:y},textContent:x,textPosition:b,parent:{page:{pageNumber:w}}}=e;if(!x||x.length===0)return null;i=e={annotationType:Ke.FREETEXT,color:Array.from(l),fontSize:o,value:x.join(`
`),position:b,pageIndex:w-1,rect:u.slice(0),rotation:h,annotationElementId:c,id:c,deleted:!1,popupRef:f,comment:g?.str||null,richText:m,creationDate:v,modificationDate:y}}const a=await super.deserialize(e,t,n);return a.#s=e.fontSize,a.color=Ae.makeHexColor(...e.color),a.#e=hs.#u(e.value),a._initialData=i,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Oe._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#s,value:this.#h()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((o,l)=>o!==i[l])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const i of this.#e.split(`
`)){const a=document.createElement("div");a.append(i?document.createTextNode(i):document.createElement("br")),t.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Se{static PRECISION=1e-4;toSVGPath(){vt("Abstract method `toSVGPath` must be implemented.")}get box(){vt("Abstract getter `box` must be implemented.")}serialize(e,t){vt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,a,o){o||=new Float32Array(e.length);for(let l=0,u=e.length;l<u;l+=2)o[l]=t+e[l]*i,o[l+1]=n+e[l+1]*a;return o}static _rescaleAndSwap(e,t,n,i,a,o){o||=new Float32Array(e.length);for(let l=0,u=e.length;l<u;l+=2)o[l]=t+e[l+1]*i,o[l+1]=n+e[l]*a;return o}static _translate(e,t,n,i){i||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)i[a]=t+e[a],i[a+1]=n+e[a+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,a){switch(a){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,a,o){return[(e+5*n)/6,(t+5*i)/6,(5*n+a)/6,(5*i+o)/6,(n+a)/2,(i+o)/2]}}class ea{#e;#t=[];#r;#s;#a=[];#i=new Float32Array(18);#n;#o;#c;#l;#h;#u;#f=[];static#g=8;static#p=2;static#d=ea.#g+ea.#p;constructor({x:e,y:t},n,i,a,o,l=0){this.#e=n,this.#u=a*i,this.#s=o,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#r=l,this.#l=ea.#g*i,this.#c=ea.#d*i,this.#h=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#m(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[n,i,a,o]=this.#e;return[(this.#n+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-i)/o,(this.#n+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-i)/o]}add({x:e,y:t}){this.#n=e,this.#o=t;const[n,i,a,o]=this.#e;let[l,u,h,c]=this.#i.subarray(8,12);const f=e-h,m=t-c,g=Math.hypot(f,m);if(g<this.#c)return!1;const v=g-this.#l,y=v/g,x=y*f,b=y*m;let w=l,k=u;l=h,u=c,h+=x,c+=b,this.#f?.push(e,t);const N=-b/v,E=x/v,S=N*this.#u,A=E*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([h+S,c+A],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([h-S,c-A],16),isNaN(this.#i[6])?(this.#a.length===0&&(this.#i.set([l+S,u+A],2),this.#a.push(NaN,NaN,NaN,NaN,(l+S-n)/a,(u+A-i)/o),this.#i.set([l-S,u-A],14),this.#t.push(NaN,NaN,NaN,NaN,(l-S-n)/a,(u-A-i)/o)),this.#i.set([w,k,l,u,h,c],6),!this.isEmpty()):(this.#i.set([w,k,l,u,h,c],6),Math.abs(Math.atan2(k-u,w-l)-Math.atan2(b,x))<Math.PI/2?([l,u,h,c]=this.#i.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((l+h)/2-n)/a,((u+c)/2-i)/o),[l,u,w,k]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((w+l)/2-n)/a,((k+u)/2-i)/o),!0):([w,k,l,u,h,c]=this.#i.subarray(0,6),this.#a.push(((w+5*l)/6-n)/a,((k+5*u)/6-i)/o,((5*l+h)/6-n)/a,((5*u+c)/6-i)/o,((l+h)/2-n)/a,((u+c)/2-i)/o),[h,c,l,u,w,k]=this.#i.subarray(12,18),this.#t.push(((w+5*l)/6-n)/a,((k+5*u)/6-i)/o,((5*l+h)/6-n)/a,((5*u+c)/6-i)/o,((l+h)/2-n)/a,((u+c)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#x();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#y(n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#v(n),n.join(" ")}#x(){const[e,t,n,i]=this.#e,[a,o,l,u]=this.#m();return`M${(this.#i[2]-e)/n} ${(this.#i[3]-t)/i} L${(this.#i[4]-e)/n} ${(this.#i[5]-t)/i} L${a} ${o} L${l} ${u} L${(this.#i[16]-e)/n} ${(this.#i[17]-t)/i} L${(this.#i[14]-e)/n} ${(this.#i[15]-t)/i} Z`}#v(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#y(e){const[t,n,i,a]=this.#e,o=this.#i.subarray(4,6),l=this.#i.subarray(16,18),[u,h,c,f]=this.#m();e.push(`L${(o[0]-t)/i} ${(o[1]-n)/a} L${u} ${h} L${c} ${f} L${(l[0]-t)/i} ${(l[1]-n)/a}`)}newFreeDrawOutline(e,t,n,i,a,o){return new DC(e,t,n,i,a,o)}getOutlines(){const e=this.#a,t=this.#t,n=this.#i,[i,a,o,l]=this.#e,u=new Float32Array((this.#f?.length??0)+2);for(let f=0,m=u.length-2;f<m;f+=2)u[f]=(this.#f[f]-i)/o,u[f+1]=(this.#f[f+1]-a)/l;if(u[u.length-2]=(this.#n-i)/o,u[u.length-1]=(this.#o-a)/l,isNaN(n[6])&&!this.isEmpty())return this.#E(u);const h=new Float32Array(this.#a.length+24+this.#t.length);let c=e.length;for(let f=0;f<c;f+=2){if(isNaN(e[f])){h[f]=h[f+1]=NaN;continue}h[f]=e[f],h[f+1]=e[f+1]}c=this.#j(h,c);for(let f=t.length-6;f>=6;f-=6)for(let m=0;m<6;m+=2){if(isNaN(t[f+m])){h[c]=h[c+1]=NaN,c+=2;continue}h[c]=t[f+m],h[c+1]=t[f+m+1],c+=2}return this.#N(h,c),this.newFreeDrawOutline(h,u,this.#e,this.#h,this.#r,this.#s)}#E(e){const t=this.#i,[n,i,a,o]=this.#e,[l,u,h,c]=this.#m(),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-i)/o,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-i)/o],0),this.newFreeDrawOutline(f,e,this.#e,this.#h,this.#r,this.#s)}#N(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#j(e,t){const n=this.#i.subarray(4,6),i=this.#i.subarray(16,18),[a,o,l,u]=this.#e,[h,c,f,m]=this.#m();return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/l,(n[1]-o)/u,NaN,NaN,NaN,NaN,h,c,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(i[0]-a)/l,(i[1]-o)/u],t),t+=24}}class DC extends Se{#e;#t=new Float32Array(4);#r;#s;#a;#i;#n;constructor(e,t,n,i,a,o){super(),this.#n=e,this.#a=t,this.#e=n,this.#i=i,this.#r=a,this.#s=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[l,u,h,c]=this.#t;for(let f=0,m=e.length;f<m;f+=2)e[f]=(e[f]-l)/h,e[f+1]=(e[f+1]-u)/c;for(let f=0,m=t.length;f<m;f+=2)t[f]=(t[f]-l)/h,t[f+1]=(t[f+1]-u)/c}toSVGPath(){const e=[`M${this.#n[4]} ${this.#n[5]}`];for(let t=6,n=this.#n.length;t<n;t+=6){if(isNaN(this.#n[t])){e.push(`L${this.#n[t+4]} ${this.#n[t+5]}`);continue}e.push(`C${this.#n[t]} ${this.#n[t+1]} ${this.#n[t+2]} ${this.#n[t+3]} ${this.#n[t+4]} ${this.#n[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,i],a){const o=n-e,l=i-t;let u,h;switch(a){case 0:u=Se._rescale(this.#n,e,i,o,-l),h=Se._rescale(this.#a,e,i,o,-l);break;case 90:u=Se._rescaleAndSwap(this.#n,e,t,o,l),h=Se._rescaleAndSwap(this.#a,e,t,o,l);break;case 180:u=Se._rescale(this.#n,n,t,-o,l),h=Se._rescale(this.#a,n,t,-o,l);break;case 270:u=Se._rescaleAndSwap(this.#n,n,i,-o,-l),h=Se._rescaleAndSwap(this.#a,n,i,-o,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}#o(e){const t=this.#n;let n=t[4],i=t[5];const a=[n,i,n,i];let o=n,l=i,u=n,h=i;const c=e?Math.max:Math.min,f=new Float32Array(4);for(let g=6,v=t.length;g<v;g+=6){const y=t[g+4],x=t[g+5];isNaN(t[g])?(Ae.pointBoundingBox(y,x,a),l>x?(o=y,l=x):l===x&&(o=c(o,y)),h<x?(u=y,h=x):h===x&&(u=c(u,y))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,Ae.bezierBoundingBox(n,i,...t.slice(g,g+6),f),Ae.rectBoundingBox(f[0],f[1],f[2],f[3],a),l>f[1]?(o=f[0],l=f[1]):l===f[1]&&(o=c(o,f[0])),h<f[3]?(u=f[2],h=f[3]):h===f[3]&&(u=c(u,f[2]))),n=y,i=x}const m=this.#t;m[0]=a[0]-this.#r,m[1]=a[1]-this.#r,m[2]=a[2]-a[0]+2*this.#r,m[3]=a[3]-a[1]+2*this.#r,this.firstPoint=[o,l],this.lastPoint=[u,h]}get box(){return this.#t}newOutliner(e,t,n,i,a,o=0){return new ea(e,t,n,i,a,o)}getNewOutline(e,t){const[n,i,a,o]=this.#t,[l,u,h,c]=this.#e,f=a*h,m=o*c,g=n*h+l,v=i*c+u,y=this.newOutliner({x:this.#a[0]*f+g,y:this.#a[1]*m+v},this.#e,this.#i,e,this.#s,t??this.#r);for(let x=2;x<this.#a.length;x+=2)y.add({x:this.#a[x]*f+g,y:this.#a[x+1]*m+v});return y.getOutlines()}}class Gx{#e;#t;#r;#s=[];#a=[];constructor(e,t=0,n=0,i=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:y,y:x,width:b,height:w}of e){const k=Math.floor((y-t)/o)*o,N=Math.ceil((y+b+t)/o)*o,E=Math.floor((x-t)/o)*o,S=Math.ceil((x+w+t)/o)*o,A=[k,E,S,!0],C=[N,E,S,!1];this.#s.push(A,C),Ae.rectBoundingBox(k,E,N,S,a)}const l=a[2]-a[0]+2*n,u=a[3]-a[1]+2*n,h=a[0]-n,c=a[1]-n;let f=i?-1/0:1/0,m=1/0;const g=this.#s.at(i?-1:-2),v=[g[0],g[2]];for(const y of this.#s){const[x,b,w,k]=y;!k&&i?b<m?(m=b,f=x):b===m&&(f=Math.max(f,x)):k&&!i&&(b<m?(m=b,f=x):b===m&&(f=Math.min(f,x))),y[0]=(x-h)/l,y[1]=(b-c)/u,y[2]=(w-c)/u}this.#e=new Float32Array([h,c,l,u]),this.#t=[f,m],this.#r=v}getOutlines(){this.#s.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#i(e)}#i(e){const t=[],n=new Set;for(const o of e){const[l,u,h]=o;t.push([l,u,o],[l,h,o])}t.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=t.length;o<l;o+=2){const u=t[o][2],h=t[o+1][2];u.push(h),h.push(u),n.add(u),n.add(h)}const i=[];let a;for(;n.size>0;){const o=n.values().next().value;let[l,u,h,c,f]=o;n.delete(o);let m=l,g=u;for(a=[l,h],i.push(a);;){let v;if(n.has(c))v=c;else if(n.has(f))v=f;else break;n.delete(v),[l,u,h,c,f]=v,m!==l&&(a.push(m,g,l,g===u?u:h),m=l),g=g===u?h:u}a.push(m,g)}return new DH(i,this.#e,this.#t,this.#r)}#n(e){const t=this.#a;let n=0,i=t.length-1;for(;n<=i;){const a=n+i>>1,o=t[a][0];if(o===e)return a;o<e?n=a+1:i=a-1}return i+1}#o([,e,t]){const n=this.#n(e);this.#a.splice(n,0,[e,t])}#c([,e,t]){const n=this.#n(e);for(let i=n;i<this.#a.length;i++){const[a,o]=this.#a[i];if(a!==e)break;if(a===e&&o===t){this.#a.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,o]=this.#a[i];if(a!==e)break;if(a===e&&o===t){this.#a.splice(i,1);return}}}#l(e){const[t,n,i]=e,a=[[t,n,i]],o=this.#n(i);for(let l=0;l<o;l++){const[u,h]=this.#a[l];for(let c=0,f=a.length;c<f;c++){const[,m,g]=a[c];if(!(h<=m||g<=u)){if(m>=u){if(g>h)a[c][1]=h;else{if(f===1)return[];a.splice(c,1),c--,f--}continue}a[c][2]=u,g>h&&a.push([t,h,g])}}}return a}}class DH extends Se{#e;#t;constructor(e,t,n,i){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[n,i]=t;e.push(`M${n} ${i}`);for(let a=2;a<t.length;a+=2){const o=t[a],l=t[a+1];o===n?(e.push(`V${l}`),i=l):l===i&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],a){const o=[],l=n-e,u=i-t;for(const h of this.#t){const c=new Array(h.length);for(let f=0;f<h.length;f+=2)c[f]=e+h[f]*l,c[f+1]=i-h[f+1]*u;o.push(c)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Yx extends ea{newFreeDrawOutline(e,t,n,i,a,o){return new PH(e,t,n,i,a,o)}}class PH extends DC{newOutliner(e,t,n,i,a,o=0){return new Yx(e,t,n,i,a,o)}}class Yt extends Oe{#e=null;#t=0;#r;#s=null;#a=null;#i=null;#n=null;#o=0;#c=null;#l=null;#h=null;#u=!1;#f=null;#g=null;#p=null;#d="";#m;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ke.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Yt.prototype;return Xe(this,"_keyboardManager",new mc([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Yt._defaultColor,this.#m=e.thickness||Yt._defaultThickness,this.opacity=e.opacity||Yt._defaultOpacity,this.#r=e.boxes||null,this.#x=e.methodOfCreation||"",this.#d=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#y(e),this.#b()):this.#r&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#n=e.focusNode,this.#o=e.focusOffset,this.#v(),this.#b(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#v(){const e=new Gx(this.#r,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Gx(this.#r,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:i}=this.#i;this.#g=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#y({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const i=1.5;if(this.#i=e.getNewOutline(this.#m/2+i,.0025),t>=0)this.#h=t,this.#s=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Yt.#k(this.#l.box,(f-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Yt.#k(this.#i.box,f),path:{d:this.#i.toSVGPath()}})}const[a,o,l,u]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[f,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*m/f,this.height=u*f/m;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[f,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*m/f,this.height=u*f/m;break}}const{firstPoint:h}=e;this.#f=[(h[0]-a)/l,(h[1]-o)/u];const{lastPoint:c}=this.#i;this.#g=[(c[0]-a)/l,(c[1]-o)/u]}static initialize(e,t){Oe.initialize(e,t),Yt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case nt.HIGHLIGHT_COLOR:Yt._defaultColor=t;break;case nt.HIGHLIGHT_THICKNESS:Yt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case nt.HIGHLIGHT_COLOR:this.#E(t);break;case nt.HIGHLIGHT_THICKNESS:this.#N(t);break}}static get defaultPropertiesToUpdate(){return[[nt.HIGHLIGHT_COLOR,Yt._defaultColor],[nt.HIGHLIGHT_THICKNESS,Yt._defaultThickness]]}get propertiesToUpdate(){return[[nt.HIGHLIGHT_COLOR,this.color||Yt._defaultColor],[nt.HIGHLIGHT_THICKNESS,this.#m||Yt._defaultThickness],[nt.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#E(e){const t=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,Yt._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#N(e){const t=this.#m,n=i=>{this.#m=i,this.#j(i)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new kr({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#C())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#C())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#_():e&&(this.#b(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#j(e){this.#u&&(this.#y({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#_(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#b(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#s}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#s))}static#k([e,t,n,i],a){switch(a){case 90:return[1-t-i,e,i,n];case 180:return[1-e-n,1-t-i,n,i];case 270:return[t,1-e-n,i,n]}return[e,t,n,i]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#u?(e=(e-this.rotation+360)%360,n=Yt.#k(this.#l.box,e)):n=Yt.#k([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Yt.#k(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#d&&(e.setAttribute("aria-label",this.#d),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#s,this.setDims(),oC(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#T(e){Yt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#A(!0);break;case 1:case 3:this.#A(!1);break}}#A(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#n,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#A(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#C(){return this.#u?this.rotation:0}#I(){if(this.#u)return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,a=this.#r,o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:h,width:c,height:f}of a){const m=u*e+n,g=(1-h)*t+i;o[l]=o[l+4]=m,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=m+c*e,o[l+5]=o[l+7]=g-f*t,l+=8}return o}#D(e){return this.#l.serialize(e,this.#C())}static startHighlighting(e,t,{target:n,x:i,y:a}){const{x:o,y:l,width:u,height:h}=n.getBoundingClientRect(),c=new AbortController,f=e.combinedSignal(c),m=g=>{c.abort(),this.#B(e,g)};window.addEventListener("blur",m,{signal:f}),window.addEventListener("pointerup",m,{signal:f}),window.addEventListener("pointerdown",qt,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Cr,{signal:f}),n.addEventListener("pointermove",this.#M.bind(this,e),{signal:f}),this._freeHighlight=new Yx({x:i,y:a},[o,l,u,h],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#M(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let i=null;if(e instanceof TC){const{data:{quadPoints:v,rect:y,rotation:x,id:b,color:w,opacity:k,popupRef:N,richText:E,contentsObj:S,creationDate:A,modificationDate:C},parent:{page:{pageNumber:I}}}=e;i=e={annotationType:Ke.HIGHLIGHT,color:Array.from(w),opacity:k,quadPoints:v,boxes:null,pageIndex:I-1,rect:y.slice(0),rotation:x,annotationElementId:b,id:b,deleted:!1,popupRef:N,richText:E,comment:S?.str||null,creationDate:A,modificationDate:C}}else if(e instanceof My){const{data:{inkLists:v,rect:y,rotation:x,id:b,color:w,borderStyle:{rawWidth:k},popupRef:N,richText:E,contentsObj:S,creationDate:A,modificationDate:C},parent:{page:{pageNumber:I}}}=e;i=e={annotationType:Ke.HIGHLIGHT,color:Array.from(w),thickness:k,inkLists:v,boxes:null,pageIndex:I-1,rect:y.slice(0),rotation:x,annotationElementId:b,id:b,deleted:!1,popupRef:N,richText:E,comment:S?.str||null,creationDate:A,modificationDate:C}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=e,h=await super.deserialize(e,t,n);h.color=Ae.makeHexColor(...a),h.opacity=u||1,l&&(h.#m=e.thickness),h._initialData=i,e.comment&&h.setCommentData(e);const[c,f]=h.pageDimensions,[m,g]=h.pageTranslation;if(o){const v=h.#r=[];for(let y=0;y<o.length;y+=8)v.push({x:(o[y]-m)/c,y:1-(o[y+1]-g)/f,width:(o[y+2]-o[y])/c,height:(o[y+1]-o[y+5])/f});h.#v(),h.#b(),h.rotate(h.rotation)}else if(l){h.#u=!0;const v=l[0],y={x:v[0]-m,y:f-(v[1]-g)},x=new Yx(y,[0,0,c,f],1,h.#m/2,!0,.001);for(let k=0,N=v.length;k<N;k+=2)y.x=v[k]-m,y.y=f-(v[k+1]-g),x.add(y);const{id:b,clipPathId:w}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);h.#y({highlightOutlines:x.getOutlines(),highlightId:b,clipPathId:w}),h.#b(),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Oe._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#m,quadPoints:this.#I(),outlines:this.#D(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#O(n)?null:(n.id=this.annotationElementId,n)}#O(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,i)=>n!==t[i])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class PC{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){vt("Not implemented")}}class ht extends Oe{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#r=null;static#s=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#i(e),this.#c())}#i({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#n(e,this.parent),this.#u(e.box)}#n(e,t){const{id:n}=t.drawLayer.draw(ht._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,a]of Object.entries(t))n.has(i)?Object.assign(e[i],a):e[i]=a;return e}static getDefaultDrawingOptions(e){vt("Not implemented")}static get typesMap(){vt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(ht.#r.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,a=i[t],o=l=>{i.updateProperty(t,l);const u=this.#e.updateProperty(t,l);u&&this.#u(u),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#u(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#n(this.#e,e)}}#l([e,t,n,i]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[t,1-e,n*(o/a),i*(a/o)];case 180:return[1-e,1-t,n,i];case 270:return[1-t,e,n*(o/a),i*(a/o)];default:return[e,t,n,i]}}#h(){const{x:e,y:t,width:n,height:i,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-t,e,n*(a/o),i*(o/a)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(a/o),i*(o/a)];default:return[e,t,n,i]}}#u(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:n,height:i,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(l/u),i*(u/l),n*(l/u)];case 5:return[1-t,e,n*(l/u),i*(u/l)];case 6:return[1-e-i*(u/l),1-t,i*(u/l),n*(l/u)];case 7:return[t-n*(l/u),1-e-i*(u/l),n*(l/u),i*(u/l)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(u/l),t,i*(u/l),n*(l/u)];case 13:return[1-t-n*(l/u),e-i*(u/l),n*(l/u),i*(u/l)];case 14:return[1-e,1-t-n*(l/u),i*(u/l),n*(l/u)];case 15:return[t,1-e,n*(l/u),i*(u/l)];default:return[e,t,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ht._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,a){vt("Not implemented")}static startDrawing(e,t,n,i){const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:h}=i;if(ft.isInitializedAndDifferentPointerType(h))return;const{viewport:{rotation:c}}=e,{width:f,height:m}=a.getBoundingClientRect(),g=ht.#s=new AbortController,v=e.combinedSignal(g);if(ft.setPointer(h,u),window.addEventListener("pointerup",y=>{ft.isSamePointerIdOrRemove(y.pointerId)&&this._endDraw(y)},{signal:v}),window.addEventListener("pointercancel",y=>{ft.isSamePointerIdOrRemove(y.pointerId)&&this._currentParent.endDrawingSession()},{signal:v}),window.addEventListener("pointerdown",y=>{ft.isSamePointerType(y.pointerType)&&(ft.initializeAndAddPointerId(y.pointerId),ht.#r.isCancellable()&&(ht.#r.removeLastElement(),ht.#r.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Cr,{signal:v}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),a.addEventListener("touchmove",y=>{ft.isSameTimeStamp(y.timeStamp)&&qt(y)},{signal:v}),e.toggleDrawing(),t._editorUndoBar?.hide(),ht.#r){e.drawLayer.updateProperties(this._currentDrawId,ht.#r.startNew(o,l,f,m,c));return}t.updateUIForDefaultProperties(this),ht.#r=this.createDrawerInstance(o,l,f,m,c),ht.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(ht.#a.toSVGProperties(),ht.#r.defaultSVGProperties),!0,!1)}static _drawMove(e){if(ft.isSameTimeStamp(e.timeStamp),!ht.#r)return;const{offsetX:t,offsetY:n,pointerId:i}=e;if(ft.isSamePointerId(i)){if(ft.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ht.#r.add(t,n)),ft.setTimeStamp(e.timeStamp),qt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,ht.#r=null,ht.#a=null,ft.clearPointerType(),ft.clearTimeStamp()),ht.#s&&(ht.#s.abort(),ht.#s=null,ft.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,ht.#r.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=ht.#r,i=this._currentDrawId,a=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,n.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:nt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(nt.DRAW_STEP),!ht.#r.isEmpty()){const{pageDimensions:[n,i],scale:a}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ht.#r.getOutlines(n*a,i*a,a,this._INNER_MARGIN),drawingOptions:ht.#a,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,a,o){vt("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}=t.viewport,u=this.deserializeDraw(o,l,i,a,this._INNER_MARGIN,e),h=await super.deserialize(e,t,n);return h.createDrawingOptions(e),h.#i({drawOutlines:u}),h.#c(),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[t,n]=this.pageTranslation,[i,a]=this.pageDimensions;return this.#e.serialize([t,n,i,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class MH{#e=new Float64Array(6);#t;#r;#s;#a;#i;#n="";#o=0;#c=new gc;#l;#h;constructor(e,t,n,i,a,o){this.#l=n,this.#h=i,this.#s=a,this.#a=o,[e,t]=this.#u(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#r=[{line:l,points:this.#i}],this.#e.set(l,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#u(e,t){return Se._normalizePoint(e,t,this.#l,this.#h,this.#s)}isEmpty(){return!this.#r||this.#r.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#u(e,t);const[n,i,a,o]=this.#e.subarray(2,6),l=e-a,u=t-o;return Math.hypot(this.#l*l,this.#h*u)<=2?null:(this.#i.push(e,t),isNaN(n)?(this.#e.set([a,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,i,a,o,e,t],0),this.#t.push(...Se.createBezierPoints(n,i,a,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,a){this.#l=n,this.#h=i,this.#s=a,[e,t]=this.#u(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const l=this.#r.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#r.push({line:o,points:this.#i}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#r.at(-1)}setLastElement(e){return this.#r?(this.#r.push(e),this.#t=e.line,this.#i=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#r)return this.#c.removeLastElement();this.#r.pop(),this.#n="";for(let e=0,t=this.#r.length;e<t;e++){const{line:n,points:i}=this.#r[e];this.#t=n,this.#i=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#n}}}toSVGPath(){const e=Se.svgRound(this.#t[4]),t=Se.svgRound(this.#t[5]);if(this.#i.length===2)return this.#n=`${this.#n} M ${e} ${t} Z`,this.#n;if(this.#i.length<=6){const i=this.#n.lastIndexOf("M");this.#n=`${this.#n.slice(0,i)} M ${e} ${t}`,this.#o=6}if(this.#i.length===4){const i=Se.svgRound(this.#t[10]),a=Se.svgRound(this.#t[11]);return this.#n=`${this.#n} L ${i} ${a}`,this.#o=12,this.#n}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let i=this.#o,a=this.#t.length;i<a;i+=6){const[o,l,u,h,c,f]=this.#t.slice(i,i+6).map(Se.svgRound);n.push(`C${o} ${l} ${u} ${h} ${c} ${f}`)}return this.#n+=n.join(" "),this.#o=this.#t.length,this.#n}getOutlines(e,t,n,i){const a=this.#r.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#r,e,t,n,this.#s,this.#a,i),this.#e=null,this.#t=null,this.#r=null,this.#n=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class gc extends Se{#e;#t=0;#r;#s;#a;#i;#n;#o;#c;build(e,t,n,i,a,o,l){this.#a=t,this.#i=n,this.#n=i,this.#o=a,this.#c=o,this.#r=l??0,this.#s=e,this.#u()}get thickness(){return this.#c}setLastElement(e){return this.#s.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#s){if(e.push(`M${Se.svgRound(t[4])} ${Se.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Se.svgRound(t[10])} ${Se.svgRound(t[11])}`);continue}for(let n=6,i=t.length;n<i;n+=6){const[a,o,l,u,h,c]=t.subarray(n,n+6).map(Se.svgRound);e.push(`C${a} ${o} ${l} ${u} ${h} ${c}`)}}return e.join("")}serialize([e,t,n,i],a){const o=[],l=[],[u,h,c,f]=this.#h();let m,g,v,y,x,b,w,k,N;switch(this.#o){case 0:N=Se._rescale,m=e,g=t+i,v=n,y=-i,x=e+u*n,b=t+(1-h-f)*i,w=e+(u+c)*n,k=t+(1-h)*i;break;case 90:N=Se._rescaleAndSwap,m=e,g=t,v=n,y=i,x=e+h*n,b=t+u*i,w=e+(h+f)*n,k=t+(u+c)*i;break;case 180:N=Se._rescale,m=e+n,g=t,v=-n,y=i,x=e+(1-u-c)*n,b=t+h*i,w=e+(1-u)*n,k=t+(h+f)*i;break;case 270:N=Se._rescaleAndSwap,m=e+n,g=t+i,v=-n,y=-i,x=e+(1-h-f)*n,b=t+(1-u-c)*i,w=e+(1-h)*n,k=t+(1-u)*i;break}for(const{line:E,points:S}of this.#s)o.push(N(E,m,g,v,y,a?new Array(E.length):null)),l.push(N(S,m,g,v,y,a?new Array(S.length):null));return{lines:o,points:l,rect:[x,b,w,k]}}static deserialize(e,t,n,i,a,{paths:{lines:o,points:l},rotation:u,thickness:h}){const c=[];let f,m,g,v,y;switch(u){case 0:y=Se._rescale,f=-e/n,m=t/i+1,g=1/n,v=-1/i;break;case 90:y=Se._rescaleAndSwap,f=-t/i,m=-e/n,g=1/i,v=1/n;break;case 180:y=Se._rescale,f=e/n+1,m=-t/i,g=-1/n,v=1/i;break;case 270:y=Se._rescaleAndSwap,f=t/i+1,m=e/n+1,g=-1/i,v=-1/n;break}if(!o){o=[];for(const b of l){const w=b.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const k=new Float32Array(3*(w-2));o.push(k);let[N,E,S,A]=b.subarray(0,4);k.set([NaN,NaN,NaN,NaN,N,E],0);for(let C=4;C<w;C+=2){const I=b[C],L=b[C+1];k.set(Se.createBezierPoints(N,E,S,A,I,L),(C-2)*3),[N,E,S,A]=[S,A,I,L]}}}for(let b=0,w=o.length;b<w;b++)c.push({line:y(o[b].map(k=>k??NaN),f,m,g,v),points:y(l[b].map(k=>k??NaN),f,m,g,v)});const x=new this.prototype.constructor;return x.build(c,n,i,1,u,h,a),x}#l(e=this.#c){const t=this.#r+e/2*this.#n;return this.#o%180===0?[t/this.#a,t/this.#i]:[t/this.#i,t/this.#a]}#h(){const[e,t,n,i]=this.#e,[a,o]=this.#l(0);return[e+a,t+o,n-2*a,i-2*o]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#s){if(i.length<=12){for(let l=4,u=i.length;l<u;l+=6)Ae.pointBoundingBox(i[l],i[l+1],e);continue}let a=i[4],o=i[5];for(let l=6,u=i.length;l<u;l+=6){const[h,c,f,m,g,v]=i.subarray(l,l+6);Ae.bezierBoundingBox(a,o,h,c,f,m,g,v,e),a=g,o=v}}const[t,n]=this.#l();e[0]=Bs(e[0]-t,0,1),e[1]=Bs(e[1]-n,0,1),e[2]=Bs(e[2]+t,0,1),e[3]=Bs(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[i,a]=this.#l(),[o,l]=[i-t,a-n],u=this.#e;return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u}updateParentDimensions([e,t],n){const[i,a]=this.#l();this.#a=e,this.#i=t,this.#n=n;const[o,l]=this.#l(),u=o-i,h=l-a,c=this.#e;return c[0]-=u,c[1]-=h,c[2]+=2*u,c[3]+=2*h,c}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Se.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,i=0,a=0,o=0,l=0,u=0;switch(this.#t){case 90:i=t/e,a=-e/t,l=e;break;case 180:n=-1,o=-1,l=e,u=t;break;case 270:i=-t/e,a=e/t,u=t;break;default:return""}return`matrix(${n} ${i} ${a} ${o} ${Se.svgRound(l)} ${Se.svgRound(u)})`}getPathResizingSVGProperties([e,t,n,i]){const[a,o]=this.#l(),[l,u,h,c]=this.#e;if(Math.abs(h-a)<=Se.PRECISION||Math.abs(c-o)<=Se.PRECISION){const y=e+n/2-(l+h/2),x=t+i/2-(u+c/2);return{path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:`${this.rotationTransform} translate(${y} ${x})`}}}const f=(n-2*a)/(h-2*a),m=(i-2*o)/(c-2*o),g=h/n,v=c/i;return{path:{"transform-origin":`${Se.svgRound(l)} ${Se.svgRound(u)}`,transform:`${this.rotationTransform} scale(${g} ${v}) translate(${Se.svgRound(a)} ${Se.svgRound(o)}) scale(${f} ${m}) translate(${Se.svgRound(-a)} ${Se.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,n,i]){const[a,o]=this.#l(),l=this.#e,[u,h,c,f]=l;if(l[0]=e,l[1]=t,l[2]=n,l[3]=i,Math.abs(c-a)<=Se.PRECISION||Math.abs(f-o)<=Se.PRECISION){const x=e+n/2-(u+c/2),b=t+i/2-(h+f/2);for(const{line:w,points:k}of this.#s)Se._translate(w,x,b,w),Se._translate(k,x,b,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(n-2*a)/(c-2*a),g=(i-2*o)/(f-2*o),v=-m*(u+a)+e+a,y=-g*(h+o)+t+o;if(m!==1||g!==1||v!==0||y!==0)for(const{line:x,points:b}of this.#s)Se._rescale(x,v,y,m,g,x),Se._rescale(b,v,y,m,g,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[i,a]=n,o=this.#e,l=e-o[0],u=t-o[1];if(this.#a===i&&this.#i===a)for(const{line:h,points:c}of this.#s)Se._translate(h,l,u,h),Se._translate(c,l,u,c);else{const h=this.#a/i,c=this.#i/a;this.#a=i,this.#i=a;for(const{line:f,points:m}of this.#s)Se._rescale(f,l,u,h,c,f),Se._rescale(m,l,u,h,c,m);o[2]*=h,o[3]*=c}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Se.svgRound(e[0])} ${Se.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class _h extends PC{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Oe._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new _h(this._viewParameters);return e.updateAll(this),e}}class Ly extends ht{static _type="ink";static _editorType=Ke.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Oe.initialize(e,t),this._defaultDrawingOptions=new _h(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Xe(this,"typesMap",new Map([[nt.INK_THICKNESS,"stroke-width"],[nt.INK_COLOR,"stroke"],[nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,a){return new MH(e,t,n,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,a,o){return gc.deserialize(e,t,n,i,a,o)}static async deserialize(e,t,n){let i=null;if(e instanceof My){const{data:{inkLists:o,rect:l,rotation:u,id:h,color:c,opacity:f,borderStyle:{rawWidth:m},popupRef:g,richText:v,contentsObj:y,creationDate:x,modificationDate:b},parent:{page:{pageNumber:w}}}=e;i=e={annotationType:Ke.INK,color:Array.from(c),thickness:m,opacity:f,paths:{points:o},boxes:null,pageIndex:w-1,rect:l.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:g,richText:v,comment:y?.str||null,creationDate:x,modificationDate:b}}const a=await super.deserialize(e,t,n);return a._initialData=i,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||=new tc(this),[["colorPicker",this._colorPicker]]}get colorType(){return nt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=Ly.getDefaultDrawingOptions({stroke:Ae.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(e),{color:Oe._colorManager.convert(i),opacity:a,thickness:o,paths:{lines:t,points:n}});return this.addComment(l),e?(l.isCopy=!0,l):this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:n,opacity:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((o,l)=>o!==t[l])||e.thickness!==n||e.opacity!==i||e.pageIndex!==a}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class Kx extends gc{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Zd=8,jl=3;class Ga{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,i){return n-=e,i-=t,n===0?i>0?0:4:n===1?i+6:2-i}static#r=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#s(e,t,n,i,a,o,l){const u=this.#t(n,i,a,o);for(let h=0;h<8;h++){const c=(-h+u-l+16)%8,f=this.#r[2*c],m=this.#r[2*c+1];if(e[(n+f)*t+(i+m)]!==0)return c}return-1}static#a(e,t,n,i,a,o,l){const u=this.#t(n,i,a,o);for(let h=0;h<8;h++){const c=(h+u+l+16)%8,f=this.#r[2*c],m=this.#r[2*c+1];if(e[(n+f)*t+(i+m)]!==0)return c}return-1}static#i(e,t,n,i){const a=e.length,o=new Int32Array(a);for(let c=0;c<a;c++)o[c]=e[c]<=i?1:0;for(let c=1;c<n-1;c++)o[c*t]=o[c*t+t-1]=0;for(let c=0;c<t;c++)o[c]=o[t*n-1-c]=0;let l=1,u;const h=[];for(let c=1;c<n-1;c++){u=1;for(let f=1;f<t-1;f++){const m=c*t+f,g=o[m];if(g===0)continue;let v=c,y=f;if(g===1&&o[m-1]===0)l+=1,y-=1;else if(g>=1&&o[m+1]===0)l+=1,y+=1,g>1&&(u=g);else{g!==1&&(u=Math.abs(g));continue}const x=[f,c],b=y===f+1,w={isHole:b,points:x,id:l,parent:0};h.push(w);let k;for(const M of h)if(M.id===u){k=M;break}k?k.isHole?w.parent=b?k.parent:u:w.parent=b?u:k.parent:w.parent=b?u:0;const N=this.#s(o,t,c,f,v,y,0);if(N===-1){o[m]=-l,o[m]!==1&&(u=Math.abs(o[m]));continue}let E=this.#r[2*N],S=this.#r[2*N+1];const A=c+E,C=f+S;v=A,y=C;let I=c,L=f;for(;;){const M=this.#a(o,t,I,L,v,y,1);E=this.#r[2*M],S=this.#r[2*M+1];const D=I+E,F=L+S;x.push(F,D);const q=I*t+L;if(o[q+1]===0?o[q]=-l:o[q]===1&&(o[q]=l),D===c&&F===f&&I===A&&L===C){o[m]!==1&&(u=Math.abs(o[m]));break}else v=I,y=L,I=D,L=F}}}return h}static#n(e,t,n,i){if(n-t<=4){for(let A=t;A<n-2;A+=2)i.push(e[A],e[A+1]);return}const a=e[t],o=e[t+1],l=e[n-4]-a,u=e[n-3]-o,h=Math.hypot(l,u),c=l/h,f=u/h,m=c*o-f*a,g=u/l,v=1/h,y=Math.atan(g),x=Math.cos(y),b=Math.sin(y),w=v*(Math.abs(x)+Math.abs(b)),k=v*(1-w+w**2),N=Math.max(Math.atan(Math.abs(b+x)*k),Math.atan(Math.abs(b-x)*k));let E=0,S=t;for(let A=t+2;A<n-2;A+=2){const C=Math.abs(m-c*e[A+1]+f*e[A]);C>E&&(S=A,E=C)}E>(h*N)**2?(this.#n(e,t,S+2,i),this.#n(e,S,n,i)):i.push(a,o)}static#o(e){const t=[],n=e.length;return this.#n(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,i,a,o){const l=new Float32Array(o**2),u=-2*i**2,h=o>>1;for(let y=0;y<o;y++){const x=(y-h)**2;for(let b=0;b<o;b++)l[y*o+b]=Math.exp((x+(b-h)**2)/u)}const c=new Float32Array(256),f=-2*a**2;for(let y=0;y<256;y++)c[y]=Math.exp(y**2/f);const m=e.length,g=new Uint8Array(m),v=new Uint32Array(256);for(let y=0;y<n;y++)for(let x=0;x<t;x++){const b=y*t+x,w=e[b];let k=0,N=0;for(let S=0;S<o;S++){const A=y+S-h;if(!(A<0||A>=n))for(let C=0;C<o;C++){const I=x+C-h;if(I<0||I>=t)continue;const L=e[A*t+I],M=l[S*o+C]*c[Math.abs(L-w)];k+=L*M,N+=M}}const E=g[b]=Math.round(k/N);v[E]++}return[g,v]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#h(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,a=1/0;for(let l=0,u=n.length;l<u;l++){const h=n[l]=e[l<<2];i=Math.max(i,h),a=Math.min(a,h)}const o=255/(i-a);for(let l=0,u=n.length;l<u;l++)n[l]=(n[l]-a)*o;return n}static#u(e){let t,n=-1/0,i=-1/0;const a=e.findIndex(u=>u!==0);let o=a,l=a;for(t=a;t<256;t++){const u=e[t];u>n&&(t-o>i&&(i=t-o,l=t-1),n=u,o=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:i}=e,{maxDim:a}=this.#e;let o=n,l=i;if(n>a||i>a){let m=n,g=i,v=Math.log2(Math.max(n,i)/a);const y=Math.floor(v);v=v===y?y-1:y;for(let b=0;b<v;b++){o=Math.ceil(m/2),l=Math.ceil(g/2);const w=new OffscreenCanvas(o,l);w.getContext("2d").drawImage(e,0,0,m,g,0,0,o,l),m=o,g=l,e!==t&&e.close(),e=w.transferToImageBitmap()}const x=Math.min(a/o,a/l);o=Math.round(o*x),l=Math.round(l*x)}const h=new OffscreenCanvas(o,l).getContext("2d",{willReadFrequently:!0});h.fillStyle="white",h.fillRect(0,0,o,l),h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,o,l);const c=h.getImageData(0,0,o,l).data;return[this.#h(c),o,l]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},a,o,l,u){let h=new OffscreenCanvas(1,1),c=h.getContext("2d",{alpha:!1});const f=200,m=c.font=`${n} ${i} ${f}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:v,actualBoundingBoxAscent:y,actualBoundingBoxDescent:x,fontBoundingBoxAscent:b,fontBoundingBoxDescent:w,width:k}=c.measureText(e),N=1.5,E=Math.ceil(Math.max(Math.abs(g)+Math.abs(v)||0,k)*N),S=Math.ceil(Math.max(Math.abs(y)+Math.abs(x)||f,Math.abs(b)+Math.abs(w)||f)*N);h=new OffscreenCanvas(E,S),c=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=m,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,E,S),c.fillStyle="black",c.fillText(e,E*(N-1)/2,S*(3-N)/2);const A=this.#h(c.getImageData(0,0,E,S).data),C=this.#l(A),I=this.#u(C),L=this.#i(A,E,S,I);return this.processDrawnLines({lines:{curves:L,width:E,height:S},pageWidth:a,pageHeight:o,rotation:l,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,a){const[o,l,u]=this.#f(e),[h,c]=this.#c(o,l,u,Math.hypot(l,u)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),f=this.#u(c),m=this.#i(h,l,u,f);return this.processDrawnLines({lines:{curves:m,width:l,height:u},pageWidth:t,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:o,areContours:l}){i%180!==0&&([t,n]=[n,t]);const{curves:u,width:h,height:c}=e,f=e.thickness??0,m=[],g=Math.min(t/h,n/c),v=g/t,y=g/n,x=[];for(const{points:w}of u){const k=o?this.#o(w):w;if(!k)continue;x.push(k);const N=k.length,E=new Float32Array(N),S=new Float32Array(3*(N===2?2:N-2));if(m.push({line:S,points:E}),N===2){E[0]=k[0]*v,E[1]=k[1]*y,S.set([NaN,NaN,NaN,NaN,E[0],E[1]],0);continue}let[A,C,I,L]=k;A*=v,C*=y,I*=v,L*=y,E.set([A,C,I,L],0),S.set([NaN,NaN,NaN,NaN,A,C],0);for(let M=4;M<N;M+=2){const D=E[M]=k[M]*v,F=E[M+1]=k[M+1]*y;S.set(Se.createBezierPoints(A,C,I,L,D,F),(M-2)*3),[A,C,I,L]=[I,L,D,F]}}if(m.length===0)return null;const b=l?new Kx:new gc;return b.build(m,t,n,1,i,l?0:f,a),{outline:b,newCurves:x,areContours:l,thickness:f,width:h,height:c}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:a}){let o=1/0,l=-1/0,u=0;for(const k of e){u+=k.length;for(let N=2,E=k.length;N<E;N++){const S=k[N]-k[N-2];o=Math.min(o,S),l=Math.max(l,S)}}let h;o>=-128&&l<=127?h=Int8Array:o>=-32768&&l<=32767?h=Int16Array:h=Int32Array;const c=e.length,f=Zd+jl*c,m=new Uint32Array(f);let g=0;m[g++]=f*Uint32Array.BYTES_PER_ELEMENT+(u-2*c)*h.BYTES_PER_ELEMENT,m[g++]=0,m[g++]=i,m[g++]=a,m[g++]=t?0:1,m[g++]=Math.max(0,Math.floor(n??0)),m[g++]=c,m[g++]=h.BYTES_PER_ELEMENT;for(const k of e)m[g++]=k.length-2,m[g++]=k[0],m[g++]=k[1];const v=new CompressionStream("deflate-raw"),y=v.writable.getWriter();await y.ready,y.write(m);const x=h.prototype.constructor;for(const k of e){const N=new x(k.length-2);for(let E=2,S=k.length;E<S;E++)N[E-2]=k[E]-k[E-2];y.write(N)}y.close();const b=await new Response(v.readable).arrayBuffer(),w=new Uint8Array(b);return rC(w)}static async decompressSignature(e){try{const t=Q7(e),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),a=i.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,l=0;for await(const k of n)o||=new Uint8Array(new Uint32Array(k.buffer,0,4)[0]),o.set(k,l),l+=k.length;const u=new Uint32Array(o.buffer,0,o.length>>2),h=u[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const c=u[2],f=u[3],m=u[4]===0,g=u[5],v=u[6],y=u[7],x=[],b=(Zd+jl*v)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(y){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,b);break}l=0;for(let k=0;k<v;k++){const N=u[jl*k+Zd],E=new Float32Array(N+2);x.push(E);for(let S=0;S<jl-1;S++)E[S]=u[jl*k+Zd+S+1];for(let S=0;S<N;S++)E[S+2]=E[S]+w[l++]}return{areContours:m,thickness:g,outlines:x,width:c,height:f}}catch(t){return $e(`decompressSignature: ${t}`),null}}}class Iy extends PC{constructor(){super(),super.updateProperties({fill:Oe._defaultLineColor,"stroke-width":0})}clone(){const e=new Iy;return e.updateAll(this),e}}class By extends _h{constructor(e){super(e),super.updateProperties({stroke:Oe._defaultLineColor,"stroke-width":1})}clone(){const e=new By(this._viewParameters);return e.updateAll(this),e}}class nn extends ht{#e=!1;#t=null;#r=null;#s=null;static _type="signature";static _editorType=Ke.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#r=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Oe.initialize(e,t),this._defaultDrawingOptions=new Iy,this._defaultDrawnSignatureOptions=new By(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Xe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#r){const{lines:i,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:h}=this.#r,{rawDims:{pageWidth:c,pageHeight:f},rotation:m}=this.parent.viewport,g=Ga.processDrawnLines({lines:i,pageWidth:c,pageHeight:f,rotation:m,innerMargin:nn._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(g,h,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#s=e,this.addEditToolbar()}getUuid(){return this.#s}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:a}=this.#r,o=Math.max(i,a),l=Ga.processDrawnLines({lines:{curves:e.map(u=>({points:u})),thickness:n,width:i,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:a,y:o}=this,{outline:l}=this.#r=e;this.#e=l instanceof Kx,this.description=n;let u;this.#e?u=nn.getDefaultDrawingOptions():(u=nn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,h]=this.pageDimensions;let c=t/h;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Ga.process(e,t,n,i,nn._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:a}=this.parent.viewport;return Ga.extractContoursFromText(e,t,n,i,a,nn._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Ga.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:nn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=nn.getDefaultDrawingOptions():(this._drawingOptions=nn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:i});return this.addComment(a),e?(a.paths={lines:t,points:n},a.uuid=this.#s,a.isCopy=!0):a.lines=t,this.#t&&(a.accessibilityData={type:"Figure",alt:this.#t}),a}static deserializeDraw(e,t,n,i,a,o){return o.areContours?Kx.deserialize(e,t,n,i,a,o):gc.deserialize(e,t,n,i,a,o)}static async deserialize(e,t,n){const i=await super.deserialize(e,t,n);return i.#e=e.areContours,i.description=e.accessibilityData?.alt||"",i.#s=e.uuid,i}}class OH extends Oe{#e=null;#t=null;#r=null;#s=null;#a=null;#i="";#n=null;#o=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=Ke.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#s=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Oe.initialize(e,t)}static isHandlingMimeForPasting(e){return zx.includes(e)}static paste(e,t){t.pasteEditor({mode:Ke.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#i=e.file.name),this.#p()}#f(){if(this.#r=null,this._uiManager.enableWaiting(!1),!!this.#n){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,l=await n.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),t&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#u(i)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromFile(n).then(i=>this.#u(i)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=zx.join(",");const t=this._uiManager._signal;this.#r=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#n?.remove(),this.#n=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#n===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#r||this.#e||this.#s||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,i&&(this.#e=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#m()},e)}#p(){const{div:e}=this;let{width:t,height:n}=this.#e;const[i,a]=this.pageDimensions,o=.75;if(this.width)t=this.width*i,n=this.height*a;else if(t>o*i||n>o*a){const u=Math.min(o*i/t,o*a/n);t*=u,n*=u}this._uiManager.enableWaiting(!1);const l=this.#n=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=t/i,this.height=n/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:i,height:a}=this.#e,o=new gn;let l=this.#e,u=i,h=a,c=null;if(t){if(i>t||a>t){const S=Math.min(t/i,t/a);u=Math.floor(i*S),h=Math.floor(a*S)}c=document.createElement("canvas");const m=c.width=Math.ceil(u*o.sx),g=c.height=Math.ceil(h*o.sy);this.#l||(l=this.#d(m,g));const v=c.getContext("2d");v.filter=this._uiManager.hcmFilter;let y="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":rU.isDarkMode&&(y="#8f8f9d",x="#42414d");const b=15,w=b*o.sx,k=b*o.sy,N=new OffscreenCanvas(w*2,k*2),E=N.getContext("2d");E.fillStyle=y,E.fillRect(0,0,w*2,k*2),E.fillStyle=x,E.fillRect(0,0,w,k),E.fillRect(w,k,w,k),v.fillStyle=v.createPattern(N,"repeat"),v.fillRect(0,0,m,g),v.drawImage(l,0,0,l.width,l.height,0,0,m,g)}let f=null;if(n){let m,g;if(o.symmetric&&l.width<e&&l.height<e)m=l.width,g=l.height;else if(l=this.#e,i>e||a>e){const x=Math.min(e/i,e/a);m=Math.floor(i*x),g=Math.floor(a*x),this.#l||(l=this.#d(m,g))}const y=new OffscreenCanvas(m,g).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,m,g),f={width:m,height:g,data:y.getImageData(0,0,m,g).data}}return{canvas:c,width:u,height:h,imageData:f}}#d(e,t){const{width:n,height:i}=this.#e;let a=n,o=i,l=this.#e;for(;a>2*e||o>2*t;){const u=a,h=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const c=new OffscreenCanvas(a,o);c.getContext("2d").drawImage(l,0,0,u,h,0,0,a,o),l=c.transferToImageBitmap()}return l}#m(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,a=new gn,o=Math.ceil(n*e*a.sx),l=Math.ceil(i*t*a.sy),u=this.#n;if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const h=this.#l?this.#e:this.#d(o,l),c=u.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(h,0,0,h.width,h.height,0,0,o,l)}#x(e){if(e){if(this.#l){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,i=Math.round(this.width*t*jo.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*jo.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let i=null,a=!1;if(e instanceof RC){const{data:{rect:y,rotation:x,id:b,structParent:w,popupRef:k,richText:N,contentsObj:E,creationDate:S,modificationDate:A},container:C,parent:{page:{pageNumber:I}},canvas:L}=e;let M,D;L?(delete e.canvas,{id:M,bitmap:D}=n.imageManager.getFromCanvas(C.id,L),L.remove()):(a=!0,e._hasNoCanvas=!0);const F=(await t._structTree.getAriaAttributes(`${so}${b}`))?.get("aria-label")||"";i=e={annotationType:Ke.STAMP,bitmapId:M,bitmap:D,pageIndex:I-1,rect:y.slice(0),rotation:x,annotationElementId:b,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:F},isSvg:!1,structParent:w,popupRef:k,richText:N,comment:E?.str||null,creationDate:S,modificationDate:A}}const o=await super.deserialize(e,t,n),{rect:l,bitmap:u,bitmapUrl:h,bitmapId:c,isSvg:f,accessibilityData:m}=e;a?(n.addMissingCanvas(e.id,o),o.#o=!0):c&&n.imageManager.isValidId(c)?(o.#t=c,u&&(o.#e=u)):o.#s=h,o.#l=f;const[g,v]=o.pageDimensions;return o.width=(l[2]-l[0])/g,o.height=(l[3]-l[1])/v,m&&(o.altTextData=m),o._initialData=i,e.comment&&o.setCommentData(e),o.#h=!!i,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#x(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=this.#v(n);return l.isSame?null:(l.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const o=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:n}),n.bitmap=this.#x(!1);else if(this.#l){const l=t.stamps.get(this.#t);o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=this.#x(!1))}return n}#v(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,i=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class An{#e;#t=!1;#r=null;#s=null;#a=null;#i=new Map;#n=!1;#o=!1;#c=!1;#l=null;#h=null;#u=null;#f=null;#g=null;#p=-1;#d;static _initialized=!1;static#m=new Map([hs,Ly,OH,Yt,nn].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:o,drawLayer:l,textLayer:u,viewport:h,l10n:c}){const f=[...An.#m.values()];if(!An._initialized){An._initialized=!0;for(const m of f)m.initialize(c,e)}e.registerEditorTypes(f),this.#d=e,this.pageIndex=t,this.div=n,this.#e=a,this.#r=o,this.viewport=h,this.#u=u,this.drawLayer=l,this._structTree=i,this.#d.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#d.getMode()===Ke.NONE}updateToolbar(e){this.#d.updateToolbar(e)}updateMode(e=this.#d.getMode()){switch(this.#j(),e){case Ke.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ke.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ke.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ke.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of An.#m.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#d.setEditingState(e)}addCommands(e){this.#d.addCommands(e)}cleanUndoStack(e){this.#d.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#r?.togglePointerEvents(e)}get#x(){return this.#i.size!==0?this.#i.values():this.#d.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const e=new Set;for(const n of this.#x)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#d.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#r;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#d.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#c=!1,this.#d._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#g){this.#g=new AbortController;const i=this.#d.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:h}=a,c=this.#p;if(h-c>500){this.#p=h;return}this.#p=-1;const{classList:f}=this.div;f.toggle("getElements",!0);const m=document.elementsFromPoint(l,u);if(f.toggle("getElements",!1),!this.div.contains(m[0]))return;let g;const v=new RegExp(`^${Ql}[0-9]+$`);for(const x of m)if(v.test(x.id)){g=x.id;break}if(!g)return;const y=this.#i.get(g);y?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),y.dblclick(a))},{signal:i,capture:!0})}const e=this.#r,t=[];if(e){const i=new Map,a=new Map;for(const l of this.#x){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){i.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(this.#d.isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let h=a.get(u);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=i.get(u),h&&(this.#d.addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}this.#j(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of An.#m.values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#r?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#d.getActive()!==e&&this.#d.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#d.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#v.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#v(e){this.#d.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:n}=Es.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#d.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Yt.startHighlighting(this,this.#d.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#d._signal}),e.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;const e=this.#d.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#s?.abort(),this.#s=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#d.isDeletedAnnotationElement(t)&&this.#d.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#d.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#d.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#d.addDeletedAnnotationElement(e.annotationElementId),Oe.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#d.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#d.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#d._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#i.values())if(t.uid===e)return t;return null}getNextId(){return this.#d.getId()}get#y(){return An.#m.get(this.#d.getMode())}combinedSignal(e){return this.#d.combinedSignal(e)}#E(e){const t=this.#y;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#d.updateMode(e.mode);const{offsetX:n,offsetY:i}=this.#N(),a=this.getNextId(),o=this.#E({parent:this,id:a,x:n,y:i,uiManager:this.#d,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await An.#m.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#d)||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),a=this.#E({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#d,isCentered:t,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#N(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,a=Math.max(0,e),o=Math.max(0,t),l=Math.min(window.innerWidth,e+n),u=Math.min(window.innerHeight,t+i),h=(a+l)/2-e,c=(o+u)/2-t,[f,m]=this.viewport.rotation%180===0?[h,c]:[c,h];return{offsetX:f,offsetY:m}}addNewEditor(e={}){this.createAndAddNewEditor(this.#N(),!0,e)}setSelected(e){this.#d.setSelected(e)}toggleSelected(e){this.#d.toggleSelected(e)}unselect(e){this.#d.unselect(e)}pointerup(e){const{isMac:t}=Es.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#n||(this.#n=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#d.getMode();if(n===Ke.STAMP||n===Ke.SIGNATURE){this.#d.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#d.getMode()===Ke.HIGHLIGHT&&this.enableTextSelection(),this.#n){this.#n=!1;return}const{isMac:t}=Es.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#n=!0,this.#y?.isDrawer){this.startDrawingSession(e);return}const n=this.#d.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#d,!1,e);return}this.#d.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#d.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#y.startDrawing(this,this.#d,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#d.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#y.endDrawing(e)):null}findNewParent(e,t,n){const i=this.#d.findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#d.getActive()?.parent===this&&(this.#d.commitOrRemove(),this.#d.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#d.removeLayer(this)}#j(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,ha(this.div,e);for(const t of this.#d.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#d.commitOrRemove(),this.#j();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,ha(this.div,{rotation:n}),t!==n)for(const i of this.#i.values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#d.viewParameters.realScale}}class ws{#e=null;#t=new Map;#r=new Map;static#s=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Xe(this,"_svgFactory",new qu)}static#a(e,[t,n,i,a]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*a}%`}#i(){const e=ws._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#n(e,t){const n=ws._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=ws._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),i}#o(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)}draw(e,t=!1,n=!1){const i=ws.#s++,a=this.#i(),o=ws._svgFactory.createElement("defs");a.append(o);const l=ws._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#r.set(i,l);const h=n?this.#n(o,u):null,c=ws._svgFactory.createElement("use");return a.append(c),c.setAttribute("href",`#${u}`),this.updateProperties(a,e),this.#t.set(i,a),{id:i,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=ws.#s++,i=this.#i(),a=ws._svgFactory.createElement("defs");i.append(a);const o=ws._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(t){const f=ws._svgFactory.createElement("mask");a.append(f),u=`mask_p${this.pageIndex}_${n}`,f.setAttribute("id",u),f.setAttribute("maskUnits","objectBoundingBox");const m=ws._svgFactory.createElement("rect");f.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const g=ws._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${l}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const h=ws._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${l}`),u&&h.setAttribute("mask",`url(#${u})`);const c=h.cloneNode();return i.append(c),h.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(n,i),n}finalizeDraw(e,t){this.#r.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:a,path:o}=t,l=typeof e=="number"?this.#t.get(e):e;if(l){if(n&&this.#o(l,n),i&&ws.#a(l,i),a){const{classList:u}=l;for(const[h,c]of Object.entries(a))u.toggle(h,c)}if(o){const h=l.firstChild.firstChild;this.#o(h,o)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#r.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#r.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Gx};globalThis.pdfjsLib={AbortException:Si,AnnotationEditorLayer:An,AnnotationEditorParamsType:nt,AnnotationEditorType:Ke,AnnotationEditorUIManager:_i,AnnotationLayer:Oy,AnnotationMode:ui,AnnotationType:ts,applyOpacity:iU,build:uH,ColorPicker:kr,createValidAbsoluteUrl:ZA,CSSConstants:nU,DOMSVGFactory:qu,DrawLayer:ws,FeatureTest:Es,fetchData:uc,findContrastColor:aU,getDocument:wC,getFilenameFromUrl:J7,getPdfFilenameFromUrl:Z7,getRGB:fc,getUuid:sC,getXfaPageViewport:tU,GlobalWorkerOptions:fo,ImageKind:hu,InvalidPDFException:Bx,isDataScheme:kh,isPdfFile:Ey,isValidExplicitDest:gU,MathClamp:Bs,noContextMenu:Cr,normalizeUnicode:K7,OPS:Jl,OutputScale:gn,PasswordResponses:z7,PDFDataRangeTransport:NC,PDFDateString:Fx,PDFWorker:ec,PermissionFlag:F7,PixelsPerInch:jo,RenderingCancelledException:ky,renderRichText:iC,ResponseException:Hu,setLayerDimensions:ha,shadow:Xe,SignatureExtractor:Ga,stopEvent:qt,SupportedImageMimeTypes:zx,TextLayer:Ls,TouchManager:Eh,updateUrlHash:eC,Util:Ae,VerbosityLevel:jh,version:SC,XfaLayer:nC};fo.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${SC}/pdf.worker.min.js`;function LH({blob:r,onClose:e}){const t=R.useRef(null),[n,i]=R.useState(null),[a,o]=R.useState(1),[l,u]=R.useState(0),[h,c]=R.useState(1.5);R.useEffect(()=>{r&&(async()=>{try{const x=await wC(URL.createObjectURL(r)).promise;i(x),u(x.numPages)}catch(x){console.error("Error loading PDF:",x)}})()},[r]),R.useEffect(()=>{(async()=>{if(!(!n||!t.current))try{const x=await n.getPage(a),b=x.getViewport({scale:h}),w=t.current,k=w.getContext("2d");w.height=b.height,w.width=b.width;const N={canvasContext:k,viewport:b};await x.render(N).promise}catch(x){console.error("Error rendering page:",x)}})()},[n,a,h]);const f=()=>{o(y=>Math.max(y-1,1))},m=()=>{o(y=>Math.min(y+1,l))},g=()=>c(y=>y+.25),v=()=>c(y=>Math.max(y-.25,.5));return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",a," of ",l]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{size:"sm",onClick:v,children:"-"}),s.jsxs("span",{className:"text-sm self-center",children:[Math.round(h*100),"%"]}),s.jsx(oe,{size:"sm",onClick:g,children:"+"})]})]}),s.jsx(oe,{variant:"secondary",size:"sm",onClick:e,children:s.jsx(ot,{})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-4 flex justify-center",children:s.jsx("canvas",{ref:t,className:"shadow-lg"})}),s.jsxs("div",{className:"flex items-center justify-between p-4 border-t",children:[s.jsxs(oe,{variant:"secondary",onClick:f,disabled:a<=1,children:[s.jsx(s0,{})," Prcdent"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",min:"1",max:l,value:a,onChange:y=>o(Math.min(Math.max(parseInt(y.target.value)||1,1),l)),className:"w-16 px-2 py-1 border rounded text-center"}),s.jsxs("span",{className:"self-center",children:["/ ",l]})]}),s.jsxs(oe,{variant:"secondary",onClick:m,disabled:a>=l,children:["Suivant ",s.jsx(r0,{})]})]})]})})}function IH(){const[r]=FD(),e=r.get("id"),[t,n]=R.useState(null),[i,a]=R.useState(!0);return R.useEffect(()=>{(async()=>{if(e)try{const l=await s_(e);n(l)}catch(l){console.error("Error loading ebook:",l)}finally{a(!1)}})()},[e]),i?s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-blue-900",children:"Chargement de l'ebook..."})]})}):t?s.jsx(LH,{blob:t.blob,onClose:()=>window.history.back()}):s.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(et,{className:"text-6xl text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ebook non trouv"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"L'ebook demand n'est pas disponible."}),s.jsxs(oe,{onClick:()=>window.history.back(),children:[s.jsx(Xu,{className:"mr-2"}),"Retour"]})]})})}const ci="https://vakio-boky-backend.onrender.com/api",BH=()=>{const[r,e]=R.useState([]),[t,n]=R.useState([]),[i,a]=R.useState([]),[o,l]=R.useState([]),[u,h]=R.useState(!1),[c,f]=R.useState(""),{user:m}=st(),g=async()=>{h(!0),f("");try{const S=await(await fetch(`${ci}/challenges`)).json();S.success?e(S.challenges):f(S.error||"Erreur lors du chargement des dfis")}catch(E){f("Erreur de connexion"),console.error("Error fetching challenges:",E)}finally{h(!1)}},v=async()=>{if(m?.token){h(!0),f("");try{const S=await(await fetch(`${ci}/challenges/user/progress`,{headers:{Authorization:`Bearer ${m.token}`}})).json();S.success?n(S.userChallenges):f(S.error||"Erreur lors du chargement de vos dfis")}catch(E){f("Erreur de connexion"),console.error("Error fetching user challenges:",E)}finally{h(!1)}}},y=async()=>{h(!0),f("");try{const S=await(await fetch(`${ci}/challenges/badges/all`)).json();S.success?a(S.badges):f(S.error||"Erreur lors du chargement des badges")}catch(E){f("Erreur de connexion"),console.error("Error fetching badges:",E)}finally{h(!1)}},x=async()=>{if(m?.token){h(!0),f("");try{const S=await(await fetch(`${ci}/challenges/badges/user`,{headers:{Authorization:`Bearer ${m.token}`}})).json();S.success?l(S.userBadges):f(S.error||"Erreur lors du chargement de vos badges")}catch(E){f("Erreur de connexion"),console.error("Error fetching user badges:",E)}finally{h(!1)}}},b=async E=>{if(!m?.token)return f("Vous devez tre connect pour rejoindre un dfi"),{success:!1,error:"Non authentifi"};h(!0),f("");try{const A=await(await fetch(`${ci}/challenges/${E}/join`,{method:"POST",headers:{Authorization:`Bearer ${m.token}`}})).json();return A.success?(await v(),{success:!0,message:A.message}):(f(A.error||"Erreur lors de l'inscription au dfi"),{success:!1,error:A.error})}catch(S){return f("Erreur de connexion"),console.error("Error joining challenge:",S),{success:!1,error:"Erreur de connexion"}}finally{h(!1)}},w=async(E,S)=>{if(!m?.token)return f("Vous devez tre connect pour mettre  jour votre progrs"),{success:!1,error:"Non authentifi"};h(!0),f("");try{const C=await(await fetch(`${ci}/challenges/${E}/progress`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m.token}`},body:JSON.stringify({progress:S})})).json();return C.success?(await v(),await x(),{success:!0,message:C.message}):(f(C.error||"Erreur lors de la mise  jour du progrs"),{success:!1,error:C.error})}catch(A){return f("Erreur de connexion"),console.error("Error updating progress:",A),{success:!1,error:"Erreur de connexion"}}finally{h(!1)}},k=async E=>{if(!m?.token)return f("Vous devez tre connect en tant qu'administrateur"),{success:!1,error:"Non authentifi"};h(!0),f("");try{const A=await(await fetch(`${ci}/challenges`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m.token}`},body:JSON.stringify(E)})).json();return A.success?(await g(),{success:!0,message:A.message,challenge:A.challenge}):(f(A.error||"Erreur lors de la cration du dfi"),{success:!1,error:A.error})}catch(S){return f("Erreur de connexion"),console.error("Error creating challenge:",S),{success:!1,error:"Erreur de connexion"}}finally{h(!1)}},N=async E=>{if(!m?.token)return f("Vous devez tre connect en tant qu'administrateur"),{success:!1,error:"Non authentifi"};h(!0),f("");try{const A=await(await fetch(`${ci}/challenges/badges`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m.token}`},body:JSON.stringify(E)})).json();return A.success?(await y(),{success:!0,message:A.message,badge:A.badge}):(f(A.error||"Erreur lors de la cration du badge"),{success:!1,error:A.error})}catch(S){return f("Erreur de connexion"),console.error("Error creating badge:",S),{success:!1,error:"Erreur de connexion"}}finally{h(!1)}};return R.useEffect(()=>{g(),y()},[]),R.useEffect(()=>{m&&(v(),x())},[m]),{challenges:r,userChallenges:t,badges:i,userBadges:o,loading:u,error:c,fetchChallenges:g,fetchUserChallenges:v,fetchBadges:y,fetchUserBadges:x,joinChallenge:b,updateProgress:w,createChallenge:k,createBadge:N}};function FH(){const{isAuthenticated:r}=st(),{challenges:e,userChallenges:t,badges:n,userBadges:i,loading:a,error:o,joinChallenge:l}=BH(),[u,h]=R.useState("challenges"),c=async g=>{const v=await l(g);v.success?alert("Vous avez rejoint le dfi avec succs !"):alert(v.error||"Erreur lors de l'inscription")},f=g=>t.find(v=>v.challenge_id===g),m=(g,v)=>Math.min(g/v*100,100);return a&&e.length===0?s.jsx("div",{className:"flex justify-center items-center min-h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Dfis et Badges"}),s.jsx("p",{className:"text-gray-600",children:"Relevez des dfis de lecture et gagnez des badges pour montrer votre progression !"})]}),o&&s.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-red-600",children:o})}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsxs("button",{onClick:()=>h("challenges"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="challenges"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(rs,{className:"inline mr-2"}),"Dfis Actifs"]}),s.jsxs("button",{onClick:()=>h("my-challenges"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="my-challenges"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(ct,{className:"inline mr-2"}),"Mes Dfis"]}),s.jsxs("button",{onClick:()=>h("badges"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="badges"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[s.jsx(fs,{className:"inline mr-2"}),"Tous les Badges"]}),s.jsx("button",{onClick:()=>h("my-badges"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="my-badges"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Mes Badges"})]})})}),u==="challenges"&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(g=>s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:g.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description})]}),g.reward_badge_icon&&s.jsx("img",{src:g.reward_badge_icon,alt:g.reward_badge_name,className:"w-12 h-12 rounded-full"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[s.jsxs("span",{children:["Objectif: ",g.target_value]}),s.jsxs("span",{children:["Type: ",g.type]})]}),g.end_date&&s.jsxs("p",{className:"text-xs text-gray-500",children:["chance: ",new Date(g.end_date).toLocaleDateString("fr-FR")]})]}),g.reward_badge_name&&s.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx(fs,{className:"inline mr-1"}),"Rcompense: ",g.reward_badge_name]})}),r?f(g.id)?s.jsx("div",{className:"text-center",children:s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:"Dj inscrit"})}):s.jsx(oe,{onClick:()=>c(g.id),className:"w-full",disabled:a,children:"Rejoindre le dfi"}):s.jsx("p",{className:"text-center text-gray-500 text-sm",children:"Connectez-vous pour rejoindre les dfis"})]},g.id))}),u==="my-challenges"&&s.jsx("div",{children:r?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.map(g=>s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:g.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description})]}),s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g.status==="completed"?"bg-green-100 text-green-800":g.status==="failed"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:g.status==="completed"?"Termin":g.status==="failed"?"chou":"En cours"})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:s.jsxs("span",{children:["Progression: ",g.current_value," / ",g.target_value]})}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${m(g.current_value,g.target_value)}%`}})})]}),g.reward_badge_name&&s.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx(fs,{className:"inline mr-1"}),"Rcompense: ",g.reward_badge_name]})}),g.end_date&&s.jsxs("p",{className:"text-xs text-gray-500",children:["chance: ",new Date(g.end_date).toLocaleDateString("fr-FR")]})]},g.id)),t.length===0&&s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(rs,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun dfi en cours"}),s.jsx("p",{className:"text-gray-500",children:"Rejoignez un dfi pour commencer votre progression !"})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(rs,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-500",children:"Connectez-vous pour voir vos dfis personnels."})]})}),u==="badges"&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(g=>{const v=i.some(y=>y.badge_id===g.id);return s.jsxs("div",{className:`rounded-lg shadow-md p-6 ${v?"bg-yellow-50 border-2 border-yellow-200":"bg-white"}`,children:[s.jsxs("div",{className:"flex items-center mb-4",children:[g.icon_url?s.jsx("img",{src:g.icon_url,alt:g.name,className:"w-16 h-16 rounded-full mr-4"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center mr-4",children:s.jsx(fs,{className:"w-8 h-8 text-gray-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g.name}),s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g.rarity==="legendary"?"bg-purple-100 text-purple-800":g.rarity==="epic"?"bg-red-100 text-red-800":g.rarity==="rare"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:g.rarity})]})]}),s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:[g.points," points"]}),v&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Obtenu"})]})]},g.id)})}),u==="my-badges"&&s.jsx("div",{children:r?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.map(g=>s.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg shadow-md p-6",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[g.icon_url?s.jsx("img",{src:g.icon_url,alt:g.name,className:"w-16 h-16 rounded-full mr-4"}):s.jsx("div",{className:"w-16 h-16 rounded-full bg-yellow-200 flex items-center justify-center mr-4",children:s.jsx(fs,{className:"w-8 h-8 text-yellow-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:g.name}),s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g.rarity==="legendary"?"bg-purple-100 text-purple-800":g.rarity==="epic"?"bg-red-100 text-red-800":g.rarity==="rare"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:g.rarity})]})]}),s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:[g.points," points"]}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Obtenu le ",new Date(g.earned_at).toLocaleDateString("fr-FR")]})]})]},g.id)),i.length===0&&s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun badge obtenu"}),s.jsx("p",{className:"text-gray-500",children:"Relevez des dfis pour gagner vos premiers badges !"})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connexion requise"}),s.jsx("p",{className:"text-gray-500",children:"Connectez-vous pour voir vos badges."})]})})]})}function zH(){const{id:r}=Ku(),{user:e}=st(),[t,n]=R.useState(null),[i,a]=R.useState([]),[o,l]=R.useState({content:"",media_url:null}),[u,h]=R.useState(null),[c,f]=R.useState(!0),[m,g]=R.useState(null),v=async()=>{try{const E=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}`,{headers:{Authorization:`Bearer ${e.token}`}})).json();E.success?n(E.club):g(E.message||"Erreur lors du chargement du club")}catch(N){console.error("Erreur chargement club:",N),g("Erreur de connexion au serveur")}},y=async()=>{try{const E=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/posts`,{headers:{Authorization:`Bearer ${e.token}`}})).json();console.log(" Posts reus:",E),E.success&&a(E.posts)}catch(N){console.error("Erreur chargement posts:",N)}finally{f(!1)}};R.useEffect(()=>{v(),y()},[r]);const x=N=>{l({...o,content:N.target.value})},b=N=>{const E=N.target.files[0];E&&(l({...o,media_url:E}),h(URL.createObjectURL(E)))},w=async()=>{if(!o.content.trim()){alert("Le contenu ne peut pas tre vide");return}const N=new FormData;N.append("content",o.content),o.media_url&&N.append("media_url",o.media_url);try{const S=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/posts`,{method:"POST",headers:{Authorization:`Bearer ${e.token}`},body:N})).json();console.log(" Rponse cration post:",S),S.success?(a([S.post,...i]),l({content:"",media_url:null}),h(null),alert("Post publi avec succs !")):alert(S.message||"Erreur lors de la publication")}catch(E){console.error("Erreur publication:",E),alert("Erreur lors de la publication")}},k=N=>N?N.startsWith("http")?N:`https://vakio-boky-backend.onrender.com${N}`:"/placeholder-club.jpg";return c?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100",children:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"text-blue-800 text-lg",children:"Chargement du club..."})}):m?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100",children:s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded-lg text-center max-w-md",children:m})}):t?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-xl p-6 mb-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("img",{src:k(t.image_url),alt:t.nom,className:"w-full md:w-64 h-48 object-cover rounded-xl shadow-md",onError:N=>{N.target.src="/placeholder-club.jpg"}})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsx("h1",{className:"text-3xl font-bold text-blue-900",children:t.nom}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{size:"sm",variant:"outline",onClick:()=>window.history.back(),children:"Retour"}),e&&t.createur_id===e.id&&s.jsx(oe,{size:"sm",variant:"secondary",onClick:()=>navigate(`/clubs/${r}/edit`),children:"Modifier"}),s.jsx(oe,{size:"sm",variant:"primary",onClick:()=>window.location.href=`/clubs/${r}/events`,children:"Voir les vnements"})]})]}),s.jsx("p",{className:"text-gray-600 text-lg mb-4",children:t.description}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-700 mr-2",children:"Catgorie:"}),t.categorie||"Non spcifie"]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-700 mr-2",children:"Type:"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.type==="physique"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:t.type==="physique"?"Physique":"Virtuel"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-700 mr-2",children:"Localisation:"}),t.ville&&t.pays?`${t.ville}, ${t.pays}`:"En ligne"]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-700 mr-2",children:"Visibilit:"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.visibilite==="public"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:t.visibilite})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-700 mr-2",children:"Crateur:"}),t.createur_nom||"Inconnu"]})]}),t.site_web&&s.jsx("div",{className:"mt-4",children:s.jsxs("a",{href:t.site_web,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center text-sm",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Site web du club"]})}),t.regles&&s.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Rgles du club:"}),s.jsx("p",{className:"text-sm text-blue-700",children:t.regles})]})]})]})}),s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl shadow-md p-6 mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Publier dans le club"}),s.jsx("textarea",{value:o.content,onChange:x,placeholder:"Partagez un extrait, une critique, une annonce...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("input",{type:"file",accept:"image/*,video/*,application/pdf",onChange:b,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Images, vidos ou PDF (max 10MB)"})]}),s.jsx(oe,{onClick:w,disabled:!o.content.trim(),className:"flex-shrink-0",children:"Publier"})]}),u&&s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Aperu:"}),s.jsx("img",{src:u,alt:"Preview",className:"max-w-xs max-h-48 object-cover rounded-lg shadow-sm"}),s.jsx("button",{onClick:()=>{l({...o,media_url:null}),h(null)},className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Supprimer l'image"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:["Publications du club (",i.length,")"]}),s.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>window.location.href=`/clubs/${r}/events`,children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Voir les vnements"]})]}),i.length===0?s.jsxs(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl shadow-md p-8 text-center",children:[s.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Aucune publication pour le moment."}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Soyez le premier  partager dans ce club !"})]}):i.map((N,E)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.1},className:"bg-white rounded-2xl shadow-md p-6",children:[s.jsx("p",{className:"text-gray-800 whitespace-pre-line mb-4",children:N.contenu}),N.media_url&&s.jsx("div",{className:"mb-4",children:s.jsx("img",{src:k(N.media_url),alt:"Media post",className:"max-w-full max-h-96 object-cover rounded-lg shadow-sm",onError:S=>{S.target.src="/placeholder-media.jpg"}})}),s.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 border-t border-gray-100 pt-3",children:[s.jsxs("div",{className:"flex items-center",children:[N.photo_profil?s.jsx("img",{src:k(N.photo_profil),alt:N.auteur_nom,className:"w-6 h-6 rounded-full mr-2"}):s.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-semibold mr-2",children:N.auteur_nom?.charAt(0)||"A"}),s.jsx("span",{className:"font-medium text-blue-600",children:N.auteur_nom||"Auteur inconnu"})]}),s.jsx("span",{children:new Date(N.created_at).toLocaleString("fr-FR")})]})]},N.id))]})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100",children:s.jsx("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-700 px-4 py-3 rounded-lg",children:"Club non trouv"})})}function UH(){const{user:r}=st(),e=qs(),[t,n]=R.useState({nom:"",description:"",categorie:"",ville:"",pays:"",site_web:"",regles:"",visibilite:"public",type:"physique"}),[i,a]=R.useState(null),[o,l]=R.useState(!1),[u,h]=R.useState(null),c=m=>{n({...t,[m.target.name]:m.target.value})},f=async m=>{m.preventDefault(),l(!0),h(null);try{const g=new FormData;Object.keys(t).forEach(x=>{g.append(x,t[x])}),i&&g.append("image",i);const y=await(await fetch("https://vakio-boky-backend.onrender.com/api/clubs",{method:"POST",headers:{Authorization:`Bearer ${r.token}`},body:g})).json();y.success?(alert(" Club cr avec succs !"),e(`/clubs/${y.club.id}`)):h(y.message||"Erreur lors de la cration du club")}catch(g){console.error(g),h("Erreur de connexion au serveur")}finally{l(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsx("div",{className:"max-w-2xl mx-auto px-4",children:s.jsxs(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-xl p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6 text-center",children:"Crer un nouveau club littraire"}),u&&s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-2 rounded-lg mb-4 text-center",children:u}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image du club"}),s.jsx("input",{type:"file",accept:"image/*",onChange:m=>a(m.target.files[0]),className:"w-full border border-gray-300 rounded-lg p-2"})]}),s.jsx("input",{name:"nom",placeholder:"Nom du club *",value:t.nom,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2",required:!0}),s.jsx("textarea",{name:"description",placeholder:"Description *",value:t.description,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2",rows:"3",required:!0}),s.jsx("input",{name:"categorie",placeholder:"Catgorie (ex: posie, roman)",value:t.categorie,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{name:"ville",placeholder:"Ville",value:t.ville,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsx("input",{name:"pays",placeholder:"Pays",value:t.pays,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2"})]}),s.jsx("input",{name:"site_web",placeholder:"Site web (optionnel)",value:t.site_web,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsx("textarea",{name:"regles",placeholder:"Rgles du club",value:t.regles,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2",rows:"2"}),s.jsxs("select",{name:"visibilite",value:t.visibilite,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2",children:[s.jsx("option",{value:"public",children:"Public"}),s.jsx("option",{value:"priv",children:"Priv"})]}),s.jsxs("select",{name:"type",value:t.type,onChange:c,className:"w-full border border-gray-300 rounded-lg p-2",children:[s.jsx("option",{value:"physique",children:"Club physique"}),s.jsx("option",{value:"virtuel",children:"Club virtuel"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>e("/club"),disabled:o,children:"Annuler"}),s.jsx(oe,{type:"submit",variant:"primary",disabled:o,children:o?"Cration...":"Crer le club"})]})]})]})})})}function HH(){const{id:r}=Ku(),{user:e}=st(),t=qs(),[n,i]=R.useState({nom:"",description:"",categorie:"",ville:"",pays:"",site_web:"",regles:"",visibilite:"public",type:"physique"}),[a,o]=R.useState(null),[l,u]=R.useState(""),[h,c]=R.useState(!1),[f,m]=R.useState(!0),[g,v]=R.useState(null);R.useEffect(()=>{y()},[r]);const y=async()=>{try{const k=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}`,{headers:{Authorization:`Bearer ${e.token}`}})).json();if(k.success){const N=k.club;i({nom:N.nom||"",description:N.description||"",categorie:N.categorie||"",ville:N.ville||"",pays:N.pays||"",site_web:N.site_web||"",regles:N.regles||"",visibilite:N.visibilite||"public",type:N.type||"physique"}),u(N.image_url||"")}else v(k.message||"Erreur lors du chargement du club")}catch(w){console.error("Erreur chargement club:",w),v("Erreur de connexion au serveur")}finally{m(!1)}},x=w=>{i({...n,[w.target.name]:w.target.value})},b=async w=>{w.preventDefault(),c(!0),v(null);try{const k=new FormData;Object.keys(n).forEach(S=>{k.append(S,n[S])}),a&&k.append("image",a),k.append("existing_image",l);const E=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}`,{method:"PUT",headers:{Authorization:`Bearer ${e.token}`},body:k})).json();E.success?(alert(" Club modifi avec succs !"),t(`/clubs/${r}`)):v(E.message||"Erreur lors de la modification du club")}catch(k){console.error(k),v("Erreur de connexion au serveur")}finally{c(!1)}};return f?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-blue-100",children:s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"text-blue-800 text-lg",children:"Chargement du club..."})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsx("div",{className:"max-w-2xl mx-auto px-4",children:s.jsxs(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-xl p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6 text-center",children:"Modifier le club"}),g&&s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-2 rounded-lg mb-4 text-center",children:g}),s.jsxs("form",{onSubmit:b,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image du club"}),l&&s.jsx("div",{className:"mb-2",children:s.jsx("img",{src:l.startsWith("http")?l:`https://vakio-boky-backend.onrender.com${l}`,alt:"Image actuelle",className:"w-32 h-32 object-cover rounded-lg"})}),s.jsx("input",{type:"file",accept:"image/*",onChange:w=>o(w.target.files[0]),className:"w-full border border-gray-300 rounded-lg p-2"})]}),s.jsx("input",{name:"nom",placeholder:"Nom du club *",value:n.nom,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2",required:!0}),s.jsx("textarea",{name:"description",placeholder:"Description *",value:n.description,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2",rows:"3",required:!0}),s.jsx("input",{name:"categorie",placeholder:"Catgorie (ex: posie, roman)",value:n.categorie,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{name:"ville",placeholder:"Ville",value:n.ville,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsx("input",{name:"pays",placeholder:"Pays",value:n.pays,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2"})]}),s.jsx("input",{name:"site_web",placeholder:"Site web (optionnel)",value:n.site_web,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2"}),s.jsx("textarea",{name:"regles",placeholder:"Rgles du club",value:n.regles,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2",rows:"2"}),s.jsxs("select",{name:"type",value:n.type,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2",children:[s.jsx("option",{value:"physique",children:"Club physique"}),s.jsx("option",{value:"virtuel",children:"Club virtuel"})]}),s.jsxs("select",{name:"visibilite",value:n.visibilite,onChange:x,className:"w-full border border-gray-300 rounded-lg p-2",children:[s.jsx("option",{value:"public",children:"Public"}),s.jsx("option",{value:"priv",children:"Priv"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>t(`/clubs/${r}`),disabled:h,children:"Annuler"}),s.jsx(oe,{type:"submit",variant:"primary",disabled:h,children:h?"Modification...":"Modifier le club"})]})]})]})})})}function VH(){const{id:r}=Ku(),{user:e}=st(),[t,n]=R.useState([]),[i,a]=R.useState(!1),[o,l]=R.useState(!1),[u,h]=R.useState(null),[c,f]=R.useState({titre:"",description:"",date_debut:"",date_fin:"",type:"rencontre",lieu:"",max_participants:"",lien_visio:""}),m=async()=>{try{const b=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/events`,{headers:{Authorization:`Bearer ${e.token}`}})).json();console.log(" vnements reus:",b),b.success&&n(b.events)}catch(x){console.error("Erreur:",x),h("Erreur lors du chargement des vnements")}};R.useEffect(()=>{m()},[r]);const g=async x=>{if(x.preventDefault(),l(!0),h(null),!c.titre.trim()){h("Le titre est requis"),l(!1);return}if(!c.date_debut){h("La date de dbut est requise"),l(!1);return}try{const b={titre:c.titre.trim(),description:c.description.trim(),date_debut:c.date_debut,date_fin:c.date_fin||null,type:c.type,lieu:c.lieu.trim()||null,max_participants:c.max_participants?parseInt(c.max_participants):null,lien_visio:c.lien_visio.trim()||null,club_id:parseInt(r)};console.log(" Envoi donnes vnement:",b);const k=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/events`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify(b)})).json();console.log(" Rponse cration vnement:",k),k.success?(a(!1),f({titre:"",description:"",date_debut:"",date_fin:"",type:"rencontre",lieu:"",max_participants:"",lien_visio:""}),m(),alert("vnement cr avec succs !")):h(k.message||"Erreur lors de la cration")}catch(b){console.error("Erreur cration:",b),h("Erreur de connexion au serveur")}finally{l(!1)}},v=async x=>{try{const w=await(await fetch(`https://vakio-boky-backend.onrender.com/api/events/${x}/join`,{method:"POST",headers:{Authorization:`Bearer ${e.token}`}})).json();w.success?(m(),alert("Inscription russie !")):alert(w.message)}catch{alert("Erreur lors de l'inscription")}},y=async x=>{try{const w=await(await fetch(`https://vakio-boky-backend.onrender.com/api/events/${x}/leave`,{method:"POST",headers:{Authorization:`Bearer ${e.token}`}})).json();w.success?(m(),alert("Dsinscription russie")):alert(w.message)}catch{alert("Erreur lors de la dsinscription")}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx(W.h1,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"text-3xl font-bold text-blue-900",children:"vnements du club"}),s.jsx(oe,{onClick:()=>a(!0),children:"Crer un vnement"})]}),u&&s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded-lg mb-6",children:u}),s.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.length===0?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx("svg",{className:"w-24 h-24 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucun vnement"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Soyez le premier  crer un vnement !"}),s.jsx(oe,{onClick:()=>a(!0),children:"Crer un vnement"})]}):t.map((x,b)=>s.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:b*.1},className:"bg-white rounded-2xl shadow-md p-6 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 flex-1",children:x.titre}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${x.type==="rencontre"?"bg-blue-100 text-blue-800":x.type==="webinar"?"bg-purple-100 text-purple-800":x.type==="atelier"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:x.type})]}),x.description&&s.jsx("p",{className:"text-gray-600 mb-4",children:x.description}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-500 mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),s.jsx("span",{children:new Date(x.date_debut).toLocaleString("fr-FR")})]}),x.lieu&&s.jsxs("div",{className:"flex items-center",children:[s.jsxs("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),s.jsx("span",{children:x.lieu})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),s.jsxs("span",{children:[x.participants_count," participant(s)"]})]}),x.createur_nom&&s.jsxs("div",{className:"text-xs text-gray-400 mt-2",children:["Cr par ",x.createur_nom]})]}),s.jsxs("div",{className:"flex gap-2",children:[x.est_inscrit?s.jsx(oe,{variant:"outline",onClick:()=>y(x.id),className:"flex-1",children:"Se dsinscrire"}):s.jsx(oe,{onClick:()=>v(x.id),className:"flex-1",children:"S'inscrire"}),x.lien_visio&&s.jsxs("a",{href:x.lien_visio,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium flex items-center",children:[s.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Rejoindre"]})]})]},x.id))}),s.jsx(ac,{isOpen:i,onClose:()=>a(!1),title:"Crer un vnement",size:"lg",children:s.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[u&&s.jsx("div",{className:"bg-red-100 border border-red-300 text-red-700 px-4 py-2 rounded-lg",children:u}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre de l'vnement *"}),s.jsx("input",{type:"text",placeholder:"Ex: Lecture collective de...",value:c.titre,onChange:x=>f({...c,titre:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{placeholder:"Dcrivez votre vnement...",value:c.description,onChange:x=>f({...c,description:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date et heure de dbut *"}),s.jsx("input",{type:"datetime-local",value:c.date_debut,onChange:x=>f({...c,date_debut:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date et heure de fin"}),s.jsx("input",{type:"datetime-local",value:c.date_fin,onChange:x=>f({...c,date_fin:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type d'vnement"}),s.jsxs("select",{value:c.type,onChange:x=>f({...c,type:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"rencontre",children:"Rencontre littraire"}),s.jsx("option",{value:"webinar",children:"Webinaire"}),s.jsx("option",{value:"atelier",children:"Atelier d'criture"}),s.jsx("option",{value:"lecture",children:"Lecture collective"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lieu (optionnel)"}),s.jsx("input",{type:"text",placeholder:"Ex: Caf littraire, En ligne...",value:c.lieu,onChange:x=>f({...c,lieu:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre maximum de participants (optionnel)"}),s.jsx("input",{type:"number",placeholder:"Ex: 20",min:"1",value:c.max_participants,onChange:x=>f({...c,max_participants:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lien visio (optionnel)"}),s.jsx("input",{type:"url",placeholder:"https://meet.google.com/...",value:c.lien_visio,onChange:x=>f({...c,lien_visio:x.target.value}),className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(oe,{type:"button",variant:"outline",onClick:()=>{a(!1),h(null)},disabled:o,children:"Annuler"}),s.jsx(oe,{type:"submit",disabled:o||!c.titre.trim()||!c.date_debut,children:o?"Cration...":"Crer l'vnement"})]})]})})]})})}function qH(){const{id:r}=Ku(),{user:e}=st(),[t,n]=R.useState([]),[i,a]=R.useState(null),[o,l]=R.useState(!0),u=async()=>{try{const v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/members`,{headers:{Authorization:`Bearer ${e.token}`}})).json();v.success&&n(v.members)}catch(g){console.error("Erreur:",g)}},h=async()=>{try{const v=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}`,{headers:{Authorization:`Bearer ${e.token}`}})).json();v.success&&a(v.club)}catch(g){console.error("Erreur:",g)}finally{l(!1)}};R.useEffect(()=>{h(),u()},[r]);const c=async(g,v)=>{try{const x=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/members/${g}/role`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({role:v})})).json();x.success?(u(),alert("Rle mis  jour")):alert(x.message)}catch{alert("Erreur lors de la mise  jour")}},f=async g=>{if(confirm("Retirer ce membre du club ?"))try{const y=await(await fetch(`https://vakio-boky-backend.onrender.com/api/clubs/${r}/members/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${e.token}`}})).json();y.success?(u(),alert("Membre retir")):alert(y.message)}catch{alert("Erreur lors du retrait")}},m=t.find(g=>g.user_id===e.id)?.role;return o?s.jsx("div",{className:"text-center p-8",children:"Chargement..."}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[s.jsxs(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-xl p-6 mb-6",children:[s.jsxs("h1",{className:"text-3xl font-bold text-blue-900 mb-2",children:["Membres du club - ",i?.nom]}),s.jsxs("p",{className:"text-gray-600",children:[t.length," membre",t.length!==1?"s":""]})]}),s.jsx("div",{className:"grid gap-4",children:t.map((g,v)=>s.jsxs(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:v*.1},className:"bg-white rounded-2xl shadow-md p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:g.nom.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:g.nom}),s.jsx("p",{className:"text-sm text-gray-500",children:g.email}),s.jsx("span",{className:`inline-block mt-1 px-2 py-1 text-xs rounded-full ${g.role==="admin"?"bg-purple-100 text-purple-800":g.role==="moderateur"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:g.role})]})]}),m==="admin"&&g.user_id!==e.id&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("select",{value:g.role,onChange:y=>c(g.user_id,y.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[s.jsx("option",{value:"membre",children:"Membre"}),s.jsx("option",{value:"moderateur",children:"Modrateur"}),s.jsx("option",{value:"admin",children:"Admin"})]}),s.jsx("button",{onClick:()=>f(g.user_id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},g.id))})]})})}function $H(){const{user:r}=st(),[e,t]=R.useState([]),[n,i]=R.useState(0),a=async()=>{try{const f=await(await fetch("https://vakio-boky-backend.onrender.com/api/notifications",{headers:{Authorization:`Bearer ${r.token}`}})).json();f.success&&(t(f.notifications),i(f.notifications.filter(m=>!m.lue).length))}catch(c){console.error("Erreur:",c)}};R.useEffect(()=>{a();const c=setInterval(a,3e4);return()=>clearInterval(c)},[]);const o=async c=>{try{(await(await fetch(`https://vakio-boky-backend.onrender.com/api/notifications/${c}/read`,{method:"PUT",headers:{Authorization:`Bearer ${r.token}`}})).json()).success&&a()}catch(f){console.error("Erreur:",f)}},l=async()=>{try{(await(await fetch("https://vakio-boky-backend.onrender.com/api/notifications/read-all",{method:"PUT",headers:{Authorization:`Bearer ${r.token}`}})).json()).success&&a()}catch(c){console.error("Erreur:",c)}},u=async c=>{try{(await(await fetch(`https://vakio-boky-backend.onrender.com/api/notifications/${c}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.token}`}})).json()).success&&a()}catch(f){console.error("Erreur:",f)}},h=c=>{switch(c){case"event":return"";case"post":return"";case"member":return"";default:return""}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 py-8",children:s.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[s.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-xl p-6 mb-6",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-blue-900",children:"Notifications"}),s.jsx("p",{className:"text-gray-600",children:n>0?`${n} non lue(s)`:"Toutes lues"})]}),n>0&&s.jsx(oe,{onClick:l,variant:"outline",size:"sm",children:"Tout marquer comme lu"})]})}),s.jsx("div",{className:"space-y-3",children:s.jsx(zs,{children:e.length===0?s.jsx(W.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-2xl shadow-md p-8 text-center",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune notification"})}):e.map((c,f)=>s.jsx(W.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:f*.05},className:`bg-white rounded-2xl shadow-md p-4 border-l-4 ${c.lue?"border-gray-300":"border-blue-500 bg-blue-50"}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[s.jsx("span",{className:"text-xl mt-1",children:h(c.type)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:`font-semibold ${c.lue?"text-gray-700":"text-gray-900"}`,children:c.titre}),s.jsx("p",{className:"text-gray-600 text-sm mt-1",children:c.message}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(c.created_at).toLocaleString("fr-FR")}),c.lien&&s.jsx(tr,{to:c.lien,onClick:()=>o(c.id),className:"inline-block mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Voir les dtails "})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[!c.lue&&s.jsx("button",{onClick:()=>o(c.id),className:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Marquer comme lu",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),s.jsx("button",{onClick:()=>u(c.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Supprimer",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},c.id))})})]})})}function WH({post:r,onCommentAdded:e,onCommentDeleted:t}){const[n,i]=R.useState([]),[a,o]=R.useState(""),[l,u]=R.useState(!1),[h,c]=R.useState(!1),[f,m]=R.useState(null),[g,v]=R.useState(""),y=st(),x=y.user?.user,b=y.user?.token,w=async()=>{if(r?.id){c(!0);try{const A=await(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${r.id}`)).json();A.comments&&i(A.comments)}catch(S){console.error("Erreur chargement commentaires:",S)}finally{c(!1)}}},k=async S=>{if(S.preventDefault(),!!a.trim()){u(!0);try{const C=await(await fetch("https://vakio-boky-backend.onrender.com/api/comments",{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({contenu:a})})).json();C.comment&&(i(I=>[...I,C.comment]),o(""),e?.(C.comment))}catch(A){console.error("Erreur ajout commentaire:",A)}finally{u(!1)}}},N=async S=>{if(confirm("Supprimer ce commentaire ?"))try{(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${S}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}})).ok&&(i(C=>C.filter(I=>I.id!==S)),t?.(S))}catch(A){console.error("Erreur suppression commentaire:",A)}},E=async S=>{if(g.trim())try{const C=await(await fetch(`https://vakio-boky-backend.onrender.com/api/comments/${S}`,{method:"PUT",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({contenu:g})})).json();C.comment&&(i(I=>I.map(L=>L.id===S?C.comment:L)),m(null),v(""))}catch(A){console.error("Erreur modification commentaire:",A)}};return R.useEffect(()=>{w()},[r?.id]),s.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[s.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:h?s.jsx("div",{className:"text-center py-2 text-gray-500",children:"Chargement..."}):n.length===0?s.jsx("div",{className:"text-center py-2 text-gray-500 text-sm",children:"Aucun commentaire"}):n.map(S=>s.jsxs("div",{className:"flex gap-3 group",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(Qt,{className:"text-blue-600 text-sm"})})}),s.jsx("div",{className:"flex-1 min-w-0",children:f===S.id?s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ve,{value:g,onChange:A=>v(A.target.value),className:"flex-1",autoFocus:!0}),s.jsx(oe,{size:"sm",onClick:()=>E(S.id),children:""}),s.jsx(oe,{variant:"outline",size:"sm",onClick:()=>m(null),children:""})]}):s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsxs("div",{className:"flex justify-between items-start mb-1",children:[s.jsx("p",{className:"font-medium text-sm text-blue-900",children:S.user_nom}),x?.id===S.user_id&&s.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>{m(S.id),v(S.contenu)},className:"p-1 hover:bg-gray-200 rounded text-gray-600",children:s.jsx(as,{size:12})}),s.jsx("button",{onClick:()=>N(S.id),className:"p-1 hover:bg-red-100 rounded text-red-600",children:s.jsx(zt,{size:12})})]})]}),s.jsx("p",{className:"text-gray-700 text-sm",children:S.contenu}),s.jsx("p",{className:"text-gray-400 text-xs mt-1",children:new Date(S.created_at).toLocaleTimeString("fr-FR")})]})})]},S.id))}),s.jsx("form",{onSubmit:k,className:"flex gap-2",children:s.jsxs(W.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"flex items-center rounded-md bg-white border border-blue-400 text-blue-900 placeholder:text-blue-400 px-3 py-2 gap-2",children:[s.jsx("input",{type:"text",value:a,onChange:S=>o(S.target.value),placeholder:"Ajouter un commentaire...",required:!0,className:"outline-none w-full bg-transparent text-sm gap-2"}),s.jsx("button",{type:"submit",disabled:l||!a.trim(),className:"flex items-center rounded-full bg-blue-500 text-white hover:bg-blue-600 p-3",children:s.jsx(i0,{size:14})})]})})]})}const Ok=({children:r})=>s.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[s.jsx(MS,{}),s.jsxs("main",{className:"flex-1 pt-20",children:[" ",s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:r})]}),s.jsx(tO,{})]}),GH=[{path:"/",component:mO,layout:!0},{path:"/explore",component:LL,layout:!0},{path:"/marketplace",component:s5,layout:!0},{path:"/challenges",component:FH,layout:!0},{path:"/reader",component:IH,layout:!0},{path:"/profile",component:o5,layout:!0},{path:"/postes",component:l5,layout:!0},{path:"/booklist",component:c5,layout:!0},{path:"/club",component:d5,layout:!0},{path:"/fundraising",component:g5,layout:!0},{path:"/events",component:y5,layout:!0},{path:"/calendar",component:a7,layout:!0},{path:"/login",component:aO,layout:!1},{path:"/register",component:oO,layout:!1},{path:"/forgot-password",component:lO,layout:!1},{path:"/verify-code",component:cO,layout:!1},{path:"/reset-password",component:dO,layout:!1},{path:"/clubs/:id",component:zH,layout:!1},{path:"/clubs/:id/edit",component:HH,layout:!1},{path:"/create",component:UH,layout:!1},{path:"/clubs/:id/members",component:qH,layout:!1},{path:"/clubs/:id/events",component:VH,layout:!1},{path:"/notifications",component:$H,layout:!1},{path:"/postComment",component:WH,layout:!1},{path:"/propos",component:u5,layout:!1}];function YH(){return s.jsx(OD,{children:s.jsx("div",{className:"App",children:s.jsxs(Wk,{children:[s.jsx(Ye,{path:"/admin/*",element:s.jsx(B7,{})}),GH.map(({path:r,component:e,layout:t})=>s.jsx(Ye,{path:r,element:t?s.jsx(Ok,{children:s.jsx(e,{})}):s.jsx(e,{})},r)),s.jsx(Ye,{path:"*",element:s.jsx(Ok,{children:s.jsxs("div",{className:"text-center py-20",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"404 - Page non trouve"}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"La page que vous recherchez n'existe pas."}),s.jsx("a",{href:"/",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Retour  l'accueil"})]})})})]})})})}IR.createRoot(document.getElementById("root")).render(s.jsx(_r.StrictMode,{children:s.jsx(XM,{children:s.jsx(YH,{})})}));
